diff --git a/dist/field-editor-markdown.cjs.development.js b/dist/field-editor-markdown.cjs.development.js
index e21963032475569b5de679f5eb57a7e9d56308cd..e6f4f1b823adadbd2fa3a4d3eaf3ad904f4ac4a5 100644
--- a/dist/field-editor-markdown.cjs.development.js
+++ b/dist/field-editor-markdown.cjs.development.js
@@ -4620,7 +4620,8 @@ var renderMarkdownDialog = function renderMarkdownDialog(sdk) {
   return React__default.createElement("div", null);
 };
 
-exports.MarkdownEditor = MarkdownEditorConnected;
+exports.MarkdownEditor = MarkdownEditor;
+exports.MarkdownEditorConnected = MarkdownEditorConnected;
 exports.MarkdownPreview = MarkdownPreview;
 exports.openMarkdownDialog = openMarkdownDialog;
 exports.renderMarkdownDialog = renderMarkdownDialog;
diff --git a/dist/field-editor-markdown.cjs.development.js.map b/dist/field-editor-markdown.cjs.development.js.map
index ca1f9a9cf235d0df00c858833b3240b0aca2b379..7392d6c279a5c4e352071f1270aca3d8c29dd48e 100644
--- a/dist/field-editor-markdown.cjs.development.js.map
+++ b/dist/field-editor-markdown.cjs.development.js.map
@@ -1 +1 @@
-{"version":3,"file":"field-editor-markdown.cjs.development.js","sources":["../src/components/MarkdownTabs.tsx","../src/components/icons.tsx","../src/components/HeadingSelector.tsx","../src/components/InsertLinkSelector.tsx","../src/components/MarkdownToolbar.tsx","../src/utils/userAgent.ts","../src/components/MarkdownTextarea/CodeMirrorWrapper.ts","../src/components/MarkdownTextarea/MarkdownCommands.ts","../src/components/MarkdownTextarea/createMarkdownEditor.ts","../src/components/MarkdownTextarea/MarkdownTextarea.tsx","../src/components/MarkdownBottomBar.tsx","../src/types.ts","../src/dialogs/CheatsheetModalDialog.tsx","../src/utils/replaceMailtoAmp.ts","../src/components/MarkdownPreview.tsx","../src/components/MarkdownConstraints.tsx","../../../node_modules/regenerator-runtime/runtime.js","../src/utils/isValidUrl.ts","../src/dialogs/InsertLinkModalDialog.tsx","../src/utils/specialCharacters.ts","../src/dialogs/SpecialCharacterModalDialog.tsx","../src/dialogs/InsertTableModalDialog.tsx","../src/dialogs/EmdebExternalContentDialog.tsx","../src/dialogs/ConfirmInsertAssetModalDialog.tsx","../src/dialogs/ZenModeModalDialog.tsx","../src/utils/insertAssetLinks.ts","../src/utils/linkOrganizer.ts","../src/MarkdownActions.ts","../src/MarkdownEditor.tsx","../src/dialogs/openMarkdownDialog.tsx","../src/dialogs/renderMarkdownDialog.tsx"],"sourcesContent":["import React from 'react';\nimport { css, cx } from 'emotion';\nimport tokens from '@contentful/f36-tokens';\nimport { MarkdownTab } from '../types';\n\nconst styles = {\n  root: css({\n    display: 'flex',\n    zIndex: 10,\n    flexDirection: 'row',\n    justifyContent: 'flex-end',\n    overflow: 'hidden',\n    marginBottom: '-1px',\n    fontSize: tokens.fontSizeM,\n  }),\n  tab: css({\n    cursor: 'pointer',\n    color: tokens.gray700,\n    padding: tokens.spacingXs,\n    minWidth: '70px',\n    border: `1px solid ${tokens.gray400}`,\n    borderTopLeftRadius: tokens.borderRadiusSmall,\n    borderTopRightRadius: tokens.borderRadiusSmall,\n    marginLeft: tokens.spacingXs,\n    textAlign: 'center',\n    backgroundColor: tokens.gray100,\n    borderBottomColor: tokens.gray100,\n    outline: 'none',\n    '&:focus': {\n      boxShadow: tokens.boxShadowHeavy,\n    },\n    transition: `all ${tokens.transitionEasingDefault} ${tokens.transitionDurationShort}`,\n  }),\n  inactiveTab: css({\n    background: tokens.gray200,\n    borderBottomColor: tokens.gray400,\n    '&:hover': {\n      background: tokens.gray300,\n    },\n  }),\n};\n\ninterface MarkdownTabsProps {\n  active: MarkdownTab;\n  onSelect: (selected: MarkdownTab) => void;\n}\n\nfunction MarkdownTabItem(props: {\n  isActive: boolean;\n  name: MarkdownTab;\n  testId: string;\n  onSelect: (name: MarkdownTab) => void;\n  children: React.ReactNode;\n}) {\n  return (\n    <div\n      className={cx(styles.tab, {\n        [styles.inactiveTab]: props.isActive === false,\n      })}\n      onClick={() => {\n        props.onSelect(props.name);\n      }}\n      onKeyDown={(e) => {\n        if (e.keyCode === 13) {\n          props.onSelect(props.name);\n        }\n      }}\n      tabIndex={0}\n      role=\"tab\"\n      aria-controls={props.name}\n      aria-selected={props.isActive === true}\n      data-test-id={props.testId}>\n      {props.children}\n    </div>\n  );\n}\n\nexport function MarkdownTabs(props: MarkdownTabsProps) {\n  return (\n    <div className={styles.root}>\n      <MarkdownTabItem\n        name=\"editor\"\n        onSelect={props.onSelect}\n        isActive={props.active === 'editor'}\n        testId=\"markdown-tab-md\">\n        Editor\n      </MarkdownTabItem>\n      <MarkdownTabItem\n        name=\"preview\"\n        onSelect={props.onSelect}\n        isActive={props.active === 'preview'}\n        testId=\"markdown-tab-preview\">\n        Preview\n      </MarkdownTabItem>\n    </div>\n  );\n}\n","import React from 'react';\nimport { css } from 'emotion';\n\ntype IconProps = {\n  width?: number;\n  height?: number;\n  className?: string;\n  label: string;\n};\n\nconst srOnly = css({\n  position: 'absolute',\n  width: '1px',\n  height: '1px',\n  padding: '0',\n  margin: '-1px',\n  overflow: 'hidden',\n  clip: 'rect(0, 0, 0, 0)',\n  border: '0',\n});\n\nexport const Zen = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1411 541l-355 355 355 355 144-144q29-31 70-14 39 17 39 59v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l144-144-355-355-355 355 144 144q31 30 14 69-17 40-59 40H192q-26 0-45-19t-19-45v-448q0-42 40-59 39-17 69 14l144 144 355-355-355-355-144 144q-19 19-45 19-12 0-24-5-40-17-40-59V192q0-26 19-45t45-19h448q42 0 59 40 17 39-14 69L541 381l355 355 355-355-144-144q-31-30-14-69 17-40 59-40h448q26 0 45 19t19 45v448q0 42-39 59-13 5-25 5-26 0-45-19z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Strikethrough = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1760 896q14 0 23 9t9 23v64q0 14-9 23t-23 9H32q-14 0-23-9t-9-23v-64q0-14 9-23t23-9h1728zM483 832q-28-35-51-80-48-98-48-188 0-181 134-309 133-127 393-127 50 0 167 19 66 12 177 48 10 38 21 118 14 123 14 183 0 18-5 45l-12 3-84-6-14-2q-50-149-103-205-88-91-210-91-114 0-182 59-67 58-67 146 0 73 66 140t279 129q69 20 173 66 58 28 95 52H483zm507 256h411q7 39 7 92 0 111-41 212-23 56-71 104-37 35-109 81-80 48-153 66-80 21-203 21-114 0-195-23l-140-40q-57-16-72-28-8-8-8-22v-13q0-108-2-156-1-30 0-68l2-37v-44l102-2q15 34 30 71t22.5 56 12.5 27q35 57 80 94 43 36 105 57 59 22 132 22 64 0 139-27 77-26 122-86 47-61 47-129 0-84-81-157-34-29-137-71z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Indent = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M352 832q0 14-9 23L55 1143q-9 9-23 9-13 0-22.5-9.5T0 1120V544q0-13 9.5-22.5T32 512q14 0 23 9l288 288q9 9 9 23zm1440 480v192q0 13-9.5 22.5t-22.5 9.5H32q-13 0-22.5-9.5T0 1504v-192q0-13 9.5-22.5T32 1280h1728q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5t-22.5 9.5H672q-13 0-22.5-9.5T640 1120V928q0-13 9.5-22.5T672 896h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5T1760 768H672q-13 0-22.5-9.5T640 736V544q0-13 9.5-22.5T672 512h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5T1760 384H32q-13 0-22.5-9.5T0 352V160q0-13 9.5-22.5T32 128h1728q13 0 22.5 9.5t9.5 22.5z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Dedent = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M384 544v576q0 13-9.5 22.5T352 1152q-14 0-23-9L41 855q-9-9-9-23t9-23l288-288q9-9 23-9 13 0 22.5 9.5T384 544zm1408 768v192q0 13-9.5 22.5t-22.5 9.5H32q-13 0-22.5-9.5T0 1504v-192q0-13 9.5-22.5T32 1280h1728q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5t-22.5 9.5H672q-13 0-22.5-9.5T640 1120V928q0-13 9.5-22.5T672 896h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5T1760 768H672q-13 0-22.5-9.5T640 736V544q0-13 9.5-22.5T672 512h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5T1760 384H32q-13 0-22.5-9.5T0 352V160q0-13 9.5-22.5T32 128h1728q13 0 22.5 9.5t9.5 22.5z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Cubes = ({ label, ...rest }: IconProps) => (\n  <svg width={18} height={14} viewBox=\"0 0 2304 1792\" {...rest}>\n    <path d=\"M640 1632l384-192v-314l-384 164v342zm-64-454l404-173-404-173-404 173zm1088 454l384-192v-314l-384 164v342zm-64-454l404-173-404-173-404 173zm-448-293l384-165V454l-384 164v267zm-64-379l441-189-441-189-441 189zm1088 518v416q0 36-19 67t-52 47l-448 224q-25 14-57 14t-57-14l-448-224q-4-2-7-4-2 2-7 4l-448 224q-25 14-57 14t-57-14L71 1554q-33-16-52-47t-19-67v-416q0-38 21.5-70T78 906l434-186V320q0-38 21.5-70t56.5-48l448-192q23-10 50-10t50 10l448 192q35 16 56.5 48t21.5 70v400l434 186q36 16 57 48t21 70z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Table = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M576 1376v-192q0-14-9-23t-23-9H224q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm0-384V800q0-14-9-23t-23-9H224q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm512 384v-192q0-14-9-23t-23-9H736q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zM576 608V416q0-14-9-23t-23-9H224q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm512 384V800q0-14-9-23t-23-9H736q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm512 384v-192q0-14-9-23t-23-9h-320q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm-512-768V416q0-14-9-23t-23-9H736q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm512 384V800q0-14-9-23t-23-9h-320q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm0-384V416q0-14-9-23t-23-9h-320q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm128-320v1088q0 66-47 113t-113 47H224q-66 0-113-47t-47-113V288q0-66 47-113t113-47h1344q66 0 113 47t47 113z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const SpecialChar = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1360 1307l35 159q3 12-3 22.5t-17 14.5l-5 1q-4 2-10.5 3.5t-16 4.5-21.5 5.5-25.5 5-30 5-33.5 4.5-36.5 3-38.5 1q-234 0-409-130.5T511 1054h-95q-13 0-22.5-9.5T384 1022V909q0-13 9.5-22.5T416 877h66q-2-57 1-105h-67q-14 0-23-9t-9-23V626q0-14 9-23t23-9h98q67-210 243.5-338T1158 128q102 0 194 23 11 3 20 15 6 11 3 24l-43 159q-3 13-14 19.5t-24 2.5l-4-1q-4-1-11.5-2.5L1261 364l-22.5-3.5-26-3-29-2.5-29.5-1q-126 0-226 64T778 594h468q16 0 25 12 10 12 7 26l-24 114q-5 26-32 26H734q-3 37 0 105h459q15 0 25 12 9 12 6 27l-24 112q-2 11-11 18.5t-20 7.5H782q48 117 149.5 185.5T1160 1308q18 0 36-1.5t33.5-3.5 29.5-4.5 24.5-5 18.5-4.5l12-3 5-2q13-5 26 2 12 7 15 21z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const OrgLinks = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1792 1248v320q0 40-28 68t-68 28h-320q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h96V960H960v192h96q40 0 68 28t28 68v320q0 40-28 68t-68 28H736q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h96V960H320v192h96q40 0 68 28t28 68v320q0 40-28 68t-68 28H96q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h96V960q0-52 38-90t90-38h512V640h-96q-40 0-68-28t-28-68V224q0-40 28-68t68-28h320q40 0 68 28t28 68v320q0 40-28 68t-68 28h-96v192h512q52 0 90 38t38 90v192h96q40 0 68 28t28 68z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Undo = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1664 896q0 156-61 298t-164 245-245 164-298 61q-172 0-327-72.5T305 1387q-7-10-6.5-22.5t8.5-20.5l137-138q10-9 25-9 16 2 23 12 73 95 179 147t225 52q104 0 198.5-40.5T1258 1258t109.5-163.5T1408 896t-40.5-198.5T1258 534t-163.5-109.5T896 384q-98 0-188 35.5T548 521l137 138q31 30 14 69-17 40-59 40H192q-26 0-45-19t-19-45V256q0-42 40-59 39-17 69 14l130 129q107-101 244.5-156.5T896 128q156 0 298 61t245 164 164 245 61 298z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Redo = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1664 256v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l138-138q-148-137-349-137-104 0-198.5 40.5T534 534 424.5 697.5 384 896t40.5 198.5T534 1258t163.5 109.5T896 1408q119 0 225-52t179-147q7-10 23-12 15 0 25 9l137 138q9 8 9.5 20.5t-7.5 22.5q-109 132-264 204.5T896 1664q-156 0-298-61t-245-164-164-245-61-298 61-298 164-245 245-164 298-61q147 0 284.5 55.5T1425 340l130-129q29-31 70-14 39 17 39 59z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n","import React from 'react';\nimport { Menu } from '@contentful/f36-components';\nimport { HeadingType } from '../types';\n\nexport const HeadingSelector = (props: {\n  children: React.ReactElement;\n  onSelect: (heading: HeadingType) => void;\n  tooltip?: string;\n}) => {\n  const handleMenuClick = (heading: HeadingType) => {\n    props.onSelect(heading);\n  };\n\n  return (\n    <Menu>\n      <Menu.Trigger>{props.children}</Menu.Trigger>\n      <Menu.List>\n        <Menu.Item testId=\"markdown-action-button-heading-h1\" onClick={() => handleMenuClick('h1')}>\n          Heading 1\n        </Menu.Item>\n        <Menu.Item testId=\"markdown-action-button-heading-h2\" onClick={() => handleMenuClick('h2')}>\n          Heading 2\n        </Menu.Item>\n        <Menu.Item testId=\"markdown-action-button-heading-h3\" onClick={() => handleMenuClick('h3')}>\n          Heading 3\n        </Menu.Item>\n      </Menu.List>\n    </Menu>\n  );\n};\n","import React from 'react';\nimport { Menu } from '@contentful/f36-components';\n\nimport { Button } from '@contentful/f36-components';\n\nimport { AssetIcon, ChevronDownIcon } from '@contentful/f36-icons';\n\ninterface InsertLinkSelectorProps {\n  onSelectExisting: Function;\n  onAddNew: Function;\n  canAddNew: boolean;\n  disabled: boolean;\n}\n\nexport const InsertLinkSelector = (props: InsertLinkSelectorProps) => {\n  if (props.canAddNew) {\n    return <MultipleMediaContextMenu {...props} />;\n  } else {\n    return (\n      <Button\n        isDisabled={props.disabled}\n        startIcon={<AssetIcon />}\n        testId=\"markdownEditor.linkExistingAssets\"\n        size=\"small\"\n        variant=\"secondary\"\n        onClick={() => {\n          props.onSelectExisting();\n        }}>\n        Insert media\n      </Button>\n    );\n  }\n};\n\nconst MultipleMediaContextMenu = (props: InsertLinkSelectorProps) => {\n  return (\n    <Menu placement=\"bottom-end\">\n      <Menu.Trigger>\n        <Button\n          endIcon={<ChevronDownIcon />}\n          isDisabled={props.disabled}\n          startIcon={<AssetIcon />}\n          testId=\"markdownEditor.insertMediaDropdownTrigger\"\n          size=\"small\"\n          variant=\"secondary\">\n          Insert media\n        </Button>\n      </Menu.Trigger>\n      <Menu.List>\n        <Menu.Item testId=\"markdownEditor.uploadAssetsAndLink\" onClick={() => props.onAddNew()}>\n          Add new media and link\n        </Menu.Item>\n        <Menu.Item\n          testId=\"markdownEditor.linkExistingAssets\"\n          onClick={() => props.onSelectExisting()}>\n          Link existing media\n        </Menu.Item>\n      </Menu.List>\n    </Menu>\n  );\n};\n","/* eslint-disable react/prop-types */\nimport React from 'react';\nimport { css, cx } from 'emotion';\nimport { IconButton, Flex, Tooltip } from '@contentful/f36-components';\nimport type { ButtonProps } from '@contentful/f36-components';\nimport tokens from '@contentful/f36-tokens';\nimport {\n  HeadingIcon,\n  FormatBoldIcon,\n  FormatItalicIcon,\n  QuoteIcon,\n  ListBulletedIcon,\n  ListNumberedIcon,\n  LinkIcon,\n  CodeIcon,\n  HorizontalRuleIcon,\n  MoreHorizontalIcon,\n} from '@contentful/f36-icons';\nimport * as Icons from './icons';\nimport { HeadingSelector } from './HeadingSelector';\nimport { InsertLinkSelector } from './InsertLinkSelector';\nimport { MarkdownActions } from '../types';\n\nconst styles = {\n  root: css({\n    position: 'relative',\n    zIndex: Number(tokens.zIndexWorkbenchHeader),\n    border: `1px solid ${tokens.gray400}`,\n    backgroundColor: tokens.gray100,\n    padding: tokens.spacingXs,\n    borderTopLeftRadius: tokens.borderRadiusSmall,\n  }),\n  button: css({\n    height: '30px',\n    width: '36px',\n    marginLeft: tokens.spacing2Xs,\n    marginRight: tokens.spacing2Xs,\n  }),\n  icon: css({\n    fill: tokens.gray700,\n    verticalAlign: 'middle',\n  }),\n  zenButton: css({\n    marginLeft: tokens.spacingXs,\n  }),\n  zenButtonPressed: css({\n    backgroundColor: tokens.gray400,\n  }),\n  tooltip: css({\n    zIndex: Number(tokens.zIndexTooltip),\n  }),\n};\n\nconst ToolbarButton = React.forwardRef<\n  HTMLButtonElement,\n  {\n    variant?: 'transparent' | 'secondary';\n    onClick?: Function;\n    tooltipPlace?: 'top' | 'bottom';\n    tooltip: string;\n    children: React.ReactElement;\n  } & Omit<ButtonProps, 'onClick'>\n>((props, ref) => {\n  const {\n    tooltip,\n    onClick,\n    children,\n    className,\n    variant = 'transparent',\n    tooltipPlace = 'top',\n    isDisabled = false,\n    ...otherProps\n  } = props;\n\n  return (\n    <Tooltip className={styles.tooltip} placement={tooltipPlace} content={tooltip}>\n      <IconButton\n        {...otherProps}\n        ref={ref}\n        className={cx(styles.button, className)}\n        isDisabled={isDisabled}\n        onClick={onClick as ButtonProps['onClick']}\n        variant={variant}\n        size=\"small\"\n        icon={children}\n        aria-label={tooltip}\n      />\n    </Tooltip>\n  );\n});\nToolbarButton.displayName = 'ToolbarButton';\n\ninterface MarkdownToolbarProps {\n  canUploadAssets: boolean;\n  disabled: boolean;\n  actions: MarkdownActions;\n  mode: 'default' | 'zen';\n}\n\nfunction MainButtons(props: MarkdownToolbarProps) {\n  const tooltipPlace = props.mode === 'zen' ? 'bottom' : 'top';\n\n  return (\n    <>\n      <HeadingSelector\n        onSelect={(heading) => {\n          if (heading && props.actions.headings[heading]) {\n            props.actions.headings[heading]();\n          }\n        }}>\n        <ToolbarButton\n          isDisabled={props.disabled}\n          testId=\"markdown-action-button-heading\"\n          tooltip=\"Headings\"\n          tooltipPlace={tooltipPlace}>\n          <HeadingIcon aria-label=\"Headings\" className={styles.icon} />\n        </ToolbarButton>\n      </HeadingSelector>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-bold\"\n        tooltip=\"Bold\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.bold}>\n        <FormatBoldIcon aria-label=\"Bold\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-italic\"\n        tooltip=\"Italic\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.italic}>\n        <FormatItalicIcon aria-label=\"Italic\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-quote\"\n        tooltip=\"Quote\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.quote}>\n        <QuoteIcon aria-label=\"Quote\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-ul\"\n        tooltip=\"Unordered list\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.ul}>\n        <ListBulletedIcon aria-label=\"Unordered list\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-ol\"\n        tooltip=\"Ordered list\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.ol}>\n        <ListNumberedIcon aria-label=\"Ordered list\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-link\"\n        tooltip=\"Link\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.insertLink}>\n        <LinkIcon aria-label=\"Link\" className={styles.icon} />\n      </ToolbarButton>\n    </>\n  );\n}\n\nfunction AdditionalButtons(props: MarkdownToolbarProps) {\n  const tooltipPlace = props.mode === 'zen' ? 'bottom' : 'top';\n  return (\n    <>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-strike\"\n        tooltip=\"Strike out\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.strike}>\n        <Icons.Strikethrough label=\"Strike out\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-code\"\n        tooltip=\"Code block\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.code}>\n        <CodeIcon aria-label=\"Code block\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-hr\"\n        tooltip=\"Horizontal rule\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.hr}>\n        <HorizontalRuleIcon aria-label=\"Horizontal rule\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-indent\"\n        tooltip=\"Increase indentation\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.indent}>\n        <Icons.Indent label=\"Increase indentation\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-dedent\"\n        tooltip=\"Decrease indentation\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.dedent}>\n        <Icons.Dedent label=\"Decrease indentation\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-embed\"\n        tooltip=\"Embed external content\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.embedExternalContent}>\n        <Icons.Cubes label=\"Embed external content\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-table\"\n        tooltip=\"Insert table\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.insertTable}>\n        <Icons.Table label=\"Insert table\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-special\"\n        tooltip=\"Insert special character\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.insertSpecialCharacter}>\n        <Icons.SpecialChar label=\"Insert special character\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-organizeLinks\"\n        tooltip=\"Organize links\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.organizeLinks}>\n        <Icons.OrgLinks label=\"Organize links\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-undo\"\n        tooltip=\"Undo\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.history.undo}>\n        <Icons.Undo label=\"Undo\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-redo\"\n        tooltip=\"Redo\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.history.redo}>\n        <Icons.Redo label=\"Redo\" className={styles.icon} />\n      </ToolbarButton>\n    </>\n  );\n}\n\nexport function DefaultMarkdownToolbar(props: MarkdownToolbarProps) {\n  const [showAdditional, setShowAdditional] = React.useState(false);\n\n  return (\n    <div className={styles.root}>\n      <Flex justifyContent=\"space-between\">\n        <Flex>\n          <MainButtons {...props} />\n          <ToolbarButton\n            isDisabled={props.disabled}\n            testId=\"markdown-action-button-toggle-additional\"\n            tooltip={showAdditional ? 'Hide additional actions' : 'More actions'}\n            onClick={() => {\n              setShowAdditional(!showAdditional);\n            }}>\n            <MoreHorizontalIcon className={styles.icon} />\n          </ToolbarButton>\n        </Flex>\n        <Flex>\n          <InsertLinkSelector\n            disabled={props.disabled}\n            onSelectExisting={props.actions.linkExistingMedia}\n            onAddNew={props.actions.addNewMedia}\n            canAddNew={props.canUploadAssets}\n          />\n          <ToolbarButton\n            isDisabled={props.disabled}\n            testId=\"markdown-action-button-zen\"\n            variant=\"secondary\"\n            onClick={props.actions.openZenMode}\n            className={styles.zenButton}\n            tooltip=\"Expand\">\n            <Icons.Zen label=\"Expand\" className={styles.icon} />\n          </ToolbarButton>\n        </Flex>\n      </Flex>\n      {showAdditional && (\n        <Flex justifyContent=\"space-between\" marginTop=\"spacingXs\">\n          <Flex>\n            <AdditionalButtons {...props} />\n          </Flex>\n        </Flex>\n      )}\n    </div>\n  );\n}\n\nexport function ZenMarkdownToolbar(props: MarkdownToolbarProps) {\n  return (\n    <div className={styles.root}>\n      <Flex justifyContent=\"space-between\">\n        <Flex>\n          <MainButtons {...props} />\n          <AdditionalButtons {...props} />\n        </Flex>\n        <Flex>\n          <InsertLinkSelector\n            disabled={props.disabled}\n            onSelectExisting={props.actions.linkExistingMedia}\n            onAddNew={props.actions.addNewMedia}\n            canAddNew={props.canUploadAssets}\n          />\n          <IconButton\n            testId=\"markdown-action-button-zen-close\"\n            variant=\"secondary\"\n            size=\"small\"\n            className={cx(styles.zenButton, styles.zenButtonPressed)}\n            onClick={() => {\n              props.actions.closeZenMode();\n            }}\n            icon={<Icons.Zen label=\"Collapse\" className={styles.icon} />}\n            aria-label=\"Collapse\"\n          />\n        </Flex>\n      </Flex>\n    </div>\n  );\n}\n\nexport const MarkdownToolbar = React.memo((props: MarkdownToolbarProps) => {\n  if (props.mode === 'zen') {\n    return <ZenMarkdownToolbar {...props} />;\n  }\n  return <DefaultMarkdownToolbar {...props} />;\n});\n\nMarkdownToolbar.displayName = 'MarkdownToolbar';\n","import get from 'lodash/get';\n\nconst userAgent = get(window, 'navigator.userAgent', '');\nconst platform = get(window, 'navigator.platform', '');\n\nlet ctrlKey = 'Ctrl';\n\nconst tests = {\n  // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/ban-ts-comment\n  // @ts-ignore ignore missing MSStream\n  ios: /(iphone os|ipad|iphone|ipod)/i.test(userAgent) && !window.MSStream,\n};\n\nif (tests.ios || /mac(68k|ppc|intel)/i.test(platform)) {\n  ctrlKey = 'Cmd';\n}\n\nexport function getCtrlKey() {\n  return ctrlKey;\n}\n","/* eslint-disable @typescript-eslint/no-use-before-define, @typescript-eslint/no-explicit-any */\n\nimport CodeMirror from 'codemirror';\nimport 'codemirror/addon/edit/matchbrackets';\nimport throttle from 'lodash/throttle';\nimport transform from 'lodash/transform';\n\nimport { EditorDirection } from '../../types';\nimport * as userAgent from '../../utils/userAgent';\n\nfunction stripUnit(value: number | string): number {\n  if (typeof value !== 'string') return value;\n\n  const cssRegex = /^([+-]?(?:\\d+|\\d*\\.\\d+))([a-z]*|%)$/;\n  const matchedValue = value.match(cssRegex);\n\n  if (!matchedValue) {\n    throw new Error(\"Couldn't match unit in given string\");\n  }\n\n  return parseFloat(value);\n}\n\nexport function create(\n  host: HTMLElement,\n  options: {\n    direction: EditorDirection;\n    readOnly: boolean;\n    fixedHeight?: number | boolean;\n    height?: number | string;\n  }\n) {\n  const { direction, fixedHeight, height, readOnly } = options || {};\n\n  // Set to true if `setValue()` has been called. This is to prevent\n  // undoing the initial content.\n  let initializedWithValue = false;\n\n  const LF = '\\n';\n\n  const EDITOR_SIZE = {\n    min: height ? stripUnit(height) : 300,\n    max: 500,\n    shift: 50,\n  };\n\n  const cm = CodeMirror(host, {\n    direction,\n    readOnly,\n    mode: 'markdown',\n    lineNumbers: false,\n    undoDepth: 200,\n    matchBrackets: true,\n    lineWrapping: true,\n    // When `lineSeparator === null` the document will be split\n    // on CRLFs as well as lone CRs and LFs. A single LF will\n    // be used as line separator in all output\n    lineSeparator: null,\n    theme: 'elegant',\n    tabSize: 2,\n    indentWithTabs: false,\n    indentUnit: 2,\n    autoRefresh: true,\n    spellcheck: true,\n    inputStyle: 'contenteditable',\n  });\n\n  cm.setSize('100%', EDITOR_SIZE.min);\n\n  if (!fixedHeight) {\n    cm.on('change', throttle(assureHeight, 150));\n  }\n\n  cm.setOption('extraKeys', {\n    Tab: function () {\n      replaceSelectedText(getIndentation());\n    },\n    Enter: 'newlineAndIndentContinueMarkdownList',\n    Esc: () => {\n      cm.getInputField().blur();\n    },\n  });\n\n  /**\n   * @description\n   * Custom API for a CodeMirror instance.\n   *\n   * An instance wraps a CodeMirror instance and provides a custom interface\n   * on top of CodeMirror.\n   */\n  return {\n    destroy,\n    disable,\n    enable,\n    attachEvent,\n    addKeyShortcuts,\n    setValue,\n    cmd,\n    moveToLineBeginning,\n    moveIfNotEmpty,\n    restoreCursor,\n    moveToLineEnd,\n    usePrimarySelection,\n    focus,\n    select,\n    selectBackwards,\n    selectAll: () => cm.execCommand('selectAll'),\n    extendSelectionBy,\n    insertAtCursor,\n    insertAtLineBeginning,\n    wrapSelection,\n    removeFromLineBeginning,\n    removeSelectedText,\n    replaceSelectedText,\n    getCursor,\n    setCursor,\n    getSelection,\n    getLine,\n    isLineEmpty,\n    getSelectedText,\n    getSelectionLength,\n    getCurrentLine,\n    getCurrentLineNumber,\n    getCurrentCharacter,\n    getCurrentLineLength,\n    lineStartsWith,\n    getIndentation,\n    getNl,\n    getValue,\n    getLinesCount,\n    getHistorySize,\n    setReadOnly: (value: boolean) => cm.setOption('readOnly', value),\n    getHistory: () => cm.getHistory(),\n    setHistory: (history: any) => cm.setHistory(history),\n    setFullsize: () => {\n      cm.setSize('100%', '100%');\n      cm.refresh();\n    },\n    refresh: () => cm.refresh(),\n  };\n\n  function destroy() {\n    // @ts-expect-error\n    cm.toTextArea();\n  }\n\n  function disable() {\n    cm.setOption('readOnly', 'nocursor');\n  }\n\n  function enable() {\n    cm.setOption('readOnly', false);\n  }\n\n  function assureHeight() {\n    const current = cm.heightAtLine(cm.lastLine(), 'local') + EDITOR_SIZE.shift;\n    let next = current;\n    if (current < EDITOR_SIZE.min) {\n      next = EDITOR_SIZE.min;\n    }\n    if (current > EDITOR_SIZE.max) {\n      next = EDITOR_SIZE.max;\n    }\n    cm.setSize('100%', next);\n  }\n\n  function attachEvent(name: string, fn: Function, throttleInterval: number) {\n    if (throttleInterval) {\n      fn = throttle(fn as any, throttleInterval);\n    }\n    cm.on(name, fn as any);\n  }\n\n  function addKeyShortcuts(map: any) {\n    const ctrlKey = userAgent.getCtrlKey();\n    cm.addKeyMap(\n      transform(\n        map,\n        (acc, value, key) => {\n          // eslint-disable-next-line -- TODO: describe this disable\n          // @ts-ignore\n          acc[ctrlKey + '-' + key] = value;\n        },\n        {}\n      )\n    );\n  }\n\n  /**\n   * low-level editor manipulation functions\n   */\n\n  /**\n   * @description\n   * Sets the content of the editor while preserving the cursor\n   * position.\n   *\n   * If called for the first time it will not record the change in\n   * the history.\n   */\n  function setValue(value?: string) {\n    value = value || '';\n    if (getValue() === value) {\n      return;\n    }\n\n    // set value, but save cursor position first\n    // position will be restored, but w/o focus (third arg)\n    const line = getCurrentLineNumber();\n    const ch = getCurrentCharacter();\n    cm.setValue(value);\n    restoreCursor(ch, line, true);\n\n    // We do not want to record the initial population in the\n    // history. Otherwise it would always be possible to revert to\n    // the empty string.\n    if (!initializedWithValue) {\n      cm.clearHistory();\n      initializedWithValue = true;\n    }\n  }\n\n  function cmd(name: string) {\n    cm.execCommand(name);\n    cm.focus();\n  }\n\n  function moveToLineBeginning(lineNumber?: number) {\n    cm.setCursor({ line: defaultToCurrentLineNumber(lineNumber), ch: 0 });\n    cm.focus();\n  }\n\n  /**\n   * @description\n   * Insert a new line below the cursor and move to the beginning of\n   * that line.\n   *\n   * Only do this if the editor has content and we are not already on\n   * the last line.\n   *\n   * TODO rename this\n   */\n  function moveIfNotEmpty() {\n    if (getCurrentLineLength() < 1) {\n      return;\n    }\n\n    const next = getCurrentLineNumber() + 1;\n    if (cm.lastLine() < next) {\n      moveToLineEnd();\n      insertAtCursor(getNl());\n    }\n\n    moveToLineBeginning(next);\n  }\n\n  function restoreCursor(character: number, lineNumber?: number, noFocus?: boolean) {\n    cm.setCursor(defaultToCurrentLineNumber(lineNumber), character, {\n      scroll: !noFocus,\n    });\n    if (!noFocus) {\n      cm.focus();\n    }\n  }\n\n  function moveToLineEnd(lineNumber?: number) {\n    cm.setCursor({\n      line: defaultToCurrentLineNumber(lineNumber),\n      ch: getCurrentLineLength(),\n    });\n    cm.focus();\n  }\n\n  function defaultToCurrentLineNumber(lineNumber?: number) {\n    if (lineNumber === 0 || (lineNumber !== undefined && lineNumber > 0)) {\n      return lineNumber;\n    }\n    return getCurrentLineNumber();\n  }\n\n  function usePrimarySelection() {\n    cmd('singleSelection');\n  }\n\n  function focus() {\n    cm.focus();\n  }\n\n  function select(from: CodeMirror.Position, to: CodeMirror.Position) {\n    cm.setSelection(from, to);\n    cm.focus();\n  }\n\n  function selectBackwards(skip: number, len: number) {\n    select(getPos(-skip - len), getPos(-skip));\n\n    function getPos(modifier: number) {\n      return {\n        line: getCurrentLineNumber(),\n        ch: getCurrentCharacter() + modifier,\n      };\n    }\n  }\n\n  function extendSelectionBy(modifier: number) {\n    select(getPos('anchor', 0), getPos('head', modifier));\n\n    function getPos(prop: 'anchor' | 'head', modifier: number): CodeMirror.Position {\n      const selection = getSelection();\n      if (!selection) {\n        return { line: 0, ch: 0 };\n      }\n      return { line: selection[prop].line, ch: selection[prop].ch + modifier };\n    }\n  }\n\n  function insertAtCursor(text: string) {\n    cm.replaceRange(text, cm.getCursor());\n    cm.focus();\n  }\n\n  function insertAtLineBeginning(text: string) {\n    const initialCh = getCurrentCharacter();\n    moveToLineBeginning();\n    insertAtCursor(text);\n    restoreCursor(initialCh + text.length);\n    cm.focus();\n  }\n\n  function wrapSelection(wrapper: string) {\n    const replacement = wrapper + getSelectedText() + wrapper;\n    const selection = getSelection();\n    if (selection) {\n      cm.replaceRange(replacement, selection.anchor, selection?.head);\n      cm.focus();\n    }\n  }\n\n  function removeFromLineBeginning(charCount: number) {\n    const lineNumber = getCurrentLineNumber();\n    cm.replaceRange('', { line: lineNumber, ch: 0 }, { line: lineNumber, ch: charCount });\n    cm.focus();\n  }\n\n  function removeSelectedText() {\n    cm.replaceSelection('');\n    cm.focus();\n  }\n\n  /**\n   * @description\n   * Replace the selected text with the given string.\n   *\n   * If nothing is selected it will insert the text at the current\n   * cursor position\n   *\n   * The optional `select` parameter controls what will be selected\n   * afters wards. By default the cursor will be at the end of the\n   * inserted text. You can pass 'around' to select the inserted\n   * text.\n   */\n  function replaceSelectedText(replacement: string, select?: string) {\n    cm.replaceSelection(replacement, select);\n    cm.focus();\n  }\n\n  /**\n   *  low-level editor get/check functions\n   */\n\n  function getCursor() {\n    return cm.getCursor();\n  }\n\n  function setCursor(cursor: number | CodeMirror.Position) {\n    cm.setCursor(cursor);\n  }\n\n  function getSelection() {\n    const selections = cm.listSelections();\n    if (!cm.somethingSelected() || !selections || selections.length < 1) {\n      return null;\n    }\n    return selections[0];\n  }\n\n  function getLine(lineNumber: number) {\n    return cm.getLine(lineNumber) || '';\n  }\n\n  function isLineEmpty(lineNumber?: number) {\n    const n = defaultToCurrentLineNumber(lineNumber);\n    return n > -1 && getLine(n).length < 1 && n < cm.lineCount();\n  }\n\n  function getLinesCount() {\n    return cm.lineCount();\n  }\n\n  function getSelectedText() {\n    return getSelection() ? cm.getSelection() : '';\n  }\n\n  function getSelectionLength() {\n    return getSelectedText().length;\n  }\n\n  function getCurrentLine() {\n    return getLine(getCurrentLineNumber());\n  }\n\n  function getCurrentLineNumber() {\n    return cm.getCursor().line;\n  }\n\n  function getCurrentCharacter() {\n    return cm.getCursor().ch;\n  }\n\n  function getCurrentLineLength() {\n    return getCurrentLine().length;\n  }\n\n  function lineStartsWith(text: string) {\n    return getCurrentLine().startsWith(text);\n  }\n\n  function getIndentation() {\n    return repeat(' ', cm.getOption('indentUnit') ?? 0);\n  }\n\n  function getNl(n = 1) {\n    if (n < 1) {\n      return '';\n    }\n    return repeat(LF, n);\n  }\n\n  function getValue() {\n    return cm.getValue() || '';\n  }\n\n  function getHistorySize(which?: 'undo' | 'redo') {\n    const history = cm.historySize();\n    return which ? history[which] : history;\n  }\n\n  function repeat(what: string, n: number) {\n    return new Array(n + 1).join(what);\n  }\n}\n","/* eslint-disable @typescript-eslint/no-use-before-define */\n\nimport range from 'lodash/range';\nimport min from 'lodash/min';\nimport max from 'lodash/max';\nimport times from 'lodash/times';\n// eslint-disable-next-line -- TODO: describe this disable  you-dont-need-lodash-underscore/repeat\nimport repeat from 'lodash/repeat';\n\nimport * as CodeMirrorWrapper from './CodeMirrorWrapper';\n\ntype EditorInstanceType = ReturnType<typeof CodeMirrorWrapper.create>;\n\nfunction createPrefixToggleFn(prefix: string) {\n  return (editor: EditorInstanceType) => {\n    if (editor.lineStartsWith(prefix)) {\n      editor.removeFromLineBeginning(prefix.length);\n    } else {\n      editor.insertAtLineBeginning(prefix);\n    }\n  };\n}\n\n/**\n * Wraps the current selection with a marker.\n *\n * If nothing is selected it inserts the given text wrapped in the\n * marker and selects the inner text\n *\n * Used b the `bold`, `italic`, and `strike` commands.\n */\nfunction wrapSelection(editor: EditorInstanceType, marker: string, emptyText: string) {\n  return () => {\n    editor.usePrimarySelection();\n\n    // there's a selection - wrap it with inline marker\n    if (editor.getSelection()) {\n      const selectedText = editor.getSelectedText();\n      if (selectedText.startsWith(marker) && selectedText.endsWith(marker)) {\n        const markerLength = marker.length;\n        const textWithoutMarker = selectedText.slice(\n          markerLength,\n          selectedText.length - markerLength\n        );\n        editor.replaceSelectedText(textWithoutMarker);\n      } else {\n        editor.wrapSelection(marker);\n      }\n    } else {\n      // no selection - insert sample text and select it\n      editor.insertAtCursor(marker + emptyText + marker);\n      editor.selectBackwards(marker.length, emptyText.length);\n    }\n  };\n}\n\nconst HEADER_CHAR = '#';\nconst quoteToggleFn = createPrefixToggleFn('> ');\nconst codeToggleFn = createPrefixToggleFn('    ');\n\n/**\n * @description\n * A collection of commands used by the user bound to a\n * CodeMirrorWrapper instance.\n *\n * The command collection only depends on the wrapper instance and is\n * used by UI from code mirror stuff.\n */\nexport function create(editor: EditorInstanceType) {\n  return {\n    bold: wrapSelection(editor, '__', 'text in bold'),\n    italic: wrapSelection(editor, '*', 'text in italic'),\n    strike: wrapSelection(editor, '~~', 'striked out'),\n    quote: modifySelection(editor, quoteToggleFn),\n    code: modifySelection(editor, codeToggleFn),\n    link,\n    h1: toggleHeader(editor, 1),\n    h2: toggleHeader(editor, 2),\n    h3: toggleHeader(editor, 3),\n    ul: modifySelection(editor, ulToggleFn, true),\n    ol: modifySelection(editor, olToggleFn, true),\n    undo: function () {\n      editor.cmd('undo');\n    },\n    redo: function () {\n      editor.cmd('redo');\n    },\n    hr,\n    indent,\n    dedent,\n    table,\n  };\n\n  /**\n   * @description\n   * Insert a line with `---` below the cursor.\n   */\n  function hr() {\n    editor.moveIfNotEmpty();\n    const nl = editor.getNl();\n    const markup = nl + '---' + nl + nl;\n    editor.insertAtCursor(markup);\n  }\n\n  /**\n   * @description\n   * Indent the current line.\n   */\n  function indent() {\n    editor.insertAtLineBeginning(editor.getIndentation());\n  }\n\n  /**\n   * @description\n   * Dedent the current line.\n   */\n  function dedent() {\n    const indentation = editor.getIndentation();\n    if (editor.lineStartsWith(indentation)) {\n      editor.removeFromLineBeginning(indentation.length);\n    }\n  }\n\n  /**\n   * @description\n   * Insert a markdown table template in a new line.\n   */\n  function table(config: { rows: number; cols: number }) {\n    const nl = editor.getNl();\n    editor.moveIfNotEmpty();\n    editor.insertAtCursor(nl);\n    const line = editor.getCurrentLineNumber();\n    editor.insertAtCursor(tableTemplate(config.rows, config.cols).join(nl));\n    editor.insertAtCursor(nl + nl);\n    editor.restoreCursor(2, line);\n  }\n\n  /**\n   * @description\n   * Inserts or replaces the current selection with a markdown link\n   */\n  function link(url: string, text?: string, title?: string) {\n    editor.usePrimarySelection();\n\n    const linkTitle = title ? ' \"' + title + '\"' : '';\n\n    const link = text ? '[' + text + '](' + url + linkTitle + ')' : '<' + url + '>';\n\n    editor.replaceSelectedText(link, 'around');\n  }\n}\n\n/**\n * For each line in the selection move to that line and call\n * `toggleFn` with the 1-based index of the line in the selection.\n *\n * If there is no selection we just call `toggleFn(editor)`.\n */\nfunction modifySelection(\n  editor: EditorInstanceType,\n  toggleFn: (editor: EditorInstanceType, listNumber?: number) => void,\n  isList?: boolean\n) {\n  return () => {\n    editor.usePrimarySelection();\n\n    const selection = editor.getSelection();\n    if (selection) {\n      // there's a selection - toggle list bullet for each line\n      // listNumber is 1, 2, 3... and can be used as ol bullet\n      forLineIn(selection, (lineNumber: number, listNumber: number) => {\n        // TODO move this into forLineIn\n        editor.moveToLineBeginning(lineNumber);\n        toggleFn(editor, listNumber);\n      });\n      editor.moveToLineEnd();\n    } else {\n      // there's no selection - just toggle line prefix\n      // but if adding list, add whitespace before and after list\n      if (isList && !getListNumber(editor) && !editor.lineStartsWith('- ')) {\n        prepareListWhitespace(editor);\n      }\n      toggleFn(editor);\n    }\n  };\n}\n\n/**\n * Calls callback for each line number that is in the selection\n *\n * The second argument is the 1-based index of the iteration.\n *\n * @param {CodeMirror.Selection} selection\n * param {function(number)} cb\n */\nfunction forLineIn(\n  selection: {\n    anchor: CodeMirror.Position;\n    head: CodeMirror.Position;\n  },\n  cb: Function\n) {\n  // anchor/head depend on selection direction, so min & max have to be used\n  const lines = [selection.anchor.line, selection.head.line];\n  const maxNumber = max(lines);\n  const minNumber = min(lines);\n  const lineRange = range(minNumber || 0, maxNumber !== undefined ? maxNumber + 1 : undefined);\n\n  lineRange.forEach((lineNumber, i) => {\n    cb(lineNumber, i + 1);\n  });\n}\n\nfunction prepareListWhitespace(editor: EditorInstanceType) {\n  const line = editor.getCurrentLineNumber();\n\n  const isCurrentLineEmpty = editor.isLineEmpty(line);\n\n  const isPrevLineEmpty = line > 0 ? editor.isLineEmpty(line - 1) : false;\n  const isNextLineEmpty = line < editor.getLinesCount() - 1 ? editor.isLineEmpty(line + 1) : true;\n\n  let linesToInsert = isCurrentLineEmpty ? 2 : 4;\n  if (isPrevLineEmpty) {\n    linesToInsert = linesToInsert - 1;\n  }\n  if (isNextLineEmpty) {\n    linesToInsert = linesToInsert - 1;\n  }\n\n  editor.moveToLineEnd();\n  editor.insertAtCursor(editor.getNl(linesToInsert));\n  editor.restoreCursor(0, isCurrentLineEmpty ? line : line + 2);\n}\n\nfunction getListNumber(editor: EditorInstanceType) {\n  const result = editor.getCurrentLine().match(/^(\\d+\\. )/);\n  return result ? result[1] : null;\n}\n\nfunction ulToggleFn(editor: EditorInstanceType) {\n  if (editor.lineStartsWith('- ')) {\n    editor.removeFromLineBeginning(2);\n  } else {\n    const listNumber = getListNumber(editor);\n    if (listNumber) {\n      editor.removeFromLineBeginning(listNumber.length);\n    }\n    editor.insertAtLineBeginning('- ');\n  }\n}\n\nfunction olToggleFn(editor: EditorInstanceType, n?: number) {\n  const listNumber = getListNumber(editor);\n  if (listNumber) {\n    editor.removeFromLineBeginning(listNumber.length);\n  } else {\n    if (editor.lineStartsWith('- ')) {\n      editor.removeFromLineBeginning(2);\n    }\n    editor.insertAtLineBeginning((n || 1) + '. ');\n  }\n}\n\n/**\n * From a table layout specification build a Markdown table template.\n *\n * Returns the lines as an array.\n * Used by the `table()` command\n *\n * @param {object} config\n * @param {number} rows\n * @param {number} cols\n * @returns {string[]}\n */\nfunction tableTemplate(nrows: number, ncols: number) {\n  const cellWidth = new Array(11);\n  const cell = ' ' + cellWidth.join(' ') + ' |';\n  const separatorCell = ' ' + cellWidth.join('-') + ' |';\n\n  let baseRow = '|';\n  let separatorRow = '|';\n\n  times(ncols, () => {\n    baseRow += cell;\n    separatorRow += separatorCell;\n  });\n\n  const bodyRows = range(nrows).map(() => baseRow.replace(/\\| {5}/g, '| Cell'));\n\n  const headerRow = baseRow.replace(/\\| {7}/g, '| Header');\n\n  return [headerRow, separatorRow].concat(bodyRows);\n}\n\n/**\n * Toggles the header prefix for a given level on the current line.\n *\n * - Removes a header when one of the same level is\n * - Replaces the header if there is one of a different level\n * - Otherwise inserts the header\n */\nfunction toggleHeader(editor: EditorInstanceType, level: number) {\n  return () => {\n    const initialCh = editor.getCurrentCharacter();\n    const currentHeader = selectHeader(editor);\n    const prefix = repeat(HEADER_CHAR, level);\n\n    // there's no header at the current line - create one\n    if (!currentHeader) {\n      editor.moveToLineBeginning();\n      editor.insertAtCursor(prefix + ' ');\n      editor.restoreCursor(initialCh + prefix.length + 1);\n      return;\n    }\n\n    // there's exactly the same header - remove one\n    if (editor.getSelectedText() === prefix) {\n      editor.extendSelectionBy(1);\n      const removedCh = editor.getSelectionLength();\n      editor.removeSelectedText();\n      editor.restoreCursor(initialCh - removedCh);\n      return;\n    }\n\n    // there's another header at the current line - replace\n    const diff = prefix.length - editor.getSelectionLength();\n    editor.replaceSelectedText(prefix);\n    editor.restoreCursor(initialCh + diff);\n  };\n}\n\n/**\n * On the current line select a Markdown header prefix. That is the\n * string at the beginning of the line that consists of up to six `#`.\n *\n * If the selection was successful return the selected string.\n */\nfunction selectHeader(editor: EditorInstanceType) {\n  const result = editor.getCurrentLine().match(/^( {0,3})(#{1,6}) /);\n  if (!result) {\n    return null;\n  }\n  const indentation = result[1];\n  const header = result[2];\n\n  editor.select(getPos(0), getPos(header.length));\n  return editor.getSelection();\n\n  function getPos(modifier: number) {\n    return {\n      line: editor.getCurrentLineNumber(),\n      ch: indentation.length + modifier,\n    };\n  }\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n\nimport * as CodeMirrorWrapper from './CodeMirrorWrapper';\nimport * as Commands from './MarkdownCommands';\nimport { EditorDirection } from '../../types';\n\nexport function createMarkdownEditor(\n  host: HTMLElement,\n  options: {\n    direction: EditorDirection;\n    readOnly: boolean;\n    fixedHeight?: number | boolean;\n    height?: number | string;\n  }\n) {\n  const editor = CodeMirrorWrapper.create(host, options);\n\n  function wrapChange(fn: Function) {\n    return (e: any, ch: any) => {\n      fn(editor.getValue(), e, ch);\n    };\n  }\n\n  const api = {\n    actions: Commands.create(editor),\n    history: {\n      hasUndo: function () {\n        return editor.getHistorySize('undo') > 0;\n      },\n      hasRedo: function () {\n        return editor.getHistorySize('redo') > 0;\n      },\n    },\n    events: {\n      onScroll: function (fn: Function) {\n        editor.attachEvent('scroll', fn, 150);\n      },\n      onChange: function (fn: Function) {\n        editor.attachEvent('change', wrapChange(fn), 0);\n      },\n      onPaste: function (fn: Function) {\n        editor.attachEvent('paste', fn, 0);\n      },\n    },\n    insert: editor.insertAtCursor,\n    focus: editor.focus,\n    getContent: editor.getValue,\n    destroy: editor.destroy,\n    setContent: editor.setValue,\n    getSelectedText: editor.getSelectedText,\n    usePrimarySelection: editor.usePrimarySelection,\n    setReadOnly: editor.setReadOnly,\n    selectBackwards: editor.selectBackwards,\n    getCursor: editor.getCursor,\n    setCursor: editor.setCursor,\n    clear: () => editor.setValue(''),\n    selectAll: editor.selectAll,\n    setFullsize: editor.setFullsize,\n    refresh: editor.refresh,\n  };\n\n  editor.addKeyShortcuts({\n    B: api.actions.bold,\n    I: api.actions.italic,\n  });\n\n  return api;\n}\n","import React, { useRef, useEffect, useState } from 'react';\nimport tokens from '@contentful/f36-tokens';\nimport { css, cx } from 'emotion';\nimport { createMarkdownEditor } from './createMarkdownEditor';\nimport { EditorDirection } from '../../types';\n\nexport type InitializedEditorType = ReturnType<typeof createMarkdownEditor>;\n\ntype MarkdownTextareaProps = {\n  /**\n   * Minimum height to set for the markdown text area\n   */\n  minHeight?: string | number;\n  mode: 'default' | 'zen';\n  direction: EditorDirection;\n  disabled: boolean;\n  visible: boolean;\n  onReady: (editor: InitializedEditorType) => void;\n};\n\nconst styles = {\n  root: css`\n    border: 1px solid ${tokens.gray400};\n    border-width: 0 1px;\n    overflow-y: auto;\n    height: auto;\n    min-height: 300px;\n\n    .CodeMirror {\n      height: auto;\n      line-height: ${tokens.lineHeightDefault};\n    }\n    .CodeMirror-lines {\n      color: ${tokens.gray700};\n      padding: ${tokens.spacingL};\n    }\n    .CodeMirror-code {\n      font-family: ${tokens.fontStackMonospace};\n      font-size: ${tokens.fontSizeM};\n    }\n    .CodeMirror-scroll {\n      min-height: '6rem';\n    }\n\n    .cm-header {\n      color: ${tokens.gray900};\n    }\n    span.cm-variable-2 {\n      color: ${tokens.gray700};\n    }\n    .cm-header-1 {\n      font-size: 1.9em;\n    }\n    .cm-header-2 {\n      font-size: 1.75em;\n    }\n    .cm-header-3 {\n      font-size: 1.6em;\n    }\n    .cm-header-4 {\n      font-size: 1.45em;\n    }\n    .cm-header-5 {\n      font-size: 1.3em;\n    }\n    .cm-header-6 {\n      font-size: 1.15em;\n    }\n\n    span.cm-tag,\n    span.cm-string,\n    span.cm-attribute {\n      color: ${tokens.red600};\n    }\n    span.cm-string {\n      text-decoration: none !important;\n    }\n    span.cm-quote,\n    span.cm-comment {\n      color: ${tokens.gray600};\n    }\n    span.cm-link,\n    span.cm-url {\n      color: ${tokens.blue500} !important;\n    }\n    span.cm-link {\n      text-decoration: underline;\n    }\n  `,\n  framed: css({\n    '.CodeMirror': {\n      maxHeight: '500px',\n    },\n  }),\n  zen: css({\n    border: 'none !important',\n    '.CodeMirror-lines': {\n      maxWidth: '650px',\n      margin: '0 auto',\n    },\n  }),\n  disabled: css`\n    .CodeMirror {\n      background: ${tokens.gray100};\n      cursor: 'not-allowed';\n    }\n    .CodeMirror-cursors {\n      visibility: hidden !important;\n    }\n    .CodeMirror-scroll,\n    .CodeMirror-sizer,\n    .CodeMirror-lines {\n      cursor: not-allowed;\n    }\n  `,\n};\n\nexport const MarkdownTextarea = React.memo((props: MarkdownTextareaProps) => {\n  const hostRef = useRef<HTMLDivElement>(null);\n  const [editor, setEditor] = useState<InitializedEditorType | null>(null);\n\n  useEffect(() => {\n    if (hostRef.current) {\n      setEditor(\n        createMarkdownEditor(\n          hostRef.current,\n          Object.assign(\n            {},\n            {\n              direction: props.direction,\n              readOnly: true,\n            },\n            props.mode === 'zen'\n              ? {\n                  fixedHeight: true,\n                  height: '100%',\n                }\n              : {},\n            props.minHeight !== undefined ? { height: props.minHeight } : {}\n          )\n        )\n      );\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, []);\n\n  useEffect(() => {\n    if (editor) {\n      props.onReady(editor);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, [editor]);\n\n  const className = cx(\n    styles.root,\n    props.minHeight !== undefined ? css({ minHeight: props.minHeight }) : undefined,\n    props.mode === 'default' ? styles.framed : styles.zen,\n    props.disabled && styles.disabled\n  );\n\n  return (\n    <div\n      className={className}\n      ref={hostRef}\n      data-test-id=\"markdown-textarea\"\n      style={{ display: props.visible ? 'block' : 'none' }}\n    />\n  );\n});\n\nMarkdownTextarea.displayName = 'MarkdownTextarea';\n","import React from 'react';\n\nimport { TextLink, Paragraph } from '@contentful/f36-components';\nimport tokens from '@contentful/f36-tokens';\nimport { css } from 'emotion';\n\nconst styles = {\n  root: css({\n    display: 'flex',\n    justifyContent: 'space-between',\n    background: tokens.gray100,\n    border: `1px solid ${tokens.gray400}`,\n    borderBottomLeftRadius: tokens.borderRadiusSmall,\n    borderBottomRightRadius: tokens.borderRadiusSmall,\n    padding: `${tokens.spacingXs} ${tokens.spacingS}`,\n  }),\n  help: css({\n    color: tokens.gray700,\n    fontSize: tokens.fontSizeS,\n    button: {\n      fontSize: tokens.fontSizeS,\n      lineHeight: 'inherit',\n    },\n  }),\n};\n\nexport function MarkdownCounter(props: { words: number; characters: number }) {\n  return (\n    <Paragraph marginBottom=\"none\" className={styles.help}>\n      {props.words} {props.words !== 1 ? 'words' : 'word'}, {props.characters}{' '}\n      {props.characters !== 1 ? 'characters' : 'character'}\n    </Paragraph>\n  );\n}\n\nexport function MarkdownHelp(props: { onClick: () => void }) {\n  return (\n    <Paragraph marginBottom=\"none\" className={styles.help}>\n      Format your text like a pro with the{' '}\n      <TextLink\n        as=\"button\"\n        testId=\"open-markdown-cheatsheet-button\"\n        onClick={() => {\n          props.onClick();\n        }}\n      >\n        markdown cheatsheet\n      </TextLink>\n      .\n    </Paragraph>\n  );\n}\n\nexport function MarkdownBottomBar(props: { children: React.ReactNode }) {\n  return <div className={styles.root}>{props.children}</div>;\n}\n","export type MarkdownTab = 'editor' | 'preview';\n\nexport type HeadingType = 'h1' | 'h2' | 'h3';\n\nexport type EditorDirection = 'ltr' | 'rtl';\n\nexport enum MarkdownDialogType {\n  cheatsheet = 'markdown-cheatsheet',\n  insertLink = 'markdown-insertLink',\n  insertSpecialCharacter = 'markdown-insertSpecialCharacter',\n  insertTable = 'markdown-insertTable',\n  embedExternalContent = 'markdown-embedExternalContent',\n  confirmInsertAsset = 'markdown-confirmInsertAsset',\n  zenMode = 'markdown-zenMode',\n}\n\nexport type MarkdownDialogsParams =\n  | {\n      type: MarkdownDialogType.zenMode;\n      initialValue: string;\n      locale: string;\n    }\n  | {\n      type: MarkdownDialogType.cheatsheet;\n    }\n  | {\n      type: MarkdownDialogType.insertLink;\n      selectedText?: string;\n    }\n  | {\n      type: MarkdownDialogType.insertSpecialCharacter;\n    }\n  | {\n      type: MarkdownDialogType.insertTable;\n    }\n  | {\n      type: MarkdownDialogType.embedExternalContent;\n    }\n  | {\n      type: MarkdownDialogType.confirmInsertAsset;\n      locale: string;\n      assets: Array<{\n        title: string;\n        description: string;\n        thumbnailUrl: string;\n        thumbnailAltText: string;\n      }>;\n    };\n\nexport type MarkdownActions = {\n  simple: {\n    bold: Function;\n    italic: Function;\n    quote: Function;\n    ol: Function;\n    ul: Function;\n    strike: Function;\n    code: Function;\n    hr: Function;\n    indent: Function;\n    dedent: Function;\n  };\n  headings: {\n    h1: Function;\n    h2: Function;\n    h3: Function;\n  };\n  history: {\n    undo: Function;\n    redo: Function;\n  };\n  insertLink: Function;\n  embedExternalContent: Function;\n  insertTable: Function;\n  insertSpecialCharacter: Function;\n  linkExistingMedia: Function;\n  addNewMedia: Function;\n  organizeLinks: Function;\n  openZenMode: Function;\n  closeZenMode: Function;\n};\n\nexport type PreviewComponents = {\n  embedly?: React.ComponentType<{ url: string }>;\n};\n","import React from 'react';\nimport { css, cx } from 'emotion';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport { ModalContent } from '@contentful/f36-components';\nimport tokens from '@contentful/f36-tokens';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\n\nimport { TextLink, Heading } from '@contentful/f36-components';\n\nconst styles = {\n  flexColumnContainer: css({\n    display: 'flex',\n    flexWrap: 'nowrap',\n  }),\n  flexColumn: css({\n    flexGrow: 1,\n  }),\n  verticalDivider: css({\n    borderRight: `1px solid ${tokens.gray500}`,\n    paddingRight: tokens.spacing3Xl,\n    marginRight: tokens.spacing2Xl,\n  }),\n  preview: css({\n    display: 'inline-block',\n    paddingRight: tokens.spacingL,\n    width: '50%',\n  }),\n  unOrderedListPreview: css({\n    listStyleType: 'disc',\n    marginLeft: tokens.spacingS,\n  }),\n  orderedListPreview: css({\n    listStyleType: 'decimal',\n    marginLeft: tokens.spacingS,\n  }),\n  markup: css({\n    display: 'inline-block',\n    color: tokens.gray600,\n    paddingLeft: tokens.spacingL,\n    width: '50%',\n  }),\n  h1: css({\n    fontSize: tokens.fontSize2Xl,\n  }),\n  h2: css({\n    fontSize: tokens.fontSizeXl,\n  }),\n  h3: css({\n    fontSize: tokens.fontSizeL,\n  }),\n  helpItem: css({\n    marginBottom: tokens.spacingS,\n    display: 'flex',\n    alignItems: 'flex-end',\n    height: tokens.spacingXl,\n  }),\n  helpLink: css({\n    margin: 'auto',\n  }),\n  flexRowContainer: css({\n    display: 'flex',\n    width: '100%',\n    justifyContent: 'center',\n    marginTop: tokens.spacingXl,\n  }),\n};\n\nexport const CheatsheetModalDialog = () => {\n  return (\n    <ModalContent testId=\"markdown-cheatsheet-dialog-content\">\n      <div className={styles.flexColumnContainer}>\n        <div className={cx(styles.flexColumn, styles.verticalDivider)}>\n          <div className={styles.helpItem}>\n            <Heading marginBottom=\"none\" as=\"h1\" className={cx(styles.preview, styles.h1)}>\n              H1\n            </Heading>\n            <div className={styles.markup}># heading</div>\n          </div>\n          <div className={styles.helpItem}>\n            <Heading marginBottom=\"none\" as=\"h2\" className={cx(styles.preview, styles.h2)}>\n              H2\n            </Heading>\n            <div className={styles.markup}>## heading</div>\n          </div>\n          <div className={styles.helpItem}>\n            <Heading marginBottom=\"none\" as=\"h3\" className={cx(styles.preview, styles.h3)}>\n              H3\n            </Heading>\n            <div className={styles.markup}>### heading</div>\n          </div>\n          <div className={styles.helpItem}>\n            <strong className={styles.preview}>bold</strong>\n            <div className={styles.markup}>__text__</div>\n          </div>\n          <div className={styles.helpItem}>\n            <em className={styles.preview}>italic</em>\n            <div className={styles.markup}>*text*</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>strikethrough</div>\n            <div className={styles.markup}>~~text~~</div>\n          </div>\n          <div className={styles.helpItem}>\n            <TextLink as=\"button\" className={styles.preview}>\n              Link\n            </TextLink>\n            <div className={styles.markup}>[text](url)</div>\n          </div>\n        </div>\n        <div className={styles.flexColumn}>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>Image</div>\n            <div className={styles.markup}>![alt-text](url)</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>Unordered list</div>\n            <div className={styles.markup}>* list item</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>\n              <div>Ordered list</div>\n            </div>\n            <div className={styles.markup}>1. list item</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>\n              <div>Blockquote</div>\n            </div>\n            <div className={styles.markup}>&gt; quote</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>code span</div>\n            <div className={styles.markup}>`code here`</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>code block</div>\n            <div className={styles.markup}>```code here```</div>\n          </div>\n        </div>\n      </div>\n      <div className={styles.flexRowContainer}>\n        <TextLink\n          className={styles.helpLink}\n          href=\"https://help.github.com/en/github/writing-on-github/basic-writing-and-formatting-syntax\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\">\n          View the full GitHub-flavored Markdown syntax help (opens in a new window)\n        </TextLink>\n      </div>\n    </ModalContent>\n  );\n};\n\nexport const openCheatsheetModal = (dialogs: DialogsAPI): Promise<void> => {\n  return dialogs.openCurrent({\n    title: 'Markdown formatting help',\n    width: 'large',\n    minHeight: '415px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.cheatsheet,\n    } as MarkdownDialogsParams,\n  });\n};\n","// This code will replace '&amp;' with '&' only inside the href attribute of the mailto link.\n// Otherwise the mailto link will not work correctly\nexport const replaceMailtoAmp = (string: string) => {\n  return string.replace(/href=\"mailto:[^\"]*&amp;/g, function (match) {\n    return match.replace(/&amp;/g, '&');\n  });\n};\n","import React from 'react';\n\nimport tokens from '@contentful/f36-tokens';\nimport DOMPurify from 'dompurify';\nimport { css, cx } from 'emotion';\nimport Markdown from 'markdown-to-jsx';\n\nimport { EditorDirection, PreviewComponents } from '../types';\nimport { replaceMailtoAmp } from '../utils/replaceMailtoAmp';\n\nconst styles = {\n  root: css`\n    border: 1px solid ${tokens.gray400};\n    border-width: 0 1px;\n    word-wrap: break-word;\n    overflow-wrap: break-word;\n    min-height: 300px;\n    padding: ${tokens.spacingL};\n    font-size: ${tokens.fontSizeM};\n    font-family: ${tokens.fontStackPrimary};\n    line-height: ${tokens.lineHeightDefault};\n    color: ${tokens.gray700};\n    white-space: pre-line;\n\n    h1,\n    h2,\n    h3,\n    h4,\n    h5,\n    h6 {\n      margin-top: ${tokens.spacingL};\n      margin-bottom: ${tokens.spacingM};\n      color: ${tokens.gray900};\n    }\n\n    h1:first-child,\n    h2:first-child,\n    h3:first-child,\n    h4:first-child,\n    h5:first-child,\n    h6:first-child {\n      margin-top: 0;\n    }\n\n    h1 {\n      font-size: 1.9em;\n    }\n    h2 {\n      font-size: 1.75em;\n    }\n    h3 {\n      font-size: 1.6em;\n    }\n    h4 {\n      font-size: 1.45em;\n    }\n    h5 {\n      font-size: 1.3em;\n    }\n    h6 {\n      font-size: 1.15em;\n    }\n\n    p {\n      margin-top: 0;\n      margin-bottom: ${tokens.spacingM};\n    }\n\n    ul,\n    ol {\n      margin: ${tokens.spacingS} 0;\n      padding-left: ${tokens.spacingM};\n    }\n    ul > li {\n      list-style-type: disc;\n      margin-bottom: 0;\n    }\n\n    ol > li {\n      list-style-type: decimal;\n      margin-bottom: 0;\n    }\n\n    table {\n      table-layout: fixed;\n      border-right-width: 0;\n      border-bottom-width: 0;\n      width: 80%;\n      margin: ${tokens.spacingM} auto;\n      border-spacing: 0;\n      border-collapse: collapse;\n      border: 1px solid ${tokens.gray300};\n    }\n\n    table th,\n    table td {\n      padding: 5px;\n      border-left-width: 0;\n      border-top-width: 0;\n    }\n\n    table th {\n      background: ${tokens.gray200};\n    }\n\n    table td {\n      border: 1px solid ${tokens.gray300};\n    }\n\n    a {\n      color: ${tokens.blue500};\n    }\n\n    hr {\n      margin-top: ${tokens.spacingL};\n      margin-bottom: ${tokens.spacingL};\n      height: 1px;\n      background-color: ${tokens.gray300};\n      border: none;\n    }\n\n    blockquote {\n      border-left: 4px solid ${tokens.gray200};\n      padding-left: ${tokens.spacingL};\n      margin: 0;\n      margin-top: ${tokens.spacingM};\n      font-style: italic;\n    }\n\n    img {\n      margin: ${tokens.spacingM} auto;\n      display: block;\n      max-width: 80%;\n      max-height: 250px;\n    }\n\n    pre code {\n      font-size: ${tokens.fontSizeS};\n      font-family: ${tokens.fontStackMonospace};\n    }\n\n    .embedly-card {\n      margin: ${tokens.spacingM} auto;\n      display: block;\n    }\n  `,\n  framed: css({\n    height: '100%',\n    maxHeight: '500px',\n    overflowY: 'auto',\n  }),\n  zen: css({\n    maxWidth: '650px',\n    margin: '0 auto',\n    border: 'none !important',\n  }),\n  rtl: css({\n    direction: 'rtl',\n  }),\n};\n\ntype MarkdownPreviewProps = {\n  /**\n   * Minimum height to set for the markdown preview\n   */\n  minHeight?: string | number;\n  mode: 'default' | 'zen';\n  direction: EditorDirection;\n  value: string;\n  previewComponents?: PreviewComponents;\n};\n\nfunction MarkdownLink(props: {\n  href: string;\n  title: string;\n  className?: string;\n  // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n  children: any;\n  Embedly?: React.SFC<{ url: string }>;\n}) {\n  const { Embedly, children, ...rest } = props;\n\n  if (props.className === 'embedly-card' && Embedly) {\n    return <Embedly url={props.href} />;\n  }\n\n  return (\n    <a {...rest} target=\"_blank\" rel=\"noopener noreferrer\">\n      {children}\n    </a>\n  );\n}\n\nexport const MarkdownPreview = React.memo((props: MarkdownPreviewProps) => {\n  const className = cx(\n    styles.root,\n    props.minHeight !== undefined ? css({ minHeight: props.minHeight }) : undefined,\n    props.mode === 'default' ? styles.framed : styles.zen,\n    props.direction === 'rtl' ? styles.rtl : undefined\n  );\n\n  // See the list of allowed Tags here:\n  // https://github.com/cure53/DOMPurify/blob/main/src/tags.js#L3-L121\n  const cleanHTML = React.useMemo(() => {\n    return replaceMailtoAmp(DOMPurify.sanitize(props.value));\n  }, [props.value]);\n\n  return (\n    <div className={className} data-test-id=\"markdown-preview\">\n      <Markdown\n        options={{\n          overrides: {\n            a: {\n              // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n              component: MarkdownLink as any,\n              props: {\n                Embedly: props.previewComponents?.embedly,\n              },\n            },\n          },\n        }}>\n        {cleanHTML}\n      </Markdown>\n    </div>\n  );\n});\n\nMarkdownPreview.displayName = 'MarkdownPreview';\n","import React from 'react';\nimport { css } from 'emotion';\nimport tokens from '@contentful/f36-tokens';\nimport { FieldExtensionSDK } from '@contentful/app-sdk';\nimport { ConstraintsUtils, CharCounter, CharValidation } from '@contentful/field-editor-shared';\n\nconst styles = {\n  root: css({\n    display: 'flex',\n    justifyContent: 'space-between',\n    fontSize: tokens.fontSizeM,\n    marginTop: tokens.spacingXs,\n    color: tokens.gray700,\n  }),\n};\n\nexport function MarkdownConstraints(props: { sdk: FieldExtensionSDK; value: string }) {\n  const constraints = ConstraintsUtils.fromFieldValidations(\n    props.sdk.field.validations,\n    props.sdk.field.type as 'Text'\n  );\n\n  const checkConstraint = ConstraintsUtils.makeChecker(constraints);\n\n  return (\n    <div className={styles.root}>\n      <CharCounter value={props.value} checkConstraint={checkConstraint} />\n      <CharValidation constraints={constraints} />\n    </div>\n  );\n}\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = GeneratorFunctionPrototype;\n  define(Gp, \"constructor\", GeneratorFunctionPrototype);\n  define(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction);\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  });\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  define(Gp, iteratorSymbol, function() {\n    return this;\n  });\n\n  define(Gp, \"toString\", function() {\n    return \"[object Generator]\";\n  });\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, in modern engines\n  // we can explicitly access globalThis. In older engines we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","export const urlRegex =\n  /^(ftp|http|https):\\/\\/(\\w+:{0,1}\\w*@)?(\\S+)(:[0-9]+)?(\\/|\\/([\\w#!:.?+=&%@!\\-/]))?$/;\n\nexport function isValidUrl(value: string) {\n  return urlRegex.test(value);\n}\n","import React, { useState, useRef, useEffect } from 'react';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\nimport {\n  ModalContent,\n  ModalControls,\n  Button,\n  Form,\n  FormControl,\n  TextInput,\n} from '@contentful/f36-components';\nimport { isValidUrl } from '../utils/isValidUrl';\n\ntype InsertLinkModalPositiveResult = { url: string; text: string; title: string };\nexport type InsertLinkModalResult = InsertLinkModalPositiveResult | false | undefined;\n\ntype InsertLinkModalProps = {\n  selectedText?: string;\n  onClose: (result: InsertLinkModalResult) => void;\n};\n\nexport const InsertLinkModal = ({ selectedText, onClose }: InsertLinkModalProps) => {\n  const mainInputRef = useRef<HTMLInputElement>(null);\n  const [text, setText] = useState(selectedText || '');\n  const [url, setUrl] = useState('');\n  const [touched, setTouched] = useState(false);\n  const [title, setTitle] = useState('');\n  const onInsert = (values: InsertLinkModalPositiveResult) => onClose(values);\n\n  const urlIsValid = isValidUrl(url);\n\n  useEffect(() => {\n    if (mainInputRef?.current?.focus) {\n      mainInputRef.current.focus();\n    }\n  }, [mainInputRef]);\n\n  return (\n    <>\n      <ModalContent testId=\"insert-link-modal\">\n        <Form onSubmit={() => onInsert({ url, text, title })}>\n          <FormControl id=\"link-text-field\" isDisabled={Boolean(selectedText)}>\n            <FormControl.Label>Link text</FormControl.Label>\n            <TextInput\n              name=\"link-text\"\n              value={text}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                setText(e.target.value);\n              }}\n              testId=\"link-text-field\"\n            />\n          </FormControl>\n\n          <FormControl id=\"target-url-field\" isInvalid={touched && !urlIsValid}>\n            <FormControl.Label>Target URL</FormControl.Label>\n            <TextInput\n              name=\"target-url\"\n              value={url}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                setUrl(e.target.value);\n                setTouched(true);\n              }}\n              placeholder=\"https://\"\n              maxLength={2100}\n              testId=\"target-url-field\"\n              ref={mainInputRef}\n            />\n            <FormControl.HelpText>Include protocol (e.g. https://)</FormControl.HelpText>\n            {touched && !urlIsValid && (\n              <FormControl.ValidationMessage>Invalid URL</FormControl.ValidationMessage>\n            )}\n          </FormControl>\n\n          <FormControl id=\"link-title-field\">\n            <FormControl.Label>Link title</FormControl.Label>\n            <TextInput\n              name=\"link-title\"\n              value={title}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                setTitle(e.target.value);\n              }}\n              testId=\"link-title-field\"\n            />\n            <FormControl.HelpText>\n              Extra link information, usually shown as a tooltip on mouse hover\n            </FormControl.HelpText>\n          </FormControl>\n        </Form>\n      </ModalContent>\n      <ModalControls>\n        <Button\n          testId=\"insert-link-cancel\"\n          onClick={() => onClose(false)}\n          variant=\"secondary\"\n          size=\"small\">\n          Cancel\n        </Button>\n        <Button\n          testId=\"insert-link-confirm\"\n          onClick={() => {\n            onInsert({ url, text, title });\n          }}\n          isDisabled={!urlIsValid}\n          variant=\"positive\"\n          size=\"small\">\n          Insert\n        </Button>\n      </ModalControls>\n    </>\n  );\n};\n\nexport const openInsertLinkDialog = (\n  dialogs: DialogsAPI,\n  params: { selectedText?: string }\n): Promise<InsertLinkModalResult> => {\n  return dialogs.openCurrent({\n    title: 'Insert link',\n    width: 'large',\n    minHeight: '410px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.insertLink,\n      ...params,\n    } as MarkdownDialogsParams,\n  });\n};\n","export const specialCharacters = [\n  { code: 180, desc: 'acute accent' },\n  { code: 38, desc: 'ampersand' },\n  { code: 166, desc: 'broken vertical bar' },\n  { code: 8226, desc: 'bullet' },\n  { code: 184, desc: 'cedilla' },\n  { code: 162, desc: 'cent' },\n  { code: 169, desc: 'copyright' },\n  { code: 176, desc: 'degree' },\n  { code: 247, desc: 'division' },\n  { code: 189, desc: 'fraction half' },\n  { code: 188, desc: 'fraction quarter' },\n  { code: 190, desc: 'fraction three quarters' },\n  { code: 62, desc: 'greater than' },\n  { code: 161, desc: 'inverted exclamation mark' },\n  { code: 191, desc: 'inverted question mark' },\n  { code: 171, desc: 'left-pointing double angle quotation mark' },\n  { code: 60, desc: 'less than' },\n  { code: 175, desc: 'macron' },\n  { code: 181, desc: 'micro' },\n  { code: 160, desc: 'non-breaking space' },\n  { code: 172, desc: 'not' },\n  { code: 182, desc: 'paragraph' },\n  { code: 177, desc: 'plus-minus' },\n  { code: 34, desc: 'quotation mark' },\n  { code: 174, desc: 'registered' },\n  { code: 187, desc: 'right-pointing double angle quotation mark' },\n  { code: 167, desc: 'section' },\n  { code: 168, desc: 'umlaut/diaeresis' },\n  { code: 215, desc: 'multiplication' },\n  { code: 8482, desc: 'trade mark' },\n  { code: 8364, desc: 'euro' },\n  { code: 163, desc: 'pound' },\n  { code: 165, desc: 'yen' },\n  { code: 8222, desc: 'double low-9 quotation mark' },\n  { code: 710, desc: 'modifier circumflex accent' },\n  { code: 8224, desc: 'dagger' },\n  { code: 8225, desc: 'double dagger' },\n  { code: 8230, desc: 'horizontal ellipsis' },\n  { code: 8220, desc: 'left double quotation mark' },\n  { code: 8249, desc: 'single left-pointing angle quotation mark' },\n  { code: 8216, desc: 'left single quotation mark' },\n  { code: 183, desc: 'middle dot' },\n  { code: 8212, desc: 'em dash' },\n  { code: 8211, desc: 'en dash' },\n  { code: 8240, desc: 'per mille' },\n  { code: 8250, desc: 'single right-pointing angle quotation mark' },\n  { code: 8217, desc: 'right single quotation mark' },\n  { code: 8218, desc: 'single low-9 quotation mark' },\n  { code: 170, desc: 'feminine ordinal indicator' },\n  { code: 186, desc: 'masculine ordinal indicator' },\n  { code: 8221, desc: 'right double quotation mark' },\n  { code: 732, desc: 'small tilde' },\n  { code: 9829, desc: 'black heart' },\n  { code: 9830, desc: 'diamond' },\n];\n","import React, { useState } from 'react';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport { css } from 'emotion';\nimport tokens from '@contentful/f36-tokens';\nimport {\n  ModalContent,\n  ModalControls,\n  Text,\n  Flex,\n  Button,\n  Tooltip,\n} from '@contentful/f36-components';\nimport { specialCharacters } from '../utils/specialCharacters';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\n\nconst styles = {\n  buttonPanel: css({\n    display: 'flex',\n    flexWrap: 'wrap',\n  }),\n  charButton: css({\n    border: `1px solid ${tokens.gray500}`,\n    width: '4.1rem',\n    height: '4.1rem',\n    fontSize: tokens.fontSizeXl,\n    marginTop: tokens.spacing2Xs,\n    marginRight: tokens.spacing2Xs,\n  }),\n  selectedCharButton: css({\n    backgroundColor: tokens.gray100,\n  }),\n  tooltip: css({ zIndex: 1000 }),\n  button: css({\n    marginTop: tokens.spacingM,\n    marginRight: tokens.spacingS,\n  }),\n};\n\nexport type SpecialCharacterModalResult = string | false | undefined;\n\ntype SpecialCharacterModalDialogProps = {\n  onClose: (result: SpecialCharacterModalResult) => void;\n};\n\nexport const SpecialCharacterModalDialog = ({ onClose }: SpecialCharacterModalDialogProps) => {\n  const [selectedCharacter, setSelectedCharacter] = useState<{ code: number; desc: string }>(\n    specialCharacters[0]\n  );\n  return (\n    <>\n      <ModalContent testId=\"insert-special-character-modal\">\n        <Flex flexDirection=\"column\" alignItems=\"center\">\n          <Text as=\"div\" lineHeight=\"lineHeight3Xl\" fontSize=\"fontSize3Xl\" marginBottom=\"spacingS\">\n            {String.fromCharCode(selectedCharacter.code)}\n          </Text>\n          <Text as=\"div\" marginBottom=\"spacingS\">\n            {selectedCharacter.desc}\n          </Text>\n        </Flex>\n        <div className={styles.buttonPanel}>\n          {specialCharacters.map((char) => (\n            <div key={char.code}>\n              <Tooltip className={styles.tooltip} content={char.desc}>\n                <Button\n                  testId=\"special-character-button\"\n                  isActive={char.code === selectedCharacter.code}\n                  className={styles.charButton}\n                  variant=\"transparent\"\n                  onClick={() => setSelectedCharacter(char)}>\n                  {String.fromCharCode(char.code)}\n                </Button>\n              </Tooltip>\n            </div>\n          ))}\n        </div>\n      </ModalContent>\n      <ModalControls>\n        <Button\n          testId=\"insert-character-cancel\"\n          className={styles.button}\n          onClick={() => onClose(false)}\n          variant=\"secondary\"\n          size=\"small\">\n          Cancel\n        </Button>\n        <Button\n          className={styles.button}\n          testId=\"insert-character-confirm\"\n          onClick={() => onClose(String.fromCharCode(selectedCharacter.code))}\n          variant=\"positive\"\n          size=\"small\">\n          Insert selected\n        </Button>\n      </ModalControls>\n    </>\n  );\n};\n\nexport const openInsertSpecialCharacter = (\n  dialogs: DialogsAPI\n): Promise<SpecialCharacterModalResult> => {\n  return dialogs.openCurrent({\n    title: 'Insert special character',\n    width: 'large',\n    minHeight: '600px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.insertSpecialCharacter,\n    } as MarkdownDialogsParams,\n  });\n};\n","import React, { useState, useRef, useEffect } from 'react';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport inRange from 'lodash/inRange';\nimport {\n  ModalContent,\n  ModalControls,\n  Button,\n  Form,\n  FormControl,\n  TextInput,\n} from '@contentful/f36-components';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\n\ntype InsertTableModalPositiveResult = { cols: number; rows: number };\nexport type InsertTableModalResult = InsertTableModalPositiveResult | false | undefined;\n\ntype InsertTableModalProps = {\n  onClose: (result: InsertTableModalResult) => void;\n};\n\nexport const InsertTableModal = ({ onClose }: InsertTableModalProps) => {\n  const mainInputRef = useRef<HTMLInputElement>(null);\n  const [rows, setRows] = useState(2);\n  const [cols, setColumns] = useState(1);\n  const rowsAreValid = inRange(rows, 2, 100);\n  const colsAreValid = inRange(cols, 1, 100);\n\n  useEffect(() => {\n    if (mainInputRef.current?.focus) {\n      mainInputRef.current.focus();\n    }\n  }, [mainInputRef]);\n\n  return (\n    <>\n      <ModalContent testId=\"insert-table-modal\">\n        <Form>\n          <FormControl id=\"insert-table-rows-number-field\" isRequired isInvalid={!rowsAreValid}>\n            <FormControl.Label>Number of rows</FormControl.Label>\n            <TextInput\n              name=\"rows\"\n              value={rows.toString()}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => setRows(Number(e.target.value))}\n              testId=\"insert-table-rows-number-field\"\n              min={2}\n              max={100}\n              pattern=\"[1-9][0-9]*\"\n              type=\"number\"\n              width=\"small\"\n              autoComplete=\"off\"\n              ref={mainInputRef}\n            />\n            {!rowsAreValid && (\n              <FormControl.ValidationMessage>\n                Should be between 2 and 100\n              </FormControl.ValidationMessage>\n            )}\n          </FormControl>\n\n          <FormControl id=\"insert-table-columns-number-field\" isRequired isInvalid={!colsAreValid}>\n            <FormControl.Label>Number of columns</FormControl.Label>\n            <TextInput\n              name=\"columns\"\n              value={cols.toString()}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                setColumns(Number(e.target.value))\n              }\n              testId=\"insert-table-columns-number-field\"\n              min={1}\n              max={100}\n              pattern=\"[1-9][0-9]*\"\n              type=\"number\"\n              width=\"small\"\n              autoComplete=\"off\"\n            />\n            {!colsAreValid && (\n              <FormControl.ValidationMessage>\n                Should be between 1 and 100\n              </FormControl.ValidationMessage>\n            )}\n          </FormControl>\n        </Form>\n      </ModalContent>\n      <ModalControls>\n        <Button\n          testId=\"insert-table-cancel\"\n          onClick={() => onClose(false)}\n          variant=\"secondary\"\n          size=\"small\">\n          Cancel\n        </Button>\n        <Button\n          testId=\"insert-table-confirm\"\n          onClick={() => onClose({ rows, cols })}\n          variant=\"positive\"\n          size=\"small\"\n          isDisabled={!rowsAreValid || !colsAreValid}>\n          Insert\n        </Button>\n      </ModalControls>\n    </>\n  );\n};\n\nexport const openInsertTableDialog = (dialogs: DialogsAPI): Promise<InsertTableModalResult> => {\n  return dialogs.openCurrent({\n    title: 'Insert table',\n    width: 'medium',\n    minHeight: '260px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.insertTable,\n    } as MarkdownDialogsParams,\n  });\n};\n","import React, { useState, useRef, useEffect } from 'react';\nimport { css } from 'emotion';\nimport tokens from '@contentful/f36-tokens';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\nimport {\n  ModalContent,\n  ModalControls,\n  Text,\n  TextLink,\n  Button,\n  Checkbox,\n  Radio,\n  Form,\n  FormControl,\n  TextInput,\n} from '@contentful/f36-components';\nimport { isValidUrl } from '../utils/isValidUrl';\n\nconst styles = {\n  widthFiledGroup: css({\n    display: 'flex',\n    flexWrap: 'nowrap',\n    alignItems: 'flex-start',\n  }),\n  radioButtonGroup: css({\n    display: 'inline-flex',\n    alignItems: 'flex-start',\n    paddingTop: tokens.spacingXl,\n  }),\n  radioButton: css({\n    marginLeft: tokens.spacingM,\n  }),\n};\n\nexport type EmbedExternalContentModalResult = string | false | undefined;\n\ntype EmbedExternalContentModalProps = {\n  onClose: (result: EmbedExternalContentModalResult) => void;\n};\n\ntype Unit = 'percent' | 'px';\n\nconst makeEmbedlyLink = ({\n  url,\n  width,\n  selectedUnit,\n  attachSocial,\n}: {\n  url: string;\n  width: number;\n  selectedUnit: Unit;\n  attachSocial: boolean;\n}): string => {\n  const s = { percent: '%', px: 'px' };\n  return [\n    '<a href=\"' + url + '\" class=\"embedly-card\" ',\n    'data-card-width=\"' + width + s[selectedUnit] + '\" ',\n    'data-card-controls=\"' + (attachSocial ? '1' : '0') + '\"',\n    '>Embedded content: ' + url + '</a>',\n  ].join('');\n};\n\nconst isWidthValid = (width: number, unit: Unit) => (unit === 'percent' ? width <= 100 : true);\n\nexport const EmbedExternalContentModal = ({ onClose }: EmbedExternalContentModalProps) => {\n  const mainInputRef = useRef<HTMLInputElement>(null);\n  const [url, setUrl] = useState<string>('https://');\n  const [selectedUnit, setUnit] = useState<Unit>('percent');\n  const [urlIsValid, setUrlValidity] = useState<boolean>(true);\n  const [width, setWidth] = useState('100');\n  const [attachSocial, setAttachSocial] = useState(false);\n\n  useEffect(() => {\n    if (mainInputRef.current?.focus) {\n      mainInputRef.current.focus();\n    }\n  }, [mainInputRef]);\n\n  return (\n    <>\n      <ModalContent testId=\"embed-external-dialog\">\n        <Form>\n          <FormControl id=\"external-link-url-field\" isRequired isInvalid={!urlIsValid}>\n            <FormControl.Label>Content URL</FormControl.Label>\n            <TextInput\n              name=\"external-link-url\"\n              value={url}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                const value = e.target.value;\n                setUrl(value);\n                setUrlValidity(isValidUrl(value));\n              }}\n              testId=\"external-link-url-field\"\n              placeholder=\"https://example.com\"\n              ref={mainInputRef}\n            />\n            <FormControl.HelpText>Include protocol (e.g. https://)</FormControl.HelpText>\n            {!urlIsValid && (\n              <FormControl.ValidationMessage>URL is invalid</FormControl.ValidationMessage>\n            )}\n          </FormControl>\n          <TextLink href=\"http://embed.ly/providers\" target=\"_blank\" rel=\"noopener noreferrer\">\n            Supported sources\n          </TextLink>\n          <div className={styles.widthFiledGroup}>\n            <FormControl\n              id=\"embedded-content-width\"\n              isRequired\n              isInvalid={!isWidthValid(Number(width), selectedUnit)}>\n              <FormControl.Label>Width</FormControl.Label>\n              <TextInput\n                value={width}\n                name=\"embedded-content-width\"\n                testId=\"embedded-content-width\"\n                type=\"number\"\n                width=\"small\"\n                onChange={(e: React.ChangeEvent<HTMLInputElement>) => setWidth(e.target.value)}\n              />\n              {!isWidthValid(Number(width), selectedUnit) && (\n                <FormControl.ValidationMessage>\n                  Should be equal or less then 100\n                </FormControl.ValidationMessage>\n              )}\n            </FormControl>\n\n            <div className={styles.radioButtonGroup}>\n              <Radio\n                id=\"unit-option-percent\"\n                value=\"percent\"\n                isChecked={selectedUnit === 'percent'}\n                onChange={() => setUnit('percent')}\n                className={styles.radioButton}>\n                percent\n              </Radio>\n              <Radio\n                id=\"unit-option-pixels\"\n                value=\"pixels\"\n                isChecked={selectedUnit === 'px'}\n                onChange={() => setUnit('px')}\n                className={styles.radioButton}>\n                pixels\n              </Radio>\n            </div>\n          </div>\n          <Checkbox\n            id=\"attach-social-checkbox\"\n            name=\"attach-social-checkbox\"\n            value=\"Yes\"\n            isChecked={attachSocial}\n            onChange={() => setAttachSocial(!attachSocial)}\n            testId=\"attach-social-checkbox\">\n            Attach social sharing links to this element\n          </Checkbox>\n          <Text as=\"p\" fontColor=\"gray500\" marginTop=\"spacingXs\">\n            To enable this embedded content in your application make sure to add the&nbsp;\n            <TextLink\n              href=\"http://embed.ly/docs/products/cards\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\">\n              Embedly&apos;s platform.js\n            </TextLink>\n            &nbsp;on your development environment\n          </Text>\n          {/* <EmbedlyPreview previewUrl={url} /> */}\n        </Form>\n      </ModalContent>\n      <ModalControls>\n        <Button\n          testId=\"emded-external-cancel\"\n          onClick={() => onClose(false)}\n          variant=\"secondary\"\n          size=\"small\">\n          Cancel\n        </Button>\n        <Button\n          testId=\"embed-external-confirm\"\n          onClick={() =>\n            onClose(makeEmbedlyLink({ url, width: Number(width), selectedUnit, attachSocial }))\n          }\n          variant=\"positive\"\n          size=\"small\">\n          Insert\n        </Button>\n      </ModalControls>\n    </>\n  );\n};\n\nexport const openEmbedExternalContentDialog = (\n  dialogs: DialogsAPI\n): Promise<EmbedExternalContentModalResult> => {\n  return dialogs.openCurrent({\n    title: 'Embed external content',\n    width: 'large',\n    minHeight: '435px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.embedExternalContent,\n    } as MarkdownDialogsParams,\n  });\n};\n","import React from 'react';\nimport {\n  ModalContent,\n  ModalControls,\n  Paragraph,\n  Button,\n  EntityList,\n} from '@contentful/f36-components';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\n\ninterface ConfirmInsertAssetModalDialogProps {\n  onClose: (result: boolean) => void;\n  assets: Array<{\n    title: string;\n    description: string;\n    thumbnailUrl: string;\n    thumbnailAltText: string;\n  }>;\n  locale: string;\n}\n\nexport const ConfirmInsertAssetModalDialog = ({\n  onClose,\n  assets,\n  locale,\n}: ConfirmInsertAssetModalDialogProps) => {\n  const localesNumber = assets.length;\n\n  return (\n    <>\n      <ModalContent testId=\"confirm-insert-asset\">\n        <Paragraph>\n          {localesNumber === 1\n            ? `Link asset with missing file for locale ${locale}`\n            : `Link assets with missing files for locale ${locale}`}\n        </Paragraph>\n        <Paragraph>\n          {localesNumber === 1\n            ? 'Do you want to link to the file in its fallback locale?'\n            : 'Do you want to link to the files in their fallback locales?'}\n        </Paragraph>\n        <EntityList>\n          {assets.map(({ title, description, thumbnailUrl, thumbnailAltText }) => (\n            <EntityList.Item\n              key={thumbnailUrl}\n              title={title}\n              thumbnailUrl={`${thumbnailUrl}?w=46&h=46&fit=thumb`}\n              thumbnailAltText={thumbnailAltText}\n              description={description}\n            />\n          ))}\n        </EntityList>\n      </ModalContent>\n      <ModalControls>\n        <Button onClick={() => onClose(false)} variant=\"secondary\" size=\"small\">\n          Cancel\n        </Button>\n        <Button\n          testId=\"confirm-insert-asset\"\n          onClick={() => onClose(true)}\n          variant=\"positive\"\n          size=\"small\">\n          Confirm\n        </Button>\n      </ModalControls>\n    </>\n  );\n};\n\nexport const openConfirmInsertAsset = (\n  dialogs: DialogsAPI,\n  options: {\n    locale: string;\n    assets: Array<{\n      title: string;\n      description: string;\n      thumbnailUrl: string;\n      thumbnailAltText: string;\n    }>;\n  }\n): Promise<boolean> => {\n  return dialogs.openCurrent({\n    title: 'Confirm using fallback assets',\n    width: 'medium',\n    minHeight: '270px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.confirmInsertAsset,\n      ...options,\n    } as MarkdownDialogsParams,\n  });\n};\n","import React from 'react';\nimport { css, cx } from 'emotion';\nimport { DialogsAPI, DialogExtensionSDK } from '@contentful/app-sdk';\nimport { MarkdownDialogType, MarkdownDialogsParams, PreviewComponents } from '../types';\nimport { InitializedEditorType } from '../components/MarkdownTextarea/MarkdownTextarea';\nimport { MarkdownToolbar } from '../components/MarkdownToolbar';\nimport { MarkdownTextarea } from '../components/MarkdownTextarea/MarkdownTextarea';\nimport { MarkdownPreview } from '../components/MarkdownPreview';\nimport { MarkdownBottomBar, MarkdownHelp } from '../components/MarkdownBottomBar';\nimport { createMarkdownActions } from '../MarkdownActions';\nimport { openCheatsheetModal } from '../dialogs/CheatsheetModalDialog';\nimport tokens from '@contentful/f36-tokens';\n\nimport { ChevronRightIcon, ChevronLeftIcon } from '@contentful/f36-icons';\n\nexport type ZenModeResult = {\n  value: string;\n  cursor?: {\n    ch: number;\n    line: number;\n  };\n};\n\ntype ZenModeDialogProps = {\n  saveValueToSDK: (value: string | null | undefined) => void;\n  onClose: (result: ZenModeResult) => void;\n  initialValue: string;\n  locale: string;\n  sdk: DialogExtensionSDK;\n  previewComponents?: PreviewComponents;\n};\n\nconst styles = {\n  root: css({\n    position: 'fixed',\n    left: 0,\n    right: 0,\n    top: 0,\n    bottom: 0,\n  }),\n  topSplit: css({\n    position: 'fixed',\n    top: 0,\n    height: '48px',\n    left: 0,\n    right: 0,\n  }),\n  bottomSplit: css({\n    position: 'fixed',\n    bottom: 0,\n    left: 0,\n    right: 0,\n    height: '36px',\n  }),\n  editorSplit: css({\n    width: '50%',\n    position: 'fixed',\n    top: '48px',\n    left: 0,\n    bottom: '36px',\n    overflowX: 'hidden',\n    overflowY: 'scroll',\n  }),\n  editorSplitFullscreen: css({\n    left: 0,\n    right: 0,\n    width: '100%',\n  }),\n  previewSplit: css({\n    width: '50%',\n    position: 'fixed',\n    top: '48px',\n    right: 0,\n    bottom: '36px',\n    overflowX: 'hidden',\n    overflowY: 'scroll',\n  }),\n  separator: css({\n    position: 'fixed',\n    top: '48px',\n    bottom: '36px',\n    width: '1px',\n    background: tokens.gray400,\n    left: '50%',\n  }),\n  button: css({\n    position: 'fixed',\n    cursor: 'pointer',\n    zIndex: 105,\n    top: '49%',\n    height: '30px',\n    backgroundColor: tokens.gray100,\n    border: `1px solid ${tokens.gray400}`,\n    padding: 0,\n  }),\n  hideButton: css({\n    left: '50%',\n  }),\n  showButton: css({\n    right: 0,\n    borderRightWidth: 0,\n  }),\n  icon: css({\n    verticalAlign: 'middle',\n  }),\n};\n\nexport const ZenModeModalDialog = (props: ZenModeDialogProps) => {\n  const [currentValue, setCurrentValue] = React.useState<string>(props.initialValue ?? '');\n  const [showPreview, setShowPreview] = React.useState<boolean>(true);\n  const [editor, setEditor] = React.useState<InitializedEditorType | null>(null);\n\n  React.useEffect(() => {\n    // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n    props.sdk?.window?.updateHeight('100%' as any);\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, []);\n\n  // refresh editor right after dialog is opened to avoid disappearing effect\n  React.useEffect(() => {\n    setTimeout(() => {\n      editor?.setFullsize();\n      editor?.refresh();\n    }, 150);\n  }, [editor]);\n\n  const actions = React.useMemo(() => {\n    return createMarkdownActions({ sdk: props.sdk, editor, locale: props.locale });\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, [editor]);\n\n  actions.closeZenMode = () => {\n    props.onClose({\n      value: currentValue,\n      cursor: editor?.getCursor(),\n    });\n  };\n\n  const direction = props.sdk.locales.direction[props.locale] ?? 'ltr';\n\n  return (\n    <div className={styles.root} data-test-id=\"zen-mode-markdown-editor\">\n      <div className={styles.topSplit}>\n        <MarkdownToolbar mode=\"zen\" disabled={false} canUploadAssets={false} actions={actions} />\n      </div>\n\n      <div\n        className={cx(styles.editorSplit, {\n          [styles.editorSplitFullscreen]: showPreview === false,\n        })}>\n        <MarkdownTextarea\n          mode=\"zen\"\n          visible\n          disabled={false}\n          direction={direction}\n          onReady={(editor) => {\n            editor.setContent(props.initialValue ?? '');\n            editor.setReadOnly(false);\n            setEditor(editor);\n            editor.focus();\n            editor.events.onChange((value: string) => {\n              setCurrentValue(value);\n              props.saveValueToSDK(value);\n            });\n          }}\n        />\n      </div>\n      {showPreview && (\n        <div className={styles.previewSplit}>\n          <MarkdownPreview\n            direction={direction}\n            mode=\"zen\"\n            value={currentValue}\n            previewComponents={props.previewComponents}\n          />\n        </div>\n      )}\n      {showPreview && <div className={styles.separator} />}\n      {showPreview && (\n        <button\n          className={cx(styles.button, styles.hideButton)}\n          aria-label=\"Hide preview\"\n          onClick={() => {\n            setShowPreview(false);\n          }}>\n          <ChevronRightIcon variant=\"muted\" size=\"tiny\" className={styles.icon} />\n        </button>\n      )}\n      {!showPreview && (\n        <button\n          className={cx(styles.button, styles.showButton)}\n          aria-label=\"Show preview\"\n          onClick={() => {\n            setShowPreview(true);\n          }}>\n          <ChevronLeftIcon variant=\"muted\" size=\"tiny\" className={styles.icon} />\n        </button>\n      )}\n      <div className={styles.bottomSplit}>\n        <MarkdownBottomBar>\n          <MarkdownHelp\n            onClick={() => {\n              openCheatsheetModal(props.sdk.dialogs);\n            }}\n          />\n        </MarkdownBottomBar>\n      </div>\n    </div>\n  );\n};\n\nexport const openZenMode = (\n  dialogs: DialogsAPI,\n  options: { initialValue: string; locale: string }\n): Promise<ZenModeResult> => {\n  return dialogs.openCurrent({\n    width: 'zen' as any, // eslint-disable-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n    shouldCloseOnEscapePress: false,\n    minHeight: '100vh',\n    shouldCloseOnOverlayClick: false,\n    parameters: {\n      type: MarkdownDialogType.zenMode,\n      initialValue: options.initialValue,\n      locale: options.locale,\n    } as MarkdownDialogsParams,\n  });\n};\n","import get from 'lodash/get';\nimport isObject from 'lodash/isObject';\n\n// eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\ntype Asset = any;\n\ntype LinkWithMedia = {\n  title: string;\n  asset: Asset;\n  url: string;\n  isLocalized: boolean;\n  isFallback: boolean;\n  asMarkdown: string;\n};\n\ntype Locales = {\n  localeCode: string;\n  fallbackCode: string | undefined;\n  defaultLocaleCode: string;\n};\n\nfunction normalizeWhiteSpace(str: string) {\n  if (str) {\n    return str.trim().replace(/\\s{2,}/g, ' ');\n  } else {\n    return str;\n  }\n}\n\nfunction removeExtension(str: string) {\n  return str.replace(/\\.\\w+$/g, '');\n}\n\nfunction fileNameToTitle(str: string) {\n  return normalizeWhiteSpace(removeExtension(str).replace(/_/g, ' '));\n}\n\nexport function replaceAssetDomain(fileUrl: string) {\n  const assetDomainMap: Record<string, string> = {\n    images: 'images.ctfassets.net',\n    assets: 'assets.ctfassets.net',\n    downloads: 'downloads.ctfassets.net',\n    videos: 'videos.ctfassets.net',\n  };\n\n  return fileUrl.replace(/(images|assets|downloads|videos).contentful.com/, (_, p1) => {\n    return assetDomainMap[p1];\n  });\n}\n\nfunction makeAssetLink(\n  asset: Asset,\n  { localeCode, fallbackCode, defaultLocaleCode }: Locales\n): LinkWithMedia | null {\n  const localizedFile = get(asset, ['fields', 'file', localeCode]);\n  const fallbackFile = fallbackCode ? get(asset, ['fields', 'file', fallbackCode]) : null;\n  const defaultFile = get(asset, ['fields', 'file', defaultLocaleCode]);\n  const file:\n    | {\n        url: string;\n        fileName: string;\n      }\n    | undefined = localizedFile || fallbackFile || defaultFile;\n\n  if (isObject(file) && file.url) {\n    const title: string =\n      get(asset, ['fields', 'title', localeCode]) ||\n      get(asset, ['fields', 'title', fallbackCode || '']) ||\n      get(asset, ['fields', 'title', defaultLocaleCode]) ||\n      fileNameToTitle(file.fileName);\n\n    const fileUrl = replaceAssetDomain(file.url);\n\n    return {\n      title,\n      asset,\n      url: fileUrl,\n      // is normally localized and we should not warn about this file\n      isLocalized: Boolean(localizedFile),\n      // was fallback value used\n      // if it was not localized normally, and we did not used a fallback\n      // it means we used a default locale - we filter empty values\n      isFallback: Boolean(fallbackFile),\n      // todo: tranform using fromHostname\n      asMarkdown: `![${title}](${fileUrl})`,\n    };\n  } else {\n    return null;\n  }\n}\n\nexport async function insertAssetLinks(assets: Array<Asset>, locales: Locales) {\n  // check whether do we have some assets, which don't have\n  // a version in this field's locale\n  const otherLocales = assets.filter((asset) => {\n    return !get(asset, ['fields', 'file', locales.localeCode]);\n  });\n\n  const linksWithMeta = assets\n    .map((asset) => makeAssetLink(asset, locales))\n    // remove empty links\n    .filter((asset) => asset !== null) as LinkWithMedia[];\n\n  // if there have values from fallback/default locales, we need to\n  // provide user a warning so we show him modal\n  if (otherLocales.length > 0) {\n    const fallbackAssets = linksWithMeta\n      // we don't want to warn about normally localized files\n      .filter(({ isLocalized }) => !isLocalized)\n      .map(({ title, isFallback, asset }) => {\n        const code = isFallback ? locales.fallbackCode : locales.defaultLocaleCode;\n        return {\n          title,\n          thumbnailUrl: asset.fields.file[code as string].url,\n          thumbnailAltText: title,\n          description: isFallback ? `Fallback locale (${code})` : `Default locale (${code})`,\n          asset: asset,\n        };\n      });\n\n    return {\n      fallbacks: fallbackAssets,\n      links: linksWithMeta,\n    };\n  }\n  return {\n    links: linksWithMeta,\n  };\n}\n","/* eslint-disable @typescript-eslint/no-use-before-define, @typescript-eslint/no-explicit-any */\n\nimport extend from 'lodash/extend';\nimport isString from 'lodash/isString';\nimport isObject from 'lodash/isObject';\nimport max from 'lodash/max';\n// eslint-disable-next-line -- TODO: describe this disable\nimport isFinite from 'lodash/isFinite';\n// eslint-disable-next-line -- TODO: describe this disable\nimport forEach from 'lodash/forEach';\n\nfunction extractTitle(title: string) {\n  title = title || '';\n  title = title.replace(/^ *('|\"|\\()*/, '');\n  title = title.replace(/('|\"|\\))* *$/, '');\n  return title;\n}\n\nfunction head(text: string) {\n  return text.split(' ').shift();\n}\n\nfunction tail(text: string) {\n  const segments = text.split(' ');\n  segments.shift();\n  return segments.join(' ');\n}\n\nconst PROCESSORS = {\n  inline: function (match: any) {\n    return {\n      match: match[0],\n      text: match[1],\n      href: head(match[2]),\n      title: extractTitle(tail(match[2])),\n    };\n  },\n  ref: function (match: any) {\n    return {\n      match: match[0],\n      text: match[1],\n      id: match[2],\n    };\n  },\n  label: function (match: any) {\n    return {\n      match: match[0],\n      id: match[1],\n      href: head(match[2]),\n      title: extractTitle(tail(match[2])),\n    };\n  },\n};\n\nconst REGEXS = {\n  inline: /\\[([^\\r\\n[\\]]+)]\\(([^\\r\\n)]+)\\)/,\n  ref: /\\[([^\\r\\n[\\]]+)] ?\\[([^\\r\\n[\\]]+)]/,\n  label: /^ {0,3}\\[([^\\r\\n[\\]]+)]:\\s+(.+)$/,\n};\nexport const findInline = makeFinder('inline');\nexport const findRefs = makeFinder('ref');\nexport const findLabels = makeFinder('label');\n\nexport function convertInlineToRef(text: string) {\n  let id = findMaxLabelId(text);\n\n  forEach(findInline(text), (inline) => {\n    id += 1;\n    text = text.replace(inline.match, buildRef(inline, id));\n    text += '\\n' + buildLabel(inline, id);\n  });\n\n  return text;\n}\n\nfunction mergeLabels(text: string): any {\n  const byHref: any = {};\n  const byOldId: any = {};\n\n  forEach(findLabels(text), (label) => {\n    const alreadyAdded = byHref[label.href];\n    const current = extend({}, label);\n\n    if (!alreadyAdded) {\n      byHref[current.href] = current;\n    } else if (hasTitle(current) && !hasTitle(alreadyAdded)) {\n      alreadyAdded.title = current.title;\n    }\n\n    byOldId[current.id] = alreadyAdded || current;\n  });\n\n  return {\n    byHref: byHref,\n    byOldId: byOldId,\n  };\n}\n\nexport function rewriteRefs(text: string) {\n  const merged = mergeLabels(text);\n  const hrefToRefId: any = {};\n  const labels: any[] = [];\n  const rewrites: any[] = [];\n  let i = 1;\n\n  // 1. compose list of labels with new ids, in order\n  forEach(findRefs(text), (ref) => {\n    const oldLabel = merged.byOldId[ref.id];\n    if (!oldLabel) {\n      return;\n    }\n    const href = oldLabel.href;\n    let newRefId = hrefToRefId[href];\n\n    if (!newRefId) {\n      hrefToRefId[href] = newRefId = i;\n      i += 1;\n      labels.push(extend({ newId: newRefId }, oldLabel));\n    }\n\n    // 1b. prepare rewrites to be applied, with new label ids\n    rewrites.push(extend({ newId: newRefId }, ref));\n  });\n\n  // 2. remove all labels!\n  forEach(findLabels(text), (label) => {\n    text = text.replace(label.match, '');\n  });\n\n  // 3. remove whitespace from the end of text\n  text = text.replace(/[\\r\\n\\s]*$/, '');\n  text += '\\n\\n';\n\n  // 4. apply rewrites\n  forEach(rewrites, (ref) => {\n    text = text.replace(ref.match, buildRef(ref, ref.newId));\n  });\n\n  // 5. print new labels at the end of text\n  forEach(labels, (label) => {\n    text += '\\n' + buildLabel(label, label.newId);\n  });\n\n  return text;\n}\n\n/**\n * Finding stuff\n */\n\nfunction makeFinder(type: 'inline' | 'ref' | 'label'): (text: string) => Array<any> {\n  return (text: string) => findAll(text, type).map(PROCESSORS[type] as any);\n}\n\nexport function findMaxLabelId(textOrLabels: any): number {\n  if (isString(textOrLabels)) {\n    textOrLabels = findLabels(textOrLabels);\n  }\n\n  const ids = textOrLabels\n    .map((x: any) => x.id)\n    .map((x: any) => parseInt(x, 10))\n    .filter((x: any) => isFinite(x) && x > 0);\n\n  return ids.length > 0 ? max(ids) || 0 : 0;\n}\n\nfunction findAll(text: string, type: 'inline' | 'ref' | 'label') {\n  const flags = 'g' + (type === 'label' ? 'm' : '');\n  const matches = [];\n  const re = new RegExp(REGEXS[type].source, flags);\n  let found = re.exec(text);\n\n  while (found) {\n    matches.push(found);\n    re.lastIndex = found.index + found[0].length;\n    found = re.exec(text);\n  }\n\n  return matches;\n}\n\n/**\n * Other utilities\n */\n\nfunction hasTitle(link: { title: string }) {\n  return isObject(link) && isString(link.title) && link.title.length > 0;\n}\n\nfunction buildLabel(link: { href: string; title: string }, id: number) {\n  let markup = '[' + id + ']: ' + link.href;\n  if (hasTitle(link)) {\n    markup += ' \"' + link.title + '\"';\n  }\n  return markup;\n}\n\nfunction buildRef(link: { text: string }, id: number) {\n  return '[' + link.text + '][' + id + ']';\n}\n","import { InitializedEditorType } from './components/MarkdownTextarea/MarkdownTextarea';\nimport { KnownSDK } from '@contentful/app-sdk';\nimport { openInsertLinkDialog } from './dialogs/InsertLinkModalDialog';\nimport { openInsertSpecialCharacter } from './dialogs/SpecialCharacterModalDialog';\nimport { openInsertTableDialog } from './dialogs/InsertTableModalDialog';\nimport { openEmbedExternalContentDialog } from './dialogs/EmdebExternalContentDialog';\nimport { openConfirmInsertAsset } from './dialogs/ConfirmInsertAssetModalDialog';\nimport { openZenMode } from './dialogs/ZenModeModalDialog';\nimport { insertAssetLinks } from './utils/insertAssetLinks';\nimport * as LinkOrganizer from './utils/linkOrganizer';\n\nexport function createMarkdownActions(props: {\n  sdk: KnownSDK;\n  editor: InitializedEditorType | null;\n  locale: string;\n}) {\n  const { sdk, editor, locale } = props;\n\n  // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/ban-types\n  const insertAssetsWithConfirmation = async (assets: Array<Object> | null) => {\n    if (assets) {\n      const { links, fallbacks } = await insertAssetLinks(assets, {\n        localeCode: locale,\n        defaultLocaleCode: sdk.locales.default,\n        fallbackCode: sdk.locales.fallbacks[locale],\n      });\n      if (links && links.length > 0) {\n        if (fallbacks) {\n          const insertAnyway = await openConfirmInsertAsset(sdk.dialogs, {\n            locale: locale,\n            assets: fallbacks,\n          });\n          if (!insertAnyway) {\n            throw Error('User decided to not use fallbacks');\n          }\n        }\n        return links.map((link) => link.asMarkdown).join('\\n\\n');\n      }\n    }\n    return '';\n  };\n\n  return {\n    headings: {\n      h1: () => {\n        editor?.actions.h1();\n      },\n      h2: () => {\n        editor?.actions.h2();\n      },\n      h3: () => {\n        editor?.actions.h3();\n      },\n    },\n    simple: {\n      italic: () => {\n        editor?.actions.italic();\n      },\n      bold: () => {\n        editor?.actions.bold();\n      },\n      quote: () => {\n        editor?.actions.quote();\n      },\n      ol: () => {\n        editor?.actions.ol();\n      },\n      ul: () => {\n        editor?.actions.ul();\n      },\n      strike: () => {\n        editor?.actions.strike();\n      },\n      code: () => {\n        editor?.actions.code();\n      },\n      hr: () => {\n        editor?.actions.hr();\n      },\n      indent: () => {\n        editor?.actions.indent();\n      },\n      dedent: () => {\n        editor?.actions.dedent();\n      },\n    },\n    history: {\n      undo: () => {\n        editor?.actions.undo();\n      },\n      redo: () => {\n        editor?.actions.redo();\n      },\n    },\n    insertLink: async () => {\n      if (!editor) {\n        return;\n      }\n      editor.usePrimarySelection();\n      const selectedText = editor.getSelectedText();\n      const result = await openInsertLinkDialog(sdk.dialogs, { selectedText });\n      if (result) {\n        editor.actions.link(result.url, selectedText || result.text, result.title);\n      }\n    },\n    insertSpecialCharacter: async () => {\n      if (!editor) {\n        return;\n      }\n      const result = await openInsertSpecialCharacter(sdk.dialogs);\n      if (result) {\n        editor.insert(result);\n      }\n    },\n    insertTable: async () => {\n      if (!editor) {\n        return;\n      }\n      const result = await openInsertTableDialog(sdk.dialogs);\n      if (result) {\n        editor.actions.table(result);\n      }\n    },\n    organizeLinks: () => {\n      if (!editor) {\n        return;\n      }\n      let text = editor.getContent();\n      if (!text) {\n        return;\n      }\n      text = LinkOrganizer.convertInlineToRef(text);\n      text = LinkOrganizer.rewriteRefs(text);\n      editor.setContent(text);\n      sdk.notifier.success('All your links are now references at the bottom of your document.');\n    },\n    embedExternalContent: async () => {\n      if (!editor) {\n        return;\n      }\n      const result = await openEmbedExternalContentDialog(sdk.dialogs);\n      if (result) {\n        editor.insert(result);\n      }\n    },\n    addNewMedia: async () => {\n      if (!editor) {\n        return;\n      }\n      try {\n        const { entity: asset } = (await sdk.navigator.openNewAsset({\n          slideIn: { waitForClose: true },\n        })) as any; // eslint-disable-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n\n        const markdownLinks = await insertAssetsWithConfirmation([asset]);\n        editor.insert(markdownLinks);\n      } finally {\n        editor.focus();\n      }\n    },\n    linkExistingMedia: async () => {\n      if (!editor) {\n        return;\n      }\n      try {\n        const assets = await sdk.dialogs.selectMultipleAssets({\n          locale: locale,\n        });\n        const markdownLinks = await insertAssetsWithConfirmation(assets);\n        editor.insert(markdownLinks);\n      } finally {\n        editor.focus();\n      }\n    },\n    openZenMode: async () => {\n      if (!editor) {\n        return;\n      }\n      const result = await openZenMode(sdk.dialogs, {\n        initialValue: editor.getContent(),\n        locale: props.locale,\n      });\n\n      editor.setContent(result.value);\n\n      if (result.cursor) {\n        editor.setCursor(result.cursor);\n      }\n\n      editor.focus();\n    },\n    closeZenMode: () => {\n      // do nothing\n      // this method is overwritten in dialog app\n    },\n  };\n}\n","import React from 'react';\nimport { css } from 'emotion';\nimport tokens from '@contentful/f36-tokens';\nimport { FieldConnector } from '@contentful/field-editor-shared';\nimport { FieldExtensionSDK } from '@contentful/app-sdk';\nimport { MarkdownTabs } from './components/MarkdownTabs';\nimport { MarkdownToolbar } from './components/MarkdownToolbar';\nimport { MarkdownTextarea } from './components/MarkdownTextarea/MarkdownTextarea';\nimport { InitializedEditorType } from './components/MarkdownTextarea/MarkdownTextarea';\nimport { MarkdownBottomBar, MarkdownHelp } from './components/MarkdownBottomBar';\nimport { MarkdownTab, PreviewComponents } from './types';\nimport { openCheatsheetModal } from './dialogs/CheatsheetModalDialog';\nimport { MarkdownPreview } from './components/MarkdownPreview';\nimport { MarkdownConstraints } from './components/MarkdownConstraints';\nimport { createMarkdownActions } from './MarkdownActions';\n\nconst styles = {\n  container: css({\n    display: 'flex',\n    flexDirection: 'column',\n    fontFamily: tokens.fontStackPrimary,\n  }),\n};\n\nexport interface MarkdownEditorProps {\n  /**\n   * is the field disabled initially\n   */\n  isInitiallyDisabled: boolean;\n  /**\n   * Minimum height to set for the markdown text area and preview\n   */\n  minHeight?: string | number;\n\n  sdk: FieldExtensionSDK;\n\n  previewComponents?: PreviewComponents;\n  onReady?: Function;\n}\n\nexport function MarkdownEditor(\n  props: MarkdownEditorProps & {\n    disabled: boolean;\n    initialValue: string | null | undefined;\n    saveValueToSDK: Function;\n  }\n) {\n  const [currentValue, setCurrentValue] = React.useState<string>(props.initialValue ?? '');\n  const [selectedTab, setSelectedTab] = React.useState<MarkdownTab>('editor');\n  const [editor, setEditor] = React.useState<InitializedEditorType | null>(null);\n  const [canUploadAssets, setCanUploadAssets] = React.useState<boolean>(false);\n\n  React.useEffect(() => {\n    if (editor && props.onReady) {\n      props.onReady(editor);\n      // fix: http://codemirror.977696.n3.nabble.com/codemirror-content-not-visible-in-bootstrap-modal-td4026988.html\n      setTimeout(() => {\n        editor.refresh();\n      }, 1);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, [editor]);\n\n  React.useEffect(() => {\n    props.sdk.access.can('create', 'Asset').then((value) => {\n      setCanUploadAssets(value);\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, []);\n\n  React.useEffect(() => {\n    if (editor) {\n      editor.setReadOnly(props.disabled);\n    }\n  }, [editor, props.disabled]);\n\n  const isActionDisabled = editor === null || props.disabled || selectedTab !== 'editor';\n\n  const direction = props.sdk.locales.direction[props.sdk.field.locale] ?? 'ltr';\n\n  const actions = React.useMemo(() => {\n    return createMarkdownActions({ sdk: props.sdk, editor, locale: props.sdk.field.locale });\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, [editor]);\n\n  const openMarkdownHelp = React.useCallback(() => {\n    openCheatsheetModal(props.sdk.dialogs);\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, []);\n\n  return (\n    <div className={styles.container} data-test-id=\"markdown-editor\">\n      <MarkdownTabs\n        active={selectedTab}\n        onSelect={(tab) => {\n          setSelectedTab(tab);\n        }}\n      />\n      <MarkdownToolbar\n        mode=\"default\"\n        disabled={isActionDisabled}\n        canUploadAssets={canUploadAssets}\n        actions={actions}\n      />\n      <MarkdownTextarea\n        minHeight={props.minHeight}\n        mode=\"default\"\n        visible={selectedTab === 'editor'}\n        disabled={isActionDisabled}\n        direction={direction}\n        onReady={(editor) => {\n          editor.setContent(props.initialValue ?? '');\n          editor.setReadOnly(props.disabled);\n          setEditor(editor);\n          editor.events.onChange((value: string) => {\n            // Trim empty lines\n            const trimmedValue = value.replace(/^\\s+$/gm, '');\n            props.saveValueToSDK(trimmedValue);\n            setCurrentValue(value);\n          });\n        }}\n      />\n      {selectedTab === 'preview' && (\n        <MarkdownPreview\n          direction={direction}\n          minHeight={props.minHeight}\n          mode=\"default\"\n          value={currentValue}\n          previewComponents={props.previewComponents}\n        />\n      )}\n      <MarkdownBottomBar>\n        <MarkdownHelp onClick={openMarkdownHelp} />\n      </MarkdownBottomBar>\n      <MarkdownConstraints sdk={props.sdk} value={currentValue} />\n    </div>\n  );\n}\n\nexport function MarkdownEditorConnected(props: MarkdownEditorProps) {\n  return (\n    <FieldConnector<string>\n      throttle={300}\n      field={props.sdk.field}\n      isInitiallyDisabled={props.isInitiallyDisabled}>\n      {({ value, disabled, setValue, externalReset }) => {\n        // on external change reset component completely and init with initial value again\n        return (\n          <MarkdownEditor\n            {...props}\n            key={`markdown-editor-${externalReset}`}\n            initialValue={value}\n            disabled={disabled}\n            saveValueToSDK={setValue}\n          />\n        );\n      }}\n    </FieldConnector>\n  );\n}\n","import React from 'react';\nimport {\n  FieldExtensionSDK,\n  DialogExtensionSDK,\n  OpenCustomWidgetOptions,\n} from '@contentful/app-sdk';\nimport { ModalDialogLauncher } from '@contentful/field-editor-shared';\nimport { MarkdownDialogsParams, PreviewComponents } from '../types';\n\nimport { CheatsheetModalDialog } from './CheatsheetModalDialog';\nimport { SpecialCharacterModalDialog } from './SpecialCharacterModalDialog';\nimport { MarkdownDialogType } from '../types';\nimport { InsertLinkModal, InsertLinkModalResult } from './InsertLinkModalDialog';\nimport { InsertTableModal, InsertTableModalResult } from './InsertTableModalDialog';\nimport { ConfirmInsertAssetModalDialog } from './ConfirmInsertAssetModalDialog';\nimport {\n  EmbedExternalContentModal,\n  EmbedExternalContentModalResult,\n} from './EmdebExternalContentDialog';\nimport { ZenModeModalDialog, ZenModeResult } from './ZenModeModalDialog';\n\nexport const openMarkdownDialog =\n  (sdk: FieldExtensionSDK, previewComponents?: PreviewComponents) =>\n  (\n    options: OpenCustomWidgetOptions & {\n      parameters?: MarkdownDialogsParams;\n    }\n  ) => {\n    if (options.parameters?.type === MarkdownDialogType.cheatsheet) {\n      return ModalDialogLauncher.openDialog(options, () => {\n        return <CheatsheetModalDialog />;\n      });\n    } else if (options.parameters?.type === MarkdownDialogType.insertLink) {\n      const selectedText = options.parameters.selectedText;\n      return ModalDialogLauncher.openDialog<InsertLinkModalResult>(options, ({ onClose }) => {\n        return <InsertLinkModal selectedText={selectedText} onClose={onClose} />;\n      });\n    } else if (options.parameters?.type === MarkdownDialogType.insertSpecialCharacter) {\n      return ModalDialogLauncher.openDialog(options, ({ onClose }) => {\n        return <SpecialCharacterModalDialog onClose={onClose} />;\n      });\n    } else if (options.parameters?.type === MarkdownDialogType.insertTable) {\n      return ModalDialogLauncher.openDialog<InsertTableModalResult>(options, ({ onClose }) => {\n        return <InsertTableModal onClose={onClose} />;\n      });\n    } else if (options.parameters?.type === MarkdownDialogType.embedExternalContent) {\n      return ModalDialogLauncher.openDialog<EmbedExternalContentModalResult>(\n        options,\n        ({ onClose }) => {\n          return <EmbedExternalContentModal onClose={onClose} />;\n        }\n      );\n    } else if (options.parameters?.type === MarkdownDialogType.confirmInsertAsset) {\n      const locale = options.parameters.locale;\n      const assets = options.parameters.assets;\n      return ModalDialogLauncher.openDialog<boolean>(options, ({ onClose }) => {\n        return <ConfirmInsertAssetModalDialog onClose={onClose} locale={locale} assets={assets} />;\n      });\n    } else if (options.parameters?.type === MarkdownDialogType.zenMode) {\n      const initialValue = options.parameters.initialValue;\n      const locale = options.parameters.locale;\n      return ModalDialogLauncher.openDialog<ZenModeResult>(options, ({ onClose }) => {\n        return (\n          <ZenModeModalDialog\n            saveValueToSDK={(value) => {\n              if (value) {\n                return sdk?.field?.setValue(value);\n              }\n              return sdk?.field?.removeValue();\n            }}\n            onClose={onClose}\n            initialValue={initialValue}\n            locale={locale}\n            sdk={sdk as unknown as DialogExtensionSDK}\n            previewComponents={previewComponents}\n          />\n        );\n      });\n    }\n    return Promise.reject();\n  };\n","import React from 'react';\nimport { DialogExtensionSDK } from '@contentful/app-sdk';\nimport { MarkdownDialogsParams, MarkdownDialogType } from '../types';\nimport { SpecialCharacterModalDialog } from './SpecialCharacterModalDialog';\nimport { CheatsheetModalDialog } from './CheatsheetModalDialog';\nimport { InsertLinkModal } from './InsertLinkModalDialog';\nimport { InsertTableModal } from './InsertTableModalDialog';\nimport { EmbedExternalContentModal } from './EmdebExternalContentDialog';\nimport { ConfirmInsertAssetModalDialog } from './ConfirmInsertAssetModalDialog';\nimport { ZenModeModalDialog } from './ZenModeModalDialog';\n\nexport const renderMarkdownDialog = (\n  sdk: DialogExtensionSDK & { parameters: { invocation: MarkdownDialogsParams } }\n) => {\n  const parameters = sdk.parameters.invocation;\n  if (parameters.type === MarkdownDialogType.cheatsheet) {\n    sdk.window.startAutoResizer();\n    return <CheatsheetModalDialog />;\n  } else if (parameters.type === MarkdownDialogType.insertLink) {\n    const selectedText = parameters.selectedText;\n    sdk.window.startAutoResizer();\n    return <InsertLinkModal selectedText={selectedText} onClose={sdk.close} />;\n  } else if (parameters.type === MarkdownDialogType.insertSpecialCharacter) {\n    sdk.window.startAutoResizer();\n    return <SpecialCharacterModalDialog onClose={sdk.close} />;\n  } else if (parameters.type === MarkdownDialogType.insertTable) {\n    sdk.window.startAutoResizer();\n    return <InsertTableModal onClose={sdk.close} />;\n  } else if (parameters.type === MarkdownDialogType.embedExternalContent) {\n    sdk.window.startAutoResizer();\n    return <EmbedExternalContentModal onClose={sdk.close} />;\n  } else if (parameters.type === MarkdownDialogType.confirmInsertAsset) {\n    const locale = parameters.locale;\n    const assets = parameters.assets;\n    sdk.window.startAutoResizer();\n    return <ConfirmInsertAssetModalDialog onClose={sdk.close} locale={locale} assets={assets} />;\n  } else if (parameters.type === MarkdownDialogType.zenMode) {\n    const locale = parameters.locale;\n    const initialValue = parameters.initialValue;\n    // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n    sdk.window.updateHeight('100%' as any);\n    return (\n      <ZenModeModalDialog\n        onClose={sdk.close}\n        saveValueToSDK={() => {\n          // don't save changes in dialog mode\n        }}\n        initialValue={initialValue}\n        locale={locale}\n        sdk={sdk}\n      />\n    );\n  }\n\n  return <div />;\n};\n"],"names":["styles","root","css","display","zIndex","flexDirection","justifyContent","overflow","marginBottom","fontSize","tokens","fontSizeM","tab","cursor","color","gray700","padding","spacingXs","minWidth","border","gray400","borderTopLeftRadius","borderRadiusSmall","borderTopRightRadius","marginLeft","textAlign","backgroundColor","gray100","borderBottomColor","outline","boxShadow","boxShadowHeavy","transition","transitionEasingDefault","transitionDurationShort","inactiveTab","background","gray200","gray300","MarkdownTabItem","props","React","className","cx","isActive","onClick","onSelect","name","onKeyDown","e","keyCode","tabIndex","role","testId","children","MarkdownTabs","active","srOnly","position","width","height","margin","clip","Zen","label","rest","viewBox","d","Strikethrough","Indent","Dedent","Cubes","Table","SpecialChar","OrgLinks","Undo","Redo","HeadingSelector","handleMenuClick","heading","Menu","Trigger","List","Item","InsertLinkSelector","canAddNew","MultipleMediaContextMenu","Button","isDisabled","disabled","startIcon","AssetIcon","size","variant","onSelectExisting","placement","endIcon","ChevronDownIcon","onAddNew","Number","zIndexWorkbenchHeader","button","spacing2Xs","marginRight","icon","fill","verticalAlign","zenButton","zenButtonPressed","tooltip","zIndexTooltip","ToolbarButton","forwardRef","ref","tooltipPlace","otherProps","Tooltip","content","IconButton","displayName","MainButtons","mode","actions","headings","HeadingIcon","simple","bold","FormatBoldIcon","italic","FormatItalicIcon","quote","QuoteIcon","ul","ListBulletedIcon","ol","ListNumberedIcon","insertLink","LinkIcon","AdditionalButtons","strike","Icons","code","CodeIcon","hr","HorizontalRuleIcon","indent","dedent","embedExternalContent","insertTable","insertSpecialCharacter","organizeLinks","history","undo","redo","DefaultMarkdownToolbar","useState","showAdditional","setShowAdditional","Flex","MoreHorizontalIcon","linkExistingMedia","addNewMedia","canUploadAssets","openZenMode","marginTop","ZenMarkdownToolbar","closeZenMode","MarkdownToolbar","memo","userAgent","get","window","platform","ctrlKey","tests","ios","test","MSStream","getCtrlKey","stripUnit","value","cssRegex","matchedValue","match","Error","parseFloat","create","host","options","direction","fixedHeight","readOnly","initializedWithValue","LF","EDITOR_SIZE","min","max","shift","cm","CodeMirror","lineNumbers","undoDepth","matchBrackets","lineWrapping","lineSeparator","theme","tabSize","indentWithTabs","indentUnit","autoRefresh","spellcheck","inputStyle","setSize","on","throttle","assureHeight","setOption","Tab","replaceSelectedText","getIndentation","Enter","Esc","getInputField","blur","destroy","disable","enable","attachEvent","addKeyShortcuts","setValue","cmd","moveToLineBeginning","moveIfNotEmpty","restoreCursor","moveToLineEnd","usePrimarySelection","focus","select","selectBackwards","selectAll","execCommand","extendSelectionBy","insertAtCursor","insertAtLineBeginning","wrapSelection","removeFromLineBeginning","removeSelectedText","getCursor","setCursor","getSelection","getLine","isLineEmpty","getSelectedText","getSelectionLength","getCurrentLine","getCurrentLineNumber","getCurrentCharacter","getCurrentLineLength","lineStartsWith","getNl","getValue","getLinesCount","getHistorySize","setReadOnly","getHistory","setHistory","setFullsize","refresh","toTextArea","current","heightAtLine","lastLine","next","fn","throttleInterval","map","addKeyMap","transform","acc","key","line","ch","clearHistory","lineNumber","defaultToCurrentLineNumber","character","noFocus","scroll","undefined","from","to","setSelection","skip","len","getPos","modifier","prop","selection","text","replaceRange","initialCh","length","wrapper","replacement","anchor","head","charCount","replaceSelection","selections","listSelections","somethingSelected","n","lineCount","startsWith","repeat","getOption","which","historySize","what","Array","join","createPrefixToggleFn","prefix","editor","marker","emptyText","selectedText","endsWith","markerLength","textWithoutMarker","slice","HEADER_CHAR","quoteToggleFn","codeToggleFn","modifySelection","link","h1","toggleHeader","h2","h3","ulToggleFn","olToggleFn","table","nl","markup","indentation","config","tableTemplate","rows","cols","url","title","linkTitle","toggleFn","isList","forLineIn","listNumber","getListNumber","prepareListWhitespace","cb","lines","maxNumber","minNumber","lineRange","range","forEach","i","isCurrentLineEmpty","isPrevLineEmpty","isNextLineEmpty","linesToInsert","result","nrows","ncols","cellWidth","cell","separatorCell","baseRow","separatorRow","times","bodyRows","replace","headerRow","concat","level","currentHeader","selectHeader","removedCh","diff","header","createMarkdownEditor","CodeMirrorWrapper","wrapChange","api","Commands","hasUndo","hasRedo","events","onScroll","onChange","onPaste","insert","getContent","setContent","clear","B","I","lineHeightDefault","spacingL","fontStackMonospace","gray900","red600","gray600","blue500","framed","maxHeight","zen","maxWidth","MarkdownTextarea","hostRef","useRef","setEditor","useEffect","Object","assign","minHeight","onReady","style","visible","borderBottomLeftRadius","borderBottomRightRadius","spacingS","help","fontSizeS","lineHeight","MarkdownHelp","Paragraph","TextLink","as","MarkdownBottomBar","MarkdownDialogType","flexColumnContainer","flexWrap","flexColumn","flexGrow","verticalDivider","borderRight","gray500","paddingRight","spacing3Xl","spacing2Xl","preview","unOrderedListPreview","listStyleType","orderedListPreview","paddingLeft","fontSize2Xl","fontSizeXl","fontSizeL","helpItem","alignItems","spacingXl","helpLink","flexRowContainer","CheatsheetModalDialog","ModalContent","Heading","href","target","rel","openCheatsheetModal","dialogs","openCurrent","shouldCloseOnEscapePress","shouldCloseOnOverlayClick","parameters","type","cheatsheet","replaceMailtoAmp","string","fontStackPrimary","spacingM","overflowY","rtl","MarkdownLink","Embedly","MarkdownPreview","cleanHTML","useMemo","DOMPurify","sanitize","Markdown","overrides","a","component","previewComponents","embedly","MarkdownConstraints","constraints","ConstraintsUtils","fromFieldValidations","sdk","field","validations","checkConstraint","makeChecker","CharCounter","CharValidation","runtime","exports","Op","prototype","hasOwn","hasOwnProperty","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","obj","defineProperty","enumerable","configurable","writable","err","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","context","Context","_invoke","makeInvokeMethod","tryCatch","arg","call","GenStateSuspendedStart","GenStateSuspendedYield","GenStateExecuting","GenStateCompleted","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","method","isGeneratorFunction","genFun","ctor","constructor","mark","setPrototypeOf","__proto__","awrap","__await","AsyncIterator","PromiseImpl","invoke","resolve","reject","record","then","unwrapped","error","previousPromise","enqueue","callInvokeWithMethodAndArg","async","Promise","iter","done","state","doneResult","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","TypeError","info","resultName","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","keys","object","reverse","pop","iterable","iteratorMethod","isNaN","skipTempReset","prev","charAt","stop","rootEntry","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","module","regeneratorRuntime","accidentalStrictMode","globalThis","Function","urlRegex","isValidUrl","InsertLinkModal","onClose","mainInputRef","setText","setUrl","touched","setTouched","setTitle","onInsert","urlIsValid","Form","onSubmit","FormControl","id","Boolean","Label","TextInput","isInvalid","placeholder","maxLength","HelpText","ValidationMessage","ModalControls","openInsertLinkDialog","params","specialCharacters","desc","buttonPanel","charButton","selectedCharButton","SpecialCharacterModalDialog","selectedCharacter","setSelectedCharacter","Text","String","fromCharCode","char","openInsertSpecialCharacter","InsertTableModal","setRows","setColumns","rowsAreValid","inRange","colsAreValid","isRequired","toString","pattern","autoComplete","openInsertTableDialog","widthFiledGroup","radioButtonGroup","paddingTop","radioButton","makeEmbedlyLink","selectedUnit","attachSocial","s","percent","px","isWidthValid","unit","EmbedExternalContentModal","setUnit","setUrlValidity","setWidth","setAttachSocial","Radio","isChecked","Checkbox","fontColor","openEmbedExternalContentDialog","ConfirmInsertAssetModalDialog","assets","locale","localesNumber","EntityList","description","thumbnailUrl","thumbnailAltText","openConfirmInsertAsset","confirmInsertAsset","left","right","top","bottom","topSplit","bottomSplit","editorSplit","overflowX","editorSplitFullscreen","previewSplit","separator","hideButton","showButton","borderRightWidth","ZenModeModalDialog","initialValue","currentValue","setCurrentValue","showPreview","setShowPreview","updateHeight","setTimeout","createMarkdownActions","locales","saveValueToSDK","ChevronRightIcon","ChevronLeftIcon","zenMode","normalizeWhiteSpace","str","trim","removeExtension","fileNameToTitle","replaceAssetDomain","fileUrl","assetDomainMap","images","downloads","videos","_","p1","makeAssetLink","asset","localeCode","fallbackCode","defaultLocaleCode","localizedFile","fallbackFile","defaultFile","file","isObject","fileName","isLocalized","isFallback","asMarkdown","insertAssetLinks","otherLocales","filter","linksWithMeta","fallbackAssets","fields","fallbacks","links","extractTitle","split","tail","segments","PROCESSORS","inline","REGEXS","findInline","makeFinder","findRefs","findLabels","convertInlineToRef","findMaxLabelId","buildRef","buildLabel","mergeLabels","byHref","byOldId","alreadyAdded","extend","hasTitle","rewriteRefs","merged","hrefToRefId","labels","rewrites","oldLabel","newRefId","newId","findAll","textOrLabels","isString","ids","x","parseInt","isFinite","flags","matches","re","RegExp","source","found","exec","lastIndex","index","insertAssetsWithConfirmation","insertAnyway","LinkOrganizer","notifier","success","navigator","openNewAsset","slideIn","waitForClose","entity","markdownLinks","selectMultipleAssets","container","fontFamily","MarkdownEditor","selectedTab","setSelectedTab","setCanUploadAssets","access","can","isActionDisabled","openMarkdownHelp","useCallback","trimmedValue","MarkdownEditorConnected","FieldConnector","isInitiallyDisabled","externalReset","openMarkdownDialog","ModalDialogLauncher","openDialog","removeValue","renderMarkdownDialog","invocation","startAutoResizer","close"],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"field-editor-markdown.cjs.development.js","sources":["../src/components/MarkdownTabs.tsx","../src/components/icons.tsx","../src/components/HeadingSelector.tsx","../src/components/InsertLinkSelector.tsx","../src/components/MarkdownToolbar.tsx","../src/utils/userAgent.ts","../src/components/MarkdownTextarea/CodeMirrorWrapper.ts","../src/components/MarkdownTextarea/MarkdownCommands.ts","../src/components/MarkdownTextarea/createMarkdownEditor.ts","../src/components/MarkdownTextarea/MarkdownTextarea.tsx","../src/components/MarkdownBottomBar.tsx","../src/types.ts","../src/dialogs/CheatsheetModalDialog.tsx","../src/utils/replaceMailtoAmp.ts","../src/components/MarkdownPreview.tsx","../src/components/MarkdownConstraints.tsx","../../../node_modules/regenerator-runtime/runtime.js","../src/utils/isValidUrl.ts","../src/dialogs/InsertLinkModalDialog.tsx","../src/utils/specialCharacters.ts","../src/dialogs/SpecialCharacterModalDialog.tsx","../src/dialogs/InsertTableModalDialog.tsx","../src/dialogs/EmdebExternalContentDialog.tsx","../src/dialogs/ConfirmInsertAssetModalDialog.tsx","../src/dialogs/ZenModeModalDialog.tsx","../src/utils/insertAssetLinks.ts","../src/utils/linkOrganizer.ts","../src/MarkdownActions.ts","../src/MarkdownEditor.tsx","../src/dialogs/openMarkdownDialog.tsx","../src/dialogs/renderMarkdownDialog.tsx"],"sourcesContent":["import React from 'react';\nimport { css, cx } from 'emotion';\nimport tokens from '@contentful/f36-tokens';\nimport { MarkdownTab } from '../types';\n\nconst styles = {\n  root: css({\n    display: 'flex',\n    zIndex: 10,\n    flexDirection: 'row',\n    justifyContent: 'flex-end',\n    overflow: 'hidden',\n    marginBottom: '-1px',\n    fontSize: tokens.fontSizeM,\n  }),\n  tab: css({\n    cursor: 'pointer',\n    color: tokens.gray700,\n    padding: tokens.spacingXs,\n    minWidth: '70px',\n    border: `1px solid ${tokens.gray400}`,\n    borderTopLeftRadius: tokens.borderRadiusSmall,\n    borderTopRightRadius: tokens.borderRadiusSmall,\n    marginLeft: tokens.spacingXs,\n    textAlign: 'center',\n    backgroundColor: tokens.gray100,\n    borderBottomColor: tokens.gray100,\n    outline: 'none',\n    '&:focus': {\n      boxShadow: tokens.boxShadowHeavy,\n    },\n    transition: `all ${tokens.transitionEasingDefault} ${tokens.transitionDurationShort}`,\n  }),\n  inactiveTab: css({\n    background: tokens.gray200,\n    borderBottomColor: tokens.gray400,\n    '&:hover': {\n      background: tokens.gray300,\n    },\n  }),\n};\n\ninterface MarkdownTabsProps {\n  active: MarkdownTab;\n  onSelect: (selected: MarkdownTab) => void;\n}\n\nfunction MarkdownTabItem(props: {\n  isActive: boolean;\n  name: MarkdownTab;\n  testId: string;\n  onSelect: (name: MarkdownTab) => void;\n  children: React.ReactNode;\n}) {\n  return (\n    <div\n      className={cx(styles.tab, {\n        [styles.inactiveTab]: props.isActive === false,\n      })}\n      onClick={() => {\n        props.onSelect(props.name);\n      }}\n      onKeyDown={(e) => {\n        if (e.keyCode === 13) {\n          props.onSelect(props.name);\n        }\n      }}\n      tabIndex={0}\n      role=\"tab\"\n      aria-controls={props.name}\n      aria-selected={props.isActive === true}\n      data-test-id={props.testId}>\n      {props.children}\n    </div>\n  );\n}\n\nexport function MarkdownTabs(props: MarkdownTabsProps) {\n  return (\n    <div className={styles.root}>\n      <MarkdownTabItem\n        name=\"editor\"\n        onSelect={props.onSelect}\n        isActive={props.active === 'editor'}\n        testId=\"markdown-tab-md\">\n        Editor\n      </MarkdownTabItem>\n      <MarkdownTabItem\n        name=\"preview\"\n        onSelect={props.onSelect}\n        isActive={props.active === 'preview'}\n        testId=\"markdown-tab-preview\">\n        Preview\n      </MarkdownTabItem>\n    </div>\n  );\n}\n","import React from 'react';\nimport { css } from 'emotion';\n\ntype IconProps = {\n  width?: number;\n  height?: number;\n  className?: string;\n  label: string;\n};\n\nconst srOnly = css({\n  position: 'absolute',\n  width: '1px',\n  height: '1px',\n  padding: '0',\n  margin: '-1px',\n  overflow: 'hidden',\n  clip: 'rect(0, 0, 0, 0)',\n  border: '0',\n});\n\nexport const Zen = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1411 541l-355 355 355 355 144-144q29-31 70-14 39 17 39 59v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l144-144-355-355-355 355 144 144q31 30 14 69-17 40-59 40H192q-26 0-45-19t-19-45v-448q0-42 40-59 39-17 69 14l144 144 355-355-355-355-144 144q-19 19-45 19-12 0-24-5-40-17-40-59V192q0-26 19-45t45-19h448q42 0 59 40 17 39-14 69L541 381l355 355 355-355-144-144q-31-30-14-69 17-40 59-40h448q26 0 45 19t19 45v448q0 42-39 59-13 5-25 5-26 0-45-19z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Strikethrough = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1760 896q14 0 23 9t9 23v64q0 14-9 23t-23 9H32q-14 0-23-9t-9-23v-64q0-14 9-23t23-9h1728zM483 832q-28-35-51-80-48-98-48-188 0-181 134-309 133-127 393-127 50 0 167 19 66 12 177 48 10 38 21 118 14 123 14 183 0 18-5 45l-12 3-84-6-14-2q-50-149-103-205-88-91-210-91-114 0-182 59-67 58-67 146 0 73 66 140t279 129q69 20 173 66 58 28 95 52H483zm507 256h411q7 39 7 92 0 111-41 212-23 56-71 104-37 35-109 81-80 48-153 66-80 21-203 21-114 0-195-23l-140-40q-57-16-72-28-8-8-8-22v-13q0-108-2-156-1-30 0-68l2-37v-44l102-2q15 34 30 71t22.5 56 12.5 27q35 57 80 94 43 36 105 57 59 22 132 22 64 0 139-27 77-26 122-86 47-61 47-129 0-84-81-157-34-29-137-71z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Indent = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M352 832q0 14-9 23L55 1143q-9 9-23 9-13 0-22.5-9.5T0 1120V544q0-13 9.5-22.5T32 512q14 0 23 9l288 288q9 9 9 23zm1440 480v192q0 13-9.5 22.5t-22.5 9.5H32q-13 0-22.5-9.5T0 1504v-192q0-13 9.5-22.5T32 1280h1728q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5t-22.5 9.5H672q-13 0-22.5-9.5T640 1120V928q0-13 9.5-22.5T672 896h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5T1760 768H672q-13 0-22.5-9.5T640 736V544q0-13 9.5-22.5T672 512h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5T1760 384H32q-13 0-22.5-9.5T0 352V160q0-13 9.5-22.5T32 128h1728q13 0 22.5 9.5t9.5 22.5z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Dedent = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M384 544v576q0 13-9.5 22.5T352 1152q-14 0-23-9L41 855q-9-9-9-23t9-23l288-288q9-9 23-9 13 0 22.5 9.5T384 544zm1408 768v192q0 13-9.5 22.5t-22.5 9.5H32q-13 0-22.5-9.5T0 1504v-192q0-13 9.5-22.5T32 1280h1728q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5t-22.5 9.5H672q-13 0-22.5-9.5T640 1120V928q0-13 9.5-22.5T672 896h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5T1760 768H672q-13 0-22.5-9.5T640 736V544q0-13 9.5-22.5T672 512h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5T1760 384H32q-13 0-22.5-9.5T0 352V160q0-13 9.5-22.5T32 128h1728q13 0 22.5 9.5t9.5 22.5z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Cubes = ({ label, ...rest }: IconProps) => (\n  <svg width={18} height={14} viewBox=\"0 0 2304 1792\" {...rest}>\n    <path d=\"M640 1632l384-192v-314l-384 164v342zm-64-454l404-173-404-173-404 173zm1088 454l384-192v-314l-384 164v342zm-64-454l404-173-404-173-404 173zm-448-293l384-165V454l-384 164v267zm-64-379l441-189-441-189-441 189zm1088 518v416q0 36-19 67t-52 47l-448 224q-25 14-57 14t-57-14l-448-224q-4-2-7-4-2 2-7 4l-448 224q-25 14-57 14t-57-14L71 1554q-33-16-52-47t-19-67v-416q0-38 21.5-70T78 906l434-186V320q0-38 21.5-70t56.5-48l448-192q23-10 50-10t50 10l448 192q35 16 56.5 48t21.5 70v400l434 186q36 16 57 48t21 70z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Table = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M576 1376v-192q0-14-9-23t-23-9H224q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm0-384V800q0-14-9-23t-23-9H224q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm512 384v-192q0-14-9-23t-23-9H736q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zM576 608V416q0-14-9-23t-23-9H224q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm512 384V800q0-14-9-23t-23-9H736q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm512 384v-192q0-14-9-23t-23-9h-320q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm-512-768V416q0-14-9-23t-23-9H736q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm512 384V800q0-14-9-23t-23-9h-320q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm0-384V416q0-14-9-23t-23-9h-320q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm128-320v1088q0 66-47 113t-113 47H224q-66 0-113-47t-47-113V288q0-66 47-113t113-47h1344q66 0 113 47t47 113z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const SpecialChar = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1360 1307l35 159q3 12-3 22.5t-17 14.5l-5 1q-4 2-10.5 3.5t-16 4.5-21.5 5.5-25.5 5-30 5-33.5 4.5-36.5 3-38.5 1q-234 0-409-130.5T511 1054h-95q-13 0-22.5-9.5T384 1022V909q0-13 9.5-22.5T416 877h66q-2-57 1-105h-67q-14 0-23-9t-9-23V626q0-14 9-23t23-9h98q67-210 243.5-338T1158 128q102 0 194 23 11 3 20 15 6 11 3 24l-43 159q-3 13-14 19.5t-24 2.5l-4-1q-4-1-11.5-2.5L1261 364l-22.5-3.5-26-3-29-2.5-29.5-1q-126 0-226 64T778 594h468q16 0 25 12 10 12 7 26l-24 114q-5 26-32 26H734q-3 37 0 105h459q15 0 25 12 9 12 6 27l-24 112q-2 11-11 18.5t-20 7.5H782q48 117 149.5 185.5T1160 1308q18 0 36-1.5t33.5-3.5 29.5-4.5 24.5-5 18.5-4.5l12-3 5-2q13-5 26 2 12 7 15 21z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const OrgLinks = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1792 1248v320q0 40-28 68t-68 28h-320q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h96V960H960v192h96q40 0 68 28t28 68v320q0 40-28 68t-68 28H736q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h96V960H320v192h96q40 0 68 28t28 68v320q0 40-28 68t-68 28H96q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h96V960q0-52 38-90t90-38h512V640h-96q-40 0-68-28t-28-68V224q0-40 28-68t68-28h320q40 0 68 28t28 68v320q0 40-28 68t-68 28h-96v192h512q52 0 90 38t38 90v192h96q40 0 68 28t28 68z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Undo = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1664 896q0 156-61 298t-164 245-245 164-298 61q-172 0-327-72.5T305 1387q-7-10-6.5-22.5t8.5-20.5l137-138q10-9 25-9 16 2 23 12 73 95 179 147t225 52q104 0 198.5-40.5T1258 1258t109.5-163.5T1408 896t-40.5-198.5T1258 534t-163.5-109.5T896 384q-98 0-188 35.5T548 521l137 138q31 30 14 69-17 40-59 40H192q-26 0-45-19t-19-45V256q0-42 40-59 39-17 69 14l130 129q107-101 244.5-156.5T896 128q156 0 298 61t245 164 164 245 61 298z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Redo = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1664 256v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l138-138q-148-137-349-137-104 0-198.5 40.5T534 534 424.5 697.5 384 896t40.5 198.5T534 1258t163.5 109.5T896 1408q119 0 225-52t179-147q7-10 23-12 15 0 25 9l137 138q9 8 9.5 20.5t-7.5 22.5q-109 132-264 204.5T896 1664q-156 0-298-61t-245-164-164-245-61-298 61-298 164-245 245-164 298-61q147 0 284.5 55.5T1425 340l130-129q29-31 70-14 39 17 39 59z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n","import React from 'react';\nimport { Menu } from '@contentful/f36-components';\nimport { HeadingType } from '../types';\n\nexport const HeadingSelector = (props: {\n  children: React.ReactElement;\n  onSelect: (heading: HeadingType) => void;\n  tooltip?: string;\n}) => {\n  const handleMenuClick = (heading: HeadingType) => {\n    props.onSelect(heading);\n  };\n\n  return (\n    <Menu>\n      <Menu.Trigger>{props.children}</Menu.Trigger>\n      <Menu.List>\n        <Menu.Item testId=\"markdown-action-button-heading-h1\" onClick={() => handleMenuClick('h1')}>\n          Heading 1\n        </Menu.Item>\n        <Menu.Item testId=\"markdown-action-button-heading-h2\" onClick={() => handleMenuClick('h2')}>\n          Heading 2\n        </Menu.Item>\n        <Menu.Item testId=\"markdown-action-button-heading-h3\" onClick={() => handleMenuClick('h3')}>\n          Heading 3\n        </Menu.Item>\n      </Menu.List>\n    </Menu>\n  );\n};\n","import React from 'react';\nimport { Menu } from '@contentful/f36-components';\n\nimport { Button } from '@contentful/f36-components';\n\nimport { AssetIcon, ChevronDownIcon } from '@contentful/f36-icons';\n\ninterface InsertLinkSelectorProps {\n  onSelectExisting: Function;\n  onAddNew: Function;\n  canAddNew: boolean;\n  disabled: boolean;\n}\n\nexport const InsertLinkSelector = (props: InsertLinkSelectorProps) => {\n  if (props.canAddNew) {\n    return <MultipleMediaContextMenu {...props} />;\n  } else {\n    return (\n      <Button\n        isDisabled={props.disabled}\n        startIcon={<AssetIcon />}\n        testId=\"markdownEditor.linkExistingAssets\"\n        size=\"small\"\n        variant=\"secondary\"\n        onClick={() => {\n          props.onSelectExisting();\n        }}>\n        Insert media\n      </Button>\n    );\n  }\n};\n\nconst MultipleMediaContextMenu = (props: InsertLinkSelectorProps) => {\n  return (\n    <Menu placement=\"bottom-end\">\n      <Menu.Trigger>\n        <Button\n          endIcon={<ChevronDownIcon />}\n          isDisabled={props.disabled}\n          startIcon={<AssetIcon />}\n          testId=\"markdownEditor.insertMediaDropdownTrigger\"\n          size=\"small\"\n          variant=\"secondary\">\n          Insert media\n        </Button>\n      </Menu.Trigger>\n      <Menu.List>\n        <Menu.Item testId=\"markdownEditor.uploadAssetsAndLink\" onClick={() => props.onAddNew()}>\n          Add new media and link\n        </Menu.Item>\n        <Menu.Item\n          testId=\"markdownEditor.linkExistingAssets\"\n          onClick={() => props.onSelectExisting()}>\n          Link existing media\n        </Menu.Item>\n      </Menu.List>\n    </Menu>\n  );\n};\n","/* eslint-disable react/prop-types */\nimport React from 'react';\nimport { css, cx } from 'emotion';\nimport { IconButton, Flex, Tooltip } from '@contentful/f36-components';\nimport type { ButtonProps } from '@contentful/f36-components';\nimport tokens from '@contentful/f36-tokens';\nimport {\n  HeadingIcon,\n  FormatBoldIcon,\n  FormatItalicIcon,\n  QuoteIcon,\n  ListBulletedIcon,\n  ListNumberedIcon,\n  LinkIcon,\n  CodeIcon,\n  HorizontalRuleIcon,\n  MoreHorizontalIcon,\n} from '@contentful/f36-icons';\nimport * as Icons from './icons';\nimport { HeadingSelector } from './HeadingSelector';\nimport { InsertLinkSelector } from './InsertLinkSelector';\nimport { MarkdownActions } from '../types';\n\nconst styles = {\n  root: css({\n    position: 'relative',\n    zIndex: Number(tokens.zIndexWorkbenchHeader),\n    border: `1px solid ${tokens.gray400}`,\n    backgroundColor: tokens.gray100,\n    padding: tokens.spacingXs,\n    borderTopLeftRadius: tokens.borderRadiusSmall,\n  }),\n  button: css({\n    height: '30px',\n    width: '36px',\n    marginLeft: tokens.spacing2Xs,\n    marginRight: tokens.spacing2Xs,\n  }),\n  icon: css({\n    fill: tokens.gray700,\n    verticalAlign: 'middle',\n  }),\n  zenButton: css({\n    marginLeft: tokens.spacingXs,\n  }),\n  zenButtonPressed: css({\n    backgroundColor: tokens.gray400,\n  }),\n  tooltip: css({\n    zIndex: Number(tokens.zIndexTooltip),\n  }),\n};\n\nconst ToolbarButton = React.forwardRef<\n  HTMLButtonElement,\n  {\n    variant?: 'transparent' | 'secondary';\n    onClick?: Function;\n    tooltipPlace?: 'top' | 'bottom';\n    tooltip: string;\n    children: React.ReactElement;\n  } & Omit<ButtonProps, 'onClick'>\n>((props, ref) => {\n  const {\n    tooltip,\n    onClick,\n    children,\n    className,\n    variant = 'transparent',\n    tooltipPlace = 'top',\n    isDisabled = false,\n    ...otherProps\n  } = props;\n\n  return (\n    <Tooltip className={styles.tooltip} placement={tooltipPlace} content={tooltip}>\n      <IconButton\n        {...otherProps}\n        ref={ref}\n        className={cx(styles.button, className)}\n        isDisabled={isDisabled}\n        onClick={onClick as ButtonProps['onClick']}\n        variant={variant}\n        size=\"small\"\n        icon={children}\n        aria-label={tooltip}\n      />\n    </Tooltip>\n  );\n});\nToolbarButton.displayName = 'ToolbarButton';\n\ninterface MarkdownToolbarProps {\n  canUploadAssets: boolean;\n  disabled: boolean;\n  actions: MarkdownActions;\n  mode: 'default' | 'zen';\n}\n\nfunction MainButtons(props: MarkdownToolbarProps) {\n  const tooltipPlace = props.mode === 'zen' ? 'bottom' : 'top';\n\n  return (\n    <>\n      <HeadingSelector\n        onSelect={(heading) => {\n          if (heading && props.actions.headings[heading]) {\n            props.actions.headings[heading]();\n          }\n        }}>\n        <ToolbarButton\n          isDisabled={props.disabled}\n          testId=\"markdown-action-button-heading\"\n          tooltip=\"Headings\"\n          tooltipPlace={tooltipPlace}>\n          <HeadingIcon aria-label=\"Headings\" className={styles.icon} />\n        </ToolbarButton>\n      </HeadingSelector>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-bold\"\n        tooltip=\"Bold\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.bold}>\n        <FormatBoldIcon aria-label=\"Bold\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-italic\"\n        tooltip=\"Italic\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.italic}>\n        <FormatItalicIcon aria-label=\"Italic\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-quote\"\n        tooltip=\"Quote\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.quote}>\n        <QuoteIcon aria-label=\"Quote\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-ul\"\n        tooltip=\"Unordered list\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.ul}>\n        <ListBulletedIcon aria-label=\"Unordered list\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-ol\"\n        tooltip=\"Ordered list\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.ol}>\n        <ListNumberedIcon aria-label=\"Ordered list\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-link\"\n        tooltip=\"Link\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.insertLink}>\n        <LinkIcon aria-label=\"Link\" className={styles.icon} />\n      </ToolbarButton>\n    </>\n  );\n}\n\nfunction AdditionalButtons(props: MarkdownToolbarProps) {\n  const tooltipPlace = props.mode === 'zen' ? 'bottom' : 'top';\n  return (\n    <>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-strike\"\n        tooltip=\"Strike out\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.strike}>\n        <Icons.Strikethrough label=\"Strike out\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-code\"\n        tooltip=\"Code block\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.code}>\n        <CodeIcon aria-label=\"Code block\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-hr\"\n        tooltip=\"Horizontal rule\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.hr}>\n        <HorizontalRuleIcon aria-label=\"Horizontal rule\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-indent\"\n        tooltip=\"Increase indentation\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.indent}>\n        <Icons.Indent label=\"Increase indentation\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-dedent\"\n        tooltip=\"Decrease indentation\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.dedent}>\n        <Icons.Dedent label=\"Decrease indentation\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-embed\"\n        tooltip=\"Embed external content\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.embedExternalContent}>\n        <Icons.Cubes label=\"Embed external content\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-table\"\n        tooltip=\"Insert table\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.insertTable}>\n        <Icons.Table label=\"Insert table\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-special\"\n        tooltip=\"Insert special character\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.insertSpecialCharacter}>\n        <Icons.SpecialChar label=\"Insert special character\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-organizeLinks\"\n        tooltip=\"Organize links\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.organizeLinks}>\n        <Icons.OrgLinks label=\"Organize links\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-undo\"\n        tooltip=\"Undo\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.history.undo}>\n        <Icons.Undo label=\"Undo\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-redo\"\n        tooltip=\"Redo\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.history.redo}>\n        <Icons.Redo label=\"Redo\" className={styles.icon} />\n      </ToolbarButton>\n    </>\n  );\n}\n\nexport function DefaultMarkdownToolbar(props: MarkdownToolbarProps) {\n  const [showAdditional, setShowAdditional] = React.useState(false);\n\n  return (\n    <div className={styles.root}>\n      <Flex justifyContent=\"space-between\">\n        <Flex>\n          <MainButtons {...props} />\n          <ToolbarButton\n            isDisabled={props.disabled}\n            testId=\"markdown-action-button-toggle-additional\"\n            tooltip={showAdditional ? 'Hide additional actions' : 'More actions'}\n            onClick={() => {\n              setShowAdditional(!showAdditional);\n            }}>\n            <MoreHorizontalIcon className={styles.icon} />\n          </ToolbarButton>\n        </Flex>\n        <Flex>\n          <InsertLinkSelector\n            disabled={props.disabled}\n            onSelectExisting={props.actions.linkExistingMedia}\n            onAddNew={props.actions.addNewMedia}\n            canAddNew={props.canUploadAssets}\n          />\n          <ToolbarButton\n            isDisabled={props.disabled}\n            testId=\"markdown-action-button-zen\"\n            variant=\"secondary\"\n            onClick={props.actions.openZenMode}\n            className={styles.zenButton}\n            tooltip=\"Expand\">\n            <Icons.Zen label=\"Expand\" className={styles.icon} />\n          </ToolbarButton>\n        </Flex>\n      </Flex>\n      {showAdditional && (\n        <Flex justifyContent=\"space-between\" marginTop=\"spacingXs\">\n          <Flex>\n            <AdditionalButtons {...props} />\n          </Flex>\n        </Flex>\n      )}\n    </div>\n  );\n}\n\nexport function ZenMarkdownToolbar(props: MarkdownToolbarProps) {\n  return (\n    <div className={styles.root}>\n      <Flex justifyContent=\"space-between\">\n        <Flex>\n          <MainButtons {...props} />\n          <AdditionalButtons {...props} />\n        </Flex>\n        <Flex>\n          <InsertLinkSelector\n            disabled={props.disabled}\n            onSelectExisting={props.actions.linkExistingMedia}\n            onAddNew={props.actions.addNewMedia}\n            canAddNew={props.canUploadAssets}\n          />\n          <IconButton\n            testId=\"markdown-action-button-zen-close\"\n            variant=\"secondary\"\n            size=\"small\"\n            className={cx(styles.zenButton, styles.zenButtonPressed)}\n            onClick={() => {\n              props.actions.closeZenMode();\n            }}\n            icon={<Icons.Zen label=\"Collapse\" className={styles.icon} />}\n            aria-label=\"Collapse\"\n          />\n        </Flex>\n      </Flex>\n    </div>\n  );\n}\n\nexport const MarkdownToolbar = React.memo((props: MarkdownToolbarProps) => {\n  if (props.mode === 'zen') {\n    return <ZenMarkdownToolbar {...props} />;\n  }\n  return <DefaultMarkdownToolbar {...props} />;\n});\n\nMarkdownToolbar.displayName = 'MarkdownToolbar';\n","import get from 'lodash/get';\n\nconst userAgent = get(window, 'navigator.userAgent', '');\nconst platform = get(window, 'navigator.platform', '');\n\nlet ctrlKey = 'Ctrl';\n\nconst tests = {\n  // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/ban-ts-comment\n  // @ts-ignore ignore missing MSStream\n  ios: /(iphone os|ipad|iphone|ipod)/i.test(userAgent) && !window.MSStream,\n};\n\nif (tests.ios || /mac(68k|ppc|intel)/i.test(platform)) {\n  ctrlKey = 'Cmd';\n}\n\nexport function getCtrlKey() {\n  return ctrlKey;\n}\n","/* eslint-disable @typescript-eslint/no-use-before-define, @typescript-eslint/no-explicit-any */\n\nimport CodeMirror from 'codemirror';\nimport 'codemirror/addon/edit/matchbrackets';\nimport throttle from 'lodash/throttle';\nimport transform from 'lodash/transform';\n\nimport { EditorDirection } from '../../types';\nimport * as userAgent from '../../utils/userAgent';\n\nfunction stripUnit(value: number | string): number {\n  if (typeof value !== 'string') return value;\n\n  const cssRegex = /^([+-]?(?:\\d+|\\d*\\.\\d+))([a-z]*|%)$/;\n  const matchedValue = value.match(cssRegex);\n\n  if (!matchedValue) {\n    throw new Error(\"Couldn't match unit in given string\");\n  }\n\n  return parseFloat(value);\n}\n\nexport function create(\n  host: HTMLElement,\n  options: {\n    direction: EditorDirection;\n    readOnly: boolean;\n    fixedHeight?: number | boolean;\n    height?: number | string;\n  }\n) {\n  const { direction, fixedHeight, height, readOnly } = options || {};\n\n  // Set to true if `setValue()` has been called. This is to prevent\n  // undoing the initial content.\n  let initializedWithValue = false;\n\n  const LF = '\\n';\n\n  const EDITOR_SIZE = {\n    min: height ? stripUnit(height) : 300,\n    max: 500,\n    shift: 50,\n  };\n\n  const cm = CodeMirror(host, {\n    direction,\n    readOnly,\n    mode: 'markdown',\n    lineNumbers: false,\n    undoDepth: 200,\n    matchBrackets: true,\n    lineWrapping: true,\n    // When `lineSeparator === null` the document will be split\n    // on CRLFs as well as lone CRs and LFs. A single LF will\n    // be used as line separator in all output\n    lineSeparator: null,\n    theme: 'elegant',\n    tabSize: 2,\n    indentWithTabs: false,\n    indentUnit: 2,\n    autoRefresh: true,\n    spellcheck: true,\n    inputStyle: 'contenteditable',\n  });\n\n  cm.setSize('100%', EDITOR_SIZE.min);\n\n  if (!fixedHeight) {\n    cm.on('change', throttle(assureHeight, 150));\n  }\n\n  cm.setOption('extraKeys', {\n    Tab: function () {\n      replaceSelectedText(getIndentation());\n    },\n    Enter: 'newlineAndIndentContinueMarkdownList',\n    Esc: () => {\n      cm.getInputField().blur();\n    },\n  });\n\n  /**\n   * @description\n   * Custom API for a CodeMirror instance.\n   *\n   * An instance wraps a CodeMirror instance and provides a custom interface\n   * on top of CodeMirror.\n   */\n  return {\n    destroy,\n    disable,\n    enable,\n    attachEvent,\n    addKeyShortcuts,\n    setValue,\n    cmd,\n    moveToLineBeginning,\n    moveIfNotEmpty,\n    restoreCursor,\n    moveToLineEnd,\n    usePrimarySelection,\n    focus,\n    select,\n    selectBackwards,\n    selectAll: () => cm.execCommand('selectAll'),\n    extendSelectionBy,\n    insertAtCursor,\n    insertAtLineBeginning,\n    wrapSelection,\n    removeFromLineBeginning,\n    removeSelectedText,\n    replaceSelectedText,\n    getCursor,\n    setCursor,\n    getSelection,\n    getLine,\n    isLineEmpty,\n    getSelectedText,\n    getSelectionLength,\n    getCurrentLine,\n    getCurrentLineNumber,\n    getCurrentCharacter,\n    getCurrentLineLength,\n    lineStartsWith,\n    getIndentation,\n    getNl,\n    getValue,\n    getLinesCount,\n    getHistorySize,\n    setReadOnly: (value: boolean) => cm.setOption('readOnly', value),\n    getHistory: () => cm.getHistory(),\n    setHistory: (history: any) => cm.setHistory(history),\n    setFullsize: () => {\n      cm.setSize('100%', '100%');\n      cm.refresh();\n    },\n    refresh: () => cm.refresh(),\n  };\n\n  function destroy() {\n    // @ts-expect-error\n    cm.toTextArea();\n  }\n\n  function disable() {\n    cm.setOption('readOnly', 'nocursor');\n  }\n\n  function enable() {\n    cm.setOption('readOnly', false);\n  }\n\n  function assureHeight() {\n    const current = cm.heightAtLine(cm.lastLine(), 'local') + EDITOR_SIZE.shift;\n    let next = current;\n    if (current < EDITOR_SIZE.min) {\n      next = EDITOR_SIZE.min;\n    }\n    if (current > EDITOR_SIZE.max) {\n      next = EDITOR_SIZE.max;\n    }\n    cm.setSize('100%', next);\n  }\n\n  function attachEvent(name: string, fn: Function, throttleInterval: number) {\n    if (throttleInterval) {\n      fn = throttle(fn as any, throttleInterval);\n    }\n    cm.on(name, fn as any);\n  }\n\n  function addKeyShortcuts(map: any) {\n    const ctrlKey = userAgent.getCtrlKey();\n    cm.addKeyMap(\n      transform(\n        map,\n        (acc, value, key) => {\n          // eslint-disable-next-line -- TODO: describe this disable\n          // @ts-ignore\n          acc[ctrlKey + '-' + key] = value;\n        },\n        {}\n      )\n    );\n  }\n\n  /**\n   * low-level editor manipulation functions\n   */\n\n  /**\n   * @description\n   * Sets the content of the editor while preserving the cursor\n   * position.\n   *\n   * If called for the first time it will not record the change in\n   * the history.\n   */\n  function setValue(value?: string) {\n    value = value || '';\n    if (getValue() === value) {\n      return;\n    }\n\n    // set value, but save cursor position first\n    // position will be restored, but w/o focus (third arg)\n    const line = getCurrentLineNumber();\n    const ch = getCurrentCharacter();\n    cm.setValue(value);\n    restoreCursor(ch, line, true);\n\n    // We do not want to record the initial population in the\n    // history. Otherwise it would always be possible to revert to\n    // the empty string.\n    if (!initializedWithValue) {\n      cm.clearHistory();\n      initializedWithValue = true;\n    }\n  }\n\n  function cmd(name: string) {\n    cm.execCommand(name);\n    cm.focus();\n  }\n\n  function moveToLineBeginning(lineNumber?: number) {\n    cm.setCursor({ line: defaultToCurrentLineNumber(lineNumber), ch: 0 });\n    cm.focus();\n  }\n\n  /**\n   * @description\n   * Insert a new line below the cursor and move to the beginning of\n   * that line.\n   *\n   * Only do this if the editor has content and we are not already on\n   * the last line.\n   *\n   * TODO rename this\n   */\n  function moveIfNotEmpty() {\n    if (getCurrentLineLength() < 1) {\n      return;\n    }\n\n    const next = getCurrentLineNumber() + 1;\n    if (cm.lastLine() < next) {\n      moveToLineEnd();\n      insertAtCursor(getNl());\n    }\n\n    moveToLineBeginning(next);\n  }\n\n  function restoreCursor(character: number, lineNumber?: number, noFocus?: boolean) {\n    cm.setCursor(defaultToCurrentLineNumber(lineNumber), character, {\n      scroll: !noFocus,\n    });\n    if (!noFocus) {\n      cm.focus();\n    }\n  }\n\n  function moveToLineEnd(lineNumber?: number) {\n    cm.setCursor({\n      line: defaultToCurrentLineNumber(lineNumber),\n      ch: getCurrentLineLength(),\n    });\n    cm.focus();\n  }\n\n  function defaultToCurrentLineNumber(lineNumber?: number) {\n    if (lineNumber === 0 || (lineNumber !== undefined && lineNumber > 0)) {\n      return lineNumber;\n    }\n    return getCurrentLineNumber();\n  }\n\n  function usePrimarySelection() {\n    cmd('singleSelection');\n  }\n\n  function focus() {\n    cm.focus();\n  }\n\n  function select(from: CodeMirror.Position, to: CodeMirror.Position) {\n    cm.setSelection(from, to);\n    cm.focus();\n  }\n\n  function selectBackwards(skip: number, len: number) {\n    select(getPos(-skip - len), getPos(-skip));\n\n    function getPos(modifier: number) {\n      return {\n        line: getCurrentLineNumber(),\n        ch: getCurrentCharacter() + modifier,\n      };\n    }\n  }\n\n  function extendSelectionBy(modifier: number) {\n    select(getPos('anchor', 0), getPos('head', modifier));\n\n    function getPos(prop: 'anchor' | 'head', modifier: number): CodeMirror.Position {\n      const selection = getSelection();\n      if (!selection) {\n        return { line: 0, ch: 0 };\n      }\n      return { line: selection[prop].line, ch: selection[prop].ch + modifier };\n    }\n  }\n\n  function insertAtCursor(text: string) {\n    cm.replaceRange(text, cm.getCursor());\n    cm.focus();\n  }\n\n  function insertAtLineBeginning(text: string) {\n    const initialCh = getCurrentCharacter();\n    moveToLineBeginning();\n    insertAtCursor(text);\n    restoreCursor(initialCh + text.length);\n    cm.focus();\n  }\n\n  function wrapSelection(wrapper: string) {\n    const replacement = wrapper + getSelectedText() + wrapper;\n    const selection = getSelection();\n    if (selection) {\n      cm.replaceRange(replacement, selection.anchor, selection?.head);\n      cm.focus();\n    }\n  }\n\n  function removeFromLineBeginning(charCount: number) {\n    const lineNumber = getCurrentLineNumber();\n    cm.replaceRange('', { line: lineNumber, ch: 0 }, { line: lineNumber, ch: charCount });\n    cm.focus();\n  }\n\n  function removeSelectedText() {\n    cm.replaceSelection('');\n    cm.focus();\n  }\n\n  /**\n   * @description\n   * Replace the selected text with the given string.\n   *\n   * If nothing is selected it will insert the text at the current\n   * cursor position\n   *\n   * The optional `select` parameter controls what will be selected\n   * afters wards. By default the cursor will be at the end of the\n   * inserted text. You can pass 'around' to select the inserted\n   * text.\n   */\n  function replaceSelectedText(replacement: string, select?: string) {\n    cm.replaceSelection(replacement, select);\n    cm.focus();\n  }\n\n  /**\n   *  low-level editor get/check functions\n   */\n\n  function getCursor() {\n    return cm.getCursor();\n  }\n\n  function setCursor(cursor: number | CodeMirror.Position) {\n    cm.setCursor(cursor);\n  }\n\n  function getSelection() {\n    const selections = cm.listSelections();\n    if (!cm.somethingSelected() || !selections || selections.length < 1) {\n      return null;\n    }\n    return selections[0];\n  }\n\n  function getLine(lineNumber: number) {\n    return cm.getLine(lineNumber) || '';\n  }\n\n  function isLineEmpty(lineNumber?: number) {\n    const n = defaultToCurrentLineNumber(lineNumber);\n    return n > -1 && getLine(n).length < 1 && n < cm.lineCount();\n  }\n\n  function getLinesCount() {\n    return cm.lineCount();\n  }\n\n  function getSelectedText() {\n    return getSelection() ? cm.getSelection() : '';\n  }\n\n  function getSelectionLength() {\n    return getSelectedText().length;\n  }\n\n  function getCurrentLine() {\n    return getLine(getCurrentLineNumber());\n  }\n\n  function getCurrentLineNumber() {\n    return cm.getCursor().line;\n  }\n\n  function getCurrentCharacter() {\n    return cm.getCursor().ch;\n  }\n\n  function getCurrentLineLength() {\n    return getCurrentLine().length;\n  }\n\n  function lineStartsWith(text: string) {\n    return getCurrentLine().startsWith(text);\n  }\n\n  function getIndentation() {\n    return repeat(' ', cm.getOption('indentUnit') ?? 0);\n  }\n\n  function getNl(n = 1) {\n    if (n < 1) {\n      return '';\n    }\n    return repeat(LF, n);\n  }\n\n  function getValue() {\n    return cm.getValue() || '';\n  }\n\n  function getHistorySize(which?: 'undo' | 'redo') {\n    const history = cm.historySize();\n    return which ? history[which] : history;\n  }\n\n  function repeat(what: string, n: number) {\n    return new Array(n + 1).join(what);\n  }\n}\n","/* eslint-disable @typescript-eslint/no-use-before-define */\n\nimport range from 'lodash/range';\nimport min from 'lodash/min';\nimport max from 'lodash/max';\nimport times from 'lodash/times';\n// eslint-disable-next-line -- TODO: describe this disable  you-dont-need-lodash-underscore/repeat\nimport repeat from 'lodash/repeat';\n\nimport * as CodeMirrorWrapper from './CodeMirrorWrapper';\n\ntype EditorInstanceType = ReturnType<typeof CodeMirrorWrapper.create>;\n\nfunction createPrefixToggleFn(prefix: string) {\n  return (editor: EditorInstanceType) => {\n    if (editor.lineStartsWith(prefix)) {\n      editor.removeFromLineBeginning(prefix.length);\n    } else {\n      editor.insertAtLineBeginning(prefix);\n    }\n  };\n}\n\n/**\n * Wraps the current selection with a marker.\n *\n * If nothing is selected it inserts the given text wrapped in the\n * marker and selects the inner text\n *\n * Used b the `bold`, `italic`, and `strike` commands.\n */\nfunction wrapSelection(editor: EditorInstanceType, marker: string, emptyText: string) {\n  return () => {\n    editor.usePrimarySelection();\n\n    // there's a selection - wrap it with inline marker\n    if (editor.getSelection()) {\n      const selectedText = editor.getSelectedText();\n      if (selectedText.startsWith(marker) && selectedText.endsWith(marker)) {\n        const markerLength = marker.length;\n        const textWithoutMarker = selectedText.slice(\n          markerLength,\n          selectedText.length - markerLength\n        );\n        editor.replaceSelectedText(textWithoutMarker);\n      } else {\n        editor.wrapSelection(marker);\n      }\n    } else {\n      // no selection - insert sample text and select it\n      editor.insertAtCursor(marker + emptyText + marker);\n      editor.selectBackwards(marker.length, emptyText.length);\n    }\n  };\n}\n\nconst HEADER_CHAR = '#';\nconst quoteToggleFn = createPrefixToggleFn('> ');\nconst codeToggleFn = createPrefixToggleFn('    ');\n\n/**\n * @description\n * A collection of commands used by the user bound to a\n * CodeMirrorWrapper instance.\n *\n * The command collection only depends on the wrapper instance and is\n * used by UI from code mirror stuff.\n */\nexport function create(editor: EditorInstanceType) {\n  return {\n    bold: wrapSelection(editor, '__', 'text in bold'),\n    italic: wrapSelection(editor, '*', 'text in italic'),\n    strike: wrapSelection(editor, '~~', 'striked out'),\n    quote: modifySelection(editor, quoteToggleFn),\n    code: modifySelection(editor, codeToggleFn),\n    link,\n    h1: toggleHeader(editor, 1),\n    h2: toggleHeader(editor, 2),\n    h3: toggleHeader(editor, 3),\n    ul: modifySelection(editor, ulToggleFn, true),\n    ol: modifySelection(editor, olToggleFn, true),\n    undo: function () {\n      editor.cmd('undo');\n    },\n    redo: function () {\n      editor.cmd('redo');\n    },\n    hr,\n    indent,\n    dedent,\n    table,\n  };\n\n  /**\n   * @description\n   * Insert a line with `---` below the cursor.\n   */\n  function hr() {\n    editor.moveIfNotEmpty();\n    const nl = editor.getNl();\n    const markup = nl + '---' + nl + nl;\n    editor.insertAtCursor(markup);\n  }\n\n  /**\n   * @description\n   * Indent the current line.\n   */\n  function indent() {\n    editor.insertAtLineBeginning(editor.getIndentation());\n  }\n\n  /**\n   * @description\n   * Dedent the current line.\n   */\n  function dedent() {\n    const indentation = editor.getIndentation();\n    if (editor.lineStartsWith(indentation)) {\n      editor.removeFromLineBeginning(indentation.length);\n    }\n  }\n\n  /**\n   * @description\n   * Insert a markdown table template in a new line.\n   */\n  function table(config: { rows: number; cols: number }) {\n    const nl = editor.getNl();\n    editor.moveIfNotEmpty();\n    editor.insertAtCursor(nl);\n    const line = editor.getCurrentLineNumber();\n    editor.insertAtCursor(tableTemplate(config.rows, config.cols).join(nl));\n    editor.insertAtCursor(nl + nl);\n    editor.restoreCursor(2, line);\n  }\n\n  /**\n   * @description\n   * Inserts or replaces the current selection with a markdown link\n   */\n  function link(url: string, text?: string, title?: string) {\n    editor.usePrimarySelection();\n\n    const linkTitle = title ? ' \"' + title + '\"' : '';\n\n    const link = text ? '[' + text + '](' + url + linkTitle + ')' : '<' + url + '>';\n\n    editor.replaceSelectedText(link, 'around');\n  }\n}\n\n/**\n * For each line in the selection move to that line and call\n * `toggleFn` with the 1-based index of the line in the selection.\n *\n * If there is no selection we just call `toggleFn(editor)`.\n */\nfunction modifySelection(\n  editor: EditorInstanceType,\n  toggleFn: (editor: EditorInstanceType, listNumber?: number) => void,\n  isList?: boolean\n) {\n  return () => {\n    editor.usePrimarySelection();\n\n    const selection = editor.getSelection();\n    if (selection) {\n      // there's a selection - toggle list bullet for each line\n      // listNumber is 1, 2, 3... and can be used as ol bullet\n      forLineIn(selection, (lineNumber: number, listNumber: number) => {\n        // TODO move this into forLineIn\n        editor.moveToLineBeginning(lineNumber);\n        toggleFn(editor, listNumber);\n      });\n      editor.moveToLineEnd();\n    } else {\n      // there's no selection - just toggle line prefix\n      // but if adding list, add whitespace before and after list\n      if (isList && !getListNumber(editor) && !editor.lineStartsWith('- ')) {\n        prepareListWhitespace(editor);\n      }\n      toggleFn(editor);\n    }\n  };\n}\n\n/**\n * Calls callback for each line number that is in the selection\n *\n * The second argument is the 1-based index of the iteration.\n *\n * @param {CodeMirror.Selection} selection\n * param {function(number)} cb\n */\nfunction forLineIn(\n  selection: {\n    anchor: CodeMirror.Position;\n    head: CodeMirror.Position;\n  },\n  cb: Function\n) {\n  // anchor/head depend on selection direction, so min & max have to be used\n  const lines = [selection.anchor.line, selection.head.line];\n  const maxNumber = max(lines);\n  const minNumber = min(lines);\n  const lineRange = range(minNumber || 0, maxNumber !== undefined ? maxNumber + 1 : undefined);\n\n  lineRange.forEach((lineNumber, i) => {\n    cb(lineNumber, i + 1);\n  });\n}\n\nfunction prepareListWhitespace(editor: EditorInstanceType) {\n  const line = editor.getCurrentLineNumber();\n\n  const isCurrentLineEmpty = editor.isLineEmpty(line);\n\n  const isPrevLineEmpty = line > 0 ? editor.isLineEmpty(line - 1) : false;\n  const isNextLineEmpty = line < editor.getLinesCount() - 1 ? editor.isLineEmpty(line + 1) : true;\n\n  let linesToInsert = isCurrentLineEmpty ? 2 : 4;\n  if (isPrevLineEmpty) {\n    linesToInsert = linesToInsert - 1;\n  }\n  if (isNextLineEmpty) {\n    linesToInsert = linesToInsert - 1;\n  }\n\n  editor.moveToLineEnd();\n  editor.insertAtCursor(editor.getNl(linesToInsert));\n  editor.restoreCursor(0, isCurrentLineEmpty ? line : line + 2);\n}\n\nfunction getListNumber(editor: EditorInstanceType) {\n  const result = editor.getCurrentLine().match(/^(\\d+\\. )/);\n  return result ? result[1] : null;\n}\n\nfunction ulToggleFn(editor: EditorInstanceType) {\n  if (editor.lineStartsWith('- ')) {\n    editor.removeFromLineBeginning(2);\n  } else {\n    const listNumber = getListNumber(editor);\n    if (listNumber) {\n      editor.removeFromLineBeginning(listNumber.length);\n    }\n    editor.insertAtLineBeginning('- ');\n  }\n}\n\nfunction olToggleFn(editor: EditorInstanceType, n?: number) {\n  const listNumber = getListNumber(editor);\n  if (listNumber) {\n    editor.removeFromLineBeginning(listNumber.length);\n  } else {\n    if (editor.lineStartsWith('- ')) {\n      editor.removeFromLineBeginning(2);\n    }\n    editor.insertAtLineBeginning((n || 1) + '. ');\n  }\n}\n\n/**\n * From a table layout specification build a Markdown table template.\n *\n * Returns the lines as an array.\n * Used by the `table()` command\n *\n * @param {object} config\n * @param {number} rows\n * @param {number} cols\n * @returns {string[]}\n */\nfunction tableTemplate(nrows: number, ncols: number) {\n  const cellWidth = new Array(11);\n  const cell = ' ' + cellWidth.join(' ') + ' |';\n  const separatorCell = ' ' + cellWidth.join('-') + ' |';\n\n  let baseRow = '|';\n  let separatorRow = '|';\n\n  times(ncols, () => {\n    baseRow += cell;\n    separatorRow += separatorCell;\n  });\n\n  const bodyRows = range(nrows).map(() => baseRow.replace(/\\| {5}/g, '| Cell'));\n\n  const headerRow = baseRow.replace(/\\| {7}/g, '| Header');\n\n  return [headerRow, separatorRow].concat(bodyRows);\n}\n\n/**\n * Toggles the header prefix for a given level on the current line.\n *\n * - Removes a header when one of the same level is\n * - Replaces the header if there is one of a different level\n * - Otherwise inserts the header\n */\nfunction toggleHeader(editor: EditorInstanceType, level: number) {\n  return () => {\n    const initialCh = editor.getCurrentCharacter();\n    const currentHeader = selectHeader(editor);\n    const prefix = repeat(HEADER_CHAR, level);\n\n    // there's no header at the current line - create one\n    if (!currentHeader) {\n      editor.moveToLineBeginning();\n      editor.insertAtCursor(prefix + ' ');\n      editor.restoreCursor(initialCh + prefix.length + 1);\n      return;\n    }\n\n    // there's exactly the same header - remove one\n    if (editor.getSelectedText() === prefix) {\n      editor.extendSelectionBy(1);\n      const removedCh = editor.getSelectionLength();\n      editor.removeSelectedText();\n      editor.restoreCursor(initialCh - removedCh);\n      return;\n    }\n\n    // there's another header at the current line - replace\n    const diff = prefix.length - editor.getSelectionLength();\n    editor.replaceSelectedText(prefix);\n    editor.restoreCursor(initialCh + diff);\n  };\n}\n\n/**\n * On the current line select a Markdown header prefix. That is the\n * string at the beginning of the line that consists of up to six `#`.\n *\n * If the selection was successful return the selected string.\n */\nfunction selectHeader(editor: EditorInstanceType) {\n  const result = editor.getCurrentLine().match(/^( {0,3})(#{1,6}) /);\n  if (!result) {\n    return null;\n  }\n  const indentation = result[1];\n  const header = result[2];\n\n  editor.select(getPos(0), getPos(header.length));\n  return editor.getSelection();\n\n  function getPos(modifier: number) {\n    return {\n      line: editor.getCurrentLineNumber(),\n      ch: indentation.length + modifier,\n    };\n  }\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n\nimport * as CodeMirrorWrapper from './CodeMirrorWrapper';\nimport * as Commands from './MarkdownCommands';\nimport { EditorDirection } from '../../types';\n\nexport function createMarkdownEditor(\n  host: HTMLElement,\n  options: {\n    direction: EditorDirection;\n    readOnly: boolean;\n    fixedHeight?: number | boolean;\n    height?: number | string;\n  }\n) {\n  const editor = CodeMirrorWrapper.create(host, options);\n\n  function wrapChange(fn: Function) {\n    return (e: any, ch: any) => {\n      fn(editor.getValue(), e, ch);\n    };\n  }\n\n  const api = {\n    actions: Commands.create(editor),\n    history: {\n      hasUndo: function () {\n        return editor.getHistorySize('undo') > 0;\n      },\n      hasRedo: function () {\n        return editor.getHistorySize('redo') > 0;\n      },\n    },\n    events: {\n      onScroll: function (fn: Function) {\n        editor.attachEvent('scroll', fn, 150);\n      },\n      onChange: function (fn: Function) {\n        editor.attachEvent('change', wrapChange(fn), 0);\n      },\n      onPaste: function (fn: Function) {\n        editor.attachEvent('paste', fn, 0);\n      },\n    },\n    insert: editor.insertAtCursor,\n    focus: editor.focus,\n    getContent: editor.getValue,\n    destroy: editor.destroy,\n    setContent: editor.setValue,\n    getSelectedText: editor.getSelectedText,\n    usePrimarySelection: editor.usePrimarySelection,\n    setReadOnly: editor.setReadOnly,\n    selectBackwards: editor.selectBackwards,\n    getCursor: editor.getCursor,\n    setCursor: editor.setCursor,\n    clear: () => editor.setValue(''),\n    selectAll: editor.selectAll,\n    setFullsize: editor.setFullsize,\n    refresh: editor.refresh,\n  };\n\n  editor.addKeyShortcuts({\n    B: api.actions.bold,\n    I: api.actions.italic,\n  });\n\n  return api;\n}\n","import React, { useRef, useEffect, useState } from 'react';\nimport tokens from '@contentful/f36-tokens';\nimport { css, cx } from 'emotion';\nimport { createMarkdownEditor } from './createMarkdownEditor';\nimport { EditorDirection } from '../../types';\n\nexport type InitializedEditorType = ReturnType<typeof createMarkdownEditor>;\n\ntype MarkdownTextareaProps = {\n  /**\n   * Minimum height to set for the markdown text area\n   */\n  minHeight?: string | number;\n  mode: 'default' | 'zen';\n  direction: EditorDirection;\n  disabled: boolean;\n  visible: boolean;\n  onReady: (editor: InitializedEditorType) => void;\n};\n\nconst styles = {\n  root: css`\n    border: 1px solid ${tokens.gray400};\n    border-width: 0 1px;\n    overflow-y: auto;\n    height: auto;\n    min-height: 300px;\n\n    .CodeMirror {\n      height: auto;\n      line-height: ${tokens.lineHeightDefault};\n    }\n    .CodeMirror-lines {\n      color: ${tokens.gray700};\n      padding: ${tokens.spacingL};\n    }\n    .CodeMirror-code {\n      font-family: ${tokens.fontStackMonospace};\n      font-size: ${tokens.fontSizeM};\n    }\n    .CodeMirror-scroll {\n      min-height: '6rem';\n    }\n\n    .cm-header {\n      color: ${tokens.gray900};\n    }\n    span.cm-variable-2 {\n      color: ${tokens.gray700};\n    }\n    .cm-header-1 {\n      font-size: 1.9em;\n    }\n    .cm-header-2 {\n      font-size: 1.75em;\n    }\n    .cm-header-3 {\n      font-size: 1.6em;\n    }\n    .cm-header-4 {\n      font-size: 1.45em;\n    }\n    .cm-header-5 {\n      font-size: 1.3em;\n    }\n    .cm-header-6 {\n      font-size: 1.15em;\n    }\n\n    span.cm-tag,\n    span.cm-string,\n    span.cm-attribute {\n      color: ${tokens.red600};\n    }\n    span.cm-string {\n      text-decoration: none !important;\n    }\n    span.cm-quote,\n    span.cm-comment {\n      color: ${tokens.gray600};\n    }\n    span.cm-link,\n    span.cm-url {\n      color: ${tokens.blue500} !important;\n    }\n    span.cm-link {\n      text-decoration: underline;\n    }\n  `,\n  framed: css({\n    '.CodeMirror': {\n      maxHeight: '500px',\n    },\n  }),\n  zen: css({\n    border: 'none !important',\n    '.CodeMirror-lines': {\n      maxWidth: '650px',\n      margin: '0 auto',\n    },\n  }),\n  disabled: css`\n    .CodeMirror {\n      background: ${tokens.gray100};\n      cursor: 'not-allowed';\n    }\n    .CodeMirror-cursors {\n      visibility: hidden !important;\n    }\n    .CodeMirror-scroll,\n    .CodeMirror-sizer,\n    .CodeMirror-lines {\n      cursor: not-allowed;\n    }\n  `,\n};\n\nexport const MarkdownTextarea = React.memo((props: MarkdownTextareaProps) => {\n  const hostRef = useRef<HTMLDivElement>(null);\n  const [editor, setEditor] = useState<InitializedEditorType | null>(null);\n\n  useEffect(() => {\n    if (hostRef.current) {\n      setEditor(\n        createMarkdownEditor(\n          hostRef.current,\n          Object.assign(\n            {},\n            {\n              direction: props.direction,\n              readOnly: true,\n            },\n            props.mode === 'zen'\n              ? {\n                  fixedHeight: true,\n                  height: '100%',\n                }\n              : {},\n            props.minHeight !== undefined ? { height: props.minHeight } : {}\n          )\n        )\n      );\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, []);\n\n  useEffect(() => {\n    if (editor) {\n      props.onReady(editor);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, [editor]);\n\n  const className = cx(\n    styles.root,\n    props.minHeight !== undefined ? css({ minHeight: props.minHeight }) : undefined,\n    props.mode === 'default' ? styles.framed : styles.zen,\n    props.disabled && styles.disabled\n  );\n\n  return (\n    <div\n      className={className}\n      ref={hostRef}\n      data-test-id=\"markdown-textarea\"\n      style={{ display: props.visible ? 'block' : 'none' }}\n    />\n  );\n});\n\nMarkdownTextarea.displayName = 'MarkdownTextarea';\n","import React from 'react';\n\nimport { TextLink, Paragraph } from '@contentful/f36-components';\nimport tokens from '@contentful/f36-tokens';\nimport { css } from 'emotion';\n\nconst styles = {\n  root: css({\n    display: 'flex',\n    justifyContent: 'space-between',\n    background: tokens.gray100,\n    border: `1px solid ${tokens.gray400}`,\n    borderBottomLeftRadius: tokens.borderRadiusSmall,\n    borderBottomRightRadius: tokens.borderRadiusSmall,\n    padding: `${tokens.spacingXs} ${tokens.spacingS}`,\n  }),\n  help: css({\n    color: tokens.gray700,\n    fontSize: tokens.fontSizeS,\n    button: {\n      fontSize: tokens.fontSizeS,\n      lineHeight: 'inherit',\n    },\n  }),\n};\n\nexport function MarkdownCounter(props: { words: number; characters: number }) {\n  return (\n    <Paragraph marginBottom=\"none\" className={styles.help}>\n      {props.words} {props.words !== 1 ? 'words' : 'word'}, {props.characters}{' '}\n      {props.characters !== 1 ? 'characters' : 'character'}\n    </Paragraph>\n  );\n}\n\nexport function MarkdownHelp(props: { onClick: () => void }) {\n  return (\n    <Paragraph marginBottom=\"none\" className={styles.help}>\n      Format your text like a pro with the{' '}\n      <TextLink\n        as=\"button\"\n        testId=\"open-markdown-cheatsheet-button\"\n        onClick={() => {\n          props.onClick();\n        }}\n      >\n        markdown cheatsheet\n      </TextLink>\n      .\n    </Paragraph>\n  );\n}\n\nexport function MarkdownBottomBar(props: { children: React.ReactNode }) {\n  return <div className={styles.root}>{props.children}</div>;\n}\n","export type MarkdownTab = 'editor' | 'preview';\n\nexport type HeadingType = 'h1' | 'h2' | 'h3';\n\nexport type EditorDirection = 'ltr' | 'rtl';\n\nexport enum MarkdownDialogType {\n  cheatsheet = 'markdown-cheatsheet',\n  insertLink = 'markdown-insertLink',\n  insertSpecialCharacter = 'markdown-insertSpecialCharacter',\n  insertTable = 'markdown-insertTable',\n  embedExternalContent = 'markdown-embedExternalContent',\n  confirmInsertAsset = 'markdown-confirmInsertAsset',\n  zenMode = 'markdown-zenMode',\n}\n\nexport type MarkdownDialogsParams =\n  | {\n      type: MarkdownDialogType.zenMode;\n      initialValue: string;\n      locale: string;\n    }\n  | {\n      type: MarkdownDialogType.cheatsheet;\n    }\n  | {\n      type: MarkdownDialogType.insertLink;\n      selectedText?: string;\n    }\n  | {\n      type: MarkdownDialogType.insertSpecialCharacter;\n    }\n  | {\n      type: MarkdownDialogType.insertTable;\n    }\n  | {\n      type: MarkdownDialogType.embedExternalContent;\n    }\n  | {\n      type: MarkdownDialogType.confirmInsertAsset;\n      locale: string;\n      assets: Array<{\n        title: string;\n        description: string;\n        thumbnailUrl: string;\n        thumbnailAltText: string;\n      }>;\n    };\n\nexport type MarkdownActions = {\n  simple: {\n    bold: Function;\n    italic: Function;\n    quote: Function;\n    ol: Function;\n    ul: Function;\n    strike: Function;\n    code: Function;\n    hr: Function;\n    indent: Function;\n    dedent: Function;\n  };\n  headings: {\n    h1: Function;\n    h2: Function;\n    h3: Function;\n  };\n  history: {\n    undo: Function;\n    redo: Function;\n  };\n  insertLink: Function;\n  embedExternalContent: Function;\n  insertTable: Function;\n  insertSpecialCharacter: Function;\n  linkExistingMedia: Function;\n  addNewMedia: Function;\n  organizeLinks: Function;\n  openZenMode: Function;\n  closeZenMode: Function;\n};\n\nexport type PreviewComponents = {\n  embedly?: React.ComponentType<{ url: string }>;\n};\n","import React from 'react';\nimport { css, cx } from 'emotion';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport { ModalContent } from '@contentful/f36-components';\nimport tokens from '@contentful/f36-tokens';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\n\nimport { TextLink, Heading } from '@contentful/f36-components';\n\nconst styles = {\n  flexColumnContainer: css({\n    display: 'flex',\n    flexWrap: 'nowrap',\n  }),\n  flexColumn: css({\n    flexGrow: 1,\n  }),\n  verticalDivider: css({\n    borderRight: `1px solid ${tokens.gray500}`,\n    paddingRight: tokens.spacing3Xl,\n    marginRight: tokens.spacing2Xl,\n  }),\n  preview: css({\n    display: 'inline-block',\n    paddingRight: tokens.spacingL,\n    width: '50%',\n  }),\n  unOrderedListPreview: css({\n    listStyleType: 'disc',\n    marginLeft: tokens.spacingS,\n  }),\n  orderedListPreview: css({\n    listStyleType: 'decimal',\n    marginLeft: tokens.spacingS,\n  }),\n  markup: css({\n    display: 'inline-block',\n    color: tokens.gray600,\n    paddingLeft: tokens.spacingL,\n    width: '50%',\n  }),\n  h1: css({\n    fontSize: tokens.fontSize2Xl,\n  }),\n  h2: css({\n    fontSize: tokens.fontSizeXl,\n  }),\n  h3: css({\n    fontSize: tokens.fontSizeL,\n  }),\n  helpItem: css({\n    marginBottom: tokens.spacingS,\n    display: 'flex',\n    alignItems: 'flex-end',\n    height: tokens.spacingXl,\n  }),\n  helpLink: css({\n    margin: 'auto',\n  }),\n  flexRowContainer: css({\n    display: 'flex',\n    width: '100%',\n    justifyContent: 'center',\n    marginTop: tokens.spacingXl,\n  }),\n};\n\nexport const CheatsheetModalDialog = () => {\n  return (\n    <ModalContent testId=\"markdown-cheatsheet-dialog-content\">\n      <div className={styles.flexColumnContainer}>\n        <div className={cx(styles.flexColumn, styles.verticalDivider)}>\n          <div className={styles.helpItem}>\n            <Heading marginBottom=\"none\" as=\"h1\" className={cx(styles.preview, styles.h1)}>\n              H1\n            </Heading>\n            <div className={styles.markup}># heading</div>\n          </div>\n          <div className={styles.helpItem}>\n            <Heading marginBottom=\"none\" as=\"h2\" className={cx(styles.preview, styles.h2)}>\n              H2\n            </Heading>\n            <div className={styles.markup}>## heading</div>\n          </div>\n          <div className={styles.helpItem}>\n            <Heading marginBottom=\"none\" as=\"h3\" className={cx(styles.preview, styles.h3)}>\n              H3\n            </Heading>\n            <div className={styles.markup}>### heading</div>\n          </div>\n          <div className={styles.helpItem}>\n            <strong className={styles.preview}>bold</strong>\n            <div className={styles.markup}>__text__</div>\n          </div>\n          <div className={styles.helpItem}>\n            <em className={styles.preview}>italic</em>\n            <div className={styles.markup}>*text*</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>strikethrough</div>\n            <div className={styles.markup}>~~text~~</div>\n          </div>\n          <div className={styles.helpItem}>\n            <TextLink as=\"button\" className={styles.preview}>\n              Link\n            </TextLink>\n            <div className={styles.markup}>[text](url)</div>\n          </div>\n        </div>\n        <div className={styles.flexColumn}>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>Image</div>\n            <div className={styles.markup}>![alt-text](url)</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>Unordered list</div>\n            <div className={styles.markup}>* list item</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>\n              <div>Ordered list</div>\n            </div>\n            <div className={styles.markup}>1. list item</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>\n              <div>Blockquote</div>\n            </div>\n            <div className={styles.markup}>&gt; quote</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>code span</div>\n            <div className={styles.markup}>`code here`</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>code block</div>\n            <div className={styles.markup}>```code here```</div>\n          </div>\n        </div>\n      </div>\n      <div className={styles.flexRowContainer}>\n        <TextLink\n          className={styles.helpLink}\n          href=\"https://help.github.com/en/github/writing-on-github/basic-writing-and-formatting-syntax\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\">\n          View the full GitHub-flavored Markdown syntax help (opens in a new window)\n        </TextLink>\n      </div>\n    </ModalContent>\n  );\n};\n\nexport const openCheatsheetModal = (dialogs: DialogsAPI): Promise<void> => {\n  return dialogs.openCurrent({\n    title: 'Markdown formatting help',\n    width: 'large',\n    minHeight: '415px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.cheatsheet,\n    } as MarkdownDialogsParams,\n  });\n};\n","// This code will replace '&amp;' with '&' only inside the href attribute of the mailto link.\n// Otherwise the mailto link will not work correctly\nexport const replaceMailtoAmp = (string: string) => {\n  return string.replace(/href=\"mailto:[^\"]*&amp;/g, function (match) {\n    return match.replace(/&amp;/g, '&');\n  });\n};\n","import React from 'react';\n\nimport tokens from '@contentful/f36-tokens';\nimport DOMPurify from 'dompurify';\nimport { css, cx } from 'emotion';\nimport Markdown from 'markdown-to-jsx';\n\nimport { EditorDirection, PreviewComponents } from '../types';\nimport { replaceMailtoAmp } from '../utils/replaceMailtoAmp';\n\nconst styles = {\n  root: css`\n    border: 1px solid ${tokens.gray400};\n    border-width: 0 1px;\n    word-wrap: break-word;\n    overflow-wrap: break-word;\n    min-height: 300px;\n    padding: ${tokens.spacingL};\n    font-size: ${tokens.fontSizeM};\n    font-family: ${tokens.fontStackPrimary};\n    line-height: ${tokens.lineHeightDefault};\n    color: ${tokens.gray700};\n    white-space: pre-line;\n\n    h1,\n    h2,\n    h3,\n    h4,\n    h5,\n    h6 {\n      margin-top: ${tokens.spacingL};\n      margin-bottom: ${tokens.spacingM};\n      color: ${tokens.gray900};\n    }\n\n    h1:first-child,\n    h2:first-child,\n    h3:first-child,\n    h4:first-child,\n    h5:first-child,\n    h6:first-child {\n      margin-top: 0;\n    }\n\n    h1 {\n      font-size: 1.9em;\n    }\n    h2 {\n      font-size: 1.75em;\n    }\n    h3 {\n      font-size: 1.6em;\n    }\n    h4 {\n      font-size: 1.45em;\n    }\n    h5 {\n      font-size: 1.3em;\n    }\n    h6 {\n      font-size: 1.15em;\n    }\n\n    p {\n      margin-top: 0;\n      margin-bottom: ${tokens.spacingM};\n    }\n\n    ul,\n    ol {\n      margin: ${tokens.spacingS} 0;\n      padding-left: ${tokens.spacingM};\n    }\n    ul > li {\n      list-style-type: disc;\n      margin-bottom: 0;\n    }\n\n    ol > li {\n      list-style-type: decimal;\n      margin-bottom: 0;\n    }\n\n    table {\n      table-layout: fixed;\n      border-right-width: 0;\n      border-bottom-width: 0;\n      width: 80%;\n      margin: ${tokens.spacingM} auto;\n      border-spacing: 0;\n      border-collapse: collapse;\n      border: 1px solid ${tokens.gray300};\n    }\n\n    table th,\n    table td {\n      padding: 5px;\n      border-left-width: 0;\n      border-top-width: 0;\n    }\n\n    table th {\n      background: ${tokens.gray200};\n    }\n\n    table td {\n      border: 1px solid ${tokens.gray300};\n    }\n\n    a {\n      color: ${tokens.blue500};\n    }\n\n    hr {\n      margin-top: ${tokens.spacingL};\n      margin-bottom: ${tokens.spacingL};\n      height: 1px;\n      background-color: ${tokens.gray300};\n      border: none;\n    }\n\n    blockquote {\n      border-left: 4px solid ${tokens.gray200};\n      padding-left: ${tokens.spacingL};\n      margin: 0;\n      margin-top: ${tokens.spacingM};\n      font-style: italic;\n    }\n\n    img {\n      margin: ${tokens.spacingM} auto;\n      display: block;\n      max-width: 80%;\n      max-height: 250px;\n    }\n\n    pre code {\n      font-size: ${tokens.fontSizeS};\n      font-family: ${tokens.fontStackMonospace};\n    }\n\n    .embedly-card {\n      margin: ${tokens.spacingM} auto;\n      display: block;\n    }\n  `,\n  framed: css({\n    height: '100%',\n    maxHeight: '500px',\n    overflowY: 'auto',\n  }),\n  zen: css({\n    maxWidth: '650px',\n    margin: '0 auto',\n    border: 'none !important',\n  }),\n  rtl: css({\n    direction: 'rtl',\n  }),\n};\n\ntype MarkdownPreviewProps = {\n  /**\n   * Minimum height to set for the markdown preview\n   */\n  minHeight?: string | number;\n  mode: 'default' | 'zen';\n  direction: EditorDirection;\n  value: string;\n  previewComponents?: PreviewComponents;\n};\n\nfunction MarkdownLink(props: {\n  href: string;\n  title: string;\n  className?: string;\n  // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n  children: any;\n  Embedly?: React.SFC<{ url: string }>;\n}) {\n  const { Embedly, children, ...rest } = props;\n\n  if (props.className === 'embedly-card' && Embedly) {\n    return <Embedly url={props.href} />;\n  }\n\n  return (\n    <a {...rest} target=\"_blank\" rel=\"noopener noreferrer\">\n      {children}\n    </a>\n  );\n}\n\nexport const MarkdownPreview = React.memo((props: MarkdownPreviewProps) => {\n  const className = cx(\n    styles.root,\n    props.minHeight !== undefined ? css({ minHeight: props.minHeight }) : undefined,\n    props.mode === 'default' ? styles.framed : styles.zen,\n    props.direction === 'rtl' ? styles.rtl : undefined\n  );\n\n  // See the list of allowed Tags here:\n  // https://github.com/cure53/DOMPurify/blob/main/src/tags.js#L3-L121\n  const cleanHTML = React.useMemo(() => {\n    return replaceMailtoAmp(DOMPurify.sanitize(props.value));\n  }, [props.value]);\n\n  return (\n    <div className={className} data-test-id=\"markdown-preview\">\n      <Markdown\n        options={{\n          overrides: {\n            a: {\n              // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n              component: MarkdownLink as any,\n              props: {\n                Embedly: props.previewComponents?.embedly,\n              },\n            },\n          },\n        }}>\n        {cleanHTML}\n      </Markdown>\n    </div>\n  );\n});\n\nMarkdownPreview.displayName = 'MarkdownPreview';\n","import React from 'react';\nimport { css } from 'emotion';\nimport tokens from '@contentful/f36-tokens';\nimport { FieldExtensionSDK } from '@contentful/app-sdk';\nimport { ConstraintsUtils, CharCounter, CharValidation } from '@contentful/field-editor-shared';\n\nconst styles = {\n  root: css({\n    display: 'flex',\n    justifyContent: 'space-between',\n    fontSize: tokens.fontSizeM,\n    marginTop: tokens.spacingXs,\n    color: tokens.gray700,\n  }),\n};\n\nexport function MarkdownConstraints(props: { sdk: FieldExtensionSDK; value: string }) {\n  const constraints = ConstraintsUtils.fromFieldValidations(\n    props.sdk.field.validations,\n    props.sdk.field.type as 'Text'\n  );\n\n  const checkConstraint = ConstraintsUtils.makeChecker(constraints);\n\n  return (\n    <div className={styles.root}>\n      <CharCounter value={props.value} checkConstraint={checkConstraint} />\n      <CharValidation constraints={constraints} />\n    </div>\n  );\n}\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = GeneratorFunctionPrototype;\n  define(Gp, \"constructor\", GeneratorFunctionPrototype);\n  define(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction);\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  });\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  define(Gp, iteratorSymbol, function() {\n    return this;\n  });\n\n  define(Gp, \"toString\", function() {\n    return \"[object Generator]\";\n  });\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, in modern engines\n  // we can explicitly access globalThis. In older engines we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","export const urlRegex =\n  /^(ftp|http|https):\\/\\/(\\w+:{0,1}\\w*@)?(\\S+)(:[0-9]+)?(\\/|\\/([\\w#!:.?+=&%@!\\-/]))?$/;\n\nexport function isValidUrl(value: string) {\n  return urlRegex.test(value);\n}\n","import React, { useState, useRef, useEffect } from 'react';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\nimport {\n  ModalContent,\n  ModalControls,\n  Button,\n  Form,\n  FormControl,\n  TextInput,\n} from '@contentful/f36-components';\nimport { isValidUrl } from '../utils/isValidUrl';\n\ntype InsertLinkModalPositiveResult = { url: string; text: string; title: string };\nexport type InsertLinkModalResult = InsertLinkModalPositiveResult | false | undefined;\n\ntype InsertLinkModalProps = {\n  selectedText?: string;\n  onClose: (result: InsertLinkModalResult) => void;\n};\n\nexport const InsertLinkModal = ({ selectedText, onClose }: InsertLinkModalProps) => {\n  const mainInputRef = useRef<HTMLInputElement>(null);\n  const [text, setText] = useState(selectedText || '');\n  const [url, setUrl] = useState('');\n  const [touched, setTouched] = useState(false);\n  const [title, setTitle] = useState('');\n  const onInsert = (values: InsertLinkModalPositiveResult) => onClose(values);\n\n  const urlIsValid = isValidUrl(url);\n\n  useEffect(() => {\n    if (mainInputRef?.current?.focus) {\n      mainInputRef.current.focus();\n    }\n  }, [mainInputRef]);\n\n  return (\n    <>\n      <ModalContent testId=\"insert-link-modal\">\n        <Form onSubmit={() => onInsert({ url, text, title })}>\n          <FormControl id=\"link-text-field\" isDisabled={Boolean(selectedText)}>\n            <FormControl.Label>Link text</FormControl.Label>\n            <TextInput\n              name=\"link-text\"\n              value={text}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                setText(e.target.value);\n              }}\n              testId=\"link-text-field\"\n            />\n          </FormControl>\n\n          <FormControl id=\"target-url-field\" isInvalid={touched && !urlIsValid}>\n            <FormControl.Label>Target URL</FormControl.Label>\n            <TextInput\n              name=\"target-url\"\n              value={url}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                setUrl(e.target.value);\n                setTouched(true);\n              }}\n              placeholder=\"https://\"\n              maxLength={2100}\n              testId=\"target-url-field\"\n              ref={mainInputRef}\n            />\n            <FormControl.HelpText>Include protocol (e.g. https://)</FormControl.HelpText>\n            {touched && !urlIsValid && (\n              <FormControl.ValidationMessage>Invalid URL</FormControl.ValidationMessage>\n            )}\n          </FormControl>\n\n          <FormControl id=\"link-title-field\">\n            <FormControl.Label>Link title</FormControl.Label>\n            <TextInput\n              name=\"link-title\"\n              value={title}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                setTitle(e.target.value);\n              }}\n              testId=\"link-title-field\"\n            />\n            <FormControl.HelpText>\n              Extra link information, usually shown as a tooltip on mouse hover\n            </FormControl.HelpText>\n          </FormControl>\n        </Form>\n      </ModalContent>\n      <ModalControls>\n        <Button\n          testId=\"insert-link-cancel\"\n          onClick={() => onClose(false)}\n          variant=\"secondary\"\n          size=\"small\">\n          Cancel\n        </Button>\n        <Button\n          testId=\"insert-link-confirm\"\n          onClick={() => {\n            onInsert({ url, text, title });\n          }}\n          isDisabled={!urlIsValid}\n          variant=\"positive\"\n          size=\"small\">\n          Insert\n        </Button>\n      </ModalControls>\n    </>\n  );\n};\n\nexport const openInsertLinkDialog = (\n  dialogs: DialogsAPI,\n  params: { selectedText?: string }\n): Promise<InsertLinkModalResult> => {\n  return dialogs.openCurrent({\n    title: 'Insert link',\n    width: 'large',\n    minHeight: '410px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.insertLink,\n      ...params,\n    } as MarkdownDialogsParams,\n  });\n};\n","export const specialCharacters = [\n  { code: 180, desc: 'acute accent' },\n  { code: 38, desc: 'ampersand' },\n  { code: 166, desc: 'broken vertical bar' },\n  { code: 8226, desc: 'bullet' },\n  { code: 184, desc: 'cedilla' },\n  { code: 162, desc: 'cent' },\n  { code: 169, desc: 'copyright' },\n  { code: 176, desc: 'degree' },\n  { code: 247, desc: 'division' },\n  { code: 189, desc: 'fraction half' },\n  { code: 188, desc: 'fraction quarter' },\n  { code: 190, desc: 'fraction three quarters' },\n  { code: 62, desc: 'greater than' },\n  { code: 161, desc: 'inverted exclamation mark' },\n  { code: 191, desc: 'inverted question mark' },\n  { code: 171, desc: 'left-pointing double angle quotation mark' },\n  { code: 60, desc: 'less than' },\n  { code: 175, desc: 'macron' },\n  { code: 181, desc: 'micro' },\n  { code: 160, desc: 'non-breaking space' },\n  { code: 172, desc: 'not' },\n  { code: 182, desc: 'paragraph' },\n  { code: 177, desc: 'plus-minus' },\n  { code: 34, desc: 'quotation mark' },\n  { code: 174, desc: 'registered' },\n  { code: 187, desc: 'right-pointing double angle quotation mark' },\n  { code: 167, desc: 'section' },\n  { code: 168, desc: 'umlaut/diaeresis' },\n  { code: 215, desc: 'multiplication' },\n  { code: 8482, desc: 'trade mark' },\n  { code: 8364, desc: 'euro' },\n  { code: 163, desc: 'pound' },\n  { code: 165, desc: 'yen' },\n  { code: 8222, desc: 'double low-9 quotation mark' },\n  { code: 710, desc: 'modifier circumflex accent' },\n  { code: 8224, desc: 'dagger' },\n  { code: 8225, desc: 'double dagger' },\n  { code: 8230, desc: 'horizontal ellipsis' },\n  { code: 8220, desc: 'left double quotation mark' },\n  { code: 8249, desc: 'single left-pointing angle quotation mark' },\n  { code: 8216, desc: 'left single quotation mark' },\n  { code: 183, desc: 'middle dot' },\n  { code: 8212, desc: 'em dash' },\n  { code: 8211, desc: 'en dash' },\n  { code: 8240, desc: 'per mille' },\n  { code: 8250, desc: 'single right-pointing angle quotation mark' },\n  { code: 8217, desc: 'right single quotation mark' },\n  { code: 8218, desc: 'single low-9 quotation mark' },\n  { code: 170, desc: 'feminine ordinal indicator' },\n  { code: 186, desc: 'masculine ordinal indicator' },\n  { code: 8221, desc: 'right double quotation mark' },\n  { code: 732, desc: 'small tilde' },\n  { code: 9829, desc: 'black heart' },\n  { code: 9830, desc: 'diamond' },\n];\n","import React, { useState } from 'react';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport { css } from 'emotion';\nimport tokens from '@contentful/f36-tokens';\nimport {\n  ModalContent,\n  ModalControls,\n  Text,\n  Flex,\n  Button,\n  Tooltip,\n} from '@contentful/f36-components';\nimport { specialCharacters } from '../utils/specialCharacters';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\n\nconst styles = {\n  buttonPanel: css({\n    display: 'flex',\n    flexWrap: 'wrap',\n  }),\n  charButton: css({\n    border: `1px solid ${tokens.gray500}`,\n    width: '4.1rem',\n    height: '4.1rem',\n    fontSize: tokens.fontSizeXl,\n    marginTop: tokens.spacing2Xs,\n    marginRight: tokens.spacing2Xs,\n  }),\n  selectedCharButton: css({\n    backgroundColor: tokens.gray100,\n  }),\n  tooltip: css({ zIndex: 1000 }),\n  button: css({\n    marginTop: tokens.spacingM,\n    marginRight: tokens.spacingS,\n  }),\n};\n\nexport type SpecialCharacterModalResult = string | false | undefined;\n\ntype SpecialCharacterModalDialogProps = {\n  onClose: (result: SpecialCharacterModalResult) => void;\n};\n\nexport const SpecialCharacterModalDialog = ({ onClose }: SpecialCharacterModalDialogProps) => {\n  const [selectedCharacter, setSelectedCharacter] = useState<{ code: number; desc: string }>(\n    specialCharacters[0]\n  );\n  return (\n    <>\n      <ModalContent testId=\"insert-special-character-modal\">\n        <Flex flexDirection=\"column\" alignItems=\"center\">\n          <Text as=\"div\" lineHeight=\"lineHeight3Xl\" fontSize=\"fontSize3Xl\" marginBottom=\"spacingS\">\n            {String.fromCharCode(selectedCharacter.code)}\n          </Text>\n          <Text as=\"div\" marginBottom=\"spacingS\">\n            {selectedCharacter.desc}\n          </Text>\n        </Flex>\n        <div className={styles.buttonPanel}>\n          {specialCharacters.map((char) => (\n            <div key={char.code}>\n              <Tooltip className={styles.tooltip} content={char.desc}>\n                <Button\n                  testId=\"special-character-button\"\n                  isActive={char.code === selectedCharacter.code}\n                  className={styles.charButton}\n                  variant=\"transparent\"\n                  onClick={() => setSelectedCharacter(char)}>\n                  {String.fromCharCode(char.code)}\n                </Button>\n              </Tooltip>\n            </div>\n          ))}\n        </div>\n      </ModalContent>\n      <ModalControls>\n        <Button\n          testId=\"insert-character-cancel\"\n          className={styles.button}\n          onClick={() => onClose(false)}\n          variant=\"secondary\"\n          size=\"small\">\n          Cancel\n        </Button>\n        <Button\n          className={styles.button}\n          testId=\"insert-character-confirm\"\n          onClick={() => onClose(String.fromCharCode(selectedCharacter.code))}\n          variant=\"positive\"\n          size=\"small\">\n          Insert selected\n        </Button>\n      </ModalControls>\n    </>\n  );\n};\n\nexport const openInsertSpecialCharacter = (\n  dialogs: DialogsAPI\n): Promise<SpecialCharacterModalResult> => {\n  return dialogs.openCurrent({\n    title: 'Insert special character',\n    width: 'large',\n    minHeight: '600px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.insertSpecialCharacter,\n    } as MarkdownDialogsParams,\n  });\n};\n","import React, { useState, useRef, useEffect } from 'react';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport inRange from 'lodash/inRange';\nimport {\n  ModalContent,\n  ModalControls,\n  Button,\n  Form,\n  FormControl,\n  TextInput,\n} from '@contentful/f36-components';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\n\ntype InsertTableModalPositiveResult = { cols: number; rows: number };\nexport type InsertTableModalResult = InsertTableModalPositiveResult | false | undefined;\n\ntype InsertTableModalProps = {\n  onClose: (result: InsertTableModalResult) => void;\n};\n\nexport const InsertTableModal = ({ onClose }: InsertTableModalProps) => {\n  const mainInputRef = useRef<HTMLInputElement>(null);\n  const [rows, setRows] = useState(2);\n  const [cols, setColumns] = useState(1);\n  const rowsAreValid = inRange(rows, 2, 100);\n  const colsAreValid = inRange(cols, 1, 100);\n\n  useEffect(() => {\n    if (mainInputRef.current?.focus) {\n      mainInputRef.current.focus();\n    }\n  }, [mainInputRef]);\n\n  return (\n    <>\n      <ModalContent testId=\"insert-table-modal\">\n        <Form>\n          <FormControl id=\"insert-table-rows-number-field\" isRequired isInvalid={!rowsAreValid}>\n            <FormControl.Label>Number of rows</FormControl.Label>\n            <TextInput\n              name=\"rows\"\n              value={rows.toString()}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => setRows(Number(e.target.value))}\n              testId=\"insert-table-rows-number-field\"\n              min={2}\n              max={100}\n              pattern=\"[1-9][0-9]*\"\n              type=\"number\"\n              width=\"small\"\n              autoComplete=\"off\"\n              ref={mainInputRef}\n            />\n            {!rowsAreValid && (\n              <FormControl.ValidationMessage>\n                Should be between 2 and 100\n              </FormControl.ValidationMessage>\n            )}\n          </FormControl>\n\n          <FormControl id=\"insert-table-columns-number-field\" isRequired isInvalid={!colsAreValid}>\n            <FormControl.Label>Number of columns</FormControl.Label>\n            <TextInput\n              name=\"columns\"\n              value={cols.toString()}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                setColumns(Number(e.target.value))\n              }\n              testId=\"insert-table-columns-number-field\"\n              min={1}\n              max={100}\n              pattern=\"[1-9][0-9]*\"\n              type=\"number\"\n              width=\"small\"\n              autoComplete=\"off\"\n            />\n            {!colsAreValid && (\n              <FormControl.ValidationMessage>\n                Should be between 1 and 100\n              </FormControl.ValidationMessage>\n            )}\n          </FormControl>\n        </Form>\n      </ModalContent>\n      <ModalControls>\n        <Button\n          testId=\"insert-table-cancel\"\n          onClick={() => onClose(false)}\n          variant=\"secondary\"\n          size=\"small\">\n          Cancel\n        </Button>\n        <Button\n          testId=\"insert-table-confirm\"\n          onClick={() => onClose({ rows, cols })}\n          variant=\"positive\"\n          size=\"small\"\n          isDisabled={!rowsAreValid || !colsAreValid}>\n          Insert\n        </Button>\n      </ModalControls>\n    </>\n  );\n};\n\nexport const openInsertTableDialog = (dialogs: DialogsAPI): Promise<InsertTableModalResult> => {\n  return dialogs.openCurrent({\n    title: 'Insert table',\n    width: 'medium',\n    minHeight: '260px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.insertTable,\n    } as MarkdownDialogsParams,\n  });\n};\n","import React, { useState, useRef, useEffect } from 'react';\nimport { css } from 'emotion';\nimport tokens from '@contentful/f36-tokens';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\nimport {\n  ModalContent,\n  ModalControls,\n  Text,\n  TextLink,\n  Button,\n  Checkbox,\n  Radio,\n  Form,\n  FormControl,\n  TextInput,\n} from '@contentful/f36-components';\nimport { isValidUrl } from '../utils/isValidUrl';\n\nconst styles = {\n  widthFiledGroup: css({\n    display: 'flex',\n    flexWrap: 'nowrap',\n    alignItems: 'flex-start',\n  }),\n  radioButtonGroup: css({\n    display: 'inline-flex',\n    alignItems: 'flex-start',\n    paddingTop: tokens.spacingXl,\n  }),\n  radioButton: css({\n    marginLeft: tokens.spacingM,\n  }),\n};\n\nexport type EmbedExternalContentModalResult = string | false | undefined;\n\ntype EmbedExternalContentModalProps = {\n  onClose: (result: EmbedExternalContentModalResult) => void;\n};\n\ntype Unit = 'percent' | 'px';\n\nconst makeEmbedlyLink = ({\n  url,\n  width,\n  selectedUnit,\n  attachSocial,\n}: {\n  url: string;\n  width: number;\n  selectedUnit: Unit;\n  attachSocial: boolean;\n}): string => {\n  const s = { percent: '%', px: 'px' };\n  return [\n    '<a href=\"' + url + '\" class=\"embedly-card\" ',\n    'data-card-width=\"' + width + s[selectedUnit] + '\" ',\n    'data-card-controls=\"' + (attachSocial ? '1' : '0') + '\"',\n    '>Embedded content: ' + url + '</a>',\n  ].join('');\n};\n\nconst isWidthValid = (width: number, unit: Unit) => (unit === 'percent' ? width <= 100 : true);\n\nexport const EmbedExternalContentModal = ({ onClose }: EmbedExternalContentModalProps) => {\n  const mainInputRef = useRef<HTMLInputElement>(null);\n  const [url, setUrl] = useState<string>('https://');\n  const [selectedUnit, setUnit] = useState<Unit>('percent');\n  const [urlIsValid, setUrlValidity] = useState<boolean>(true);\n  const [width, setWidth] = useState('100');\n  const [attachSocial, setAttachSocial] = useState(false);\n\n  useEffect(() => {\n    if (mainInputRef.current?.focus) {\n      mainInputRef.current.focus();\n    }\n  }, [mainInputRef]);\n\n  return (\n    <>\n      <ModalContent testId=\"embed-external-dialog\">\n        <Form>\n          <FormControl id=\"external-link-url-field\" isRequired isInvalid={!urlIsValid}>\n            <FormControl.Label>Content URL</FormControl.Label>\n            <TextInput\n              name=\"external-link-url\"\n              value={url}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                const value = e.target.value;\n                setUrl(value);\n                setUrlValidity(isValidUrl(value));\n              }}\n              testId=\"external-link-url-field\"\n              placeholder=\"https://example.com\"\n              ref={mainInputRef}\n            />\n            <FormControl.HelpText>Include protocol (e.g. https://)</FormControl.HelpText>\n            {!urlIsValid && (\n              <FormControl.ValidationMessage>URL is invalid</FormControl.ValidationMessage>\n            )}\n          </FormControl>\n          <TextLink href=\"http://embed.ly/providers\" target=\"_blank\" rel=\"noopener noreferrer\">\n            Supported sources\n          </TextLink>\n          <div className={styles.widthFiledGroup}>\n            <FormControl\n              id=\"embedded-content-width\"\n              isRequired\n              isInvalid={!isWidthValid(Number(width), selectedUnit)}>\n              <FormControl.Label>Width</FormControl.Label>\n              <TextInput\n                value={width}\n                name=\"embedded-content-width\"\n                testId=\"embedded-content-width\"\n                type=\"number\"\n                width=\"small\"\n                onChange={(e: React.ChangeEvent<HTMLInputElement>) => setWidth(e.target.value)}\n              />\n              {!isWidthValid(Number(width), selectedUnit) && (\n                <FormControl.ValidationMessage>\n                  Should be equal or less then 100\n                </FormControl.ValidationMessage>\n              )}\n            </FormControl>\n\n            <div className={styles.radioButtonGroup}>\n              <Radio\n                id=\"unit-option-percent\"\n                value=\"percent\"\n                isChecked={selectedUnit === 'percent'}\n                onChange={() => setUnit('percent')}\n                className={styles.radioButton}>\n                percent\n              </Radio>\n              <Radio\n                id=\"unit-option-pixels\"\n                value=\"pixels\"\n                isChecked={selectedUnit === 'px'}\n                onChange={() => setUnit('px')}\n                className={styles.radioButton}>\n                pixels\n              </Radio>\n            </div>\n          </div>\n          <Checkbox\n            id=\"attach-social-checkbox\"\n            name=\"attach-social-checkbox\"\n            value=\"Yes\"\n            isChecked={attachSocial}\n            onChange={() => setAttachSocial(!attachSocial)}\n            testId=\"attach-social-checkbox\">\n            Attach social sharing links to this element\n          </Checkbox>\n          <Text as=\"p\" fontColor=\"gray500\" marginTop=\"spacingXs\">\n            To enable this embedded content in your application make sure to add the&nbsp;\n            <TextLink\n              href=\"http://embed.ly/docs/products/cards\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\">\n              Embedly&apos;s platform.js\n            </TextLink>\n            &nbsp;on your development environment\n          </Text>\n          {/* <EmbedlyPreview previewUrl={url} /> */}\n        </Form>\n      </ModalContent>\n      <ModalControls>\n        <Button\n          testId=\"emded-external-cancel\"\n          onClick={() => onClose(false)}\n          variant=\"secondary\"\n          size=\"small\">\n          Cancel\n        </Button>\n        <Button\n          testId=\"embed-external-confirm\"\n          onClick={() =>\n            onClose(makeEmbedlyLink({ url, width: Number(width), selectedUnit, attachSocial }))\n          }\n          variant=\"positive\"\n          size=\"small\">\n          Insert\n        </Button>\n      </ModalControls>\n    </>\n  );\n};\n\nexport const openEmbedExternalContentDialog = (\n  dialogs: DialogsAPI\n): Promise<EmbedExternalContentModalResult> => {\n  return dialogs.openCurrent({\n    title: 'Embed external content',\n    width: 'large',\n    minHeight: '435px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.embedExternalContent,\n    } as MarkdownDialogsParams,\n  });\n};\n","import React from 'react';\nimport {\n  ModalContent,\n  ModalControls,\n  Paragraph,\n  Button,\n  EntityList,\n} from '@contentful/f36-components';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\n\ninterface ConfirmInsertAssetModalDialogProps {\n  onClose: (result: boolean) => void;\n  assets: Array<{\n    title: string;\n    description: string;\n    thumbnailUrl: string;\n    thumbnailAltText: string;\n  }>;\n  locale: string;\n}\n\nexport const ConfirmInsertAssetModalDialog = ({\n  onClose,\n  assets,\n  locale,\n}: ConfirmInsertAssetModalDialogProps) => {\n  const localesNumber = assets.length;\n\n  return (\n    <>\n      <ModalContent testId=\"confirm-insert-asset\">\n        <Paragraph>\n          {localesNumber === 1\n            ? `Link asset with missing file for locale ${locale}`\n            : `Link assets with missing files for locale ${locale}`}\n        </Paragraph>\n        <Paragraph>\n          {localesNumber === 1\n            ? 'Do you want to link to the file in its fallback locale?'\n            : 'Do you want to link to the files in their fallback locales?'}\n        </Paragraph>\n        <EntityList>\n          {assets.map(({ title, description, thumbnailUrl, thumbnailAltText }) => (\n            <EntityList.Item\n              key={thumbnailUrl}\n              title={title}\n              thumbnailUrl={`${thumbnailUrl}?w=46&h=46&fit=thumb`}\n              thumbnailAltText={thumbnailAltText}\n              description={description}\n            />\n          ))}\n        </EntityList>\n      </ModalContent>\n      <ModalControls>\n        <Button onClick={() => onClose(false)} variant=\"secondary\" size=\"small\">\n          Cancel\n        </Button>\n        <Button\n          testId=\"confirm-insert-asset\"\n          onClick={() => onClose(true)}\n          variant=\"positive\"\n          size=\"small\">\n          Confirm\n        </Button>\n      </ModalControls>\n    </>\n  );\n};\n\nexport const openConfirmInsertAsset = (\n  dialogs: DialogsAPI,\n  options: {\n    locale: string;\n    assets: Array<{\n      title: string;\n      description: string;\n      thumbnailUrl: string;\n      thumbnailAltText: string;\n    }>;\n  }\n): Promise<boolean> => {\n  return dialogs.openCurrent({\n    title: 'Confirm using fallback assets',\n    width: 'medium',\n    minHeight: '270px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.confirmInsertAsset,\n      ...options,\n    } as MarkdownDialogsParams,\n  });\n};\n","import React from 'react';\nimport { css, cx } from 'emotion';\nimport { DialogsAPI, DialogExtensionSDK } from '@contentful/app-sdk';\nimport { MarkdownDialogType, MarkdownDialogsParams, PreviewComponents } from '../types';\nimport { InitializedEditorType } from '../components/MarkdownTextarea/MarkdownTextarea';\nimport { MarkdownToolbar } from '../components/MarkdownToolbar';\nimport { MarkdownTextarea } from '../components/MarkdownTextarea/MarkdownTextarea';\nimport { MarkdownPreview } from '../components/MarkdownPreview';\nimport { MarkdownBottomBar, MarkdownHelp } from '../components/MarkdownBottomBar';\nimport { createMarkdownActions } from '../MarkdownActions';\nimport { openCheatsheetModal } from '../dialogs/CheatsheetModalDialog';\nimport tokens from '@contentful/f36-tokens';\n\nimport { ChevronRightIcon, ChevronLeftIcon } from '@contentful/f36-icons';\n\nexport type ZenModeResult = {\n  value: string;\n  cursor?: {\n    ch: number;\n    line: number;\n  };\n};\n\ntype ZenModeDialogProps = {\n  saveValueToSDK: (value: string | null | undefined) => void;\n  onClose: (result: ZenModeResult) => void;\n  initialValue: string;\n  locale: string;\n  sdk: DialogExtensionSDK;\n  previewComponents?: PreviewComponents;\n};\n\nconst styles = {\n  root: css({\n    position: 'fixed',\n    left: 0,\n    right: 0,\n    top: 0,\n    bottom: 0,\n  }),\n  topSplit: css({\n    position: 'fixed',\n    top: 0,\n    height: '48px',\n    left: 0,\n    right: 0,\n  }),\n  bottomSplit: css({\n    position: 'fixed',\n    bottom: 0,\n    left: 0,\n    right: 0,\n    height: '36px',\n  }),\n  editorSplit: css({\n    width: '50%',\n    position: 'fixed',\n    top: '48px',\n    left: 0,\n    bottom: '36px',\n    overflowX: 'hidden',\n    overflowY: 'scroll',\n  }),\n  editorSplitFullscreen: css({\n    left: 0,\n    right: 0,\n    width: '100%',\n  }),\n  previewSplit: css({\n    width: '50%',\n    position: 'fixed',\n    top: '48px',\n    right: 0,\n    bottom: '36px',\n    overflowX: 'hidden',\n    overflowY: 'scroll',\n  }),\n  separator: css({\n    position: 'fixed',\n    top: '48px',\n    bottom: '36px',\n    width: '1px',\n    background: tokens.gray400,\n    left: '50%',\n  }),\n  button: css({\n    position: 'fixed',\n    cursor: 'pointer',\n    zIndex: 105,\n    top: '49%',\n    height: '30px',\n    backgroundColor: tokens.gray100,\n    border: `1px solid ${tokens.gray400}`,\n    padding: 0,\n  }),\n  hideButton: css({\n    left: '50%',\n  }),\n  showButton: css({\n    right: 0,\n    borderRightWidth: 0,\n  }),\n  icon: css({\n    verticalAlign: 'middle',\n  }),\n};\n\nexport const ZenModeModalDialog = (props: ZenModeDialogProps) => {\n  const [currentValue, setCurrentValue] = React.useState<string>(props.initialValue ?? '');\n  const [showPreview, setShowPreview] = React.useState<boolean>(true);\n  const [editor, setEditor] = React.useState<InitializedEditorType | null>(null);\n\n  React.useEffect(() => {\n    // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n    props.sdk?.window?.updateHeight('100%' as any);\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, []);\n\n  // refresh editor right after dialog is opened to avoid disappearing effect\n  React.useEffect(() => {\n    setTimeout(() => {\n      editor?.setFullsize();\n      editor?.refresh();\n    }, 150);\n  }, [editor]);\n\n  const actions = React.useMemo(() => {\n    return createMarkdownActions({ sdk: props.sdk, editor, locale: props.locale });\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, [editor]);\n\n  actions.closeZenMode = () => {\n    props.onClose({\n      value: currentValue,\n      cursor: editor?.getCursor(),\n    });\n  };\n\n  const direction = props.sdk.locales.direction[props.locale] ?? 'ltr';\n\n  return (\n    <div className={styles.root} data-test-id=\"zen-mode-markdown-editor\">\n      <div className={styles.topSplit}>\n        <MarkdownToolbar mode=\"zen\" disabled={false} canUploadAssets={false} actions={actions} />\n      </div>\n\n      <div\n        className={cx(styles.editorSplit, {\n          [styles.editorSplitFullscreen]: showPreview === false,\n        })}>\n        <MarkdownTextarea\n          mode=\"zen\"\n          visible\n          disabled={false}\n          direction={direction}\n          onReady={(editor) => {\n            editor.setContent(props.initialValue ?? '');\n            editor.setReadOnly(false);\n            setEditor(editor);\n            editor.focus();\n            editor.events.onChange((value: string) => {\n              setCurrentValue(value);\n              props.saveValueToSDK(value);\n            });\n          }}\n        />\n      </div>\n      {showPreview && (\n        <div className={styles.previewSplit}>\n          <MarkdownPreview\n            direction={direction}\n            mode=\"zen\"\n            value={currentValue}\n            previewComponents={props.previewComponents}\n          />\n        </div>\n      )}\n      {showPreview && <div className={styles.separator} />}\n      {showPreview && (\n        <button\n          className={cx(styles.button, styles.hideButton)}\n          aria-label=\"Hide preview\"\n          onClick={() => {\n            setShowPreview(false);\n          }}>\n          <ChevronRightIcon variant=\"muted\" size=\"tiny\" className={styles.icon} />\n        </button>\n      )}\n      {!showPreview && (\n        <button\n          className={cx(styles.button, styles.showButton)}\n          aria-label=\"Show preview\"\n          onClick={() => {\n            setShowPreview(true);\n          }}>\n          <ChevronLeftIcon variant=\"muted\" size=\"tiny\" className={styles.icon} />\n        </button>\n      )}\n      <div className={styles.bottomSplit}>\n        <MarkdownBottomBar>\n          <MarkdownHelp\n            onClick={() => {\n              openCheatsheetModal(props.sdk.dialogs);\n            }}\n          />\n        </MarkdownBottomBar>\n      </div>\n    </div>\n  );\n};\n\nexport const openZenMode = (\n  dialogs: DialogsAPI,\n  options: { initialValue: string; locale: string }\n): Promise<ZenModeResult> => {\n  return dialogs.openCurrent({\n    width: 'zen' as any, // eslint-disable-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n    shouldCloseOnEscapePress: false,\n    minHeight: '100vh',\n    shouldCloseOnOverlayClick: false,\n    parameters: {\n      type: MarkdownDialogType.zenMode,\n      initialValue: options.initialValue,\n      locale: options.locale,\n    } as MarkdownDialogsParams,\n  });\n};\n","import get from 'lodash/get';\nimport isObject from 'lodash/isObject';\n\n// eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\ntype Asset = any;\n\ntype LinkWithMedia = {\n  title: string;\n  asset: Asset;\n  url: string;\n  isLocalized: boolean;\n  isFallback: boolean;\n  asMarkdown: string;\n};\n\ntype Locales = {\n  localeCode: string;\n  fallbackCode: string | undefined;\n  defaultLocaleCode: string;\n};\n\nfunction normalizeWhiteSpace(str: string) {\n  if (str) {\n    return str.trim().replace(/\\s{2,}/g, ' ');\n  } else {\n    return str;\n  }\n}\n\nfunction removeExtension(str: string) {\n  return str.replace(/\\.\\w+$/g, '');\n}\n\nfunction fileNameToTitle(str: string) {\n  return normalizeWhiteSpace(removeExtension(str).replace(/_/g, ' '));\n}\n\nexport function replaceAssetDomain(fileUrl: string) {\n  const assetDomainMap: Record<string, string> = {\n    images: 'images.ctfassets.net',\n    assets: 'assets.ctfassets.net',\n    downloads: 'downloads.ctfassets.net',\n    videos: 'videos.ctfassets.net',\n  };\n\n  return fileUrl.replace(/(images|assets|downloads|videos).contentful.com/, (_, p1) => {\n    return assetDomainMap[p1];\n  });\n}\n\nfunction makeAssetLink(\n  asset: Asset,\n  { localeCode, fallbackCode, defaultLocaleCode }: Locales\n): LinkWithMedia | null {\n  const localizedFile = get(asset, ['fields', 'file', localeCode]);\n  const fallbackFile = fallbackCode ? get(asset, ['fields', 'file', fallbackCode]) : null;\n  const defaultFile = get(asset, ['fields', 'file', defaultLocaleCode]);\n  const file:\n    | {\n        url: string;\n        fileName: string;\n      }\n    | undefined = localizedFile || fallbackFile || defaultFile;\n\n  if (isObject(file) && file.url) {\n    const title: string =\n      get(asset, ['fields', 'title', localeCode]) ||\n      get(asset, ['fields', 'title', fallbackCode || '']) ||\n      get(asset, ['fields', 'title', defaultLocaleCode]) ||\n      fileNameToTitle(file.fileName);\n\n    const fileUrl = replaceAssetDomain(file.url);\n\n    return {\n      title,\n      asset,\n      url: fileUrl,\n      // is normally localized and we should not warn about this file\n      isLocalized: Boolean(localizedFile),\n      // was fallback value used\n      // if it was not localized normally, and we did not used a fallback\n      // it means we used a default locale - we filter empty values\n      isFallback: Boolean(fallbackFile),\n      // todo: tranform using fromHostname\n      asMarkdown: `![${title}](${fileUrl})`,\n    };\n  } else {\n    return null;\n  }\n}\n\nexport async function insertAssetLinks(assets: Array<Asset>, locales: Locales) {\n  // check whether do we have some assets, which don't have\n  // a version in this field's locale\n  const otherLocales = assets.filter((asset) => {\n    return !get(asset, ['fields', 'file', locales.localeCode]);\n  });\n\n  const linksWithMeta = assets\n    .map((asset) => makeAssetLink(asset, locales))\n    // remove empty links\n    .filter((asset) => asset !== null) as LinkWithMedia[];\n\n  // if there have values from fallback/default locales, we need to\n  // provide user a warning so we show him modal\n  if (otherLocales.length > 0) {\n    const fallbackAssets = linksWithMeta\n      // we don't want to warn about normally localized files\n      .filter(({ isLocalized }) => !isLocalized)\n      .map(({ title, isFallback, asset }) => {\n        const code = isFallback ? locales.fallbackCode : locales.defaultLocaleCode;\n        return {\n          title,\n          thumbnailUrl: asset.fields.file[code as string].url,\n          thumbnailAltText: title,\n          description: isFallback ? `Fallback locale (${code})` : `Default locale (${code})`,\n          asset: asset,\n        };\n      });\n\n    return {\n      fallbacks: fallbackAssets,\n      links: linksWithMeta,\n    };\n  }\n  return {\n    links: linksWithMeta,\n  };\n}\n","/* eslint-disable @typescript-eslint/no-use-before-define, @typescript-eslint/no-explicit-any */\n\nimport extend from 'lodash/extend';\nimport isString from 'lodash/isString';\nimport isObject from 'lodash/isObject';\nimport max from 'lodash/max';\n// eslint-disable-next-line -- TODO: describe this disable\nimport isFinite from 'lodash/isFinite';\n// eslint-disable-next-line -- TODO: describe this disable\nimport forEach from 'lodash/forEach';\n\nfunction extractTitle(title: string) {\n  title = title || '';\n  title = title.replace(/^ *('|\"|\\()*/, '');\n  title = title.replace(/('|\"|\\))* *$/, '');\n  return title;\n}\n\nfunction head(text: string) {\n  return text.split(' ').shift();\n}\n\nfunction tail(text: string) {\n  const segments = text.split(' ');\n  segments.shift();\n  return segments.join(' ');\n}\n\nconst PROCESSORS = {\n  inline: function (match: any) {\n    return {\n      match: match[0],\n      text: match[1],\n      href: head(match[2]),\n      title: extractTitle(tail(match[2])),\n    };\n  },\n  ref: function (match: any) {\n    return {\n      match: match[0],\n      text: match[1],\n      id: match[2],\n    };\n  },\n  label: function (match: any) {\n    return {\n      match: match[0],\n      id: match[1],\n      href: head(match[2]),\n      title: extractTitle(tail(match[2])),\n    };\n  },\n};\n\nconst REGEXS = {\n  inline: /\\[([^\\r\\n[\\]]+)]\\(([^\\r\\n)]+)\\)/,\n  ref: /\\[([^\\r\\n[\\]]+)] ?\\[([^\\r\\n[\\]]+)]/,\n  label: /^ {0,3}\\[([^\\r\\n[\\]]+)]:\\s+(.+)$/,\n};\nexport const findInline = makeFinder('inline');\nexport const findRefs = makeFinder('ref');\nexport const findLabels = makeFinder('label');\n\nexport function convertInlineToRef(text: string) {\n  let id = findMaxLabelId(text);\n\n  forEach(findInline(text), (inline) => {\n    id += 1;\n    text = text.replace(inline.match, buildRef(inline, id));\n    text += '\\n' + buildLabel(inline, id);\n  });\n\n  return text;\n}\n\nfunction mergeLabels(text: string): any {\n  const byHref: any = {};\n  const byOldId: any = {};\n\n  forEach(findLabels(text), (label) => {\n    const alreadyAdded = byHref[label.href];\n    const current = extend({}, label);\n\n    if (!alreadyAdded) {\n      byHref[current.href] = current;\n    } else if (hasTitle(current) && !hasTitle(alreadyAdded)) {\n      alreadyAdded.title = current.title;\n    }\n\n    byOldId[current.id] = alreadyAdded || current;\n  });\n\n  return {\n    byHref: byHref,\n    byOldId: byOldId,\n  };\n}\n\nexport function rewriteRefs(text: string) {\n  const merged = mergeLabels(text);\n  const hrefToRefId: any = {};\n  const labels: any[] = [];\n  const rewrites: any[] = [];\n  let i = 1;\n\n  // 1. compose list of labels with new ids, in order\n  forEach(findRefs(text), (ref) => {\n    const oldLabel = merged.byOldId[ref.id];\n    if (!oldLabel) {\n      return;\n    }\n    const href = oldLabel.href;\n    let newRefId = hrefToRefId[href];\n\n    if (!newRefId) {\n      hrefToRefId[href] = newRefId = i;\n      i += 1;\n      labels.push(extend({ newId: newRefId }, oldLabel));\n    }\n\n    // 1b. prepare rewrites to be applied, with new label ids\n    rewrites.push(extend({ newId: newRefId }, ref));\n  });\n\n  // 2. remove all labels!\n  forEach(findLabels(text), (label) => {\n    text = text.replace(label.match, '');\n  });\n\n  // 3. remove whitespace from the end of text\n  text = text.replace(/[\\r\\n\\s]*$/, '');\n  text += '\\n\\n';\n\n  // 4. apply rewrites\n  forEach(rewrites, (ref) => {\n    text = text.replace(ref.match, buildRef(ref, ref.newId));\n  });\n\n  // 5. print new labels at the end of text\n  forEach(labels, (label) => {\n    text += '\\n' + buildLabel(label, label.newId);\n  });\n\n  return text;\n}\n\n/**\n * Finding stuff\n */\n\nfunction makeFinder(type: 'inline' | 'ref' | 'label'): (text: string) => Array<any> {\n  return (text: string) => findAll(text, type).map(PROCESSORS[type] as any);\n}\n\nexport function findMaxLabelId(textOrLabels: any): number {\n  if (isString(textOrLabels)) {\n    textOrLabels = findLabels(textOrLabels);\n  }\n\n  const ids = textOrLabels\n    .map((x: any) => x.id)\n    .map((x: any) => parseInt(x, 10))\n    .filter((x: any) => isFinite(x) && x > 0);\n\n  return ids.length > 0 ? max(ids) || 0 : 0;\n}\n\nfunction findAll(text: string, type: 'inline' | 'ref' | 'label') {\n  const flags = 'g' + (type === 'label' ? 'm' : '');\n  const matches = [];\n  const re = new RegExp(REGEXS[type].source, flags);\n  let found = re.exec(text);\n\n  while (found) {\n    matches.push(found);\n    re.lastIndex = found.index + found[0].length;\n    found = re.exec(text);\n  }\n\n  return matches;\n}\n\n/**\n * Other utilities\n */\n\nfunction hasTitle(link: { title: string }) {\n  return isObject(link) && isString(link.title) && link.title.length > 0;\n}\n\nfunction buildLabel(link: { href: string; title: string }, id: number) {\n  let markup = '[' + id + ']: ' + link.href;\n  if (hasTitle(link)) {\n    markup += ' \"' + link.title + '\"';\n  }\n  return markup;\n}\n\nfunction buildRef(link: { text: string }, id: number) {\n  return '[' + link.text + '][' + id + ']';\n}\n","import { InitializedEditorType } from './components/MarkdownTextarea/MarkdownTextarea';\nimport { KnownSDK } from '@contentful/app-sdk';\nimport { openInsertLinkDialog } from './dialogs/InsertLinkModalDialog';\nimport { openInsertSpecialCharacter } from './dialogs/SpecialCharacterModalDialog';\nimport { openInsertTableDialog } from './dialogs/InsertTableModalDialog';\nimport { openEmbedExternalContentDialog } from './dialogs/EmdebExternalContentDialog';\nimport { openConfirmInsertAsset } from './dialogs/ConfirmInsertAssetModalDialog';\nimport { openZenMode } from './dialogs/ZenModeModalDialog';\nimport { insertAssetLinks } from './utils/insertAssetLinks';\nimport * as LinkOrganizer from './utils/linkOrganizer';\n\nexport function createMarkdownActions(props: {\n  sdk: KnownSDK;\n  editor: InitializedEditorType | null;\n  locale: string;\n}) {\n  const { sdk, editor, locale } = props;\n\n  // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/ban-types\n  const insertAssetsWithConfirmation = async (assets: Array<Object> | null) => {\n    if (assets) {\n      const { links, fallbacks } = await insertAssetLinks(assets, {\n        localeCode: locale,\n        defaultLocaleCode: sdk.locales.default,\n        fallbackCode: sdk.locales.fallbacks[locale],\n      });\n      if (links && links.length > 0) {\n        if (fallbacks) {\n          const insertAnyway = await openConfirmInsertAsset(sdk.dialogs, {\n            locale: locale,\n            assets: fallbacks,\n          });\n          if (!insertAnyway) {\n            throw Error('User decided to not use fallbacks');\n          }\n        }\n        return links.map((link) => link.asMarkdown).join('\\n\\n');\n      }\n    }\n    return '';\n  };\n\n  return {\n    headings: {\n      h1: () => {\n        editor?.actions.h1();\n      },\n      h2: () => {\n        editor?.actions.h2();\n      },\n      h3: () => {\n        editor?.actions.h3();\n      },\n    },\n    simple: {\n      italic: () => {\n        editor?.actions.italic();\n      },\n      bold: () => {\n        editor?.actions.bold();\n      },\n      quote: () => {\n        editor?.actions.quote();\n      },\n      ol: () => {\n        editor?.actions.ol();\n      },\n      ul: () => {\n        editor?.actions.ul();\n      },\n      strike: () => {\n        editor?.actions.strike();\n      },\n      code: () => {\n        editor?.actions.code();\n      },\n      hr: () => {\n        editor?.actions.hr();\n      },\n      indent: () => {\n        editor?.actions.indent();\n      },\n      dedent: () => {\n        editor?.actions.dedent();\n      },\n    },\n    history: {\n      undo: () => {\n        editor?.actions.undo();\n      },\n      redo: () => {\n        editor?.actions.redo();\n      },\n    },\n    insertLink: async () => {\n      if (!editor) {\n        return;\n      }\n      editor.usePrimarySelection();\n      const selectedText = editor.getSelectedText();\n      const result = await openInsertLinkDialog(sdk.dialogs, { selectedText });\n      if (result) {\n        editor.actions.link(result.url, selectedText || result.text, result.title);\n      }\n    },\n    insertSpecialCharacter: async () => {\n      if (!editor) {\n        return;\n      }\n      const result = await openInsertSpecialCharacter(sdk.dialogs);\n      if (result) {\n        editor.insert(result);\n      }\n    },\n    insertTable: async () => {\n      if (!editor) {\n        return;\n      }\n      const result = await openInsertTableDialog(sdk.dialogs);\n      if (result) {\n        editor.actions.table(result);\n      }\n    },\n    organizeLinks: () => {\n      if (!editor) {\n        return;\n      }\n      let text = editor.getContent();\n      if (!text) {\n        return;\n      }\n      text = LinkOrganizer.convertInlineToRef(text);\n      text = LinkOrganizer.rewriteRefs(text);\n      editor.setContent(text);\n      sdk.notifier.success('All your links are now references at the bottom of your document.');\n    },\n    embedExternalContent: async () => {\n      if (!editor) {\n        return;\n      }\n      const result = await openEmbedExternalContentDialog(sdk.dialogs);\n      if (result) {\n        editor.insert(result);\n      }\n    },\n    addNewMedia: async () => {\n      if (!editor) {\n        return;\n      }\n      try {\n        const { entity: asset } = (await sdk.navigator.openNewAsset({\n          slideIn: { waitForClose: true },\n        })) as any; // eslint-disable-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n\n        const markdownLinks = await insertAssetsWithConfirmation([asset]);\n        editor.insert(markdownLinks);\n      } finally {\n        editor.focus();\n      }\n    },\n    linkExistingMedia: async () => {\n      if (!editor) {\n        return;\n      }\n      try {\n        const assets = await sdk.dialogs.selectMultipleAssets({\n          locale: locale,\n        });\n        const markdownLinks = await insertAssetsWithConfirmation(assets);\n        editor.insert(markdownLinks);\n      } finally {\n        editor.focus();\n      }\n    },\n    openZenMode: async () => {\n      if (!editor) {\n        return;\n      }\n      const result = await openZenMode(sdk.dialogs, {\n        initialValue: editor.getContent(),\n        locale: props.locale,\n      });\n\n      editor.setContent(result.value);\n\n      if (result.cursor) {\n        editor.setCursor(result.cursor);\n      }\n\n      editor.focus();\n    },\n    closeZenMode: () => {\n      // do nothing\n      // this method is overwritten in dialog app\n    },\n  };\n}\n","import React from 'react';\nimport { css } from 'emotion';\nimport tokens from '@contentful/f36-tokens';\nimport { FieldConnector } from '@contentful/field-editor-shared';\nimport { FieldExtensionSDK } from '@contentful/app-sdk';\nimport { MarkdownTabs } from './components/MarkdownTabs';\nimport { MarkdownToolbar } from './components/MarkdownToolbar';\nimport { MarkdownTextarea } from './components/MarkdownTextarea/MarkdownTextarea';\nimport { InitializedEditorType } from './components/MarkdownTextarea/MarkdownTextarea';\nimport { MarkdownBottomBar, MarkdownHelp } from './components/MarkdownBottomBar';\nimport { MarkdownTab, PreviewComponents } from './types';\nimport { openCheatsheetModal } from './dialogs/CheatsheetModalDialog';\nimport { MarkdownPreview } from './components/MarkdownPreview';\nimport { MarkdownConstraints } from './components/MarkdownConstraints';\nimport { createMarkdownActions } from './MarkdownActions';\n\nconst styles = {\n  container: css({\n    display: 'flex',\n    flexDirection: 'column',\n    fontFamily: tokens.fontStackPrimary,\n  }),\n};\n\nexport interface MarkdownEditorProps {\n  /**\n   * is the field disabled initially\n   */\n  isInitiallyDisabled: boolean;\n  /**\n   * Minimum height to set for the markdown text area and preview\n   */\n  minHeight?: string | number;\n\n  sdk: FieldExtensionSDK;\n\n  previewComponents?: PreviewComponents;\n  onReady?: Function;\n}\n\nexport function MarkdownEditor(\n  props: MarkdownEditorProps & {\n    disabled: boolean;\n    initialValue: string | null | undefined;\n    saveValueToSDK: Function;\n  }\n) {\n  const [currentValue, setCurrentValue] = React.useState<string>(props.initialValue ?? '');\n  const [selectedTab, setSelectedTab] = React.useState<MarkdownTab>('editor');\n  const [editor, setEditor] = React.useState<InitializedEditorType | null>(null);\n  const [canUploadAssets, setCanUploadAssets] = React.useState<boolean>(false);\n\n  React.useEffect(() => {\n    if (editor && props.onReady) {\n      props.onReady(editor);\n      // fix: http://codemirror.977696.n3.nabble.com/codemirror-content-not-visible-in-bootstrap-modal-td4026988.html\n      setTimeout(() => {\n        editor.refresh();\n      }, 1);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, [editor]);\n\n  React.useEffect(() => {\n    props.sdk.access.can('create', 'Asset').then((value) => {\n      setCanUploadAssets(value);\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, []);\n\n  React.useEffect(() => {\n    if (editor) {\n      editor.setReadOnly(props.disabled);\n    }\n  }, [editor, props.disabled]);\n\n  const isActionDisabled = editor === null || props.disabled || selectedTab !== 'editor';\n\n  const direction = props.sdk.locales.direction[props.sdk.field.locale] ?? 'ltr';\n\n  const actions = React.useMemo(() => {\n    return createMarkdownActions({ sdk: props.sdk, editor, locale: props.sdk.field.locale });\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, [editor]);\n\n  const openMarkdownHelp = React.useCallback(() => {\n    openCheatsheetModal(props.sdk.dialogs);\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, []);\n\n  return (\n    <div className={styles.container} data-test-id=\"markdown-editor\">\n      <MarkdownTabs\n        active={selectedTab}\n        onSelect={(tab) => {\n          setSelectedTab(tab);\n        }}\n      />\n      <MarkdownToolbar\n        mode=\"default\"\n        disabled={isActionDisabled}\n        canUploadAssets={canUploadAssets}\n        actions={actions}\n      />\n      <MarkdownTextarea\n        minHeight={props.minHeight}\n        mode=\"default\"\n        visible={selectedTab === 'editor'}\n        disabled={isActionDisabled}\n        direction={direction}\n        onReady={(editor) => {\n          editor.setContent(props.initialValue ?? '');\n          editor.setReadOnly(props.disabled);\n          setEditor(editor);\n          editor.events.onChange((value: string) => {\n            // Trim empty lines\n            const trimmedValue = value.replace(/^\\s+$/gm, '');\n            props.saveValueToSDK(trimmedValue);\n            setCurrentValue(value);\n          });\n        }}\n      />\n      {selectedTab === 'preview' && (\n        <MarkdownPreview\n          direction={direction}\n          minHeight={props.minHeight}\n          mode=\"default\"\n          value={currentValue}\n          previewComponents={props.previewComponents}\n        />\n      )}\n      <MarkdownBottomBar>\n        <MarkdownHelp onClick={openMarkdownHelp} />\n      </MarkdownBottomBar>\n      <MarkdownConstraints sdk={props.sdk} value={currentValue} />\n    </div>\n  );\n}\n\nexport function MarkdownEditorConnected(props: MarkdownEditorProps) {\n  return (\n    <FieldConnector<string>\n      throttle={300}\n      field={props.sdk.field}\n      isInitiallyDisabled={props.isInitiallyDisabled}>\n      {({ value, disabled, setValue, externalReset }) => {\n        // on external change reset component completely and init with initial value again\n        return (\n          <MarkdownEditor\n            {...props}\n            key={`markdown-editor-${externalReset}`}\n            initialValue={value}\n            disabled={disabled}\n            saveValueToSDK={setValue}\n          />\n        );\n      }}\n    </FieldConnector>\n  );\n}\n","import React from 'react';\nimport {\n  FieldExtensionSDK,\n  DialogExtensionSDK,\n  OpenCustomWidgetOptions,\n} from '@contentful/app-sdk';\nimport { ModalDialogLauncher } from '@contentful/field-editor-shared';\nimport { MarkdownDialogsParams, PreviewComponents } from '../types';\n\nimport { CheatsheetModalDialog } from './CheatsheetModalDialog';\nimport { SpecialCharacterModalDialog } from './SpecialCharacterModalDialog';\nimport { MarkdownDialogType } from '../types';\nimport { InsertLinkModal, InsertLinkModalResult } from './InsertLinkModalDialog';\nimport { InsertTableModal, InsertTableModalResult } from './InsertTableModalDialog';\nimport { ConfirmInsertAssetModalDialog } from './ConfirmInsertAssetModalDialog';\nimport {\n  EmbedExternalContentModal,\n  EmbedExternalContentModalResult,\n} from './EmdebExternalContentDialog';\nimport { ZenModeModalDialog, ZenModeResult } from './ZenModeModalDialog';\n\nexport const openMarkdownDialog =\n  (sdk: FieldExtensionSDK, previewComponents?: PreviewComponents) =>\n  (\n    options: OpenCustomWidgetOptions & {\n      parameters?: MarkdownDialogsParams;\n    }\n  ) => {\n    if (options.parameters?.type === MarkdownDialogType.cheatsheet) {\n      return ModalDialogLauncher.openDialog(options, () => {\n        return <CheatsheetModalDialog />;\n      });\n    } else if (options.parameters?.type === MarkdownDialogType.insertLink) {\n      const selectedText = options.parameters.selectedText;\n      return ModalDialogLauncher.openDialog<InsertLinkModalResult>(options, ({ onClose }) => {\n        return <InsertLinkModal selectedText={selectedText} onClose={onClose} />;\n      });\n    } else if (options.parameters?.type === MarkdownDialogType.insertSpecialCharacter) {\n      return ModalDialogLauncher.openDialog(options, ({ onClose }) => {\n        return <SpecialCharacterModalDialog onClose={onClose} />;\n      });\n    } else if (options.parameters?.type === MarkdownDialogType.insertTable) {\n      return ModalDialogLauncher.openDialog<InsertTableModalResult>(options, ({ onClose }) => {\n        return <InsertTableModal onClose={onClose} />;\n      });\n    } else if (options.parameters?.type === MarkdownDialogType.embedExternalContent) {\n      return ModalDialogLauncher.openDialog<EmbedExternalContentModalResult>(\n        options,\n        ({ onClose }) => {\n          return <EmbedExternalContentModal onClose={onClose} />;\n        }\n      );\n    } else if (options.parameters?.type === MarkdownDialogType.confirmInsertAsset) {\n      const locale = options.parameters.locale;\n      const assets = options.parameters.assets;\n      return ModalDialogLauncher.openDialog<boolean>(options, ({ onClose }) => {\n        return <ConfirmInsertAssetModalDialog onClose={onClose} locale={locale} assets={assets} />;\n      });\n    } else if (options.parameters?.type === MarkdownDialogType.zenMode) {\n      const initialValue = options.parameters.initialValue;\n      const locale = options.parameters.locale;\n      return ModalDialogLauncher.openDialog<ZenModeResult>(options, ({ onClose }) => {\n        return (\n          <ZenModeModalDialog\n            saveValueToSDK={(value) => {\n              if (value) {\n                return sdk?.field?.setValue(value);\n              }\n              return sdk?.field?.removeValue();\n            }}\n            onClose={onClose}\n            initialValue={initialValue}\n            locale={locale}\n            sdk={sdk as unknown as DialogExtensionSDK}\n            previewComponents={previewComponents}\n          />\n        );\n      });\n    }\n    return Promise.reject();\n  };\n","import React from 'react';\nimport { DialogExtensionSDK } from '@contentful/app-sdk';\nimport { MarkdownDialogsParams, MarkdownDialogType } from '../types';\nimport { SpecialCharacterModalDialog } from './SpecialCharacterModalDialog';\nimport { CheatsheetModalDialog } from './CheatsheetModalDialog';\nimport { InsertLinkModal } from './InsertLinkModalDialog';\nimport { InsertTableModal } from './InsertTableModalDialog';\nimport { EmbedExternalContentModal } from './EmdebExternalContentDialog';\nimport { ConfirmInsertAssetModalDialog } from './ConfirmInsertAssetModalDialog';\nimport { ZenModeModalDialog } from './ZenModeModalDialog';\n\nexport const renderMarkdownDialog = (\n  sdk: DialogExtensionSDK & { parameters: { invocation: MarkdownDialogsParams } }\n) => {\n  const parameters = sdk.parameters.invocation;\n  if (parameters.type === MarkdownDialogType.cheatsheet) {\n    sdk.window.startAutoResizer();\n    return <CheatsheetModalDialog />;\n  } else if (parameters.type === MarkdownDialogType.insertLink) {\n    const selectedText = parameters.selectedText;\n    sdk.window.startAutoResizer();\n    return <InsertLinkModal selectedText={selectedText} onClose={sdk.close} />;\n  } else if (parameters.type === MarkdownDialogType.insertSpecialCharacter) {\n    sdk.window.startAutoResizer();\n    return <SpecialCharacterModalDialog onClose={sdk.close} />;\n  } else if (parameters.type === MarkdownDialogType.insertTable) {\n    sdk.window.startAutoResizer();\n    return <InsertTableModal onClose={sdk.close} />;\n  } else if (parameters.type === MarkdownDialogType.embedExternalContent) {\n    sdk.window.startAutoResizer();\n    return <EmbedExternalContentModal onClose={sdk.close} />;\n  } else if (parameters.type === MarkdownDialogType.confirmInsertAsset) {\n    const locale = parameters.locale;\n    const assets = parameters.assets;\n    sdk.window.startAutoResizer();\n    return <ConfirmInsertAssetModalDialog onClose={sdk.close} locale={locale} assets={assets} />;\n  } else if (parameters.type === MarkdownDialogType.zenMode) {\n    const locale = parameters.locale;\n    const initialValue = parameters.initialValue;\n    // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n    sdk.window.updateHeight('100%' as any);\n    return (\n      <ZenModeModalDialog\n        onClose={sdk.close}\n        saveValueToSDK={() => {\n          // don't save changes in dialog mode\n        }}\n        initialValue={initialValue}\n        locale={locale}\n        sdk={sdk}\n      />\n    );\n  }\n\n  return <div />;\n};\n"],"names":["styles","root","css","display","zIndex","flexDirection","justifyContent","overflow","marginBottom","fontSize","tokens","fontSizeM","tab","cursor","color","gray700","padding","spacingXs","minWidth","border","gray400","borderTopLeftRadius","borderRadiusSmall","borderTopRightRadius","marginLeft","textAlign","backgroundColor","gray100","borderBottomColor","outline","boxShadow","boxShadowHeavy","transition","transitionEasingDefault","transitionDurationShort","inactiveTab","background","gray200","gray300","MarkdownTabItem","props","React","className","cx","isActive","onClick","onSelect","name","onKeyDown","e","keyCode","tabIndex","role","testId","children","MarkdownTabs","active","srOnly","position","width","height","margin","clip","Zen","label","rest","viewBox","d","Strikethrough","Indent","Dedent","Cubes","Table","SpecialChar","OrgLinks","Undo","Redo","HeadingSelector","handleMenuClick","heading","Menu","Trigger","List","Item","InsertLinkSelector","canAddNew","MultipleMediaContextMenu","Button","isDisabled","disabled","startIcon","AssetIcon","size","variant","onSelectExisting","placement","endIcon","ChevronDownIcon","onAddNew","Number","zIndexWorkbenchHeader","button","spacing2Xs","marginRight","icon","fill","verticalAlign","zenButton","zenButtonPressed","tooltip","zIndexTooltip","ToolbarButton","forwardRef","ref","tooltipPlace","otherProps","Tooltip","content","IconButton","displayName","MainButtons","mode","actions","headings","HeadingIcon","simple","bold","FormatBoldIcon","italic","FormatItalicIcon","quote","QuoteIcon","ul","ListBulletedIcon","ol","ListNumberedIcon","insertLink","LinkIcon","AdditionalButtons","strike","Icons","code","CodeIcon","hr","HorizontalRuleIcon","indent","dedent","embedExternalContent","insertTable","insertSpecialCharacter","organizeLinks","history","undo","redo","DefaultMarkdownToolbar","useState","showAdditional","setShowAdditional","Flex","MoreHorizontalIcon","linkExistingMedia","addNewMedia","canUploadAssets","openZenMode","marginTop","ZenMarkdownToolbar","closeZenMode","MarkdownToolbar","memo","userAgent","get","window","platform","ctrlKey","tests","ios","test","MSStream","getCtrlKey","stripUnit","value","cssRegex","matchedValue","match","Error","parseFloat","create","host","options","direction","fixedHeight","readOnly","initializedWithValue","LF","EDITOR_SIZE","min","max","shift","cm","CodeMirror","lineNumbers","undoDepth","matchBrackets","lineWrapping","lineSeparator","theme","tabSize","indentWithTabs","indentUnit","autoRefresh","spellcheck","inputStyle","setSize","on","throttle","assureHeight","setOption","Tab","replaceSelectedText","getIndentation","Enter","Esc","getInputField","blur","destroy","disable","enable","attachEvent","addKeyShortcuts","setValue","cmd","moveToLineBeginning","moveIfNotEmpty","restoreCursor","moveToLineEnd","usePrimarySelection","focus","select","selectBackwards","selectAll","execCommand","extendSelectionBy","insertAtCursor","insertAtLineBeginning","wrapSelection","removeFromLineBeginning","removeSelectedText","getCursor","setCursor","getSelection","getLine","isLineEmpty","getSelectedText","getSelectionLength","getCurrentLine","getCurrentLineNumber","getCurrentCharacter","getCurrentLineLength","lineStartsWith","getNl","getValue","getLinesCount","getHistorySize","setReadOnly","getHistory","setHistory","setFullsize","refresh","toTextArea","current","heightAtLine","lastLine","next","fn","throttleInterval","map","addKeyMap","transform","acc","key","line","ch","clearHistory","lineNumber","defaultToCurrentLineNumber","character","noFocus","scroll","undefined","from","to","setSelection","skip","len","getPos","modifier","prop","selection","text","replaceRange","initialCh","length","wrapper","replacement","anchor","head","charCount","replaceSelection","selections","listSelections","somethingSelected","n","lineCount","startsWith","repeat","getOption","which","historySize","what","Array","join","createPrefixToggleFn","prefix","editor","marker","emptyText","selectedText","endsWith","markerLength","textWithoutMarker","slice","HEADER_CHAR","quoteToggleFn","codeToggleFn","modifySelection","link","h1","toggleHeader","h2","h3","ulToggleFn","olToggleFn","table","nl","markup","indentation","config","tableTemplate","rows","cols","url","title","linkTitle","toggleFn","isList","forLineIn","listNumber","getListNumber","prepareListWhitespace","cb","lines","maxNumber","minNumber","lineRange","range","forEach","i","isCurrentLineEmpty","isPrevLineEmpty","isNextLineEmpty","linesToInsert","result","nrows","ncols","cellWidth","cell","separatorCell","baseRow","separatorRow","times","bodyRows","replace","headerRow","concat","level","currentHeader","selectHeader","removedCh","diff","header","createMarkdownEditor","CodeMirrorWrapper","wrapChange","api","Commands","hasUndo","hasRedo","events","onScroll","onChange","onPaste","insert","getContent","setContent","clear","B","I","lineHeightDefault","spacingL","fontStackMonospace","gray900","red600","gray600","blue500","framed","maxHeight","zen","maxWidth","MarkdownTextarea","hostRef","useRef","setEditor","useEffect","Object","assign","minHeight","onReady","style","visible","borderBottomLeftRadius","borderBottomRightRadius","spacingS","help","fontSizeS","lineHeight","MarkdownHelp","Paragraph","TextLink","as","MarkdownBottomBar","MarkdownDialogType","flexColumnContainer","flexWrap","flexColumn","flexGrow","verticalDivider","borderRight","gray500","paddingRight","spacing3Xl","spacing2Xl","preview","unOrderedListPreview","listStyleType","orderedListPreview","paddingLeft","fontSize2Xl","fontSizeXl","fontSizeL","helpItem","alignItems","spacingXl","helpLink","flexRowContainer","CheatsheetModalDialog","ModalContent","Heading","href","target","rel","openCheatsheetModal","dialogs","openCurrent","shouldCloseOnEscapePress","shouldCloseOnOverlayClick","parameters","type","cheatsheet","replaceMailtoAmp","string","fontStackPrimary","spacingM","overflowY","rtl","MarkdownLink","Embedly","MarkdownPreview","cleanHTML","useMemo","DOMPurify","sanitize","Markdown","overrides","a","component","previewComponents","embedly","MarkdownConstraints","constraints","ConstraintsUtils","fromFieldValidations","sdk","field","validations","checkConstraint","makeChecker","CharCounter","CharValidation","runtime","exports","Op","prototype","hasOwn","hasOwnProperty","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","obj","defineProperty","enumerable","configurable","writable","err","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","context","Context","_invoke","makeInvokeMethod","tryCatch","arg","call","GenStateSuspendedStart","GenStateSuspendedYield","GenStateExecuting","GenStateCompleted","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","method","isGeneratorFunction","genFun","ctor","constructor","mark","setPrototypeOf","__proto__","awrap","__await","AsyncIterator","PromiseImpl","invoke","resolve","reject","record","then","unwrapped","error","previousPromise","enqueue","callInvokeWithMethodAndArg","async","Promise","iter","done","state","doneResult","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","TypeError","info","resultName","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","keys","object","reverse","pop","iterable","iteratorMethod","isNaN","skipTempReset","prev","charAt","stop","rootEntry","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","module","regeneratorRuntime","accidentalStrictMode","globalThis","Function","urlRegex","isValidUrl","InsertLinkModal","onClose","mainInputRef","setText","setUrl","touched","setTouched","setTitle","onInsert","urlIsValid","Form","onSubmit","FormControl","id","Boolean","Label","TextInput","isInvalid","placeholder","maxLength","HelpText","ValidationMessage","ModalControls","openInsertLinkDialog","params","specialCharacters","desc","buttonPanel","charButton","selectedCharButton","SpecialCharacterModalDialog","selectedCharacter","setSelectedCharacter","Text","String","fromCharCode","char","openInsertSpecialCharacter","InsertTableModal","setRows","setColumns","rowsAreValid","inRange","colsAreValid","isRequired","toString","pattern","autoComplete","openInsertTableDialog","widthFiledGroup","radioButtonGroup","paddingTop","radioButton","makeEmbedlyLink","selectedUnit","attachSocial","s","percent","px","isWidthValid","unit","EmbedExternalContentModal","setUnit","setUrlValidity","setWidth","setAttachSocial","Radio","isChecked","Checkbox","fontColor","openEmbedExternalContentDialog","ConfirmInsertAssetModalDialog","assets","locale","localesNumber","EntityList","description","thumbnailUrl","thumbnailAltText","openConfirmInsertAsset","confirmInsertAsset","left","right","top","bottom","topSplit","bottomSplit","editorSplit","overflowX","editorSplitFullscreen","previewSplit","separator","hideButton","showButton","borderRightWidth","ZenModeModalDialog","initialValue","currentValue","setCurrentValue","showPreview","setShowPreview","updateHeight","setTimeout","createMarkdownActions","locales","saveValueToSDK","ChevronRightIcon","ChevronLeftIcon","zenMode","normalizeWhiteSpace","str","trim","removeExtension","fileNameToTitle","replaceAssetDomain","fileUrl","assetDomainMap","images","downloads","videos","_","p1","makeAssetLink","asset","localeCode","fallbackCode","defaultLocaleCode","localizedFile","fallbackFile","defaultFile","file","isObject","fileName","isLocalized","isFallback","asMarkdown","insertAssetLinks","otherLocales","filter","linksWithMeta","fallbackAssets","fields","fallbacks","links","extractTitle","split","tail","segments","PROCESSORS","inline","REGEXS","findInline","makeFinder","findRefs","findLabels","convertInlineToRef","findMaxLabelId","buildRef","buildLabel","mergeLabels","byHref","byOldId","alreadyAdded","extend","hasTitle","rewriteRefs","merged","hrefToRefId","labels","rewrites","oldLabel","newRefId","newId","findAll","textOrLabels","isString","ids","x","parseInt","isFinite","flags","matches","re","RegExp","source","found","exec","lastIndex","index","insertAssetsWithConfirmation","insertAnyway","LinkOrganizer","notifier","success","navigator","openNewAsset","slideIn","waitForClose","entity","markdownLinks","selectMultipleAssets","container","fontFamily","MarkdownEditor","selectedTab","setSelectedTab","setCanUploadAssets","access","can","isActionDisabled","openMarkdownHelp","useCallback","trimmedValue","MarkdownEditorConnected","FieldConnector","isInitiallyDisabled","externalReset","openMarkdownDialog","ModalDialogLauncher","openDialog","removeValue","renderMarkdownDialog","invocation","startAutoResizer","close"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAKA,IAAMA,MAAM,GAAG;AACbC,EAAAA,IAAI,eAAEC,WAAG,CAAC;AACRC,IAAAA,OAAO,EAAE,MADD;AAERC,IAAAA,MAAM,EAAE,EAFA;AAGRC,IAAAA,aAAa,EAAE,KAHP;AAIRC,IAAAA,cAAc,EAAE,UAJR;AAKRC,IAAAA,QAAQ,EAAE,QALF;AAMRC,IAAAA,YAAY,EAAE,MANN;AAORC,IAAAA,QAAQ,EAAEC,MAAM,CAACC;AAPT,GAAD,CADI;AAUbC,EAAAA,GAAG,eAAEV,WAAG,CAAC;AACPW,IAAAA,MAAM,EAAE,SADD;AAEPC,IAAAA,KAAK,EAAEJ,MAAM,CAACK,OAFP;AAGPC,IAAAA,OAAO,EAAEN,MAAM,CAACO,SAHT;AAIPC,IAAAA,QAAQ,EAAE,MAJH;AAKPC,IAAAA,MAAM,iBAAeT,MAAM,CAACU,OALrB;AAMPC,IAAAA,mBAAmB,EAAEX,MAAM,CAACY,iBANrB;AAOPC,IAAAA,oBAAoB,EAAEb,MAAM,CAACY,iBAPtB;AAQPE,IAAAA,UAAU,EAAEd,MAAM,CAACO,SARZ;AASPQ,IAAAA,SAAS,EAAE,QATJ;AAUPC,IAAAA,eAAe,EAAEhB,MAAM,CAACiB,OAVjB;AAWPC,IAAAA,iBAAiB,EAAElB,MAAM,CAACiB,OAXnB;AAYPE,IAAAA,OAAO,EAAE,MAZF;AAaP,eAAW;AACTC,MAAAA,SAAS,EAAEpB,MAAM,CAACqB;AADT,KAbJ;AAgBPC,IAAAA,UAAU,WAAStB,MAAM,CAACuB,uBAAhB,SAA2CvB,MAAM,CAACwB;AAhBrD,GAAD,CAVK;AA4BbC,EAAAA,WAAW,eAAEjC,WAAG,CAAC;AACfkC,IAAAA,UAAU,EAAE1B,MAAM,CAAC2B,OADJ;AAEfT,IAAAA,iBAAiB,EAAElB,MAAM,CAACU,OAFX;AAGf,eAAW;AACTgB,MAAAA,UAAU,EAAE1B,MAAM,CAAC4B;AADV;AAHI,GAAD;AA5BH,CAAf;;AA0CA,SAASC,eAAT,CAAyBC,KAAzB;;;AAOE,SACEC,4BAAA,MAAA;AACEC,IAAAA,SAAS,EAAEC,UAAE,CAAC3C,MAAM,CAACY,GAAR,iBACVZ,MAAM,CAACmC,WADG,IACWK,KAAK,CAACI,QAAN,KAAmB,KAD9B;AAGbC,IAAAA,OAAO,EAAE;AACPL,MAAAA,KAAK,CAACM,QAAN,CAAeN,KAAK,CAACO,IAArB;AACD;AACDC,IAAAA,SAAS,EAAE,mBAACC,CAAD;AACT,UAAIA,CAAC,CAACC,OAAF,KAAc,EAAlB,EAAsB;AACpBV,QAAAA,KAAK,CAACM,QAAN,CAAeN,KAAK,CAACO,IAArB;AACD;AACF;AACDI,IAAAA,QAAQ,EAAE;AACVC,IAAAA,IAAI,EAAC;qBACUZ,KAAK,CAACO;qBACNP,KAAK,CAACI,QAAN,KAAmB;oBACpBJ,KAAK,CAACa;GAhBtB,EAiBGb,KAAK,CAACc,QAjBT,CADF;AAqBD;;SAEeC,aAAaf;AAC3B,SACEC,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,MAAM,CAACC;GAAvB,EACEwC,4BAAA,CAACF,eAAD;AACEQ,IAAAA,IAAI,EAAC;AACLD,IAAAA,QAAQ,EAAEN,KAAK,CAACM;AAChBF,IAAAA,QAAQ,EAAEJ,KAAK,CAACgB,MAAN,KAAiB;AAC3BH,IAAAA,MAAM,EAAC;GAJT,UAAA,CADF,EAQEZ,4BAAA,CAACF,eAAD;AACEQ,IAAAA,IAAI,EAAC;AACLD,IAAAA,QAAQ,EAAEN,KAAK,CAACM;AAChBF,IAAAA,QAAQ,EAAEJ,KAAK,CAACgB,MAAN,KAAiB;AAC3BH,IAAAA,MAAM,EAAC;GAJT,WAAA,CARF,CADF;AAkBD;;;;;;;;;;;;AChGD,AAUA,IAAMI,MAAM,gBAAGvD,WAAG,CAAC;AACjBwD,EAAAA,QAAQ,EAAE,UADO;AAEjBC,EAAAA,KAAK,EAAE,KAFU;AAGjBC,EAAAA,MAAM,EAAE,KAHS;AAIjB5C,EAAAA,OAAO,EAAE,GAJQ;AAKjB6C,EAAAA,MAAM,EAAE,MALS;AAMjBtD,EAAAA,QAAQ,EAAE,QANO;AAOjBuD,EAAAA,IAAI,EAAE,kBAPW;AAQjB3C,EAAAA,MAAM,EAAE;AARS,CAAD,CAAlB;AAWA,AAAO,IAAM4C,GAAG,GAAG,SAANA,GAAM;AAAA,MAAGC,KAAH,QAAGA,KAAH;AAAA,MAAaC,IAAb;;AAAA,SACjBxB,4BAAA,MAAA;AAAKkB,IAAAA,KAAK,EAAE,EAAZ;AAAgBC,IAAAA,MAAM,EAAE,EAAxB;AAA4BM,IAAAA,OAAO,EAAC;AAApC,KAAwDD,IAAxD,GACExB,4BAAA,OAAA;AAAM0B,IAAAA,CAAC,EAAC;GAAR,CADF,EAEE1B,4BAAA,OAAA;AAAMC,IAAAA,SAAS,EAAEe;GAAjB,EAA0BO,KAA1B,CAFF,CADiB;AAAA,CAAZ;AAOP,AAAO,IAAMI,aAAa,GAAG,SAAhBA,aAAgB;AAAA,MAAGJ,KAAH,SAAGA,KAAH;AAAA,MAAaC,IAAb;;AAAA,SAC3BxB,4BAAA,MAAA;AAAKkB,IAAAA,KAAK,EAAE,EAAZ;AAAgBC,IAAAA,MAAM,EAAE,EAAxB;AAA4BM,IAAAA,OAAO,EAAC;AAApC,KAAwDD,IAAxD,GACExB,4BAAA,OAAA;AAAM0B,IAAAA,CAAC,EAAC;GAAR,CADF,EAEE1B,4BAAA,OAAA;AAAMC,IAAAA,SAAS,EAAEe;GAAjB,EAA0BO,KAA1B,CAFF,CAD2B;AAAA,CAAtB;AAOP,AAAO,IAAMK,MAAM,GAAG,SAATA,MAAS;AAAA,MAAGL,KAAH,SAAGA,KAAH;AAAA,MAAaC,IAAb;;AAAA,SACpBxB,4BAAA,MAAA;AAAKkB,IAAAA,KAAK,EAAE,EAAZ;AAAgBC,IAAAA,MAAM,EAAE,EAAxB;AAA4BM,IAAAA,OAAO,EAAC;AAApC,KAAwDD,IAAxD,GACExB,4BAAA,OAAA;AAAM0B,IAAAA,CAAC,EAAC;GAAR,CADF,EAEE1B,4BAAA,OAAA;AAAMC,IAAAA,SAAS,EAAEe;GAAjB,EAA0BO,KAA1B,CAFF,CADoB;AAAA,CAAf;AAOP,AAAO,IAAMM,MAAM,GAAG,SAATA,MAAS;AAAA,MAAGN,KAAH,SAAGA,KAAH;AAAA,MAAaC,IAAb;;AAAA,SACpBxB,4BAAA,MAAA;AAAKkB,IAAAA,KAAK,EAAE,EAAZ;AAAgBC,IAAAA,MAAM,EAAE,EAAxB;AAA4BM,IAAAA,OAAO,EAAC;AAApC,KAAwDD,IAAxD,GACExB,4BAAA,OAAA;AAAM0B,IAAAA,CAAC,EAAC;GAAR,CADF,EAEE1B,4BAAA,OAAA;AAAMC,IAAAA,SAAS,EAAEe;GAAjB,EAA0BO,KAA1B,CAFF,CADoB;AAAA,CAAf;AAOP,AAAO,IAAMO,KAAK,GAAG,SAARA,KAAQ;AAAA,MAAGP,KAAH,SAAGA,KAAH;AAAA,MAAaC,IAAb;;AAAA,SACnBxB,4BAAA,MAAA;AAAKkB,IAAAA,KAAK,EAAE,EAAZ;AAAgBC,IAAAA,MAAM,EAAE,EAAxB;AAA4BM,IAAAA,OAAO,EAAC;AAApC,KAAwDD,IAAxD,GACExB,4BAAA,OAAA;AAAM0B,IAAAA,CAAC,EAAC;GAAR,CADF,EAEE1B,4BAAA,OAAA;AAAMC,IAAAA,SAAS,EAAEe;GAAjB,EAA0BO,KAA1B,CAFF,CADmB;AAAA,CAAd;AAOP,AAAO,IAAMQ,KAAK,GAAG,SAARA,KAAQ;AAAA,MAAGR,KAAH,SAAGA,KAAH;AAAA,MAAaC,IAAb;;AAAA,SACnBxB,4BAAA,MAAA;AAAKkB,IAAAA,KAAK,EAAE,EAAZ;AAAgBC,IAAAA,MAAM,EAAE,EAAxB;AAA4BM,IAAAA,OAAO,EAAC;AAApC,KAAwDD,IAAxD,GACExB,4BAAA,OAAA;AAAM0B,IAAAA,CAAC,EAAC;GAAR,CADF,EAEE1B,4BAAA,OAAA;AAAMC,IAAAA,SAAS,EAAEe;GAAjB,EAA0BO,KAA1B,CAFF,CADmB;AAAA,CAAd;AAOP,AAAO,IAAMS,WAAW,GAAG,SAAdA,WAAc;AAAA,MAAGT,KAAH,SAAGA,KAAH;AAAA,MAAaC,IAAb;;AAAA,SACzBxB,4BAAA,MAAA;AAAKkB,IAAAA,KAAK,EAAE,EAAZ;AAAgBC,IAAAA,MAAM,EAAE,EAAxB;AAA4BM,IAAAA,OAAO,EAAC;AAApC,KAAwDD,IAAxD,GACExB,4BAAA,OAAA;AAAM0B,IAAAA,CAAC,EAAC;GAAR,CADF,EAEE1B,4BAAA,OAAA;AAAMC,IAAAA,SAAS,EAAEe;GAAjB,EAA0BO,KAA1B,CAFF,CADyB;AAAA,CAApB;AAOP,AAAO,IAAMU,QAAQ,GAAG,SAAXA,QAAW;AAAA,MAAGV,KAAH,SAAGA,KAAH;AAAA,MAAaC,IAAb;;AAAA,SACtBxB,4BAAA,MAAA;AAAKkB,IAAAA,KAAK,EAAE,EAAZ;AAAgBC,IAAAA,MAAM,EAAE,EAAxB;AAA4BM,IAAAA,OAAO,EAAC;AAApC,KAAwDD,IAAxD,GACExB,4BAAA,OAAA;AAAM0B,IAAAA,CAAC,EAAC;GAAR,CADF,EAEE1B,4BAAA,OAAA;AAAMC,IAAAA,SAAS,EAAEe;GAAjB,EAA0BO,KAA1B,CAFF,CADsB;AAAA,CAAjB;AAOP,AAAO,IAAMW,IAAI,GAAG,SAAPA,IAAO;AAAA,MAAGX,KAAH,SAAGA,KAAH;AAAA,MAAaC,IAAb;;AAAA,SAClBxB,4BAAA,MAAA;AAAKkB,IAAAA,KAAK,EAAE,EAAZ;AAAgBC,IAAAA,MAAM,EAAE,EAAxB;AAA4BM,IAAAA,OAAO,EAAC;AAApC,KAAwDD,IAAxD,GACExB,4BAAA,OAAA;AAAM0B,IAAAA,CAAC,EAAC;GAAR,CADF,EAEE1B,4BAAA,OAAA;AAAMC,IAAAA,SAAS,EAAEe;GAAjB,EAA0BO,KAA1B,CAFF,CADkB;AAAA,CAAb;AAOP,AAAO,IAAMY,IAAI,GAAG,SAAPA,IAAO;AAAA,MAAGZ,KAAH,UAAGA,KAAH;AAAA,MAAaC,IAAb;;AAAA,SAClBxB,4BAAA,MAAA;AAAKkB,IAAAA,KAAK,EAAE,EAAZ;AAAgBC,IAAAA,MAAM,EAAE,EAAxB;AAA4BM,IAAAA,OAAO,EAAC;AAApC,KAAwDD,IAAxD,GACExB,4BAAA,OAAA;AAAM0B,IAAAA,CAAC,EAAC;GAAR,CADF,EAEE1B,4BAAA,OAAA;AAAMC,IAAAA,SAAS,EAAEe;GAAjB,EAA0BO,KAA1B,CAFF,CADkB;AAAA,CAAb;;AChFA,IAAMa,eAAe,GAAG,SAAlBA,eAAkB,CAACrC,KAAD;AAK7B,MAAMsC,eAAe,GAAG,SAAlBA,eAAkB,CAACC,OAAD;AACtBvC,IAAAA,KAAK,CAACM,QAAN,CAAeiC,OAAf;AACD,GAFD;;AAIA,SACEtC,4BAAA,CAACuC,kBAAD,MAAA,EACEvC,4BAAA,CAACuC,kBAAI,CAACC,OAAN,MAAA,EAAezC,KAAK,CAACc,QAArB,CADF,EAEEb,4BAAA,CAACuC,kBAAI,CAACE,IAAN,MAAA,EACEzC,4BAAA,CAACuC,kBAAI,CAACG,IAAN;AAAW9B,IAAAA,MAAM,EAAC;AAAoCR,IAAAA,OAAO,EAAE;AAAA,aAAMiC,eAAe,CAAC,IAAD,CAArB;AAAA;GAA/D,aAAA,CADF,EAIErC,4BAAA,CAACuC,kBAAI,CAACG,IAAN;AAAW9B,IAAAA,MAAM,EAAC;AAAoCR,IAAAA,OAAO,EAAE;AAAA,aAAMiC,eAAe,CAAC,IAAD,CAArB;AAAA;GAA/D,aAAA,CAJF,EAOErC,4BAAA,CAACuC,kBAAI,CAACG,IAAN;AAAW9B,IAAAA,MAAM,EAAC;AAAoCR,IAAAA,OAAO,EAAE;AAAA,aAAMiC,eAAe,CAAC,IAAD,CAArB;AAAA;GAA/D,aAAA,CAPF,CAFF,CADF;AAgBD,CAzBM;;ACUA,IAAMM,kBAAkB,GAAG,SAArBA,kBAAqB,CAAC5C,KAAD;AAChC,MAAIA,KAAK,CAAC6C,SAAV,EAAqB;AACnB,WAAO5C,4BAAA,CAAC6C,wBAAD,eAA8B9C,KAA9B,EAAP;AACD,GAFD,MAEO;AACL,WACEC,4BAAA,CAAC8C,oBAAD;AACEC,MAAAA,UAAU,EAAEhD,KAAK,CAACiD;AAClBC,MAAAA,SAAS,EAAEjD,4BAAA,CAACkD,kBAAD,MAAA;AACXtC,MAAAA,MAAM,EAAC;AACPuC,MAAAA,IAAI,EAAC;AACLC,MAAAA,OAAO,EAAC;AACRhD,MAAAA,OAAO,EAAE;AACPL,QAAAA,KAAK,CAACsD,gBAAN;AACD;KARH,gBAAA,CADF;AAaD;AACF,CAlBM;;AAoBP,IAAMR,wBAAwB,GAAG,SAA3BA,wBAA2B,CAAC9C,KAAD;AAC/B,SACEC,4BAAA,CAACuC,kBAAD;AAAMe,IAAAA,SAAS,EAAC;GAAhB,EACEtD,4BAAA,CAACuC,kBAAI,CAACC,OAAN,MAAA,EACExC,4BAAA,CAAC8C,oBAAD;AACES,IAAAA,OAAO,EAAEvD,4BAAA,CAACwD,wBAAD,MAAA;AACTT,IAAAA,UAAU,EAAEhD,KAAK,CAACiD;AAClBC,IAAAA,SAAS,EAAEjD,4BAAA,CAACkD,kBAAD,MAAA;AACXtC,IAAAA,MAAM,EAAC;AACPuC,IAAAA,IAAI,EAAC;AACLC,IAAAA,OAAO,EAAC;GANV,gBAAA,CADF,CADF,EAYEpD,4BAAA,CAACuC,kBAAI,CAACE,IAAN,MAAA,EACEzC,4BAAA,CAACuC,kBAAI,CAACG,IAAN;AAAW9B,IAAAA,MAAM,EAAC;AAAqCR,IAAAA,OAAO,EAAE;AAAA,aAAML,KAAK,CAAC0D,QAAN,EAAN;AAAA;GAAhE,0BAAA,CADF,EAIEzD,4BAAA,CAACuC,kBAAI,CAACG,IAAN;AACE9B,IAAAA,MAAM,EAAC;AACPR,IAAAA,OAAO,EAAE;AAAA,aAAML,KAAK,CAACsD,gBAAN,EAAN;AAAA;GAFX,uBAAA,CAJF,CAZF,CADF;AAyBD,CA1BD;;;ACXA,IAAM9F,QAAM,GAAG;AACbC,EAAAA,IAAI,eAAEC,WAAG,CAAC;AACRwD,IAAAA,QAAQ,EAAE,UADF;AAERtD,IAAAA,MAAM,eAAE+F,MAAM,CAACzF,MAAM,CAAC0F,qBAAR,CAFN;AAGRjF,IAAAA,MAAM,iBAAeT,MAAM,CAACU,OAHpB;AAIRM,IAAAA,eAAe,EAAEhB,MAAM,CAACiB,OAJhB;AAKRX,IAAAA,OAAO,EAAEN,MAAM,CAACO,SALR;AAMRI,IAAAA,mBAAmB,EAAEX,MAAM,CAACY;AANpB,GAAD,CADI;AASb+E,EAAAA,MAAM,eAAEnG,WAAG,CAAC;AACV0D,IAAAA,MAAM,EAAE,MADE;AAEVD,IAAAA,KAAK,EAAE,MAFG;AAGVnC,IAAAA,UAAU,EAAEd,MAAM,CAAC4F,UAHT;AAIVC,IAAAA,WAAW,EAAE7F,MAAM,CAAC4F;AAJV,GAAD,CATE;AAebE,EAAAA,IAAI,eAAEtG,WAAG,CAAC;AACRuG,IAAAA,IAAI,EAAE/F,MAAM,CAACK,OADL;AAER2F,IAAAA,aAAa,EAAE;AAFP,GAAD,CAfI;AAmBbC,EAAAA,SAAS,eAAEzG,WAAG,CAAC;AACbsB,IAAAA,UAAU,EAAEd,MAAM,CAACO;AADN,GAAD,CAnBD;AAsBb2F,EAAAA,gBAAgB,eAAE1G,WAAG,CAAC;AACpBwB,IAAAA,eAAe,EAAEhB,MAAM,CAACU;AADJ,GAAD,CAtBR;AAyBbyF,EAAAA,OAAO,eAAE3G,WAAG,CAAC;AACXE,IAAAA,MAAM,eAAE+F,MAAM,CAACzF,MAAM,CAACoG,aAAR;AADH,GAAD;AAzBC,CAAf;AA8BA,IAAMC,aAAa,gBAAGtE,cAAK,CAACuE,UAAN,CASpB,UAACxE,KAAD,EAAQyE,GAAR;AACA,MACEJ,OADF,GASIrE,KATJ,CACEqE,OADF;AAAA,MAEEhE,OAFF,GASIL,KATJ,CAEEK,OAFF;AAAA,MAGES,QAHF,GASId,KATJ,CAGEc,QAHF;AAAA,MAIEZ,SAJF,GASIF,KATJ,CAIEE,SAJF;AAAA,uBASIF,KATJ,CAKEqD,OALF;AAAA,MAKEA,OALF,+BAKY,aALZ;AAAA,4BASIrD,KATJ,CAME0E,YANF;AAAA,MAMEA,YANF,oCAMiB,KANjB;AAAA,0BASI1E,KATJ,CAOEgD,UAPF;AAAA,MAOEA,UAPF,kCAOe,KAPf;AAAA,MAQK2B,UARL,iCASI3E,KATJ;;AAWA,SACEC,4BAAA,CAAC2E,qBAAD;AAAS1E,IAAAA,SAAS,EAAE1C,QAAM,CAAC6G;AAASd,IAAAA,SAAS,EAAEmB;AAAcG,IAAAA,OAAO,EAAER;GAAtE,EACEpE,4BAAA,CAAC6E,wBAAD,eACMH,UADN;AAEEF,IAAAA,GAAG,EAAEA,GAFP;AAGEvE,IAAAA,SAAS,EAAEC,UAAE,CAAC3C,QAAM,CAACqG,MAAR,EAAgB3D,SAAhB,CAHf;AAIE8C,IAAAA,UAAU,EAAEA,UAJd;AAKE3C,IAAAA,OAAO,EAAEA,OALX;AAMEgD,IAAAA,OAAO,EAAEA,OANX;AAOED,IAAAA,IAAI,EAAC,OAPP;AAQEY,IAAAA,IAAI,EAAElD,QARR;kBAScuD;AATd,KADF,CADF;AAeD,CApCqB,CAAtB;AAqCAE,aAAa,CAACQ,WAAd,GAA4B,eAA5B;;AASA,SAASC,WAAT,CAAqBhF,KAArB;AACE,MAAM0E,YAAY,GAAG1E,KAAK,CAACiF,IAAN,KAAe,KAAf,GAAuB,QAAvB,GAAkC,KAAvD;AAEA,SACEhF,4BAAA,wBAAA,MAAA,EACEA,4BAAA,CAACoC,eAAD;AACE/B,IAAAA,QAAQ,EAAE,kBAACiC,OAAD;AACR,UAAIA,OAAO,IAAIvC,KAAK,CAACkF,OAAN,CAAcC,QAAd,CAAuB5C,OAAvB,CAAf,EAAgD;AAC9CvC,QAAAA,KAAK,CAACkF,OAAN,CAAcC,QAAd,CAAuB5C,OAAvB;AACD;AACF;GALH,EAMEtC,4BAAA,CAACsE,aAAD;AACEvB,IAAAA,UAAU,EAAEhD,KAAK,CAACiD;AAClBpC,IAAAA,MAAM,EAAC;AACPwD,IAAAA,OAAO,EAAC;AACRK,IAAAA,YAAY,EAAEA;GAJhB,EAKEzE,4BAAA,CAACmF,oBAAD;kBAAwB;AAAWlF,IAAAA,SAAS,EAAE1C,QAAM,CAACwG;GAArD,CALF,CANF,CADF,EAeE/D,4BAAA,CAACsE,aAAD;AACEvB,IAAAA,UAAU,EAAEhD,KAAK,CAACiD;AAClBpC,IAAAA,MAAM,EAAC;AACPwD,IAAAA,OAAO,EAAC;AACRK,IAAAA,YAAY,EAAEA;AACdrE,IAAAA,OAAO,EAAEL,KAAK,CAACkF,OAAN,CAAcG,MAAd,CAAqBC;GALhC,EAMErF,4BAAA,CAACsF,uBAAD;kBAA2B;AAAOrF,IAAAA,SAAS,EAAE1C,QAAM,CAACwG;GAApD,CANF,CAfF,EAuBE/D,4BAAA,CAACsE,aAAD;AACEvB,IAAAA,UAAU,EAAEhD,KAAK,CAACiD;AAClBpC,IAAAA,MAAM,EAAC;AACPwD,IAAAA,OAAO,EAAC;AACRK,IAAAA,YAAY,EAAEA;AACdrE,IAAAA,OAAO,EAAEL,KAAK,CAACkF,OAAN,CAAcG,MAAd,CAAqBG;GALhC,EAMEvF,4BAAA,CAACwF,yBAAD;kBAA6B;AAASvF,IAAAA,SAAS,EAAE1C,QAAM,CAACwG;GAAxD,CANF,CAvBF,EA+BE/D,4BAAA,CAACsE,aAAD;AACEvB,IAAAA,UAAU,EAAEhD,KAAK,CAACiD;AAClBpC,IAAAA,MAAM,EAAC;AACPwD,IAAAA,OAAO,EAAC;AACRK,IAAAA,YAAY,EAAEA;AACdrE,IAAAA,OAAO,EAAEL,KAAK,CAACkF,OAAN,CAAcG,MAAd,CAAqBK;GALhC,EAMEzF,4BAAA,CAAC0F,kBAAD;kBAAsB;AAAQzF,IAAAA,SAAS,EAAE1C,QAAM,CAACwG;GAAhD,CANF,CA/BF,EAuCE/D,4BAAA,CAACsE,aAAD;AACEvB,IAAAA,UAAU,EAAEhD,KAAK,CAACiD;AAClBpC,IAAAA,MAAM,EAAC;AACPwD,IAAAA,OAAO,EAAC;AACRK,IAAAA,YAAY,EAAEA;AACdrE,IAAAA,OAAO,EAAEL,KAAK,CAACkF,OAAN,CAAcG,MAAd,CAAqBO;GALhC,EAME3F,4BAAA,CAAC4F,yBAAD;kBAA6B;AAAiB3F,IAAAA,SAAS,EAAE1C,QAAM,CAACwG;GAAhE,CANF,CAvCF,EA+CE/D,4BAAA,CAACsE,aAAD;AACEvB,IAAAA,UAAU,EAAEhD,KAAK,CAACiD;AAClBpC,IAAAA,MAAM,EAAC;AACPwD,IAAAA,OAAO,EAAC;AACRK,IAAAA,YAAY,EAAEA;AACdrE,IAAAA,OAAO,EAAEL,KAAK,CAACkF,OAAN,CAAcG,MAAd,CAAqBS;GALhC,EAME7F,4BAAA,CAAC8F,yBAAD;kBAA6B;AAAe7F,IAAAA,SAAS,EAAE1C,QAAM,CAACwG;GAA9D,CANF,CA/CF,EAuDE/D,4BAAA,CAACsE,aAAD;AACEvB,IAAAA,UAAU,EAAEhD,KAAK,CAACiD;AAClBpC,IAAAA,MAAM,EAAC;AACPwD,IAAAA,OAAO,EAAC;AACRK,IAAAA,YAAY,EAAEA;AACdrE,IAAAA,OAAO,EAAEL,KAAK,CAACkF,OAAN,CAAcc;GALzB,EAME/F,4BAAA,CAACgG,iBAAD;kBAAqB;AAAO/F,IAAAA,SAAS,EAAE1C,QAAM,CAACwG;GAA9C,CANF,CAvDF,CADF;AAkED;;AAED,SAASkC,iBAAT,CAA2BlG,KAA3B;AACE,MAAM0E,YAAY,GAAG1E,KAAK,CAACiF,IAAN,KAAe,KAAf,GAAuB,QAAvB,GAAkC,KAAvD;AACA,SACEhF,4BAAA,wBAAA,MAAA,EACEA,4BAAA,CAACsE,aAAD;AACEvB,IAAAA,UAAU,EAAEhD,KAAK,CAACiD;AAClBpC,IAAAA,MAAM,EAAC;AACPwD,IAAAA,OAAO,EAAC;AACRK,IAAAA,YAAY,EAAEA;AACdrE,IAAAA,OAAO,EAAEL,KAAK,CAACkF,OAAN,CAAcG,MAAd,CAAqBc;GALhC,EAMElG,4BAAA,CAACmG,aAAD;AAAqB5E,IAAAA,KAAK,EAAC;AAAatB,IAAAA,SAAS,EAAE1C,QAAM,CAACwG;GAA1D,CANF,CADF,EASE/D,4BAAA,CAACsE,aAAD;AACEvB,IAAAA,UAAU,EAAEhD,KAAK,CAACiD;AAClBpC,IAAAA,MAAM,EAAC;AACPwD,IAAAA,OAAO,EAAC;AACRK,IAAAA,YAAY,EAAEA;AACdrE,IAAAA,OAAO,EAAEL,KAAK,CAACkF,OAAN,CAAcG,MAAd,CAAqBgB;GALhC,EAMEpG,4BAAA,CAACqG,iBAAD;kBAAqB;AAAapG,IAAAA,SAAS,EAAE1C,QAAM,CAACwG;GAApD,CANF,CATF,EAiBE/D,4BAAA,CAACsE,aAAD;AACEvB,IAAAA,UAAU,EAAEhD,KAAK,CAACiD;AAClBpC,IAAAA,MAAM,EAAC;AACPwD,IAAAA,OAAO,EAAC;AACRK,IAAAA,YAAY,EAAEA;AACdrE,IAAAA,OAAO,EAAEL,KAAK,CAACkF,OAAN,CAAcG,MAAd,CAAqBkB;GALhC,EAMEtG,4BAAA,CAACuG,2BAAD;kBAA+B;AAAkBtG,IAAAA,SAAS,EAAE1C,QAAM,CAACwG;GAAnE,CANF,CAjBF,EAyBE/D,4BAAA,CAACsE,aAAD;AACEvB,IAAAA,UAAU,EAAEhD,KAAK,CAACiD;AAClBpC,IAAAA,MAAM,EAAC;AACPwD,IAAAA,OAAO,EAAC;AACRK,IAAAA,YAAY,EAAEA;AACdrE,IAAAA,OAAO,EAAEL,KAAK,CAACkF,OAAN,CAAcG,MAAd,CAAqBoB;GALhC,EAMExG,4BAAA,CAACmG,MAAD;AAAc5E,IAAAA,KAAK,EAAC;AAAuBtB,IAAAA,SAAS,EAAE1C,QAAM,CAACwG;GAA7D,CANF,CAzBF,EAiCE/D,4BAAA,CAACsE,aAAD;AACEvB,IAAAA,UAAU,EAAEhD,KAAK,CAACiD;AAClBpC,IAAAA,MAAM,EAAC;AACPwD,IAAAA,OAAO,EAAC;AACRK,IAAAA,YAAY,EAAEA;AACdrE,IAAAA,OAAO,EAAEL,KAAK,CAACkF,OAAN,CAAcG,MAAd,CAAqBqB;GALhC,EAMEzG,4BAAA,CAACmG,MAAD;AAAc5E,IAAAA,KAAK,EAAC;AAAuBtB,IAAAA,SAAS,EAAE1C,QAAM,CAACwG;GAA7D,CANF,CAjCF,EAyCE/D,4BAAA,CAACsE,aAAD;AACEvB,IAAAA,UAAU,EAAEhD,KAAK,CAACiD;AAClBpC,IAAAA,MAAM,EAAC;AACPwD,IAAAA,OAAO,EAAC;AACRK,IAAAA,YAAY,EAAEA;AACdrE,IAAAA,OAAO,EAAEL,KAAK,CAACkF,OAAN,CAAcyB;GALzB,EAME1G,4BAAA,CAACmG,KAAD;AAAa5E,IAAAA,KAAK,EAAC;AAAyBtB,IAAAA,SAAS,EAAE1C,QAAM,CAACwG;GAA9D,CANF,CAzCF,EAiDE/D,4BAAA,CAACsE,aAAD;AACEvB,IAAAA,UAAU,EAAEhD,KAAK,CAACiD;AAClBpC,IAAAA,MAAM,EAAC;AACPwD,IAAAA,OAAO,EAAC;AACRK,IAAAA,YAAY,EAAEA;AACdrE,IAAAA,OAAO,EAAEL,KAAK,CAACkF,OAAN,CAAc0B;GALzB,EAME3G,4BAAA,CAACmG,KAAD;AAAa5E,IAAAA,KAAK,EAAC;AAAetB,IAAAA,SAAS,EAAE1C,QAAM,CAACwG;GAApD,CANF,CAjDF,EAyDE/D,4BAAA,CAACsE,aAAD;AACEvB,IAAAA,UAAU,EAAEhD,KAAK,CAACiD;AAClBpC,IAAAA,MAAM,EAAC;AACPwD,IAAAA,OAAO,EAAC;AACRK,IAAAA,YAAY,EAAEA;AACdrE,IAAAA,OAAO,EAAEL,KAAK,CAACkF,OAAN,CAAc2B;GALzB,EAME5G,4BAAA,CAACmG,WAAD;AAAmB5E,IAAAA,KAAK,EAAC;AAA2BtB,IAAAA,SAAS,EAAE1C,QAAM,CAACwG;GAAtE,CANF,CAzDF,EAiEE/D,4BAAA,CAACsE,aAAD;AACEvB,IAAAA,UAAU,EAAEhD,KAAK,CAACiD;AAClBpC,IAAAA,MAAM,EAAC;AACPwD,IAAAA,OAAO,EAAC;AACRK,IAAAA,YAAY,EAAEA;AACdrE,IAAAA,OAAO,EAAEL,KAAK,CAACkF,OAAN,CAAc4B;GALzB,EAME7G,4BAAA,CAACmG,QAAD;AAAgB5E,IAAAA,KAAK,EAAC;AAAiBtB,IAAAA,SAAS,EAAE1C,QAAM,CAACwG;GAAzD,CANF,CAjEF,EAyEE/D,4BAAA,CAACsE,aAAD;AACEvB,IAAAA,UAAU,EAAEhD,KAAK,CAACiD;AAClBpC,IAAAA,MAAM,EAAC;AACPwD,IAAAA,OAAO,EAAC;AACRK,IAAAA,YAAY,EAAEA;AACdrE,IAAAA,OAAO,EAAEL,KAAK,CAACkF,OAAN,CAAc6B,OAAd,CAAsBC;GALjC,EAME/G,4BAAA,CAACmG,IAAD;AAAY5E,IAAAA,KAAK,EAAC;AAAOtB,IAAAA,SAAS,EAAE1C,QAAM,CAACwG;GAA3C,CANF,CAzEF,EAiFE/D,4BAAA,CAACsE,aAAD;AACEvB,IAAAA,UAAU,EAAEhD,KAAK,CAACiD;AAClBpC,IAAAA,MAAM,EAAC;AACPwD,IAAAA,OAAO,EAAC;AACRK,IAAAA,YAAY,EAAEA;AACdrE,IAAAA,OAAO,EAAEL,KAAK,CAACkF,OAAN,CAAc6B,OAAd,CAAsBE;GALjC,EAMEhH,4BAAA,CAACmG,IAAD;AAAY5E,IAAAA,KAAK,EAAC;AAAOtB,IAAAA,SAAS,EAAE1C,QAAM,CAACwG;GAA3C,CANF,CAjFF,CADF;AA4FD;;AAED,SAAgBkD,uBAAuBlH;AACrC,wBAA4CC,cAAK,CAACkH,QAAN,CAAe,KAAf,CAA5C;AAAA,MAAOC,cAAP;AAAA,MAAuBC,iBAAvB;;AAEA,SACEpH,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACC;GAAvB,EACEwC,4BAAA,CAACqH,kBAAD;AAAMxJ,IAAAA,cAAc,EAAC;GAArB,EACEmC,4BAAA,CAACqH,kBAAD,MAAA,EACErH,4BAAA,CAAC+E,WAAD,eAAiBhF,KAAjB,EADF,EAEEC,4BAAA,CAACsE,aAAD;AACEvB,IAAAA,UAAU,EAAEhD,KAAK,CAACiD;AAClBpC,IAAAA,MAAM,EAAC;AACPwD,IAAAA,OAAO,EAAE+C,cAAc,GAAG,yBAAH,GAA+B;AACtD/G,IAAAA,OAAO,EAAE;AACPgH,MAAAA,iBAAiB,CAAC,CAACD,cAAF,CAAjB;AACD;GANH,EAOEnH,4BAAA,CAACsH,2BAAD;AAAoBrH,IAAAA,SAAS,EAAE1C,QAAM,CAACwG;GAAtC,CAPF,CAFF,CADF,EAaE/D,4BAAA,CAACqH,kBAAD,MAAA,EACErH,4BAAA,CAAC2C,kBAAD;AACEK,IAAAA,QAAQ,EAAEjD,KAAK,CAACiD;AAChBK,IAAAA,gBAAgB,EAAEtD,KAAK,CAACkF,OAAN,CAAcsC;AAChC9D,IAAAA,QAAQ,EAAE1D,KAAK,CAACkF,OAAN,CAAcuC;AACxB5E,IAAAA,SAAS,EAAE7C,KAAK,CAAC0H;GAJnB,CADF,EAOEzH,4BAAA,CAACsE,aAAD;AACEvB,IAAAA,UAAU,EAAEhD,KAAK,CAACiD;AAClBpC,IAAAA,MAAM,EAAC;AACPwC,IAAAA,OAAO,EAAC;AACRhD,IAAAA,OAAO,EAAEL,KAAK,CAACkF,OAAN,CAAcyC;AACvBzH,IAAAA,SAAS,EAAE1C,QAAM,CAAC2G;AAClBE,IAAAA,OAAO,EAAC;GANV,EAOEpE,4BAAA,CAACmG,GAAD;AAAW5E,IAAAA,KAAK,EAAC;AAAStB,IAAAA,SAAS,EAAE1C,QAAM,CAACwG;GAA5C,CAPF,CAPF,CAbF,CADF,EAgCGoD,cAAc,IACbnH,4BAAA,CAACqH,kBAAD;AAAMxJ,IAAAA,cAAc,EAAC;AAAgB8J,IAAAA,SAAS,EAAC;GAA/C,EACE3H,4BAAA,CAACqH,kBAAD,MAAA,EACErH,4BAAA,CAACiG,iBAAD,eAAuBlG,KAAvB,EADF,CADF,CAjCJ,CADF;AA0CD;AAED,SAAgB6H,mBAAmB7H;AACjC,SACEC,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACC;GAAvB,EACEwC,4BAAA,CAACqH,kBAAD;AAAMxJ,IAAAA,cAAc,EAAC;GAArB,EACEmC,4BAAA,CAACqH,kBAAD,MAAA,EACErH,4BAAA,CAAC+E,WAAD,eAAiBhF,KAAjB,EADF,EAEEC,4BAAA,CAACiG,iBAAD,eAAuBlG,KAAvB,EAFF,CADF,EAKEC,4BAAA,CAACqH,kBAAD,MAAA,EACErH,4BAAA,CAAC2C,kBAAD;AACEK,IAAAA,QAAQ,EAAEjD,KAAK,CAACiD;AAChBK,IAAAA,gBAAgB,EAAEtD,KAAK,CAACkF,OAAN,CAAcsC;AAChC9D,IAAAA,QAAQ,EAAE1D,KAAK,CAACkF,OAAN,CAAcuC;AACxB5E,IAAAA,SAAS,EAAE7C,KAAK,CAAC0H;GAJnB,CADF,EAOEzH,4BAAA,CAAC6E,wBAAD;AACEjE,IAAAA,MAAM,EAAC;AACPwC,IAAAA,OAAO,EAAC;AACRD,IAAAA,IAAI,EAAC;AACLlD,IAAAA,SAAS,EAAEC,UAAE,CAAC3C,QAAM,CAAC2G,SAAR,EAAmB3G,QAAM,CAAC4G,gBAA1B;AACb/D,IAAAA,OAAO,EAAE;AACPL,MAAAA,KAAK,CAACkF,OAAN,CAAc4C,YAAd;AACD;AACD9D,IAAAA,IAAI,EAAE/D,4BAAA,CAACmG,GAAD;AAAW5E,MAAAA,KAAK,EAAC;AAAWtB,MAAAA,SAAS,EAAE1C,QAAM,CAACwG;KAA9C;kBACK;GATb,CAPF,CALF,CADF,CADF;AA6BD;AAED,AAAO,IAAM+D,eAAe,gBAAG9H,cAAK,CAAC+H,IAAN,CAAW,UAAChI,KAAD;AACxC,MAAIA,KAAK,CAACiF,IAAN,KAAe,KAAnB,EAA0B;AACxB,WAAOhF,4BAAA,CAAC4H,kBAAD,eAAwB7H,KAAxB,EAAP;AACD;;AACD,SAAOC,4BAAA,CAACiH,sBAAD,eAA4BlH,KAA5B,EAAP;AACD,CAL8B,CAAxB;AAOP+H,eAAe,CAAChD,WAAhB,GAA8B,iBAA9B;;AC9VA,IAAMkD,SAAS,gBAAGC,GAAG,CAACC,MAAD,EAAS,qBAAT,EAAgC,EAAhC,CAArB;AACA,IAAMC,QAAQ,gBAAGF,GAAG,CAACC,MAAD,EAAS,oBAAT,EAA+B,EAA/B,CAApB;AAEA,IAAIE,OAAO,GAAG,MAAd;AAEA,IAAMC,KAAK,GAAG;AACZ;AACA;AACAC,EAAAA,GAAG,gDAAkCC,IAAhC,CAAqCP,SAArC,KAAmD,CAACE,MAAM,CAACM;AAHpD,CAAd;;AAMA,IAAIH,KAAK,CAACC,GAAN,IAAa,sBAAsBC,IAAtB,CAA2BJ,QAA3B,CAAjB,EAAuD;AACrDC,EAAAA,OAAO,GAAG,KAAV;AACD;;AAED,SAAgBK;AACd,SAAOL,OAAP;AACD;;ACnBD;AAEA;AAQA,SAASM,SAAT,CAAmBC,KAAnB;AACE,MAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B,OAAOA,KAAP;AAE/B,MAAMC,QAAQ,GAAG,qCAAjB;AACA,MAAMC,YAAY,GAAGF,KAAK,CAACG,KAAN,CAAYF,QAAZ,CAArB;;AAEA,MAAI,CAACC,YAAL,EAAmB;AACjB,UAAM,IAAIE,KAAJ,CAAU,qCAAV,CAAN;AACD;;AAED,SAAOC,UAAU,CAACL,KAAD,CAAjB;AACD;;AAED,SAAgBM,OACdC,MACAC;AAOA,aAAqDA,OAAO,IAAI,EAAhE;AAAA,MAAQC,SAAR,QAAQA,SAAR;AAAA,MAAmBC,WAAnB,QAAmBA,WAAnB;AAAA,MAAgClI,MAAhC,QAAgCA,MAAhC;AAAA,MAAwCmI,QAAxC,QAAwCA,QAAxC;AAGA;;;AACA,MAAIC,oBAAoB,GAAG,KAA3B;AAEA,MAAMC,EAAE,GAAG,IAAX;AAEA,MAAMC,WAAW,GAAG;AAClBC,IAAAA,GAAG,EAAEvI,MAAM,GAAGuH,SAAS,CAACvH,MAAD,CAAZ,GAAuB,GADhB;AAElBwI,IAAAA,GAAG,EAAE,GAFa;AAGlBC,IAAAA,KAAK,EAAE;AAHW,GAApB;AAMA,MAAMC,EAAE,GAAGC,UAAU,CAACZ,IAAD,EAAO;AAC1BE,IAAAA,SAAS,EAATA,SAD0B;AAE1BE,IAAAA,QAAQ,EAARA,QAF0B;AAG1BtE,IAAAA,IAAI,EAAE,UAHoB;AAI1B+E,IAAAA,WAAW,EAAE,KAJa;AAK1BC,IAAAA,SAAS,EAAE,GALe;AAM1BC,IAAAA,aAAa,EAAE,IANW;AAO1BC,IAAAA,YAAY,EAAE,IAPY;AAQ1B;AACA;AACA;AACAC,IAAAA,aAAa,EAAE,IAXW;AAY1BC,IAAAA,KAAK,EAAE,SAZmB;AAa1BC,IAAAA,OAAO,EAAE,CAbiB;AAc1BC,IAAAA,cAAc,EAAE,KAdU;AAe1BC,IAAAA,UAAU,EAAE,CAfc;AAgB1BC,IAAAA,WAAW,EAAE,IAhBa;AAiB1BC,IAAAA,UAAU,EAAE,IAjBc;AAkB1BC,IAAAA,UAAU,EAAE;AAlBc,GAAP,CAArB;AAqBAb,EAAAA,EAAE,CAACc,OAAH,CAAW,MAAX,EAAmBlB,WAAW,CAACC,GAA/B;;AAEA,MAAI,CAACL,WAAL,EAAkB;AAChBQ,IAAAA,EAAE,CAACe,EAAH,CAAM,QAAN,EAAgBC,QAAQ,CAACC,YAAD,EAAe,GAAf,CAAxB;AACD;;AAEDjB,EAAAA,EAAE,CAACkB,SAAH,CAAa,WAAb,EAA0B;AACxBC,IAAAA,GAAG,EAAE;AACHC,MAAAA,mBAAmB,CAACC,cAAc,EAAf,CAAnB;AACD,KAHuB;AAIxBC,IAAAA,KAAK,EAAE,sCAJiB;AAKxBC,IAAAA,GAAG,EAAE;AACHvB,MAAAA,EAAE,CAACwB,aAAH,GAAmBC,IAAnB;AACD;AAPuB,GAA1B;AAUA;;;;;;;;AAOA,SAAO;AACLC,IAAAA,OAAO,EAAPA,OADK;AAELC,IAAAA,OAAO,EAAPA,OAFK;AAGLC,IAAAA,MAAM,EAANA,MAHK;AAILC,IAAAA,WAAW,EAAXA,WAJK;AAKLC,IAAAA,eAAe,EAAfA,eALK;AAMLC,IAAAA,QAAQ,EAARA,QANK;AAOLC,IAAAA,GAAG,EAAHA,GAPK;AAQLC,IAAAA,mBAAmB,EAAnBA,mBARK;AASLC,IAAAA,cAAc,EAAdA,cATK;AAULC,IAAAA,aAAa,EAAbA,aAVK;AAWLC,IAAAA,aAAa,EAAbA,aAXK;AAYLC,IAAAA,mBAAmB,EAAnBA,mBAZK;AAaLC,IAAAA,KAAK,EAALA,KAbK;AAcLC,IAAAA,MAAM,EAANA,MAdK;AAeLC,IAAAA,eAAe,EAAfA,eAfK;AAgBLC,IAAAA,SAAS,EAAE;AAAA,aAAMzC,EAAE,CAAC0C,WAAH,CAAe,WAAf,CAAN;AAAA,KAhBN;AAiBLC,IAAAA,iBAAiB,EAAjBA,iBAjBK;AAkBLC,IAAAA,cAAc,EAAdA,cAlBK;AAmBLC,IAAAA,qBAAqB,EAArBA,qBAnBK;AAoBLC,IAAAA,aAAa,EAAbA,aApBK;AAqBLC,IAAAA,uBAAuB,EAAvBA,uBArBK;AAsBLC,IAAAA,kBAAkB,EAAlBA,kBAtBK;AAuBL5B,IAAAA,mBAAmB,EAAnBA,mBAvBK;AAwBL6B,IAAAA,SAAS,EAATA,SAxBK;AAyBLC,IAAAA,SAAS,EAATA,SAzBK;AA0BLC,IAAAA,YAAY,EAAZA,YA1BK;AA2BLC,IAAAA,OAAO,EAAPA,OA3BK;AA4BLC,IAAAA,WAAW,EAAXA,WA5BK;AA6BLC,IAAAA,eAAe,EAAfA,eA7BK;AA8BLC,IAAAA,kBAAkB,EAAlBA,kBA9BK;AA+BLC,IAAAA,cAAc,EAAdA,cA/BK;AAgCLC,IAAAA,oBAAoB,EAApBA,oBAhCK;AAiCLC,IAAAA,mBAAmB,EAAnBA,mBAjCK;AAkCLC,IAAAA,oBAAoB,EAApBA,oBAlCK;AAmCLC,IAAAA,cAAc,EAAdA,cAnCK;AAoCLvC,IAAAA,cAAc,EAAdA,cApCK;AAqCLwC,IAAAA,KAAK,EAALA,KArCK;AAsCLC,IAAAA,QAAQ,EAARA,QAtCK;AAuCLC,IAAAA,aAAa,EAAbA,aAvCK;AAwCLC,IAAAA,cAAc,EAAdA,cAxCK;AAyCLC,IAAAA,WAAW,EAAE,qBAACnF,KAAD;AAAA,aAAoBkB,EAAE,CAACkB,SAAH,CAAa,UAAb,EAAyBpC,KAAzB,CAApB;AAAA,KAzCR;AA0CLoF,IAAAA,UAAU,EAAE;AAAA,aAAMlE,EAAE,CAACkE,UAAH,EAAN;AAAA,KA1CP;AA2CLC,IAAAA,UAAU,EAAE,oBAAClH,OAAD;AAAA,aAAkB+C,EAAE,CAACmE,UAAH,CAAclH,OAAd,CAAlB;AAAA,KA3CP;AA4CLmH,IAAAA,WAAW,EAAE;AACXpE,MAAAA,EAAE,CAACc,OAAH,CAAW,MAAX,EAAmB,MAAnB;AACAd,MAAAA,EAAE,CAACqE,OAAH;AACD,KA/CI;AAgDLA,IAAAA,OAAO,EAAE;AAAA,aAAMrE,EAAE,CAACqE,OAAH,EAAN;AAAA;AAhDJ,GAAP;;AAmDA,WAAS3C,OAAT;AACE;AACA1B,IAAAA,EAAE,CAACsE,UAAH;AACD;;AAED,WAAS3C,OAAT;AACE3B,IAAAA,EAAE,CAACkB,SAAH,CAAa,UAAb,EAAyB,UAAzB;AACD;;AAED,WAASU,MAAT;AACE5B,IAAAA,EAAE,CAACkB,SAAH,CAAa,UAAb,EAAyB,KAAzB;AACD;;AAED,WAASD,YAAT;AACE,QAAMsD,OAAO,GAAGvE,EAAE,CAACwE,YAAH,CAAgBxE,EAAE,CAACyE,QAAH,EAAhB,EAA+B,OAA/B,IAA0C7E,WAAW,CAACG,KAAtE;AACA,QAAI2E,IAAI,GAAGH,OAAX;;AACA,QAAIA,OAAO,GAAG3E,WAAW,CAACC,GAA1B,EAA+B;AAC7B6E,MAAAA,IAAI,GAAG9E,WAAW,CAACC,GAAnB;AACD;;AACD,QAAI0E,OAAO,GAAG3E,WAAW,CAACE,GAA1B,EAA+B;AAC7B4E,MAAAA,IAAI,GAAG9E,WAAW,CAACE,GAAnB;AACD;;AACDE,IAAAA,EAAE,CAACc,OAAH,CAAW,MAAX,EAAmB4D,IAAnB;AACD;;AAED,WAAS7C,WAAT,CAAqBpL,IAArB,EAAmCkO,EAAnC,EAAiDC,gBAAjD;AACE,QAAIA,gBAAJ,EAAsB;AACpBD,MAAAA,EAAE,GAAG3D,QAAQ,CAAC2D,EAAD,EAAYC,gBAAZ,CAAb;AACD;;AACD5E,IAAAA,EAAE,CAACe,EAAH,CAAMtK,IAAN,EAAYkO,EAAZ;AACD;;AAED,WAAS7C,eAAT,CAAyB+C,GAAzB;AACE,QAAMtG,OAAO,GAAGJ,UAAA,EAAhB;AACA6B,IAAAA,EAAE,CAAC8E,SAAH,CACEC,SAAS,CACPF,GADO,EAEP,UAACG,GAAD,EAAMlG,KAAN,EAAamG,GAAb;AACE;AACA;AACAD,MAAAA,GAAG,CAACzG,OAAO,GAAG,GAAV,GAAgB0G,GAAjB,CAAH,GAA2BnG,KAA3B;AACD,KANM,EAOP,EAPO,CADX;AAWD;AAED;;;;AAIA;;;;;;;;;;AAQA,WAASiD,QAAT,CAAkBjD,KAAlB;AACEA,IAAAA,KAAK,GAAGA,KAAK,IAAI,EAAjB;;AACA,QAAIgF,QAAQ,OAAOhF,KAAnB,EAA0B;AACxB;AACD;AAGD;;;AACA,QAAMoG,IAAI,GAAGzB,oBAAoB,EAAjC;AACA,QAAM0B,EAAE,GAAGzB,mBAAmB,EAA9B;AACA1D,IAAAA,EAAE,CAAC+B,QAAH,CAAYjD,KAAZ;AACAqD,IAAAA,aAAa,CAACgD,EAAD,EAAKD,IAAL,EAAW,IAAX,CAAb;AAGA;AACA;;AACA,QAAI,CAACxF,oBAAL,EAA2B;AACzBM,MAAAA,EAAE,CAACoF,YAAH;AACA1F,MAAAA,oBAAoB,GAAG,IAAvB;AACD;AACF;;AAED,WAASsC,GAAT,CAAavL,IAAb;AACEuJ,IAAAA,EAAE,CAAC0C,WAAH,CAAejM,IAAf;AACAuJ,IAAAA,EAAE,CAACsC,KAAH;AACD;;AAED,WAASL,mBAAT,CAA6BoD,UAA7B;AACErF,IAAAA,EAAE,CAACkD,SAAH,CAAa;AAAEgC,MAAAA,IAAI,EAAEI,0BAA0B,CAACD,UAAD,CAAlC;AAAgDF,MAAAA,EAAE,EAAE;AAApD,KAAb;AACAnF,IAAAA,EAAE,CAACsC,KAAH;AACD;AAED;;;;;;;;;;;;AAUA,WAASJ,cAAT;AACE,QAAIyB,oBAAoB,KAAK,CAA7B,EAAgC;AAC9B;AACD;;AAED,QAAMe,IAAI,GAAGjB,oBAAoB,KAAK,CAAtC;;AACA,QAAIzD,EAAE,CAACyE,QAAH,KAAgBC,IAApB,EAA0B;AACxBtC,MAAAA,aAAa;AACbQ,MAAAA,cAAc,CAACiB,KAAK,EAAN,CAAd;AACD;;AAED5B,IAAAA,mBAAmB,CAACyC,IAAD,CAAnB;AACD;;AAED,WAASvC,aAAT,CAAuBoD,SAAvB,EAA0CF,UAA1C,EAA+DG,OAA/D;AACExF,IAAAA,EAAE,CAACkD,SAAH,CAAaoC,0BAA0B,CAACD,UAAD,CAAvC,EAAqDE,SAArD,EAAgE;AAC9DE,MAAAA,MAAM,EAAE,CAACD;AADqD,KAAhE;;AAGA,QAAI,CAACA,OAAL,EAAc;AACZxF,MAAAA,EAAE,CAACsC,KAAH;AACD;AACF;;AAED,WAASF,aAAT,CAAuBiD,UAAvB;AACErF,IAAAA,EAAE,CAACkD,SAAH,CAAa;AACXgC,MAAAA,IAAI,EAAEI,0BAA0B,CAACD,UAAD,CADrB;AAEXF,MAAAA,EAAE,EAAExB,oBAAoB;AAFb,KAAb;AAIA3D,IAAAA,EAAE,CAACsC,KAAH;AACD;;AAED,WAASgD,0BAAT,CAAoCD,UAApC;AACE,QAAIA,UAAU,KAAK,CAAf,IAAqBA,UAAU,KAAKK,SAAf,IAA4BL,UAAU,GAAG,CAAlE,EAAsE;AACpE,aAAOA,UAAP;AACD;;AACD,WAAO5B,oBAAoB,EAA3B;AACD;;AAED,WAASpB,mBAAT;AACEL,IAAAA,GAAG,CAAC,iBAAD,CAAH;AACD;;AAED,WAASM,KAAT;AACEtC,IAAAA,EAAE,CAACsC,KAAH;AACD;;AAED,WAASC,MAAT,CAAgBoD,IAAhB,EAA2CC,EAA3C;AACE5F,IAAAA,EAAE,CAAC6F,YAAH,CAAgBF,IAAhB,EAAsBC,EAAtB;AACA5F,IAAAA,EAAE,CAACsC,KAAH;AACD;;AAED,WAASE,eAAT,CAAyBsD,IAAzB,EAAuCC,GAAvC;AACExD,IAAAA,MAAM,CAACyD,MAAM,CAAC,CAACF,IAAD,GAAQC,GAAT,CAAP,EAAsBC,MAAM,CAAC,CAACF,IAAF,CAA5B,CAAN;;AAEA,aAASE,MAAT,CAAgBC,QAAhB;AACE,aAAO;AACLf,QAAAA,IAAI,EAAEzB,oBAAoB,EADrB;AAEL0B,QAAAA,EAAE,EAAEzB,mBAAmB,KAAKuC;AAFvB,OAAP;AAID;AACF;;AAED,WAAStD,iBAAT,CAA2BsD,QAA3B;AACE1D,IAAAA,MAAM,CAACyD,MAAM,CAAC,QAAD,EAAW,CAAX,CAAP,EAAsBA,MAAM,CAAC,MAAD,EAASC,QAAT,CAA5B,CAAN;;AAEA,aAASD,MAAT,CAAgBE,IAAhB,EAAyCD,QAAzC;AACE,UAAME,SAAS,GAAGhD,YAAY,EAA9B;;AACA,UAAI,CAACgD,SAAL,EAAgB;AACd,eAAO;AAAEjB,UAAAA,IAAI,EAAE,CAAR;AAAWC,UAAAA,EAAE,EAAE;AAAf,SAAP;AACD;;AACD,aAAO;AAAED,QAAAA,IAAI,EAAEiB,SAAS,CAACD,IAAD,CAAT,CAAgBhB,IAAxB;AAA8BC,QAAAA,EAAE,EAAEgB,SAAS,CAACD,IAAD,CAAT,CAAgBf,EAAhB,GAAqBc;AAAvD,OAAP;AACD;AACF;;AAED,WAASrD,cAAT,CAAwBwD,IAAxB;AACEpG,IAAAA,EAAE,CAACqG,YAAH,CAAgBD,IAAhB,EAAsBpG,EAAE,CAACiD,SAAH,EAAtB;AACAjD,IAAAA,EAAE,CAACsC,KAAH;AACD;;AAED,WAASO,qBAAT,CAA+BuD,IAA/B;AACE,QAAME,SAAS,GAAG5C,mBAAmB,EAArC;AACAzB,IAAAA,mBAAmB;AACnBW,IAAAA,cAAc,CAACwD,IAAD,CAAd;AACAjE,IAAAA,aAAa,CAACmE,SAAS,GAAGF,IAAI,CAACG,MAAlB,CAAb;AACAvG,IAAAA,EAAE,CAACsC,KAAH;AACD;;AAED,WAASQ,aAAT,CAAuB0D,OAAvB;AACE,QAAMC,WAAW,GAAGD,OAAO,GAAGlD,eAAe,EAAzB,GAA8BkD,OAAlD;AACA,QAAML,SAAS,GAAGhD,YAAY,EAA9B;;AACA,QAAIgD,SAAJ,EAAe;AACbnG,MAAAA,EAAE,CAACqG,YAAH,CAAgBI,WAAhB,EAA6BN,SAAS,CAACO,MAAvC,EAA+CP,SAA/C,oBAA+CA,SAAS,CAAEQ,IAA1D;AACA3G,MAAAA,EAAE,CAACsC,KAAH;AACD;AACF;;AAED,WAASS,uBAAT,CAAiC6D,SAAjC;AACE,QAAMvB,UAAU,GAAG5B,oBAAoB,EAAvC;AACAzD,IAAAA,EAAE,CAACqG,YAAH,CAAgB,EAAhB,EAAoB;AAAEnB,MAAAA,IAAI,EAAEG,UAAR;AAAoBF,MAAAA,EAAE,EAAE;AAAxB,KAApB,EAAiD;AAAED,MAAAA,IAAI,EAAEG,UAAR;AAAoBF,MAAAA,EAAE,EAAEyB;AAAxB,KAAjD;AACA5G,IAAAA,EAAE,CAACsC,KAAH;AACD;;AAED,WAASU,kBAAT;AACEhD,IAAAA,EAAE,CAAC6G,gBAAH,CAAoB,EAApB;AACA7G,IAAAA,EAAE,CAACsC,KAAH;AACD;AAED;;;;;;;;;;;;;;AAYA,WAASlB,mBAAT,CAA6BqF,WAA7B,EAAkDlE,MAAlD;AACEvC,IAAAA,EAAE,CAAC6G,gBAAH,CAAoBJ,WAApB,EAAiClE,MAAjC;AACAvC,IAAAA,EAAE,CAACsC,KAAH;AACD;AAED;;;;;AAIA,WAASW,SAAT;AACE,WAAOjD,EAAE,CAACiD,SAAH,EAAP;AACD;;AAED,WAASC,SAAT,CAAmB3O,MAAnB;AACEyL,IAAAA,EAAE,CAACkD,SAAH,CAAa3O,MAAb;AACD;;AAED,WAAS4O,YAAT;AACE,QAAM2D,UAAU,GAAG9G,EAAE,CAAC+G,cAAH,EAAnB;;AACA,QAAI,CAAC/G,EAAE,CAACgH,iBAAH,EAAD,IAA2B,CAACF,UAA5B,IAA0CA,UAAU,CAACP,MAAX,GAAoB,CAAlE,EAAqE;AACnE,aAAO,IAAP;AACD;;AACD,WAAOO,UAAU,CAAC,CAAD,CAAjB;AACD;;AAED,WAAS1D,OAAT,CAAiBiC,UAAjB;AACE,WAAOrF,EAAE,CAACoD,OAAH,CAAWiC,UAAX,KAA0B,EAAjC;AACD;;AAED,WAAShC,WAAT,CAAqBgC,UAArB;AACE,QAAM4B,CAAC,GAAG3B,0BAA0B,CAACD,UAAD,CAApC;AACA,WAAO4B,CAAC,GAAG,CAAC,CAAL,IAAU7D,OAAO,CAAC6D,CAAD,CAAP,CAAWV,MAAX,GAAoB,CAA9B,IAAmCU,CAAC,GAAGjH,EAAE,CAACkH,SAAH,EAA9C;AACD;;AAED,WAASnD,aAAT;AACE,WAAO/D,EAAE,CAACkH,SAAH,EAAP;AACD;;AAED,WAAS5D,eAAT;AACE,WAAOH,YAAY,KAAKnD,EAAE,CAACmD,YAAH,EAAL,GAAyB,EAA5C;AACD;;AAED,WAASI,kBAAT;AACE,WAAOD,eAAe,GAAGiD,MAAzB;AACD;;AAED,WAAS/C,cAAT;AACE,WAAOJ,OAAO,CAACK,oBAAoB,EAArB,CAAd;AACD;;AAED,WAASA,oBAAT;AACE,WAAOzD,EAAE,CAACiD,SAAH,GAAeiC,IAAtB;AACD;;AAED,WAASxB,mBAAT;AACE,WAAO1D,EAAE,CAACiD,SAAH,GAAekC,EAAtB;AACD;;AAED,WAASxB,oBAAT;AACE,WAAOH,cAAc,GAAG+C,MAAxB;AACD;;AAED,WAAS3C,cAAT,CAAwBwC,IAAxB;AACE,WAAO5C,cAAc,GAAG2D,UAAjB,CAA4Bf,IAA5B,CAAP;AACD;;AAED,WAAS/E,cAAT;;;AACE,WAAO+F,MAAM,CAAC,GAAD,mBAAMpH,EAAE,CAACqH,SAAH,CAAa,YAAb,CAAN,4BAAoC,CAApC,CAAb;AACD;;AAED,WAASxD,KAAT,CAAeoD,CAAf;QAAeA;AAAAA,MAAAA,IAAI;;;AACjB,QAAIA,CAAC,GAAG,CAAR,EAAW;AACT,aAAO,EAAP;AACD;;AACD,WAAOG,MAAM,CAACzH,EAAD,EAAKsH,CAAL,CAAb;AACD;;AAED,WAASnD,QAAT;AACE,WAAO9D,EAAE,CAAC8D,QAAH,MAAiB,EAAxB;AACD;;AAED,WAASE,cAAT,CAAwBsD,KAAxB;AACE,QAAMrK,OAAO,GAAG+C,EAAE,CAACuH,WAAH,EAAhB;AACA,WAAOD,KAAK,GAAGrK,OAAO,CAACqK,KAAD,CAAV,GAAoBrK,OAAhC;AACD;;AAED,WAASmK,MAAT,CAAgBI,IAAhB,EAA8BP,CAA9B;AACE,WAAO,IAAIQ,KAAJ,CAAUR,CAAC,GAAG,CAAd,EAAiBS,IAAjB,CAAsBF,IAAtB,CAAP;AACD;AACF;;AClcD;AAEA;AAWA,SAASG,oBAAT,CAA8BC,MAA9B;AACE,SAAO,UAACC,MAAD;AACL,QAAIA,MAAM,CAACjE,cAAP,CAAsBgE,MAAtB,CAAJ,EAAmC;AACjCC,MAAAA,MAAM,CAAC9E,uBAAP,CAA+B6E,MAAM,CAACrB,MAAtC;AACD,KAFD,MAEO;AACLsB,MAAAA,MAAM,CAAChF,qBAAP,CAA6B+E,MAA7B;AACD;AACF,GAND;AAOD;AAED;;;;;;;;;;AAQA,SAAS9E,aAAT,CAAuB+E,MAAvB,EAAmDC,MAAnD,EAAmEC,SAAnE;AACE,SAAO;AACLF,IAAAA,MAAM,CAACxF,mBAAP;;AAGA,QAAIwF,MAAM,CAAC1E,YAAP,EAAJ,EAA2B;AACzB,UAAM6E,YAAY,GAAGH,MAAM,CAACvE,eAAP,EAArB;;AACA,UAAI0E,YAAY,CAACb,UAAb,CAAwBW,MAAxB,KAAmCE,YAAY,CAACC,QAAb,CAAsBH,MAAtB,CAAvC,EAAsE;AACpE,YAAMI,YAAY,GAAGJ,MAAM,CAACvB,MAA5B;AACA,YAAM4B,iBAAiB,GAAGH,YAAY,CAACI,KAAb,CACxBF,YADwB,EAExBF,YAAY,CAACzB,MAAb,GAAsB2B,YAFE,CAA1B;AAIAL,QAAAA,MAAM,CAACzG,mBAAP,CAA2B+G,iBAA3B;AACD,OAPD,MAOO;AACLN,QAAAA,MAAM,CAAC/E,aAAP,CAAqBgF,MAArB;AACD;AACF,KAZD,MAYO;AACL;AACAD,MAAAA,MAAM,CAACjF,cAAP,CAAsBkF,MAAM,GAAGC,SAAT,GAAqBD,MAA3C;AACAD,MAAAA,MAAM,CAACrF,eAAP,CAAuBsF,MAAM,CAACvB,MAA9B,EAAsCwB,SAAS,CAACxB,MAAhD;AACD;AACF,GArBD;AAsBD;;AAED,IAAM8B,WAAW,GAAG,GAApB;AACA,IAAMC,aAAa,gBAAGX,oBAAoB,CAAC,IAAD,CAA1C;AACA,IAAMY,YAAY,gBAAGZ,oBAAoB,CAAC,MAAD,CAAzC;AAEA;;;;;;;;;AAQA,SAAgBvI,SAAOyI;AACrB,SAAO;AACLrM,IAAAA,IAAI,EAAEsH,aAAa,CAAC+E,MAAD,EAAS,IAAT,EAAe,cAAf,CADd;AAELnM,IAAAA,MAAM,EAAEoH,aAAa,CAAC+E,MAAD,EAAS,GAAT,EAAc,gBAAd,CAFhB;AAGLxL,IAAAA,MAAM,EAAEyG,aAAa,CAAC+E,MAAD,EAAS,IAAT,EAAe,aAAf,CAHhB;AAILjM,IAAAA,KAAK,EAAE4M,eAAe,CAACX,MAAD,EAASS,aAAT,CAJjB;AAKL/L,IAAAA,IAAI,EAAEiM,eAAe,CAACX,MAAD,EAASU,YAAT,CALhB;AAMLE,IAAAA,IAAI,EAAJA,IANK;AAOLC,IAAAA,EAAE,EAAEC,YAAY,CAACd,MAAD,EAAS,CAAT,CAPX;AAQLe,IAAAA,EAAE,EAAED,YAAY,CAACd,MAAD,EAAS,CAAT,CARX;AASLgB,IAAAA,EAAE,EAAEF,YAAY,CAACd,MAAD,EAAS,CAAT,CATX;AAUL/L,IAAAA,EAAE,EAAE0M,eAAe,CAACX,MAAD,EAASiB,UAAT,EAAqB,IAArB,CAVd;AAWL9M,IAAAA,EAAE,EAAEwM,eAAe,CAACX,MAAD,EAASkB,UAAT,EAAqB,IAArB,CAXd;AAYL7L,IAAAA,IAAI,EAAE;AACJ2K,MAAAA,MAAM,CAAC7F,GAAP,CAAW,MAAX;AACD,KAdI;AAeL7E,IAAAA,IAAI,EAAE;AACJ0K,MAAAA,MAAM,CAAC7F,GAAP,CAAW,MAAX;AACD,KAjBI;AAkBLvF,IAAAA,EAAE,EAAFA,EAlBK;AAmBLE,IAAAA,MAAM,EAANA,MAnBK;AAoBLC,IAAAA,MAAM,EAANA,MApBK;AAqBLoM,IAAAA,KAAK,EAALA;AArBK,GAAP;AAwBA;;;;;AAIA,WAASvM,EAAT;AACEoL,IAAAA,MAAM,CAAC3F,cAAP;AACA,QAAM+G,EAAE,GAAGpB,MAAM,CAAChE,KAAP,EAAX;AACA,QAAMqF,MAAM,GAAGD,EAAE,GAAG,KAAL,GAAaA,EAAb,GAAkBA,EAAjC;AACApB,IAAAA,MAAM,CAACjF,cAAP,CAAsBsG,MAAtB;AACD;AAED;;;;;;AAIA,WAASvM,MAAT;AACEkL,IAAAA,MAAM,CAAChF,qBAAP,CAA6BgF,MAAM,CAACxG,cAAP,EAA7B;AACD;AAED;;;;;;AAIA,WAASzE,MAAT;AACE,QAAMuM,WAAW,GAAGtB,MAAM,CAACxG,cAAP,EAApB;;AACA,QAAIwG,MAAM,CAACjE,cAAP,CAAsBuF,WAAtB,CAAJ,EAAwC;AACtCtB,MAAAA,MAAM,CAAC9E,uBAAP,CAA+BoG,WAAW,CAAC5C,MAA3C;AACD;AACF;AAED;;;;;;AAIA,WAASyC,KAAT,CAAeI,MAAf;AACE,QAAMH,EAAE,GAAGpB,MAAM,CAAChE,KAAP,EAAX;AACAgE,IAAAA,MAAM,CAAC3F,cAAP;AACA2F,IAAAA,MAAM,CAACjF,cAAP,CAAsBqG,EAAtB;AACA,QAAM/D,IAAI,GAAG2C,MAAM,CAACpE,oBAAP,EAAb;AACAoE,IAAAA,MAAM,CAACjF,cAAP,CAAsByG,aAAa,CAACD,MAAM,CAACE,IAAR,EAAcF,MAAM,CAACG,IAArB,CAAb,CAAwC7B,IAAxC,CAA6CuB,EAA7C,CAAtB;AACApB,IAAAA,MAAM,CAACjF,cAAP,CAAsBqG,EAAE,GAAGA,EAA3B;AACApB,IAAAA,MAAM,CAAC1F,aAAP,CAAqB,CAArB,EAAwB+C,IAAxB;AACD;AAED;;;;;;AAIA,WAASuD,IAAT,CAAce,GAAd,EAA2BpD,IAA3B,EAA0CqD,KAA1C;AACE5B,IAAAA,MAAM,CAACxF,mBAAP;AAEA,QAAMqH,SAAS,GAAGD,KAAK,GAAG,OAAOA,KAAP,GAAe,GAAlB,GAAwB,EAA/C;AAEA,QAAMhB,IAAI,GAAGrC,IAAI,GAAG,MAAMA,IAAN,GAAa,IAAb,GAAoBoD,GAApB,GAA0BE,SAA1B,GAAsC,GAAzC,GAA+C,MAAMF,GAAN,GAAY,GAA5E;AAEA3B,IAAAA,MAAM,CAACzG,mBAAP,CAA2BqH,IAA3B,EAAiC,QAAjC;AACD;AACF;AAED;;;;;;;AAMA,SAASD,eAAT,CACEX,MADF,EAEE8B,QAFF,EAGEC,MAHF;AAKE,SAAO;AACL/B,IAAAA,MAAM,CAACxF,mBAAP;AAEA,QAAM8D,SAAS,GAAG0B,MAAM,CAAC1E,YAAP,EAAlB;;AACA,QAAIgD,SAAJ,EAAe;AACb;AACA;AACA0D,MAAAA,SAAS,CAAC1D,SAAD,EAAY,UAACd,UAAD,EAAqByE,UAArB;AACnB;AACAjC,QAAAA,MAAM,CAAC5F,mBAAP,CAA2BoD,UAA3B;AACAsE,QAAAA,QAAQ,CAAC9B,MAAD,EAASiC,UAAT,CAAR;AACD,OAJQ,CAAT;AAKAjC,MAAAA,MAAM,CAACzF,aAAP;AACD,KATD,MASO;AACL;AACA;AACA,UAAIwH,MAAM,IAAI,CAACG,aAAa,CAAClC,MAAD,CAAxB,IAAoC,CAACA,MAAM,CAACjE,cAAP,CAAsB,IAAtB,CAAzC,EAAsE;AACpEoG,QAAAA,qBAAqB,CAACnC,MAAD,CAArB;AACD;;AACD8B,MAAAA,QAAQ,CAAC9B,MAAD,CAAR;AACD;AACF,GArBD;AAsBD;AAED;;;;;;;;;;AAQA,SAASgC,SAAT,CACE1D,SADF,EAKE8D,EALF;AAOE;AACA,MAAMC,KAAK,GAAG,CAAC/D,SAAS,CAACO,MAAV,CAAiBxB,IAAlB,EAAwBiB,SAAS,CAACQ,IAAV,CAAezB,IAAvC,CAAd;AACA,MAAMiF,SAAS,GAAGrK,GAAG,CAACoK,KAAD,CAArB;AACA,MAAME,SAAS,GAAGvK,GAAG,CAACqK,KAAD,CAArB;AACA,MAAMG,SAAS,GAAGC,KAAK,CAACF,SAAS,IAAI,CAAd,EAAiBD,SAAS,KAAKzE,SAAd,GAA0ByE,SAAS,GAAG,CAAtC,GAA0CzE,SAA3D,CAAvB;AAEA2E,EAAAA,SAAS,CAACE,OAAV,CAAkB,UAAClF,UAAD,EAAamF,CAAb;AAChBP,IAAAA,EAAE,CAAC5E,UAAD,EAAamF,CAAC,GAAG,CAAjB,CAAF;AACD,GAFD;AAGD;;AAED,SAASR,qBAAT,CAA+BnC,MAA/B;AACE,MAAM3C,IAAI,GAAG2C,MAAM,CAACpE,oBAAP,EAAb;AAEA,MAAMgH,kBAAkB,GAAG5C,MAAM,CAACxE,WAAP,CAAmB6B,IAAnB,CAA3B;AAEA,MAAMwF,eAAe,GAAGxF,IAAI,GAAG,CAAP,GAAW2C,MAAM,CAACxE,WAAP,CAAmB6B,IAAI,GAAG,CAA1B,CAAX,GAA0C,KAAlE;AACA,MAAMyF,eAAe,GAAGzF,IAAI,GAAG2C,MAAM,CAAC9D,aAAP,KAAyB,CAAhC,GAAoC8D,MAAM,CAACxE,WAAP,CAAmB6B,IAAI,GAAG,CAA1B,CAApC,GAAmE,IAA3F;AAEA,MAAI0F,aAAa,GAAGH,kBAAkB,GAAG,CAAH,GAAO,CAA7C;;AACA,MAAIC,eAAJ,EAAqB;AACnBE,IAAAA,aAAa,GAAGA,aAAa,GAAG,CAAhC;AACD;;AACD,MAAID,eAAJ,EAAqB;AACnBC,IAAAA,aAAa,GAAGA,aAAa,GAAG,CAAhC;AACD;;AAED/C,EAAAA,MAAM,CAACzF,aAAP;AACAyF,EAAAA,MAAM,CAACjF,cAAP,CAAsBiF,MAAM,CAAChE,KAAP,CAAa+G,aAAb,CAAtB;AACA/C,EAAAA,MAAM,CAAC1F,aAAP,CAAqB,CAArB,EAAwBsI,kBAAkB,GAAGvF,IAAH,GAAUA,IAAI,GAAG,CAA3D;AACD;;AAED,SAAS6E,aAAT,CAAuBlC,MAAvB;AACE,MAAMgD,MAAM,GAAGhD,MAAM,CAACrE,cAAP,GAAwBvE,KAAxB,CAA8B,WAA9B,CAAf;AACA,SAAO4L,MAAM,GAAGA,MAAM,CAAC,CAAD,CAAT,GAAe,IAA5B;AACD;;AAED,SAAS/B,UAAT,CAAoBjB,MAApB;AACE,MAAIA,MAAM,CAACjE,cAAP,CAAsB,IAAtB,CAAJ,EAAiC;AAC/BiE,IAAAA,MAAM,CAAC9E,uBAAP,CAA+B,CAA/B;AACD,GAFD,MAEO;AACL,QAAM+G,UAAU,GAAGC,aAAa,CAAClC,MAAD,CAAhC;;AACA,QAAIiC,UAAJ,EAAgB;AACdjC,MAAAA,MAAM,CAAC9E,uBAAP,CAA+B+G,UAAU,CAACvD,MAA1C;AACD;;AACDsB,IAAAA,MAAM,CAAChF,qBAAP,CAA6B,IAA7B;AACD;AACF;;AAED,SAASkG,UAAT,CAAoBlB,MAApB,EAAgDZ,CAAhD;AACE,MAAM6C,UAAU,GAAGC,aAAa,CAAClC,MAAD,CAAhC;;AACA,MAAIiC,UAAJ,EAAgB;AACdjC,IAAAA,MAAM,CAAC9E,uBAAP,CAA+B+G,UAAU,CAACvD,MAA1C;AACD,GAFD,MAEO;AACL,QAAIsB,MAAM,CAACjE,cAAP,CAAsB,IAAtB,CAAJ,EAAiC;AAC/BiE,MAAAA,MAAM,CAAC9E,uBAAP,CAA+B,CAA/B;AACD;;AACD8E,IAAAA,MAAM,CAAChF,qBAAP,CAA6B,CAACoE,CAAC,IAAI,CAAN,IAAW,IAAxC;AACD;AACF;AAED;;;;;;;;;;;;;AAWA,SAASoC,aAAT,CAAuByB,KAAvB,EAAsCC,KAAtC;AACE,MAAMC,SAAS,GAAG,IAAIvD,KAAJ,CAAU,EAAV,CAAlB;AACA,MAAMwD,IAAI,GAAG,MAAMD,SAAS,CAACtD,IAAV,CAAe,GAAf,CAAN,GAA4B,IAAzC;AACA,MAAMwD,aAAa,GAAG,MAAMF,SAAS,CAACtD,IAAV,CAAe,GAAf,CAAN,GAA4B,IAAlD;AAEA,MAAIyD,OAAO,GAAG,GAAd;AACA,MAAIC,YAAY,GAAG,GAAnB;AAEAC,EAAAA,KAAK,CAACN,KAAD,EAAQ;AACXI,IAAAA,OAAO,IAAIF,IAAX;AACAG,IAAAA,YAAY,IAAIF,aAAhB;AACD,GAHI,CAAL;AAKA,MAAMI,QAAQ,GAAGhB,KAAK,CAACQ,KAAD,CAAL,CAAajG,GAAb,CAAiB;AAAA,WAAMsG,OAAO,CAACI,OAAR,CAAgB,SAAhB,EAA2B,QAA3B,CAAN;AAAA,GAAjB,CAAjB;AAEA,MAAMC,SAAS,GAAGL,OAAO,CAACI,OAAR,CAAgB,SAAhB,EAA2B,UAA3B,CAAlB;AAEA,SAAO,CAACC,SAAD,EAAYJ,YAAZ,EAA0BK,MAA1B,CAAiCH,QAAjC,CAAP;AACD;AAED;;;;;;;;;AAOA,SAAS3C,YAAT,CAAsBd,MAAtB,EAAkD6D,KAAlD;AACE,SAAO;AACL,QAAMpF,SAAS,GAAGuB,MAAM,CAACnE,mBAAP,EAAlB;AACA,QAAMiI,aAAa,GAAGC,YAAY,CAAC/D,MAAD,CAAlC;AACA,QAAMD,MAAM,GAAGR,MAAM,CAACiB,WAAD,EAAcqD,KAAd,CAArB;;AAGA,QAAI,CAACC,aAAL,EAAoB;AAClB9D,MAAAA,MAAM,CAAC5F,mBAAP;AACA4F,MAAAA,MAAM,CAACjF,cAAP,CAAsBgF,MAAM,GAAG,GAA/B;AACAC,MAAAA,MAAM,CAAC1F,aAAP,CAAqBmE,SAAS,GAAGsB,MAAM,CAACrB,MAAnB,GAA4B,CAAjD;AACA;AACD;;;AAGD,QAAIsB,MAAM,CAACvE,eAAP,OAA6BsE,MAAjC,EAAyC;AACvCC,MAAAA,MAAM,CAAClF,iBAAP,CAAyB,CAAzB;AACA,UAAMkJ,SAAS,GAAGhE,MAAM,CAACtE,kBAAP,EAAlB;AACAsE,MAAAA,MAAM,CAAC7E,kBAAP;AACA6E,MAAAA,MAAM,CAAC1F,aAAP,CAAqBmE,SAAS,GAAGuF,SAAjC;AACA;AACD;;;AAGD,QAAMC,IAAI,GAAGlE,MAAM,CAACrB,MAAP,GAAgBsB,MAAM,CAACtE,kBAAP,EAA7B;AACAsE,IAAAA,MAAM,CAACzG,mBAAP,CAA2BwG,MAA3B;AACAC,IAAAA,MAAM,CAAC1F,aAAP,CAAqBmE,SAAS,GAAGwF,IAAjC;AACD,GA1BD;AA2BD;AAED;;;;;;;;AAMA,SAASF,YAAT,CAAsB/D,MAAtB;AACE,MAAMgD,MAAM,GAAGhD,MAAM,CAACrE,cAAP,GAAwBvE,KAAxB,CAA8B,oBAA9B,CAAf;;AACA,MAAI,CAAC4L,MAAL,EAAa;AACX,WAAO,IAAP;AACD;;AACD,MAAM1B,WAAW,GAAG0B,MAAM,CAAC,CAAD,CAA1B;AACA,MAAMkB,MAAM,GAAGlB,MAAM,CAAC,CAAD,CAArB;AAEAhD,EAAAA,MAAM,CAACtF,MAAP,CAAcyD,MAAM,CAAC,CAAD,CAApB,EAAyBA,MAAM,CAAC+F,MAAM,CAACxF,MAAR,CAA/B;AACA,SAAOsB,MAAM,CAAC1E,YAAP,EAAP;;AAEA,WAAS6C,MAAT,CAAgBC,QAAhB;AACE,WAAO;AACLf,MAAAA,IAAI,EAAE2C,MAAM,CAACpE,oBAAP,EADD;AAEL0B,MAAAA,EAAE,EAAEgE,WAAW,CAAC5C,MAAZ,GAAqBN;AAFpB,KAAP;AAID;AACF;;AClWD;AAEA,SAIgB+F,qBACd3M,MACAC;AAOA,MAAMuI,MAAM,GAAGoE,MAAA,CAAyB5M,IAAzB,EAA+BC,OAA/B,CAAf;;AAEA,WAAS4M,UAAT,CAAoBvH,EAApB;AACE,WAAO,UAAChO,CAAD,EAASwO,EAAT;AACLR,MAAAA,EAAE,CAACkD,MAAM,CAAC/D,QAAP,EAAD,EAAoBnN,CAApB,EAAuBwO,EAAvB,CAAF;AACD,KAFD;AAGD;;AAED,MAAMgH,GAAG,GAAG;AACV/Q,IAAAA,OAAO,EAAEgR,QAAA,CAAgBvE,MAAhB,CADC;AAEV5K,IAAAA,OAAO,EAAE;AACPoP,MAAAA,OAAO,EAAE;AACP,eAAOxE,MAAM,CAAC7D,cAAP,CAAsB,MAAtB,IAAgC,CAAvC;AACD,OAHM;AAIPsI,MAAAA,OAAO,EAAE;AACP,eAAOzE,MAAM,CAAC7D,cAAP,CAAsB,MAAtB,IAAgC,CAAvC;AACD;AANM,KAFC;AAUVuI,IAAAA,MAAM,EAAE;AACNC,MAAAA,QAAQ,EAAE,kBAAU7H,EAAV;AACRkD,QAAAA,MAAM,CAAChG,WAAP,CAAmB,QAAnB,EAA6B8C,EAA7B,EAAiC,GAAjC;AACD,OAHK;AAIN8H,MAAAA,QAAQ,EAAE,kBAAU9H,EAAV;AACRkD,QAAAA,MAAM,CAAChG,WAAP,CAAmB,QAAnB,EAA6BqK,UAAU,CAACvH,EAAD,CAAvC,EAA6C,CAA7C;AACD,OANK;AAON+H,MAAAA,OAAO,EAAE,iBAAU/H,EAAV;AACPkD,QAAAA,MAAM,CAAChG,WAAP,CAAmB,OAAnB,EAA4B8C,EAA5B,EAAgC,CAAhC;AACD;AATK,KAVE;AAqBVgI,IAAAA,MAAM,EAAE9E,MAAM,CAACjF,cArBL;AAsBVN,IAAAA,KAAK,EAAEuF,MAAM,CAACvF,KAtBJ;AAuBVsK,IAAAA,UAAU,EAAE/E,MAAM,CAAC/D,QAvBT;AAwBVpC,IAAAA,OAAO,EAAEmG,MAAM,CAACnG,OAxBN;AAyBVmL,IAAAA,UAAU,EAAEhF,MAAM,CAAC9F,QAzBT;AA0BVuB,IAAAA,eAAe,EAAEuE,MAAM,CAACvE,eA1Bd;AA2BVjB,IAAAA,mBAAmB,EAAEwF,MAAM,CAACxF,mBA3BlB;AA4BV4B,IAAAA,WAAW,EAAE4D,MAAM,CAAC5D,WA5BV;AA6BVzB,IAAAA,eAAe,EAAEqF,MAAM,CAACrF,eA7Bd;AA8BVS,IAAAA,SAAS,EAAE4E,MAAM,CAAC5E,SA9BR;AA+BVC,IAAAA,SAAS,EAAE2E,MAAM,CAAC3E,SA/BR;AAgCV4J,IAAAA,KAAK,EAAE;AAAA,aAAMjF,MAAM,CAAC9F,QAAP,CAAgB,EAAhB,CAAN;AAAA,KAhCG;AAiCVU,IAAAA,SAAS,EAAEoF,MAAM,CAACpF,SAjCR;AAkCV2B,IAAAA,WAAW,EAAEyD,MAAM,CAACzD,WAlCV;AAmCVC,IAAAA,OAAO,EAAEwD,MAAM,CAACxD;AAnCN,GAAZ;AAsCAwD,EAAAA,MAAM,CAAC/F,eAAP,CAAuB;AACrBiL,IAAAA,CAAC,EAAEZ,GAAG,CAAC/Q,OAAJ,CAAYI,IADM;AAErBwR,IAAAA,CAAC,EAAEb,GAAG,CAAC/Q,OAAJ,CAAYM;AAFM,GAAvB;AAKA,SAAOyQ,GAAP;AACD;;;AC/CD,IAAMzY,QAAM,GAAG;AACbC,EAAAA,IAAI,eAAEC,WAAF,ywCACkBQ,MAAM,CAACU,OADzB,EASeV,MAAM,CAAC6Y,iBATtB,EAYS7Y,MAAM,CAACK,OAZhB,EAaWL,MAAM,CAAC8Y,QAblB,EAgBe9Y,MAAM,CAAC+Y,kBAhBtB,EAiBa/Y,MAAM,CAACC,SAjBpB,EAwBSD,MAAM,CAACgZ,OAxBhB,EA2BShZ,MAAM,CAACK,OA3BhB,EAmDSL,MAAM,CAACiZ,MAnDhB,EA0DSjZ,MAAM,CAACkZ,OA1DhB,EA8DSlZ,MAAM,CAACmZ,OA9DhB,CADS;AAqEbC,EAAAA,MAAM,eAAE5Z,WAAG,CAAC;AACV,mBAAe;AACb6Z,MAAAA,SAAS,EAAE;AADE;AADL,GAAD,CArEE;AA0EbC,EAAAA,GAAG,eAAE9Z,WAAG,CAAC;AACPiB,IAAAA,MAAM,EAAE,iBADD;AAEP,yBAAqB;AACnB8Y,MAAAA,QAAQ,EAAE,OADS;AAEnBpW,MAAAA,MAAM,EAAE;AAFW;AAFd,GAAD,CA1EK;AAiFb4B,EAAAA,QAAQ,eAAEvF,WAAF,oWAEUQ,MAAM,CAACiB,OAFjB;AAjFK,CAAf;AAiGA,AAAO,IAAMuY,gBAAgB,gBAAGzX,cAAK,CAAC+H,IAAN,CAAW,UAAChI,KAAD;AACzC,MAAM2X,OAAO,GAAGC,YAAM,CAAiB,IAAjB,CAAtB;;AACA,kBAA4BzQ,cAAQ,CAA+B,IAA/B,CAApC;AAAA,MAAOwK,MAAP;AAAA,MAAekG,SAAf;;AAEAC,EAAAA,eAAS,CAAC;AACR,QAAIH,OAAO,CAACtJ,OAAZ,EAAqB;AACnBwJ,MAAAA,SAAS,CACP/B,oBAAoB,CAClB6B,OAAO,CAACtJ,OADU,EAElB0J,MAAM,CAACC,MAAP,CACE,EADF,EAEE;AACE3O,QAAAA,SAAS,EAAErJ,KAAK,CAACqJ,SADnB;AAEEE,QAAAA,QAAQ,EAAE;AAFZ,OAFF,EAMEvJ,KAAK,CAACiF,IAAN,KAAe,KAAf,GACI;AACEqE,QAAAA,WAAW,EAAE,IADf;AAEElI,QAAAA,MAAM,EAAE;AAFV,OADJ,GAKI,EAXN,EAYEpB,KAAK,CAACiY,SAAN,KAAoBzI,SAApB,GAAgC;AAAEpO,QAAAA,MAAM,EAAEpB,KAAK,CAACiY;AAAhB,OAAhC,GAA8D,EAZhE,CAFkB,CADb,CAAT;AAmBD;;AAEF,GAvBQ,EAuBN,EAvBM,CAAT;AAyBAH,EAAAA,eAAS,CAAC;AACR,QAAInG,MAAJ,EAAY;AACV3R,MAAAA,KAAK,CAACkY,OAAN,CAAcvG,MAAd;AACD;;AAEF,GALQ,EAKN,CAACA,MAAD,CALM,CAAT;AAOA,MAAMzR,SAAS,GAAGC,UAAE,CAClB3C,QAAM,CAACC,IADW,EAElBuC,KAAK,CAACiY,SAAN,KAAoBzI,SAApB,GAAgC9R,WAAG,CAAC;AAAEua,IAAAA,SAAS,EAAEjY,KAAK,CAACiY;AAAnB,GAAD,CAAnC,GAAsEzI,SAFpD,EAGlBxP,KAAK,CAACiF,IAAN,KAAe,SAAf,GAA2BzH,QAAM,CAAC8Z,MAAlC,GAA2C9Z,QAAM,CAACga,GAHhC,EAIlBxX,KAAK,CAACiD,QAAN,IAAkBzF,QAAM,CAACyF,QAJP,CAApB;AAOA,SACEhD,4BAAA,MAAA;AACEC,IAAAA,SAAS,EAAEA;AACXuE,IAAAA,GAAG,EAAEkT;oBACQ;AACbQ,IAAAA,KAAK,EAAE;AAAExa,MAAAA,OAAO,EAAEqC,KAAK,CAACoY,OAAN,GAAgB,OAAhB,GAA0B;AAArC;GAJT,CADF;AAQD,CAnD+B,CAAzB;AAqDPV,gBAAgB,CAAC3S,WAAjB,GAA+B,kBAA/B;;ACpKA,IAAMvH,QAAM,GAAG;AACbC,EAAAA,IAAI,eAAEC,WAAG,CAAC;AACRC,IAAAA,OAAO,EAAE,MADD;AAERG,IAAAA,cAAc,EAAE,eAFR;AAGR8B,IAAAA,UAAU,EAAE1B,MAAM,CAACiB,OAHX;AAIRR,IAAAA,MAAM,iBAAeT,MAAM,CAACU,OAJpB;AAKRyZ,IAAAA,sBAAsB,EAAEna,MAAM,CAACY,iBALvB;AAMRwZ,IAAAA,uBAAuB,EAAEpa,MAAM,CAACY,iBANxB;AAORN,IAAAA,OAAO,EAAKN,MAAM,CAACO,SAAZ,SAAyBP,MAAM,CAACqa;AAP/B,GAAD,CADI;AAUbC,EAAAA,IAAI,eAAE9a,WAAG,CAAC;AACRY,IAAAA,KAAK,EAAEJ,MAAM,CAACK,OADN;AAERN,IAAAA,QAAQ,EAAEC,MAAM,CAACua,SAFT;AAGR5U,IAAAA,MAAM,EAAE;AACN5F,MAAAA,QAAQ,EAAEC,MAAM,CAACua,SADX;AAENC,MAAAA,UAAU,EAAE;AAFN;AAHA,GAAD;AAVI,CAAf;AAoBA,SASgBC,aAAa3Y;AAC3B,SACEC,4BAAA,CAAC2Y,uBAAD;AAAW5a,IAAAA,YAAY,EAAC;AAAOkC,IAAAA,SAAS,EAAE1C,QAAM,CAACgb;GAAjD,wCAAA,EACuC,GADvC,EAEEvY,4BAAA,CAAC4Y,sBAAD;AACEC,IAAAA,EAAE,EAAC;AACHjY,IAAAA,MAAM,EAAC;AACPR,IAAAA,OAAO,EAAE;AACPL,MAAAA,KAAK,CAACK,OAAN;AACD;GALH,uBAAA,CAFF,KAAA,CADF;AAeD;AAED,SAAgB0Y,kBAAkB/Y;AAChC,SAAOC,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACC;GAAvB,EAA8BuC,KAAK,CAACc,QAApC,CAAP;AACD;;ACjDD,IAAYkY,kBAAZ;;AAAA,WAAYA;AACVA,EAAAA,gCAAA,wBAAA;AACAA,EAAAA,gCAAA,wBAAA;AACAA,EAAAA,4CAAA,oCAAA;AACAA,EAAAA,iCAAA,yBAAA;AACAA,EAAAA,0CAAA,kCAAA;AACAA,EAAAA,wCAAA,gCAAA;AACAA,EAAAA,6BAAA,qBAAA;AACD,CARD,EAAYA,kBAAkB,KAAlBA,kBAAkB,KAAA,CAA9B;;ACGA,IAAMxb,QAAM,GAAG;AACbyb,EAAAA,mBAAmB,eAAEvb,WAAG,CAAC;AACvBC,IAAAA,OAAO,EAAE,MADc;AAEvBub,IAAAA,QAAQ,EAAE;AAFa,GAAD,CADX;AAKbC,EAAAA,UAAU,eAAEzb,WAAG,CAAC;AACd0b,IAAAA,QAAQ,EAAE;AADI,GAAD,CALF;AAQbC,EAAAA,eAAe,eAAE3b,WAAG,CAAC;AACnB4b,IAAAA,WAAW,iBAAepb,MAAM,CAACqb,OADd;AAEnBC,IAAAA,YAAY,EAAEtb,MAAM,CAACub,UAFF;AAGnB1V,IAAAA,WAAW,EAAE7F,MAAM,CAACwb;AAHD,GAAD,CARP;AAabC,EAAAA,OAAO,eAAEjc,WAAG,CAAC;AACXC,IAAAA,OAAO,EAAE,cADE;AAEX6b,IAAAA,YAAY,EAAEtb,MAAM,CAAC8Y,QAFV;AAGX7V,IAAAA,KAAK,EAAE;AAHI,GAAD,CAbC;AAkBbyY,EAAAA,oBAAoB,eAAElc,WAAG,CAAC;AACxBmc,IAAAA,aAAa,EAAE,MADS;AAExB7a,IAAAA,UAAU,EAAEd,MAAM,CAACqa;AAFK,GAAD,CAlBZ;AAsBbuB,EAAAA,kBAAkB,eAAEpc,WAAG,CAAC;AACtBmc,IAAAA,aAAa,EAAE,SADO;AAEtB7a,IAAAA,UAAU,EAAEd,MAAM,CAACqa;AAFG,GAAD,CAtBV;AA0BbvF,EAAAA,MAAM,eAAEtV,WAAG,CAAC;AACVC,IAAAA,OAAO,EAAE,cADC;AAEVW,IAAAA,KAAK,EAAEJ,MAAM,CAACkZ,OAFJ;AAGV2C,IAAAA,WAAW,EAAE7b,MAAM,CAAC8Y,QAHV;AAIV7V,IAAAA,KAAK,EAAE;AAJG,GAAD,CA1BE;AAgCbqR,EAAAA,EAAE,eAAE9U,WAAG,CAAC;AACNO,IAAAA,QAAQ,EAAEC,MAAM,CAAC8b;AADX,GAAD,CAhCM;AAmCbtH,EAAAA,EAAE,eAAEhV,WAAG,CAAC;AACNO,IAAAA,QAAQ,EAAEC,MAAM,CAAC+b;AADX,GAAD,CAnCM;AAsCbtH,EAAAA,EAAE,eAAEjV,WAAG,CAAC;AACNO,IAAAA,QAAQ,EAAEC,MAAM,CAACgc;AADX,GAAD,CAtCM;AAyCbC,EAAAA,QAAQ,eAAEzc,WAAG,CAAC;AACZM,IAAAA,YAAY,EAAEE,MAAM,CAACqa,QADT;AAEZ5a,IAAAA,OAAO,EAAE,MAFG;AAGZyc,IAAAA,UAAU,EAAE,UAHA;AAIZhZ,IAAAA,MAAM,EAAElD,MAAM,CAACmc;AAJH,GAAD,CAzCA;AA+CbC,EAAAA,QAAQ,eAAE5c,WAAG,CAAC;AACZ2D,IAAAA,MAAM,EAAE;AADI,GAAD,CA/CA;AAkDbkZ,EAAAA,gBAAgB,eAAE7c,WAAG,CAAC;AACpBC,IAAAA,OAAO,EAAE,MADW;AAEpBwD,IAAAA,KAAK,EAAE,MAFa;AAGpBrD,IAAAA,cAAc,EAAE,QAHI;AAIpB8J,IAAAA,SAAS,EAAE1J,MAAM,CAACmc;AAJE,GAAD;AAlDR,CAAf;AA0DA,AAAO,IAAMG,qBAAqB,GAAG,SAAxBA,qBAAwB;AACnC,SACEva,4BAAA,CAACwa,0BAAD;AAAc5Z,IAAAA,MAAM,EAAC;GAArB,EACEZ,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACyb;GAAvB,EACEhZ,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAEC,UAAE,CAAC3C,QAAM,CAAC2b,UAAR,EAAoB3b,QAAM,CAAC6b,eAA3B;GAAlB,EACEpZ,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAAC2c;GAAvB,EACEla,4BAAA,CAACya,qBAAD;AAAS1c,IAAAA,YAAY,EAAC;AAAO8a,IAAAA,EAAE,EAAC;AAAK5Y,IAAAA,SAAS,EAAEC,UAAE,CAAC3C,QAAM,CAACmc,OAAR,EAAiBnc,QAAM,CAACgV,EAAxB;GAAlD,MAAA,CADF,EAIEvS,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACwV;GAAvB,aAAA,CAJF,CADF,EAOE/S,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAAC2c;GAAvB,EACEla,4BAAA,CAACya,qBAAD;AAAS1c,IAAAA,YAAY,EAAC;AAAO8a,IAAAA,EAAE,EAAC;AAAK5Y,IAAAA,SAAS,EAAEC,UAAE,CAAC3C,QAAM,CAACmc,OAAR,EAAiBnc,QAAM,CAACkV,EAAxB;GAAlD,MAAA,CADF,EAIEzS,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACwV;GAAvB,cAAA,CAJF,CAPF,EAaE/S,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAAC2c;GAAvB,EACEla,4BAAA,CAACya,qBAAD;AAAS1c,IAAAA,YAAY,EAAC;AAAO8a,IAAAA,EAAE,EAAC;AAAK5Y,IAAAA,SAAS,EAAEC,UAAE,CAAC3C,QAAM,CAACmc,OAAR,EAAiBnc,QAAM,CAACmV,EAAxB;GAAlD,MAAA,CADF,EAIE1S,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACwV;GAAvB,eAAA,CAJF,CAbF,EAmBE/S,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAAC2c;GAAvB,EACEla,4BAAA,SAAA;AAAQC,IAAAA,SAAS,EAAE1C,QAAM,CAACmc;GAA1B,QAAA,CADF,EAEE1Z,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACwV;GAAvB,YAAA,CAFF,CAnBF,EAuBE/S,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAAC2c;GAAvB,EACEla,4BAAA,KAAA;AAAIC,IAAAA,SAAS,EAAE1C,QAAM,CAACmc;GAAtB,UAAA,CADF,EAEE1Z,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACwV;GAAvB,UAAA,CAFF,CAvBF,EA2BE/S,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAAC2c;GAAvB,EACEla,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACmc;GAAvB,iBAAA,CADF,EAEE1Z,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACwV;GAAvB,YAAA,CAFF,CA3BF,EA+BE/S,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAAC2c;GAAvB,EACEla,4BAAA,CAAC4Y,sBAAD;AAAUC,IAAAA,EAAE,EAAC;AAAS5Y,IAAAA,SAAS,EAAE1C,QAAM,CAACmc;GAAxC,QAAA,CADF,EAIE1Z,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACwV;GAAvB,eAAA,CAJF,CA/BF,CADF,EAuCE/S,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAAC2b;GAAvB,EACElZ,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAAC2c;GAAvB,EACEla,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACmc;GAAvB,SAAA,CADF,EAEE1Z,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACwV;GAAvB,oBAAA,CAFF,CADF,EAKE/S,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAAC2c;GAAvB,EACEla,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACmc;GAAvB,kBAAA,CADF,EAEE1Z,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACwV;GAAvB,eAAA,CAFF,CALF,EASE/S,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAAC2c;GAAvB,EACEla,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACmc;GAAvB,EACE1Z,4BAAA,MAAA,MAAA,gBAAA,CADF,CADF,EAIEA,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACwV;GAAvB,gBAAA,CAJF,CATF,EAeE/S,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAAC2c;GAAvB,EACEla,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACmc;GAAvB,EACE1Z,4BAAA,MAAA,MAAA,cAAA,CADF,CADF,EAIEA,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACwV;GAAvB,WAAA,CAJF,CAfF,EAqBE/S,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAAC2c;GAAvB,EACEla,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACmc;GAAvB,aAAA,CADF,EAEE1Z,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACwV;GAAvB,eAAA,CAFF,CArBF,EAyBE/S,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAAC2c;GAAvB,EACEla,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACmc;GAAvB,cAAA,CADF,EAEE1Z,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACwV;GAAvB,mBAAA,CAFF,CAzBF,CAvCF,CADF,EAuEE/S,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAAC+c;GAAvB,EACEta,4BAAA,CAAC4Y,sBAAD;AACE3Y,IAAAA,SAAS,EAAE1C,QAAM,CAAC8c;AAClBK,IAAAA,IAAI,EAAC;AACLC,IAAAA,MAAM,EAAC;AACPC,IAAAA,GAAG,EAAC;GAJN,8EAAA,CADF,CAvEF,CADF;AAmFD,CApFM;AAsFP,AAAO,IAAMC,mBAAmB,GAAG,SAAtBA,mBAAsB,CAACC,OAAD;AACjC,SAAOA,OAAO,CAACC,WAAR,CAAoB;AACzBzH,IAAAA,KAAK,EAAE,0BADkB;AAEzBpS,IAAAA,KAAK,EAAE,OAFkB;AAGzB8W,IAAAA,SAAS,EAAE,OAHc;AAIzBgD,IAAAA,wBAAwB,EAAE,IAJD;AAKzBC,IAAAA,yBAAyB,EAAE,IALF;AAMzBC,IAAAA,UAAU,EAAE;AACVC,MAAAA,IAAI,EAAEpC,kBAAkB,CAACqC;AADf;AANa,GAApB,CAAP;AAUD,CAXM;;ACzJP;AACA;AACA,AAAO,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACC,MAAD;AAC9B,SAAOA,MAAM,CAAClG,OAAP,CAAe,0BAAf,EAA2C,UAAUtM,KAAV;AAChD,WAAOA,KAAK,CAACsM,OAAN,CAAc,QAAd,EAAwB,GAAxB,CAAP;AACD,GAFM,CAAP;AAGD,CAJM;;;;;ACQP,IAAM7X,QAAM,GAAG;AACbC,EAAAA,IAAI,eAAEC,WAAF,ywEACkBQ,MAAM,CAACU,OADzB,EAMSV,MAAM,CAAC8Y,QANhB,EAOW9Y,MAAM,CAACC,SAPlB,EAQaD,MAAM,CAACsd,gBARpB,EASatd,MAAM,CAAC6Y,iBATpB,EAUO7Y,MAAM,CAACK,OAVd,EAmBcL,MAAM,CAAC8Y,QAnBrB,EAoBiB9Y,MAAM,CAACud,QApBxB,EAqBSvd,MAAM,CAACgZ,OArBhB,EAsDiBhZ,MAAM,CAACud,QAtDxB,EA2DUvd,MAAM,CAACqa,QA3DjB,EA4DgBra,MAAM,CAACud,QA5DvB,EA6EUvd,MAAM,CAACud,QA7EjB,EAgFoBvd,MAAM,CAAC4B,OAhF3B,EA2Fc5B,MAAM,CAAC2B,OA3FrB,EA+FoB3B,MAAM,CAAC4B,OA/F3B,EAmGS5B,MAAM,CAACmZ,OAnGhB,EAuGcnZ,MAAM,CAAC8Y,QAvGrB,EAwGiB9Y,MAAM,CAAC8Y,QAxGxB,EA0GoB9Y,MAAM,CAAC4B,OA1G3B,EA+GyB5B,MAAM,CAAC2B,OA/GhC,EAgHgB3B,MAAM,CAAC8Y,QAhHvB,EAkHc9Y,MAAM,CAACud,QAlHrB,EAuHUvd,MAAM,CAACud,QAvHjB,EA8Havd,MAAM,CAACua,SA9HpB,EA+Heva,MAAM,CAAC+Y,kBA/HtB,EAmIU/Y,MAAM,CAACud,QAnIjB,CADS;AAwIbnE,EAAAA,MAAM,eAAE5Z,WAAG,CAAC;AACV0D,IAAAA,MAAM,EAAE,MADE;AAEVmW,IAAAA,SAAS,EAAE,OAFD;AAGVmE,IAAAA,SAAS,EAAE;AAHD,GAAD,CAxIE;AA6IblE,EAAAA,GAAG,eAAE9Z,WAAG,CAAC;AACP+Z,IAAAA,QAAQ,EAAE,OADH;AAEPpW,IAAAA,MAAM,EAAE,QAFD;AAGP1C,IAAAA,MAAM,EAAE;AAHD,GAAD,CA7IK;AAkJbgd,EAAAA,GAAG,eAAEje,WAAG,CAAC;AACP2L,IAAAA,SAAS,EAAE;AADJ,GAAD;AAlJK,CAAf;;AAkKA,SAASuS,YAAT,CAAsB5b,KAAtB;AAQE,MAAQ6b,OAAR,GAAuC7b,KAAvC,CAAQ6b,OAAR;AAAA,MAAiB/a,QAAjB,GAAuCd,KAAvC,CAAiBc,QAAjB;AAAA,MAA8BW,IAA9B,iCAAuCzB,KAAvC;;AAEA,MAAIA,KAAK,CAACE,SAAN,KAAoB,cAApB,IAAsC2b,OAA1C,EAAmD;AACjD,WAAO5b,4BAAA,CAAC4b,OAAD;AAASvI,MAAAA,GAAG,EAAEtT,KAAK,CAAC2a;KAApB,CAAP;AACD;;AAED,SACE1a,4BAAA,IAAA,eAAOwB,IAAP;AAAamZ,IAAAA,MAAM,EAAC,QAApB;AAA6BC,IAAAA,GAAG,EAAC;AAAjC,MACG/Z,QADH,CADF;AAKD;;AAED,IAAagb,eAAe,gBAAG7b,cAAK,CAAC+H,IAAN,CAAW,UAAChI,KAAD;;;AACxC,MAAME,SAAS,GAAGC,UAAE,CAClB3C,QAAM,CAACC,IADW,EAElBuC,KAAK,CAACiY,SAAN,KAAoBzI,SAApB,GAAgC9R,WAAG,CAAC;AAAEua,IAAAA,SAAS,EAAEjY,KAAK,CAACiY;AAAnB,GAAD,CAAnC,GAAsEzI,SAFpD,EAGlBxP,KAAK,CAACiF,IAAN,KAAe,SAAf,GAA2BzH,QAAM,CAAC8Z,MAAlC,GAA2C9Z,QAAM,CAACga,GAHhC,EAIlBxX,KAAK,CAACqJ,SAAN,KAAoB,KAApB,GAA4B7L,QAAM,CAACme,GAAnC,GAAyCnM,SAJvB,CAApB;AAQA;;AACA,MAAMuM,SAAS,GAAG9b,cAAK,CAAC+b,OAAN,CAAc;AAC9B,WAAOV,gBAAgB,CAACW,SAAS,CAACC,QAAV,CAAmBlc,KAAK,CAAC4I,KAAzB,CAAD,CAAvB;AACD,GAFiB,EAEf,CAAC5I,KAAK,CAAC4I,KAAP,CAFe,CAAlB;AAIA,SACE3I,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAEA;oBAAwB;GAAxC,EACED,4BAAA,CAACkc,QAAD;AACE/S,IAAAA,OAAO,EAAE;AACPgT,MAAAA,SAAS,EAAE;AACTC,QAAAA,CAAC,EAAE;AACD;AACAC,UAAAA,SAAS,EAAEV,YAFV;AAGD5b,UAAAA,KAAK,EAAE;AACL6b,YAAAA,OAAO,2BAAE7b,KAAK,CAACuc,iBAAR,qBAAE,sBAAyBC;AAD7B;AAHN;AADM;AADJ;GADX,EAYGT,SAZH,CADF,CADF;AAkBD,CAhC8B,CAAxB;AAkCPD,eAAe,CAAC/W,WAAhB,GAA8B,iBAA9B;;AC7NA,IAAMvH,QAAM,GAAG;AACbC,EAAAA,IAAI,eAAEC,WAAG,CAAC;AACRC,IAAAA,OAAO,EAAE,MADD;AAERG,IAAAA,cAAc,EAAE,eAFR;AAGRG,IAAAA,QAAQ,EAAEC,MAAM,CAACC,SAHT;AAIRyJ,IAAAA,SAAS,EAAE1J,MAAM,CAACO,SAJV;AAKRH,IAAAA,KAAK,EAAEJ,MAAM,CAACK;AALN,GAAD;AADI,CAAf;AAUA,SAAgBke,oBAAoBzc;AAClC,MAAM0c,WAAW,GAAGC,kCAAgB,CAACC,oBAAjB,CAClB5c,KAAK,CAAC6c,GAAN,CAAUC,KAAV,CAAgBC,WADE,EAElB/c,KAAK,CAAC6c,GAAN,CAAUC,KAAV,CAAgB1B,IAFE,CAApB;AAKA,MAAM4B,eAAe,GAAGL,kCAAgB,CAACM,WAAjB,CAA6BP,WAA7B,CAAxB;AAEA,SACEzc,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACC;GAAvB,EACEwC,4BAAA,CAACid,6BAAD;AAAatU,IAAAA,KAAK,EAAE5I,KAAK,CAAC4I;AAAOoU,IAAAA,eAAe,EAAEA;GAAlD,CADF,EAEE/c,4BAAA,CAACkd,gCAAD;AAAgBT,IAAAA,WAAW,EAAEA;GAA7B,CAFF,CADF;AAMD;;;;;;;AC9BD;AACA;AACA;AACA;AACA;AACA;AAEA,MAAIU,OAAO,GAAI,UAAUC,OAAV,EAAmB;AAChC;AAEA,QAAIC,EAAE,GAAGvF,MAAM,CAACwF,SAAhB;AACA,QAAIC,MAAM,GAAGF,EAAE,CAACG,cAAhB;AACA,QAAIjO,WAAJ,CALgC;;AAMhC,QAAIkO,OAAO,GAAG,OAAOC,MAAP,KAAkB,UAAlB,GAA+BA,MAA/B,GAAwC,EAAtD;AACA,QAAIC,cAAc,GAAGF,OAAO,CAACG,QAAR,IAAoB,YAAzC;AACA,QAAIC,mBAAmB,GAAGJ,OAAO,CAACK,aAAR,IAAyB,iBAAnD;AACA,QAAIC,iBAAiB,GAAGN,OAAO,CAACO,WAAR,IAAuB,eAA/C;;AAEA,aAASC,MAAT,CAAgBC,GAAhB,EAAqBpP,GAArB,EAA0BnG,KAA1B,EAAiC;AAC/BmP,MAAAA,MAAM,CAACqG,cAAP,CAAsBD,GAAtB,EAA2BpP,GAA3B,EAAgC;AAC9BnG,QAAAA,KAAK,EAAEA,KADuB;AAE9ByV,QAAAA,UAAU,EAAE,IAFkB;AAG9BC,QAAAA,YAAY,EAAE,IAHgB;AAI9BC,QAAAA,QAAQ,EAAE;AAJoB,OAAhC;AAMA,aAAOJ,GAAG,CAACpP,GAAD,CAAV;AACD;;AACD,QAAI;;AAEFmP,MAAAA,MAAM,CAAC,EAAD,EAAK,EAAL,CAAN;AACD,KAHD,CAGE,OAAOM,GAAP,EAAY;AACZN,MAAAA,MAAM,GAAG,gBAASC,GAAT,EAAcpP,GAAd,EAAmBnG,KAAnB,EAA0B;AACjC,eAAOuV,GAAG,CAACpP,GAAD,CAAH,GAAWnG,KAAlB;AACD,OAFD;AAGD;;AAED,aAAS6V,IAAT,CAAcC,OAAd,EAAuBC,OAAvB,EAAgCC,IAAhC,EAAsCC,WAAtC,EAAmD;;AAEjD,UAAIC,cAAc,GAAGH,OAAO,IAAIA,OAAO,CAACpB,SAAR,YAA6BwB,SAAxC,GAAoDJ,OAApD,GAA8DI,SAAnF;AACA,UAAIC,SAAS,GAAGjH,MAAM,CAAC7O,MAAP,CAAc4V,cAAc,CAACvB,SAA7B,CAAhB;AACA,UAAI0B,OAAO,GAAG,IAAIC,OAAJ,CAAYL,WAAW,IAAI,EAA3B,CAAd,CAJiD;;;AAQjDG,MAAAA,SAAS,CAACG,OAAV,GAAoBC,gBAAgB,CAACV,OAAD,EAAUE,IAAV,EAAgBK,OAAhB,CAApC;AAEA,aAAOD,SAAP;AACD;;AACD3B,IAAAA,OAAO,CAACoB,IAAR,GAAeA,IAAf,CAzCgC;;;;;;;;;;;AAqDhC,aAASY,QAAT,CAAkB5Q,EAAlB,EAAsB0P,GAAtB,EAA2BmB,GAA3B,EAAgC;AAC9B,UAAI;AACF,eAAO;AAAElE,UAAAA,IAAI,EAAE,QAAR;AAAkBkE,UAAAA,GAAG,EAAE7Q,EAAE,CAAC8Q,IAAH,CAAQpB,GAAR,EAAamB,GAAb;AAAvB,SAAP;AACD,OAFD,CAEE,OAAOd,GAAP,EAAY;AACZ,eAAO;AAAEpD,UAAAA,IAAI,EAAE,OAAR;AAAiBkE,UAAAA,GAAG,EAAEd;AAAtB,SAAP;AACD;AACF;;AAED,QAAIgB,sBAAsB,GAAG,gBAA7B;AACA,QAAIC,sBAAsB,GAAG,gBAA7B;AACA,QAAIC,iBAAiB,GAAG,WAAxB;AACA,QAAIC,iBAAiB,GAAG,WAAxB,CAhEgC;;;AAoEhC,QAAIC,gBAAgB,GAAG,EAAvB,CApEgC;;;;;AA0EhC,aAASb,SAAT,GAAqB;;AACrB,aAASc,iBAAT,GAA6B;;AAC7B,aAASC,0BAAT,GAAsC,EA5EN;;;;AAgFhC,QAAIC,iBAAiB,GAAG,EAAxB;AACA7B,IAAAA,MAAM,CAAC6B,iBAAD,EAAoBnC,cAApB,EAAoC,YAAY;AACpD,aAAO,IAAP;AACD,KAFK,CAAN;AAIA,QAAIoC,QAAQ,GAAGjI,MAAM,CAACkI,cAAtB;AACA,QAAIC,uBAAuB,GAAGF,QAAQ,IAAIA,QAAQ,CAACA,QAAQ,CAACG,MAAM,CAAC,EAAD,CAAP,CAAT,CAAlD;;AACA,QAAID,uBAAuB,IACvBA,uBAAuB,KAAK5C,EAD5B,IAEAE,MAAM,CAAC+B,IAAP,CAAYW,uBAAZ,EAAqCtC,cAArC,CAFJ,EAE0D;;;AAGxDmC,MAAAA,iBAAiB,GAAGG,uBAApB;AACD;;AAED,QAAIE,EAAE,GAAGN,0BAA0B,CAACvC,SAA3B,GACPwB,SAAS,CAACxB,SAAV,GAAsBxF,MAAM,CAAC7O,MAAP,CAAc6W,iBAAd,CADxB;AAEAF,IAAAA,iBAAiB,CAACtC,SAAlB,GAA8BuC,0BAA9B;AACA5B,IAAAA,MAAM,CAACkC,EAAD,EAAK,aAAL,EAAoBN,0BAApB,CAAN;AACA5B,IAAAA,MAAM,CAAC4B,0BAAD,EAA6B,aAA7B,EAA4CD,iBAA5C,CAAN;AACAA,IAAAA,iBAAiB,CAAC9a,WAAlB,GAAgCmZ,MAAM,CACpC4B,0BADoC,EAEpC9B,iBAFoC,EAGpC,mBAHoC,CAAtC,CApGgC;;;AA4GhC,aAASqC,qBAAT,CAA+B9C,SAA/B,EAA0C;AACxC,OAAC,MAAD,EAAS,OAAT,EAAkB,QAAlB,EAA4BlJ,OAA5B,CAAoC,UAASiM,MAAT,EAAiB;AACnDpC,QAAAA,MAAM,CAACX,SAAD,EAAY+C,MAAZ,EAAoB,UAAShB,GAAT,EAAc;AACtC,iBAAO,KAAKH,OAAL,CAAamB,MAAb,EAAqBhB,GAArB,CAAP;AACD,SAFK,CAAN;AAGD,OAJD;AAKD;;AAEDjC,IAAAA,OAAO,CAACkD,mBAAR,GAA8B,UAASC,MAAT,EAAiB;AAC7C,UAAIC,IAAI,GAAG,OAAOD,MAAP,KAAkB,UAAlB,IAAgCA,MAAM,CAACE,WAAlD;AACA,aAAOD,IAAI,GACPA,IAAI,KAAKZ,iBAAT;;AAGA,OAACY,IAAI,CAAC1b,WAAL,IAAoB0b,IAAI,CAAClgB,IAA1B,MAAoC,mBAJ7B,GAKP,KALJ;AAMD,KARD;;AAUA8c,IAAAA,OAAO,CAACsD,IAAR,GAAe,UAASH,MAAT,EAAiB;AAC9B,UAAIzI,MAAM,CAAC6I,cAAX,EAA2B;AACzB7I,QAAAA,MAAM,CAAC6I,cAAP,CAAsBJ,MAAtB,EAA8BV,0BAA9B;AACD,OAFD,MAEO;AACLU,QAAAA,MAAM,CAACK,SAAP,GAAmBf,0BAAnB;AACA5B,QAAAA,MAAM,CAACsC,MAAD,EAASxC,iBAAT,EAA4B,mBAA5B,CAAN;AACD;;AACDwC,MAAAA,MAAM,CAACjD,SAAP,GAAmBxF,MAAM,CAAC7O,MAAP,CAAckX,EAAd,CAAnB;AACA,aAAOI,MAAP;AACD,KATD,CA9HgC;;;;;;AA6IhCnD,IAAAA,OAAO,CAACyD,KAAR,GAAgB,UAASxB,GAAT,EAAc;AAC5B,aAAO;AAAEyB,QAAAA,OAAO,EAAEzB;AAAX,OAAP;AACD,KAFD;;AAIA,aAAS0B,aAAT,CAAuBhC,SAAvB,EAAkCiC,WAAlC,EAA+C;AAC7C,eAASC,MAAT,CAAgBZ,MAAhB,EAAwBhB,GAAxB,EAA6B6B,OAA7B,EAAsCC,MAAtC,EAA8C;AAC5C,YAAIC,MAAM,GAAGhC,QAAQ,CAACL,SAAS,CAACsB,MAAD,CAAV,EAAoBtB,SAApB,EAA+BM,GAA/B,CAArB;;AACA,YAAI+B,MAAM,CAACjG,IAAP,KAAgB,OAApB,EAA6B;AAC3BgG,UAAAA,MAAM,CAACC,MAAM,CAAC/B,GAAR,CAAN;AACD,SAFD,MAEO;AACL,cAAI3K,MAAM,GAAG0M,MAAM,CAAC/B,GAApB;AACA,cAAI1W,KAAK,GAAG+L,MAAM,CAAC/L,KAAnB;;AACA,cAAIA,KAAK,IACL,OAAOA,KAAP,KAAiB,QADjB,IAEA4U,MAAM,CAAC+B,IAAP,CAAY3W,KAAZ,EAAmB,SAAnB,CAFJ,EAEmC;AACjC,mBAAOqY,WAAW,CAACE,OAAZ,CAAoBvY,KAAK,CAACmY,OAA1B,EAAmCO,IAAnC,CAAwC,UAAS1Y,KAAT,EAAgB;AAC7DsY,cAAAA,MAAM,CAAC,MAAD,EAAStY,KAAT,EAAgBuY,OAAhB,EAAyBC,MAAzB,CAAN;AACD,aAFM,EAEJ,UAAS5C,GAAT,EAAc;AACf0C,cAAAA,MAAM,CAAC,OAAD,EAAU1C,GAAV,EAAe2C,OAAf,EAAwBC,MAAxB,CAAN;AACD,aAJM,CAAP;AAKD;;AAED,iBAAOH,WAAW,CAACE,OAAZ,CAAoBvY,KAApB,EAA2B0Y,IAA3B,CAAgC,UAASC,SAAT,EAAoB;;;;AAIzD5M,YAAAA,MAAM,CAAC/L,KAAP,GAAe2Y,SAAf;AACAJ,YAAAA,OAAO,CAACxM,MAAD,CAAP;AACD,WANM,EAMJ,UAAS6M,KAAT,EAAgB;;;AAGjB,mBAAON,MAAM,CAAC,OAAD,EAAUM,KAAV,EAAiBL,OAAjB,EAA0BC,MAA1B,CAAb;AACD,WAVM,CAAP;AAWD;AACF;;AAED,UAAIK,eAAJ;;AAEA,eAASC,OAAT,CAAiBpB,MAAjB,EAAyBhB,GAAzB,EAA8B;AAC5B,iBAASqC,0BAAT,GAAsC;AACpC,iBAAO,IAAIV,WAAJ,CAAgB,UAASE,OAAT,EAAkBC,MAAlB,EAA0B;AAC/CF,YAAAA,MAAM,CAACZ,MAAD,EAAShB,GAAT,EAAc6B,OAAd,EAAuBC,MAAvB,CAAN;AACD,WAFM,CAAP;AAGD;;AAED,eAAOK,eAAe;;;;;;;;;;;;AAapBA,QAAAA,eAAe,GAAGA,eAAe,CAACH,IAAhB,CAChBK,0BADgB;;AAIhBA,QAAAA,0BAJgB,CAAH,GAKXA,0BAA0B,EAlBhC;AAmBD,OA5D4C;;;;AAgE7C,WAAKxC,OAAL,GAAeuC,OAAf;AACD;;AAEDrB,IAAAA,qBAAqB,CAACW,aAAa,CAACzD,SAAf,CAArB;AACAW,IAAAA,MAAM,CAAC8C,aAAa,CAACzD,SAAf,EAA0BO,mBAA1B,EAA+C,YAAY;AAC/D,aAAO,IAAP;AACD,KAFK,CAAN;AAGAT,IAAAA,OAAO,CAAC2D,aAAR,GAAwBA,aAAxB,CAxNgC;;;;AA6NhC3D,IAAAA,OAAO,CAACuE,KAAR,GAAgB,UAASlD,OAAT,EAAkBC,OAAlB,EAA2BC,IAA3B,EAAiCC,WAAjC,EAA8CoC,WAA9C,EAA2D;AACzE,UAAIA,WAAW,KAAK,KAAK,CAAzB,EAA4BA,WAAW,GAAGY,OAAd;AAE5B,UAAIC,IAAI,GAAG,IAAId,aAAJ,CACTvC,IAAI,CAACC,OAAD,EAAUC,OAAV,EAAmBC,IAAnB,EAAyBC,WAAzB,CADK,EAEToC,WAFS,CAAX;AAKA,aAAO5D,OAAO,CAACkD,mBAAR,CAA4B5B,OAA5B,IACHmD,IADG;AAAA,QAEHA,IAAI,CAACtT,IAAL,GAAY8S,IAAZ,CAAiB,UAAS3M,MAAT,EAAiB;AAChC,eAAOA,MAAM,CAACoN,IAAP,GAAcpN,MAAM,CAAC/L,KAArB,GAA6BkZ,IAAI,CAACtT,IAAL,EAApC;AACD,OAFD,CAFJ;AAKD,KAbD;;AAeA,aAAS4Q,gBAAT,CAA0BV,OAA1B,EAAmCE,IAAnC,EAAyCK,OAAzC,EAAkD;AAChD,UAAI+C,KAAK,GAAGxC,sBAAZ;AAEA,aAAO,SAAS0B,MAAT,CAAgBZ,MAAhB,EAAwBhB,GAAxB,EAA6B;AAClC,YAAI0C,KAAK,KAAKtC,iBAAd,EAAiC;AAC/B,gBAAM,IAAI1W,KAAJ,CAAU,8BAAV,CAAN;AACD;;AAED,YAAIgZ,KAAK,KAAKrC,iBAAd,EAAiC;AAC/B,cAAIW,MAAM,KAAK,OAAf,EAAwB;AACtB,kBAAMhB,GAAN;AACD,WAH8B;;;;AAO/B,iBAAO2C,UAAU,EAAjB;AACD;;AAEDhD,QAAAA,OAAO,CAACqB,MAAR,GAAiBA,MAAjB;AACArB,QAAAA,OAAO,CAACK,GAAR,GAAcA,GAAd;;AAEA,eAAO,IAAP,EAAa;AACX,cAAI4C,QAAQ,GAAGjD,OAAO,CAACiD,QAAvB;;AACA,cAAIA,QAAJ,EAAc;AACZ,gBAAIC,cAAc,GAAGC,mBAAmB,CAACF,QAAD,EAAWjD,OAAX,CAAxC;;AACA,gBAAIkD,cAAJ,EAAoB;AAClB,kBAAIA,cAAc,KAAKvC,gBAAvB,EAAyC;AACzC,qBAAOuC,cAAP;AACD;AACF;;AAED,cAAIlD,OAAO,CAACqB,MAAR,KAAmB,MAAvB,EAA+B;;;AAG7BrB,YAAAA,OAAO,CAACoD,IAAR,GAAepD,OAAO,CAACqD,KAAR,GAAgBrD,OAAO,CAACK,GAAvC;AAED,WALD,MAKO,IAAIL,OAAO,CAACqB,MAAR,KAAmB,OAAvB,EAAgC;AACrC,gBAAI0B,KAAK,KAAKxC,sBAAd,EAAsC;AACpCwC,cAAAA,KAAK,GAAGrC,iBAAR;AACA,oBAAMV,OAAO,CAACK,GAAd;AACD;;AAEDL,YAAAA,OAAO,CAACsD,iBAAR,CAA0BtD,OAAO,CAACK,GAAlC;AAED,WARM,MAQA,IAAIL,OAAO,CAACqB,MAAR,KAAmB,QAAvB,EAAiC;AACtCrB,YAAAA,OAAO,CAACuD,MAAR,CAAe,QAAf,EAAyBvD,OAAO,CAACK,GAAjC;AACD;;AAED0C,UAAAA,KAAK,GAAGtC,iBAAR;AAEA,cAAI2B,MAAM,GAAGhC,QAAQ,CAACX,OAAD,EAAUE,IAAV,EAAgBK,OAAhB,CAArB;;AACA,cAAIoC,MAAM,CAACjG,IAAP,KAAgB,QAApB,EAA8B;;;AAG5B4G,YAAAA,KAAK,GAAG/C,OAAO,CAAC8C,IAAR,GACJpC,iBADI,GAEJF,sBAFJ;;AAIA,gBAAI4B,MAAM,CAAC/B,GAAP,KAAeM,gBAAnB,EAAqC;AACnC;AACD;;AAED,mBAAO;AACLhX,cAAAA,KAAK,EAAEyY,MAAM,CAAC/B,GADT;AAELyC,cAAAA,IAAI,EAAE9C,OAAO,CAAC8C;AAFT,aAAP;AAKD,WAhBD,MAgBO,IAAIV,MAAM,CAACjG,IAAP,KAAgB,OAApB,EAA6B;AAClC4G,YAAAA,KAAK,GAAGrC,iBAAR,CADkC;;;AAIlCV,YAAAA,OAAO,CAACqB,MAAR,GAAiB,OAAjB;AACArB,YAAAA,OAAO,CAACK,GAAR,GAAc+B,MAAM,CAAC/B,GAArB;AACD;AACF;AACF,OAxED;AAyED,KAxT+B;;;;;;AA8ThC,aAAS8C,mBAAT,CAA6BF,QAA7B,EAAuCjD,OAAvC,EAAgD;AAC9C,UAAIqB,MAAM,GAAG4B,QAAQ,CAACrE,QAAT,CAAkBoB,OAAO,CAACqB,MAA1B,CAAb;;AACA,UAAIA,MAAM,KAAK9Q,WAAf,EAA0B;;;AAGxByP,QAAAA,OAAO,CAACiD,QAAR,GAAmB,IAAnB;;AAEA,YAAIjD,OAAO,CAACqB,MAAR,KAAmB,OAAvB,EAAgC;;AAE9B,cAAI4B,QAAQ,CAACrE,QAAT,CAAkB,QAAlB,CAAJ,EAAiC;;;AAG/BoB,YAAAA,OAAO,CAACqB,MAAR,GAAiB,QAAjB;AACArB,YAAAA,OAAO,CAACK,GAAR,GAAc9P,WAAd;AACA4S,YAAAA,mBAAmB,CAACF,QAAD,EAAWjD,OAAX,CAAnB;;AAEA,gBAAIA,OAAO,CAACqB,MAAR,KAAmB,OAAvB,EAAgC;;;AAG9B,qBAAOV,gBAAP;AACD;AACF;;AAEDX,UAAAA,OAAO,CAACqB,MAAR,GAAiB,OAAjB;AACArB,UAAAA,OAAO,CAACK,GAAR,GAAc,IAAImD,SAAJ,CACZ,gDADY,CAAd;AAED;;AAED,eAAO7C,gBAAP;AACD;;AAED,UAAIyB,MAAM,GAAGhC,QAAQ,CAACiB,MAAD,EAAS4B,QAAQ,CAACrE,QAAlB,EAA4BoB,OAAO,CAACK,GAApC,CAArB;;AAEA,UAAI+B,MAAM,CAACjG,IAAP,KAAgB,OAApB,EAA6B;AAC3B6D,QAAAA,OAAO,CAACqB,MAAR,GAAiB,OAAjB;AACArB,QAAAA,OAAO,CAACK,GAAR,GAAc+B,MAAM,CAAC/B,GAArB;AACAL,QAAAA,OAAO,CAACiD,QAAR,GAAmB,IAAnB;AACA,eAAOtC,gBAAP;AACD;;AAED,UAAI8C,IAAI,GAAGrB,MAAM,CAAC/B,GAAlB;;AAEA,UAAI,CAAEoD,IAAN,EAAY;AACVzD,QAAAA,OAAO,CAACqB,MAAR,GAAiB,OAAjB;AACArB,QAAAA,OAAO,CAACK,GAAR,GAAc,IAAImD,SAAJ,CAAc,kCAAd,CAAd;AACAxD,QAAAA,OAAO,CAACiD,QAAR,GAAmB,IAAnB;AACA,eAAOtC,gBAAP;AACD;;AAED,UAAI8C,IAAI,CAACX,IAAT,EAAe;;;AAGb9C,QAAAA,OAAO,CAACiD,QAAQ,CAACS,UAAV,CAAP,GAA+BD,IAAI,CAAC9Z,KAApC,CAHa;;AAMbqW,QAAAA,OAAO,CAACzQ,IAAR,GAAe0T,QAAQ,CAACU,OAAxB,CANa;;;;;;;AAcb,YAAI3D,OAAO,CAACqB,MAAR,KAAmB,QAAvB,EAAiC;AAC/BrB,UAAAA,OAAO,CAACqB,MAAR,GAAiB,MAAjB;AACArB,UAAAA,OAAO,CAACK,GAAR,GAAc9P,WAAd;AACD;AAEF,OAnBD,MAmBO;;AAEL,eAAOkT,IAAP;AACD,OAvE6C;;;;AA2E9CzD,MAAAA,OAAO,CAACiD,QAAR,GAAmB,IAAnB;AACA,aAAOtC,gBAAP;AACD,KA3Y+B;;;;AA+YhCS,IAAAA,qBAAqB,CAACD,EAAD,CAArB;AAEAlC,IAAAA,MAAM,CAACkC,EAAD,EAAKpC,iBAAL,EAAwB,WAAxB,CAAN,CAjZgC;;;;;;AAwZhCE,IAAAA,MAAM,CAACkC,EAAD,EAAKxC,cAAL,EAAqB,YAAW;AACpC,aAAO,IAAP;AACD,KAFK,CAAN;AAIAM,IAAAA,MAAM,CAACkC,EAAD,EAAK,UAAL,EAAiB,YAAW;AAChC,aAAO,oBAAP;AACD,KAFK,CAAN;;AAIA,aAASyC,YAAT,CAAsBC,IAAtB,EAA4B;AAC1B,UAAIC,KAAK,GAAG;AAAEC,QAAAA,MAAM,EAAEF,IAAI,CAAC,CAAD;AAAd,OAAZ;;AAEA,UAAI,KAAKA,IAAT,EAAe;AACbC,QAAAA,KAAK,CAACE,QAAN,GAAiBH,IAAI,CAAC,CAAD,CAArB;AACD;;AAED,UAAI,KAAKA,IAAT,EAAe;AACbC,QAAAA,KAAK,CAACG,UAAN,GAAmBJ,IAAI,CAAC,CAAD,CAAvB;AACAC,QAAAA,KAAK,CAACI,QAAN,GAAiBL,IAAI,CAAC,CAAD,CAArB;AACD;;AAED,WAAKM,UAAL,CAAgBC,IAAhB,CAAqBN,KAArB;AACD;;AAED,aAASO,aAAT,CAAuBP,KAAvB,EAA8B;AAC5B,UAAI1B,MAAM,GAAG0B,KAAK,CAACQ,UAAN,IAAoB,EAAjC;AACAlC,MAAAA,MAAM,CAACjG,IAAP,GAAc,QAAd;AACA,aAAOiG,MAAM,CAAC/B,GAAd;AACAyD,MAAAA,KAAK,CAACQ,UAAN,GAAmBlC,MAAnB;AACD;;AAED,aAASnC,OAAT,CAAiBL,WAAjB,EAA8B;;;;AAI5B,WAAKuE,UAAL,GAAkB,CAAC;AAAEJ,QAAAA,MAAM,EAAE;AAAV,OAAD,CAAlB;AACAnE,MAAAA,WAAW,CAACxK,OAAZ,CAAoBwO,YAApB,EAAkC,IAAlC;AACA,WAAKW,KAAL,CAAW,IAAX;AACD;;AAEDnG,IAAAA,OAAO,CAACoG,IAAR,GAAe,UAASC,MAAT,EAAiB;AAC9B,UAAID,IAAI,GAAG,EAAX;;AACA,WAAK,IAAI1U,GAAT,IAAgB2U,MAAhB,EAAwB;AACtBD,QAAAA,IAAI,CAACJ,IAAL,CAAUtU,GAAV;AACD;;AACD0U,MAAAA,IAAI,CAACE,OAAL,GAL8B;;;AAS9B,aAAO,SAASnV,IAAT,GAAgB;AACrB,eAAOiV,IAAI,CAACpT,MAAZ,EAAoB;AAClB,cAAItB,GAAG,GAAG0U,IAAI,CAACG,GAAL,EAAV;;AACA,cAAI7U,GAAG,IAAI2U,MAAX,EAAmB;AACjBlV,YAAAA,IAAI,CAAC5F,KAAL,GAAamG,GAAb;AACAP,YAAAA,IAAI,CAACuT,IAAL,GAAY,KAAZ;AACA,mBAAOvT,IAAP;AACD;AACF,SARoB;;;;;AAarBA,QAAAA,IAAI,CAACuT,IAAL,GAAY,IAAZ;AACA,eAAOvT,IAAP;AACD,OAfD;AAgBD,KAzBD;;AA2BA,aAAS2R,MAAT,CAAgB0D,QAAhB,EAA0B;AACxB,UAAIA,QAAJ,EAAc;AACZ,YAAIC,cAAc,GAAGD,QAAQ,CAACjG,cAAD,CAA7B;;AACA,YAAIkG,cAAJ,EAAoB;AAClB,iBAAOA,cAAc,CAACvE,IAAf,CAAoBsE,QAApB,CAAP;AACD;;AAED,YAAI,OAAOA,QAAQ,CAACrV,IAAhB,KAAyB,UAA7B,EAAyC;AACvC,iBAAOqV,QAAP;AACD;;AAED,YAAI,CAACE,KAAK,CAACF,QAAQ,CAACxT,MAAV,CAAV,EAA6B;AAC3B,cAAIiE,CAAC,GAAG,CAAC,CAAT;AAAA,cAAY9F,IAAI,GAAG,SAASA,IAAT,GAAgB;AACjC,mBAAO,EAAE8F,CAAF,GAAMuP,QAAQ,CAACxT,MAAtB,EAA8B;AAC5B,kBAAImN,MAAM,CAAC+B,IAAP,CAAYsE,QAAZ,EAAsBvP,CAAtB,CAAJ,EAA8B;AAC5B9F,gBAAAA,IAAI,CAAC5F,KAAL,GAAaib,QAAQ,CAACvP,CAAD,CAArB;AACA9F,gBAAAA,IAAI,CAACuT,IAAL,GAAY,KAAZ;AACA,uBAAOvT,IAAP;AACD;AACF;;AAEDA,YAAAA,IAAI,CAAC5F,KAAL,GAAa4G,WAAb;AACAhB,YAAAA,IAAI,CAACuT,IAAL,GAAY,IAAZ;AAEA,mBAAOvT,IAAP;AACD,WAbD;;AAeA,iBAAOA,IAAI,CAACA,IAAL,GAAYA,IAAnB;AACD;AACF,OA7BuB;;;AAgCxB,aAAO;AAAEA,QAAAA,IAAI,EAAEyT;AAAR,OAAP;AACD;;AACD5E,IAAAA,OAAO,CAAC8C,MAAR,GAAiBA,MAAjB;;AAEA,aAAS8B,UAAT,GAAsB;AACpB,aAAO;AAAErZ,QAAAA,KAAK,EAAE4G,WAAT;AAAoBuS,QAAAA,IAAI,EAAE;AAA1B,OAAP;AACD;;AAED7C,IAAAA,OAAO,CAAC3B,SAAR,GAAoB;AAClBmD,MAAAA,WAAW,EAAExB,OADK;AAGlBsE,MAAAA,KAAK,EAAE,eAASQ,aAAT,EAAwB;AAC7B,aAAKC,IAAL,GAAY,CAAZ;AACA,aAAKzV,IAAL,GAAY,CAAZ,CAF6B;;;AAK7B,aAAK6T,IAAL,GAAY,KAAKC,KAAL,GAAa9S,WAAzB;AACA,aAAKuS,IAAL,GAAY,KAAZ;AACA,aAAKG,QAAL,GAAgB,IAAhB;AAEA,aAAK5B,MAAL,GAAc,MAAd;AACA,aAAKhB,GAAL,GAAW9P,WAAX;AAEA,aAAK4T,UAAL,CAAgB/O,OAAhB,CAAwBiP,aAAxB;;AAEA,YAAI,CAACU,aAAL,EAAoB;AAClB,eAAK,IAAIzjB,IAAT,IAAiB,IAAjB,EAAuB;;AAErB,gBAAIA,IAAI,CAAC2jB,MAAL,CAAY,CAAZ,MAAmB,GAAnB,IACA1G,MAAM,CAAC+B,IAAP,CAAY,IAAZ,EAAkBhf,IAAlB,CADA,IAEA,CAACwjB,KAAK,CAAC,CAACxjB,IAAI,CAAC2R,KAAL,CAAW,CAAX,CAAF,CAFV,EAE4B;AAC1B,mBAAK3R,IAAL,IAAaiP,WAAb;AACD;AACF;AACF;AACF,OA3BiB;AA6BlB2U,MAAAA,IAAI,EAAE,gBAAW;AACf,aAAKpC,IAAL,GAAY,IAAZ;AAEA,YAAIqC,SAAS,GAAG,KAAKhB,UAAL,CAAgB,CAAhB,CAAhB;AACA,YAAIiB,UAAU,GAAGD,SAAS,CAACb,UAA3B;;AACA,YAAIc,UAAU,CAACjJ,IAAX,KAAoB,OAAxB,EAAiC;AAC/B,gBAAMiJ,UAAU,CAAC/E,GAAjB;AACD;;AAED,eAAO,KAAKgF,IAAZ;AACD,OAvCiB;AAyClB/B,MAAAA,iBAAiB,EAAE,2BAASgC,SAAT,EAAoB;AACrC,YAAI,KAAKxC,IAAT,EAAe;AACb,gBAAMwC,SAAN;AACD;;AAED,YAAItF,OAAO,GAAG,IAAd;;AACA,iBAASuF,MAAT,CAAgBC,GAAhB,EAAqBC,MAArB,EAA6B;AAC3BrD,UAAAA,MAAM,CAACjG,IAAP,GAAc,OAAd;AACAiG,UAAAA,MAAM,CAAC/B,GAAP,GAAaiF,SAAb;AACAtF,UAAAA,OAAO,CAACzQ,IAAR,GAAeiW,GAAf;;AAEA,cAAIC,MAAJ,EAAY;;;AAGVzF,YAAAA,OAAO,CAACqB,MAAR,GAAiB,MAAjB;AACArB,YAAAA,OAAO,CAACK,GAAR,GAAc9P,WAAd;AACD;;AAED,iBAAO,CAAC,CAAEkV,MAAV;AACD;;AAED,aAAK,IAAIpQ,CAAC,GAAG,KAAK8O,UAAL,CAAgB/S,MAAhB,GAAyB,CAAtC,EAAyCiE,CAAC,IAAI,CAA9C,EAAiD,EAAEA,CAAnD,EAAsD;AACpD,cAAIyO,KAAK,GAAG,KAAKK,UAAL,CAAgB9O,CAAhB,CAAZ;AACA,cAAI+M,MAAM,GAAG0B,KAAK,CAACQ,UAAnB;;AAEA,cAAIR,KAAK,CAACC,MAAN,KAAiB,MAArB,EAA6B;;;;AAI3B,mBAAOwB,MAAM,CAAC,KAAD,CAAb;AACD;;AAED,cAAIzB,KAAK,CAACC,MAAN,IAAgB,KAAKiB,IAAzB,EAA+B;AAC7B,gBAAIU,QAAQ,GAAGnH,MAAM,CAAC+B,IAAP,CAAYwD,KAAZ,EAAmB,UAAnB,CAAf;AACA,gBAAI6B,UAAU,GAAGpH,MAAM,CAAC+B,IAAP,CAAYwD,KAAZ,EAAmB,YAAnB,CAAjB;;AAEA,gBAAI4B,QAAQ,IAAIC,UAAhB,EAA4B;AAC1B,kBAAI,KAAKX,IAAL,GAAYlB,KAAK,CAACE,QAAtB,EAAgC;AAC9B,uBAAOuB,MAAM,CAACzB,KAAK,CAACE,QAAP,EAAiB,IAAjB,CAAb;AACD,eAFD,MAEO,IAAI,KAAKgB,IAAL,GAAYlB,KAAK,CAACG,UAAtB,EAAkC;AACvC,uBAAOsB,MAAM,CAACzB,KAAK,CAACG,UAAP,CAAb;AACD;AAEF,aAPD,MAOO,IAAIyB,QAAJ,EAAc;AACnB,kBAAI,KAAKV,IAAL,GAAYlB,KAAK,CAACE,QAAtB,EAAgC;AAC9B,uBAAOuB,MAAM,CAACzB,KAAK,CAACE,QAAP,EAAiB,IAAjB,CAAb;AACD;AAEF,aALM,MAKA,IAAI2B,UAAJ,EAAgB;AACrB,kBAAI,KAAKX,IAAL,GAAYlB,KAAK,CAACG,UAAtB,EAAkC;AAChC,uBAAOsB,MAAM,CAACzB,KAAK,CAACG,UAAP,CAAb;AACD;AAEF,aALM,MAKA;AACL,oBAAM,IAAIla,KAAJ,CAAU,wCAAV,CAAN;AACD;AACF;AACF;AACF,OAnGiB;AAqGlBwZ,MAAAA,MAAM,EAAE,gBAASpH,IAAT,EAAekE,GAAf,EAAoB;AAC1B,aAAK,IAAIhL,CAAC,GAAG,KAAK8O,UAAL,CAAgB/S,MAAhB,GAAyB,CAAtC,EAAyCiE,CAAC,IAAI,CAA9C,EAAiD,EAAEA,CAAnD,EAAsD;AACpD,cAAIyO,KAAK,GAAG,KAAKK,UAAL,CAAgB9O,CAAhB,CAAZ;;AACA,cAAIyO,KAAK,CAACC,MAAN,IAAgB,KAAKiB,IAArB,IACAzG,MAAM,CAAC+B,IAAP,CAAYwD,KAAZ,EAAmB,YAAnB,CADA,IAEA,KAAKkB,IAAL,GAAYlB,KAAK,CAACG,UAFtB,EAEkC;AAChC,gBAAI2B,YAAY,GAAG9B,KAAnB;AACA;AACD;AACF;;AAED,YAAI8B,YAAY,KACXzJ,IAAI,KAAK,OAAT,IACAA,IAAI,KAAK,UAFE,CAAZ,IAGAyJ,YAAY,CAAC7B,MAAb,IAAuB1D,GAHvB,IAIAA,GAAG,IAAIuF,YAAY,CAAC3B,UAJxB,EAIoC;;;AAGlC2B,UAAAA,YAAY,GAAG,IAAf;AACD;;AAED,YAAIxD,MAAM,GAAGwD,YAAY,GAAGA,YAAY,CAACtB,UAAhB,GAA6B,EAAtD;AACAlC,QAAAA,MAAM,CAACjG,IAAP,GAAcA,IAAd;AACAiG,QAAAA,MAAM,CAAC/B,GAAP,GAAaA,GAAb;;AAEA,YAAIuF,YAAJ,EAAkB;AAChB,eAAKvE,MAAL,GAAc,MAAd;AACA,eAAK9R,IAAL,GAAYqW,YAAY,CAAC3B,UAAzB;AACA,iBAAOtD,gBAAP;AACD;;AAED,eAAO,KAAKkF,QAAL,CAAczD,MAAd,CAAP;AACD,OArIiB;AAuIlByD,MAAAA,QAAQ,EAAE,kBAASzD,MAAT,EAAiB8B,QAAjB,EAA2B;AACnC,YAAI9B,MAAM,CAACjG,IAAP,KAAgB,OAApB,EAA6B;AAC3B,gBAAMiG,MAAM,CAAC/B,GAAb;AACD;;AAED,YAAI+B,MAAM,CAACjG,IAAP,KAAgB,OAAhB,IACAiG,MAAM,CAACjG,IAAP,KAAgB,UADpB,EACgC;AAC9B,eAAK5M,IAAL,GAAY6S,MAAM,CAAC/B,GAAnB;AACD,SAHD,MAGO,IAAI+B,MAAM,CAACjG,IAAP,KAAgB,QAApB,EAA8B;AACnC,eAAKkJ,IAAL,GAAY,KAAKhF,GAAL,GAAW+B,MAAM,CAAC/B,GAA9B;AACA,eAAKgB,MAAL,GAAc,QAAd;AACA,eAAK9R,IAAL,GAAY,KAAZ;AACD,SAJM,MAIA,IAAI6S,MAAM,CAACjG,IAAP,KAAgB,QAAhB,IAA4B+H,QAAhC,EAA0C;AAC/C,eAAK3U,IAAL,GAAY2U,QAAZ;AACD;;AAED,eAAOvD,gBAAP;AACD,OAxJiB;AA0JlBmF,MAAAA,MAAM,EAAE,gBAAS7B,UAAT,EAAqB;AAC3B,aAAK,IAAI5O,CAAC,GAAG,KAAK8O,UAAL,CAAgB/S,MAAhB,GAAyB,CAAtC,EAAyCiE,CAAC,IAAI,CAA9C,EAAiD,EAAEA,CAAnD,EAAsD;AACpD,cAAIyO,KAAK,GAAG,KAAKK,UAAL,CAAgB9O,CAAhB,CAAZ;;AACA,cAAIyO,KAAK,CAACG,UAAN,KAAqBA,UAAzB,EAAqC;AACnC,iBAAK4B,QAAL,CAAc/B,KAAK,CAACQ,UAApB,EAAgCR,KAAK,CAACI,QAAtC;AACAG,YAAAA,aAAa,CAACP,KAAD,CAAb;AACA,mBAAOnD,gBAAP;AACD;AACF;AACF,OAnKiB;AAqKlB,eAAS,gBAASoD,MAAT,EAAiB;AACxB,aAAK,IAAI1O,CAAC,GAAG,KAAK8O,UAAL,CAAgB/S,MAAhB,GAAyB,CAAtC,EAAyCiE,CAAC,IAAI,CAA9C,EAAiD,EAAEA,CAAnD,EAAsD;AACpD,cAAIyO,KAAK,GAAG,KAAKK,UAAL,CAAgB9O,CAAhB,CAAZ;;AACA,cAAIyO,KAAK,CAACC,MAAN,KAAiBA,MAArB,EAA6B;AAC3B,gBAAI3B,MAAM,GAAG0B,KAAK,CAACQ,UAAnB;;AACA,gBAAIlC,MAAM,CAACjG,IAAP,KAAgB,OAApB,EAA6B;AAC3B,kBAAI4J,MAAM,GAAG3D,MAAM,CAAC/B,GAApB;AACAgE,cAAAA,aAAa,CAACP,KAAD,CAAb;AACD;;AACD,mBAAOiC,MAAP;AACD;AACF,SAXuB;;;;AAexB,cAAM,IAAIhc,KAAJ,CAAU,uBAAV,CAAN;AACD,OArLiB;AAuLlBic,MAAAA,aAAa,EAAE,uBAASpB,QAAT,EAAmBlB,UAAnB,EAA+BC,OAA/B,EAAwC;AACrD,aAAKV,QAAL,GAAgB;AACdrE,UAAAA,QAAQ,EAAEsC,MAAM,CAAC0D,QAAD,CADF;AAEdlB,UAAAA,UAAU,EAAEA,UAFE;AAGdC,UAAAA,OAAO,EAAEA;AAHK,SAAhB;;AAMA,YAAI,KAAKtC,MAAL,KAAgB,MAApB,EAA4B;;;AAG1B,eAAKhB,GAAL,GAAW9P,WAAX;AACD;;AAED,eAAOoQ,gBAAP;AACD;AArMiB,KAApB,CAlgBgC;;;;;AA8sBhC,WAAOvC,OAAP;AAED,GAhtBc;;;;AAqtBb,GAA6B6H,MAAM,CAAC7H,OAApC,CArtBa,CAAf;;AAwtBA,MAAI;AACF8H,IAAAA,kBAAkB,GAAG/H,OAArB;AACD,GAFD,CAEE,OAAOgI,oBAAP,EAA6B;;;;;;;;;;;AAW7B,QAAI,OAAOC,UAAP,KAAsB,QAA1B,EAAoC;AAClCA,MAAAA,UAAU,CAACF,kBAAX,GAAgC/H,OAAhC;AACD,KAFD,MAEO;AACLkI,MAAAA,QAAQ,CAAC,GAAD,EAAM,wBAAN,CAAR,CAAwClI,OAAxC;AACD;;;;AChvBI,IAAMmI,QAAQ,GACnB,oFADK;AAGP,SAAgBC,WAAW5c;AACzB,SAAO2c,QAAQ,CAAC/c,IAAT,CAAcI,KAAd,CAAP;AACD;;ACgBM,IAAM6c,eAAe,GAAG,SAAlBA,eAAkB;MAAG3T,oBAAAA;MAAc4T,eAAAA;AAC9C,MAAMC,YAAY,GAAG/N,YAAM,CAAmB,IAAnB,CAA3B;;AACA,kBAAwBzQ,cAAQ,CAAC2K,YAAY,IAAI,EAAjB,CAAhC;AAAA,MAAO5B,IAAP;AAAA,MAAa0V,OAAb;;AACA,mBAAsBze,cAAQ,CAAC,EAAD,CAA9B;AAAA,MAAOmM,GAAP;AAAA,MAAYuS,MAAZ;;AACA,mBAA8B1e,cAAQ,CAAC,KAAD,CAAtC;AAAA,MAAO2e,OAAP;AAAA,MAAgBC,UAAhB;;AACA,mBAA0B5e,cAAQ,CAAC,EAAD,CAAlC;AAAA,MAAOoM,KAAP;AAAA,MAAcyS,QAAd;;AACA,MAAMC,QAAQ,GAAG,SAAXA,QAAW,CAAC9F,MAAD;AAAA,WAA2CuF,OAAO,CAACvF,MAAD,CAAlD;AAAA,GAAjB;;AAEA,MAAM+F,UAAU,GAAGV,UAAU,CAAClS,GAAD,CAA7B;AAEAwE,EAAAA,eAAS,CAAC;;;AACR,QAAI6N,YAAJ,qCAAIA,YAAY,CAAEtX,OAAlB,aAAI,sBAAuBjC,KAA3B,EAAkC;AAChCuZ,MAAAA,YAAY,CAACtX,OAAb,CAAqBjC,KAArB;AACD;AACF,GAJQ,EAIN,CAACuZ,YAAD,CAJM,CAAT;AAMA,SACE1lB,4BAAA,wBAAA,MAAA,EACEA,4BAAA,CAACwa,0BAAD;AAAc5Z,IAAAA,MAAM,EAAC;GAArB,EACEZ,4BAAA,CAACkmB,kBAAD;AAAMC,IAAAA,QAAQ,EAAE;AAAA,aAAMH,QAAQ,CAAC;AAAE3S,QAAAA,GAAG,EAAHA,GAAF;AAAOpD,QAAAA,IAAI,EAAJA,IAAP;AAAaqD,QAAAA,KAAK,EAALA;AAAb,OAAD,CAAd;AAAA;GAAhB,EACEtT,4BAAA,CAAComB,yBAAD;AAAaC,IAAAA,EAAE,EAAC;AAAkBtjB,IAAAA,UAAU,EAAEujB,OAAO,CAACzU,YAAD;GAArD,EACE7R,4BAAA,CAAComB,yBAAW,CAACG,KAAb,MAAA,aAAA,CADF,EAEEvmB,4BAAA,CAACwmB,uBAAD;AACElmB,IAAAA,IAAI,EAAC;AACLqI,IAAAA,KAAK,EAAEsH;AACPqG,IAAAA,QAAQ,EAAE,kBAAC9V,CAAD;AACRmlB,MAAAA,OAAO,CAACnlB,CAAC,CAACma,MAAF,CAAShS,KAAV,CAAP;AACD;AACD/H,IAAAA,MAAM,EAAC;GANT,CAFF,CADF,EAaEZ,4BAAA,CAAComB,yBAAD;AAAaC,IAAAA,EAAE,EAAC;AAAmBI,IAAAA,SAAS,EAAEZ,OAAO,IAAI,CAACI;GAA1D,EACEjmB,4BAAA,CAAComB,yBAAW,CAACG,KAAb,MAAA,cAAA,CADF,EAEEvmB,4BAAA,CAACwmB,uBAAD;AACElmB,IAAAA,IAAI,EAAC;AACLqI,IAAAA,KAAK,EAAE0K;AACPiD,IAAAA,QAAQ,EAAE,kBAAC9V,CAAD;AACRolB,MAAAA,MAAM,CAACplB,CAAC,CAACma,MAAF,CAAShS,KAAV,CAAN;AACAmd,MAAAA,UAAU,CAAC,IAAD,CAAV;AACD;AACDY,IAAAA,WAAW,EAAC;AACZC,IAAAA,SAAS,EAAE;AACX/lB,IAAAA,MAAM,EAAC;AACP4D,IAAAA,GAAG,EAAEkhB;GAVP,CAFF,EAcE1lB,4BAAA,CAAComB,yBAAW,CAACQ,QAAb,MAAA,oCAAA,CAdF,EAeGf,OAAO,IAAI,CAACI,UAAZ,IACCjmB,4BAAA,CAAComB,yBAAW,CAACS,iBAAb,MAAA,eAAA,CAhBJ,CAbF,EAiCE7mB,4BAAA,CAAComB,yBAAD;AAAaC,IAAAA,EAAE,EAAC;GAAhB,EACErmB,4BAAA,CAAComB,yBAAW,CAACG,KAAb,MAAA,cAAA,CADF,EAEEvmB,4BAAA,CAACwmB,uBAAD;AACElmB,IAAAA,IAAI,EAAC;AACLqI,IAAAA,KAAK,EAAE2K;AACPgD,IAAAA,QAAQ,EAAE,kBAAC9V,CAAD;AACRulB,MAAAA,QAAQ,CAACvlB,CAAC,CAACma,MAAF,CAAShS,KAAV,CAAR;AACD;AACD/H,IAAAA,MAAM,EAAC;GANT,CAFF,EAUEZ,4BAAA,CAAComB,yBAAW,CAACQ,QAAb,MAAA,qEAAA,CAVF,CAjCF,CADF,CADF,EAmDE5mB,4BAAA,CAAC8mB,2BAAD,MAAA,EACE9mB,4BAAA,CAAC8C,oBAAD;AACElC,IAAAA,MAAM,EAAC;AACPR,IAAAA,OAAO,EAAE;AAAA,aAAMqlB,OAAO,CAAC,KAAD,CAAb;AAAA;AACTriB,IAAAA,OAAO,EAAC;AACRD,IAAAA,IAAI,EAAC;GAJP,UAAA,CADF,EAQEnD,4BAAA,CAAC8C,oBAAD;AACElC,IAAAA,MAAM,EAAC;AACPR,IAAAA,OAAO,EAAE;AACP4lB,MAAAA,QAAQ,CAAC;AAAE3S,QAAAA,GAAG,EAAHA,GAAF;AAAOpD,QAAAA,IAAI,EAAJA,IAAP;AAAaqD,QAAAA,KAAK,EAALA;AAAb,OAAD,CAAR;AACD;AACDvQ,IAAAA,UAAU,EAAE,CAACkjB;AACb7iB,IAAAA,OAAO,EAAC;AACRD,IAAAA,IAAI,EAAC;GAPP,UAAA,CARF,CAnDF,CADF;AAyED,CAzFM;AA2FP,AAAO,IAAM4jB,oBAAoB,GAAG,SAAvBA,oBAAuB,CAClCjM,OADkC,EAElCkM,MAFkC;AAIlC,SAAOlM,OAAO,CAACC,WAAR,CAAoB;AACzBzH,IAAAA,KAAK,EAAE,aADkB;AAEzBpS,IAAAA,KAAK,EAAE,OAFkB;AAGzB8W,IAAAA,SAAS,EAAE,OAHc;AAIzBgD,IAAAA,wBAAwB,EAAE,IAJD;AAKzBC,IAAAA,yBAAyB,EAAE,IALF;AAMzBC,IAAAA,UAAU;AACRC,MAAAA,IAAI,EAAEpC,kBAAkB,CAAChT;AADjB,OAELihB,MAFK;AANe,GAApB,CAAP;AAWD,CAfM;;AChHA,IAAMC,iBAAiB,GAAG,CAC/B;AAAE7gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CAD+B,EAE/B;AAAE9gB,EAAAA,IAAI,EAAE,EAAR;AAAY8gB,EAAAA,IAAI,EAAE;AAAlB,CAF+B,EAG/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CAH+B,EAI/B;AAAE9gB,EAAAA,IAAI,EAAE,IAAR;AAAc8gB,EAAAA,IAAI,EAAE;AAApB,CAJ+B,EAK/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CAL+B,EAM/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CAN+B,EAO/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CAP+B,EAQ/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CAR+B,EAS/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CAT+B,EAU/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CAV+B,EAW/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CAX+B,EAY/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CAZ+B,EAa/B;AAAE9gB,EAAAA,IAAI,EAAE,EAAR;AAAY8gB,EAAAA,IAAI,EAAE;AAAlB,CAb+B,EAc/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CAd+B,EAe/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CAf+B,EAgB/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CAhB+B,EAiB/B;AAAE9gB,EAAAA,IAAI,EAAE,EAAR;AAAY8gB,EAAAA,IAAI,EAAE;AAAlB,CAjB+B,EAkB/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CAlB+B,EAmB/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CAnB+B,EAoB/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CApB+B,EAqB/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CArB+B,EAsB/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CAtB+B,EAuB/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CAvB+B,EAwB/B;AAAE9gB,EAAAA,IAAI,EAAE,EAAR;AAAY8gB,EAAAA,IAAI,EAAE;AAAlB,CAxB+B,EAyB/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CAzB+B,EA0B/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CA1B+B,EA2B/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CA3B+B,EA4B/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CA5B+B,EA6B/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CA7B+B,EA8B/B;AAAE9gB,EAAAA,IAAI,EAAE,IAAR;AAAc8gB,EAAAA,IAAI,EAAE;AAApB,CA9B+B,EA+B/B;AAAE9gB,EAAAA,IAAI,EAAE,IAAR;AAAc8gB,EAAAA,IAAI,EAAE;AAApB,CA/B+B,EAgC/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CAhC+B,EAiC/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CAjC+B,EAkC/B;AAAE9gB,EAAAA,IAAI,EAAE,IAAR;AAAc8gB,EAAAA,IAAI,EAAE;AAApB,CAlC+B,EAmC/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CAnC+B,EAoC/B;AAAE9gB,EAAAA,IAAI,EAAE,IAAR;AAAc8gB,EAAAA,IAAI,EAAE;AAApB,CApC+B,EAqC/B;AAAE9gB,EAAAA,IAAI,EAAE,IAAR;AAAc8gB,EAAAA,IAAI,EAAE;AAApB,CArC+B,EAsC/B;AAAE9gB,EAAAA,IAAI,EAAE,IAAR;AAAc8gB,EAAAA,IAAI,EAAE;AAApB,CAtC+B,EAuC/B;AAAE9gB,EAAAA,IAAI,EAAE,IAAR;AAAc8gB,EAAAA,IAAI,EAAE;AAApB,CAvC+B,EAwC/B;AAAE9gB,EAAAA,IAAI,EAAE,IAAR;AAAc8gB,EAAAA,IAAI,EAAE;AAApB,CAxC+B,EAyC/B;AAAE9gB,EAAAA,IAAI,EAAE,IAAR;AAAc8gB,EAAAA,IAAI,EAAE;AAApB,CAzC+B,EA0C/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CA1C+B,EA2C/B;AAAE9gB,EAAAA,IAAI,EAAE,IAAR;AAAc8gB,EAAAA,IAAI,EAAE;AAApB,CA3C+B,EA4C/B;AAAE9gB,EAAAA,IAAI,EAAE,IAAR;AAAc8gB,EAAAA,IAAI,EAAE;AAApB,CA5C+B,EA6C/B;AAAE9gB,EAAAA,IAAI,EAAE,IAAR;AAAc8gB,EAAAA,IAAI,EAAE;AAApB,CA7C+B,EA8C/B;AAAE9gB,EAAAA,IAAI,EAAE,IAAR;AAAc8gB,EAAAA,IAAI,EAAE;AAApB,CA9C+B,EA+C/B;AAAE9gB,EAAAA,IAAI,EAAE,IAAR;AAAc8gB,EAAAA,IAAI,EAAE;AAApB,CA/C+B,EAgD/B;AAAE9gB,EAAAA,IAAI,EAAE,IAAR;AAAc8gB,EAAAA,IAAI,EAAE;AAApB,CAhD+B,EAiD/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CAjD+B,EAkD/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CAlD+B,EAmD/B;AAAE9gB,EAAAA,IAAI,EAAE,IAAR;AAAc8gB,EAAAA,IAAI,EAAE;AAApB,CAnD+B,EAoD/B;AAAE9gB,EAAAA,IAAI,EAAE,GAAR;AAAa8gB,EAAAA,IAAI,EAAE;AAAnB,CApD+B,EAqD/B;AAAE9gB,EAAAA,IAAI,EAAE,IAAR;AAAc8gB,EAAAA,IAAI,EAAE;AAApB,CArD+B,EAsD/B;AAAE9gB,EAAAA,IAAI,EAAE,IAAR;AAAc8gB,EAAAA,IAAI,EAAE;AAApB,CAtD+B,CAA1B;;ACeP,IAAM3pB,QAAM,GAAG;AACb4pB,EAAAA,WAAW,eAAE1pB,WAAG,CAAC;AACfC,IAAAA,OAAO,EAAE,MADM;AAEfub,IAAAA,QAAQ,EAAE;AAFK,GAAD,CADH;AAKbmO,EAAAA,UAAU,eAAE3pB,WAAG,CAAC;AACdiB,IAAAA,MAAM,iBAAeT,MAAM,CAACqb,OADd;AAEdpY,IAAAA,KAAK,EAAE,QAFO;AAGdC,IAAAA,MAAM,EAAE,QAHM;AAIdnD,IAAAA,QAAQ,EAAEC,MAAM,CAAC+b,UAJH;AAKdrS,IAAAA,SAAS,EAAE1J,MAAM,CAAC4F,UALJ;AAMdC,IAAAA,WAAW,EAAE7F,MAAM,CAAC4F;AANN,GAAD,CALF;AAabwjB,EAAAA,kBAAkB,eAAE5pB,WAAG,CAAC;AACtBwB,IAAAA,eAAe,EAAEhB,MAAM,CAACiB;AADF,GAAD,CAbV;AAgBbkF,EAAAA,OAAO,eAAE3G,WAAG,CAAC;AAAEE,IAAAA,MAAM,EAAE;AAAV,GAAD,CAhBC;AAiBbiG,EAAAA,MAAM,eAAEnG,WAAG,CAAC;AACVkK,IAAAA,SAAS,EAAE1J,MAAM,CAACud,QADR;AAEV1X,IAAAA,WAAW,EAAE7F,MAAM,CAACqa;AAFV,GAAD;AAjBE,CAAf;AA6BA,AAAO,IAAMgP,2BAA2B,GAAG,SAA9BA,2BAA8B;MAAG7B,eAAAA;;AAC5C,kBAAkDve,cAAQ,CACxD+f,iBAAiB,CAAC,CAAD,CADuC,CAA1D;AAAA,MAAOM,iBAAP;AAAA,MAA0BC,oBAA1B;;AAGA,SACExnB,4BAAA,wBAAA,MAAA,EACEA,4BAAA,CAACwa,0BAAD;AAAc5Z,IAAAA,MAAM,EAAC;GAArB,EACEZ,4BAAA,CAACqH,kBAAD;AAAMzJ,IAAAA,aAAa,EAAC;AAASuc,IAAAA,UAAU,EAAC;GAAxC,EACEna,4BAAA,CAACynB,kBAAD;AAAM5O,IAAAA,EAAE,EAAC;AAAMJ,IAAAA,UAAU,EAAC;AAAgBza,IAAAA,QAAQ,EAAC;AAAcD,IAAAA,YAAY,EAAC;GAA9E,EACG2pB,MAAM,CAACC,YAAP,CAAoBJ,iBAAiB,CAACnhB,IAAtC,CADH,CADF,EAIEpG,4BAAA,CAACynB,kBAAD;AAAM5O,IAAAA,EAAE,EAAC;AAAM9a,IAAAA,YAAY,EAAC;GAA5B,EACGwpB,iBAAiB,CAACL,IADrB,CAJF,CADF,EASElnB,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAAC4pB;GAAvB,EACGF,iBAAiB,CAACvY,GAAlB,CAAsB,UAACkZ,KAAD;AAAA,WACrB5nB,4BAAA,MAAA;AAAK8O,MAAAA,GAAG,EAAE8Y,KAAI,CAACxhB;KAAf,EACEpG,4BAAA,CAAC2E,qBAAD;AAAS1E,MAAAA,SAAS,EAAE1C,QAAM,CAAC6G;AAASQ,MAAAA,OAAO,EAAEgjB,KAAI,CAACV;KAAlD,EACElnB,4BAAA,CAAC8C,oBAAD;AACElC,MAAAA,MAAM,EAAC;AACPT,MAAAA,QAAQ,EAAEynB,KAAI,CAACxhB,IAAL,KAAcmhB,iBAAiB,CAACnhB;AAC1CnG,MAAAA,SAAS,EAAE1C,QAAM,CAAC6pB;AAClBhkB,MAAAA,OAAO,EAAC;AACRhD,MAAAA,OAAO,EAAE;AAAA,eAAMonB,oBAAoB,CAACI,KAAD,CAA1B;AAAA;KALX,EAMGF,MAAM,CAACC,YAAP,CAAoBC,KAAI,CAACxhB,IAAzB,CANH,CADF,CADF,CADqB;AAAA,GAAtB,CADH,CATF,CADF,EA2BEpG,4BAAA,CAAC8mB,2BAAD,MAAA,EACE9mB,4BAAA,CAAC8C,oBAAD;AACElC,IAAAA,MAAM,EAAC;AACPX,IAAAA,SAAS,EAAE1C,QAAM,CAACqG;AAClBxD,IAAAA,OAAO,EAAE;AAAA,aAAMqlB,OAAO,CAAC,KAAD,CAAb;AAAA;AACTriB,IAAAA,OAAO,EAAC;AACRD,IAAAA,IAAI,EAAC;GALP,UAAA,CADF,EASEnD,4BAAA,CAAC8C,oBAAD;AACE7C,IAAAA,SAAS,EAAE1C,QAAM,CAACqG;AAClBhD,IAAAA,MAAM,EAAC;AACPR,IAAAA,OAAO,EAAE;AAAA,aAAMqlB,OAAO,CAACiC,MAAM,CAACC,YAAP,CAAoBJ,iBAAiB,CAACnhB,IAAtC,CAAD,CAAb;AAAA;AACThD,IAAAA,OAAO,EAAC;AACRD,IAAAA,IAAI,EAAC;GALP,mBAAA,CATF,CA3BF,CADF;AAgDD,CApDM;AAsDP,AAAO,IAAM0kB,0BAA0B,GAAG,SAA7BA,0BAA6B,CACxC/M,OADwC;AAGxC,SAAOA,OAAO,CAACC,WAAR,CAAoB;AACzBzH,IAAAA,KAAK,EAAE,0BADkB;AAEzBpS,IAAAA,KAAK,EAAE,OAFkB;AAGzB8W,IAAAA,SAAS,EAAE,OAHc;AAIzBgD,IAAAA,wBAAwB,EAAE,IAJD;AAKzBC,IAAAA,yBAAyB,EAAE,IALF;AAMzBC,IAAAA,UAAU,EAAE;AACVC,MAAAA,IAAI,EAAEpC,kBAAkB,CAACnS;AADf;AANa,GAApB,CAAP;AAUD,CAbM;;AC9EA,IAAMkhB,gBAAgB,GAAG,SAAnBA,gBAAmB;MAAGrC,eAAAA;AACjC,MAAMC,YAAY,GAAG/N,YAAM,CAAmB,IAAnB,CAA3B;;AACA,kBAAwBzQ,cAAQ,CAAC,CAAD,CAAhC;AAAA,MAAOiM,IAAP;AAAA,MAAa4U,OAAb;;AACA,mBAA2B7gB,cAAQ,CAAC,CAAD,CAAnC;AAAA,MAAOkM,IAAP;AAAA,MAAa4U,UAAb;;AACA,MAAMC,YAAY,GAAGC,OAAO,CAAC/U,IAAD,EAAO,CAAP,EAAU,GAAV,CAA5B;AACA,MAAMgV,YAAY,GAAGD,OAAO,CAAC9U,IAAD,EAAO,CAAP,EAAU,GAAV,CAA5B;AAEAyE,EAAAA,eAAS,CAAC;;;AACR,iCAAI6N,YAAY,CAACtX,OAAjB,aAAI,sBAAsBjC,KAA1B,EAAiC;AAC/BuZ,MAAAA,YAAY,CAACtX,OAAb,CAAqBjC,KAArB;AACD;AACF,GAJQ,EAIN,CAACuZ,YAAD,CAJM,CAAT;AAMA,SACE1lB,4BAAA,wBAAA,MAAA,EACEA,4BAAA,CAACwa,0BAAD;AAAc5Z,IAAAA,MAAM,EAAC;GAArB,EACEZ,4BAAA,CAACkmB,kBAAD,MAAA,EACElmB,4BAAA,CAAComB,yBAAD;AAAaC,IAAAA,EAAE,EAAC;AAAiC+B,IAAAA,UAAU;AAAC3B,IAAAA,SAAS,EAAE,CAACwB;GAAxE,EACEjoB,4BAAA,CAAComB,yBAAW,CAACG,KAAb,MAAA,kBAAA,CADF,EAEEvmB,4BAAA,CAACwmB,uBAAD;AACElmB,IAAAA,IAAI,EAAC;AACLqI,IAAAA,KAAK,EAAEwK,IAAI,CAACkV,QAAL;AACP/R,IAAAA,QAAQ,EAAE,kBAAC9V,CAAD;AAAA,aAA4CunB,OAAO,CAACrkB,MAAM,CAAClD,CAAC,CAACma,MAAF,CAAShS,KAAV,CAAP,CAAnD;AAAA;AACV/H,IAAAA,MAAM,EAAC;AACP8I,IAAAA,GAAG,EAAE;AACLC,IAAAA,GAAG,EAAE;AACL2e,IAAAA,OAAO,EAAC;AACRnN,IAAAA,IAAI,EAAC;AACLja,IAAAA,KAAK,EAAC;AACNqnB,IAAAA,YAAY,EAAC;AACb/jB,IAAAA,GAAG,EAAEkhB;GAXP,CAFF,EAeG,CAACuC,YAAD,IACCjoB,4BAAA,CAAComB,yBAAW,CAACS,iBAAb,MAAA,+BAAA,CAhBJ,CADF,EAuBE7mB,4BAAA,CAAComB,yBAAD;AAAaC,IAAAA,EAAE,EAAC;AAAoC+B,IAAAA,UAAU;AAAC3B,IAAAA,SAAS,EAAE,CAAC0B;GAA3E,EACEnoB,4BAAA,CAAComB,yBAAW,CAACG,KAAb,MAAA,qBAAA,CADF,EAEEvmB,4BAAA,CAACwmB,uBAAD;AACElmB,IAAAA,IAAI,EAAC;AACLqI,IAAAA,KAAK,EAAEyK,IAAI,CAACiV,QAAL;AACP/R,IAAAA,QAAQ,EAAE,kBAAC9V,CAAD;AAAA,aACRwnB,UAAU,CAACtkB,MAAM,CAAClD,CAAC,CAACma,MAAF,CAAShS,KAAV,CAAP,CADF;AAAA;AAGV/H,IAAAA,MAAM,EAAC;AACP8I,IAAAA,GAAG,EAAE;AACLC,IAAAA,GAAG,EAAE;AACL2e,IAAAA,OAAO,EAAC;AACRnN,IAAAA,IAAI,EAAC;AACLja,IAAAA,KAAK,EAAC;AACNqnB,IAAAA,YAAY,EAAC;GAZf,CAFF,EAgBG,CAACJ,YAAD,IACCnoB,4BAAA,CAAComB,yBAAW,CAACS,iBAAb,MAAA,+BAAA,CAjBJ,CAvBF,CADF,CADF,EAiDE7mB,4BAAA,CAAC8mB,2BAAD,MAAA,EACE9mB,4BAAA,CAAC8C,oBAAD;AACElC,IAAAA,MAAM,EAAC;AACPR,IAAAA,OAAO,EAAE;AAAA,aAAMqlB,OAAO,CAAC,KAAD,CAAb;AAAA;AACTriB,IAAAA,OAAO,EAAC;AACRD,IAAAA,IAAI,EAAC;GAJP,UAAA,CADF,EAQEnD,4BAAA,CAAC8C,oBAAD;AACElC,IAAAA,MAAM,EAAC;AACPR,IAAAA,OAAO,EAAE;AAAA,aAAMqlB,OAAO,CAAC;AAAEtS,QAAAA,IAAI,EAAJA,IAAF;AAAQC,QAAAA,IAAI,EAAJA;AAAR,OAAD,CAAb;AAAA;AACThQ,IAAAA,OAAO,EAAC;AACRD,IAAAA,IAAI,EAAC;AACLJ,IAAAA,UAAU,EAAE,CAACklB,YAAD,IAAiB,CAACE;GALhC,UAAA,CARF,CAjDF,CADF;AAqED,CAlFM;AAoFP,AAAO,IAAMK,qBAAqB,GAAG,SAAxBA,qBAAwB,CAAC1N,OAAD;AACnC,SAAOA,OAAO,CAACC,WAAR,CAAoB;AACzBzH,IAAAA,KAAK,EAAE,cADkB;AAEzBpS,IAAAA,KAAK,EAAE,QAFkB;AAGzB8W,IAAAA,SAAS,EAAE,OAHc;AAIzBgD,IAAAA,wBAAwB,EAAE,IAJD;AAKzBC,IAAAA,yBAAyB,EAAE,IALF;AAMzBC,IAAAA,UAAU,EAAE;AACVC,MAAAA,IAAI,EAAEpC,kBAAkB,CAACpS;AADf;AANa,GAApB,CAAP;AAUD,CAXM;;ACrFP,IAAMpJ,QAAM,GAAG;AACbkrB,EAAAA,eAAe,eAAEhrB,WAAG,CAAC;AACnBC,IAAAA,OAAO,EAAE,MADU;AAEnBub,IAAAA,QAAQ,EAAE,QAFS;AAGnBkB,IAAAA,UAAU,EAAE;AAHO,GAAD,CADP;AAMbuO,EAAAA,gBAAgB,eAAEjrB,WAAG,CAAC;AACpBC,IAAAA,OAAO,EAAE,aADW;AAEpByc,IAAAA,UAAU,EAAE,YAFQ;AAGpBwO,IAAAA,UAAU,EAAE1qB,MAAM,CAACmc;AAHC,GAAD,CANR;AAWbwO,EAAAA,WAAW,eAAEnrB,WAAG,CAAC;AACfsB,IAAAA,UAAU,EAAEd,MAAM,CAACud;AADJ,GAAD;AAXH,CAAf;;AAwBA,IAAMqN,eAAe,GAAG,SAAlBA,eAAkB;MACtBxV,WAAAA;MACAnS,aAAAA;MACA4nB,oBAAAA;MACAC,oBAAAA;AAOA,MAAMC,CAAC,GAAG;AAAEC,IAAAA,OAAO,EAAE,GAAX;AAAgBC,IAAAA,EAAE,EAAE;AAApB,GAAV;AACA,SAAO,CACL,cAAc7V,GAAd,GAAoB,yBADf,EAEL,sBAAsBnS,KAAtB,GAA8B8nB,CAAC,CAACF,YAAD,CAA/B,GAAgD,IAF3C,EAGL,0BAA0BC,YAAY,GAAG,GAAH,GAAS,GAA/C,IAAsD,GAHjD,EAIL,wBAAwB1V,GAAxB,GAA8B,MAJzB,EAKL9B,IALK,CAKA,EALA,CAAP;AAMD,CAlBD;;AAoBA,IAAM4X,YAAY,GAAG,SAAfA,YAAe,CAACjoB,KAAD,EAAgBkoB,IAAhB;AAAA,SAAgCA,IAAI,KAAK,SAAT,GAAqBloB,KAAK,IAAI,GAA9B,GAAoC,IAApE;AAAA,CAArB;;AAEA,AAAO,IAAMmoB,yBAAyB,GAAG,SAA5BA,yBAA4B;MAAG5D,gBAAAA;AAC1C,MAAMC,YAAY,GAAG/N,YAAM,CAAmB,IAAnB,CAA3B;;AACA,kBAAsBzQ,cAAQ,CAAS,UAAT,CAA9B;AAAA,MAAOmM,GAAP;AAAA,MAAYuS,MAAZ;;AACA,mBAAgC1e,cAAQ,CAAO,SAAP,CAAxC;AAAA,MAAO4hB,YAAP;AAAA,MAAqBQ,OAArB;;AACA,mBAAqCpiB,cAAQ,CAAU,IAAV,CAA7C;AAAA,MAAO+e,UAAP;AAAA,MAAmBsD,cAAnB;;AACA,mBAA0BriB,cAAQ,CAAC,KAAD,CAAlC;AAAA,MAAOhG,KAAP;AAAA,MAAcsoB,QAAd;;AACA,mBAAwCtiB,cAAQ,CAAC,KAAD,CAAhD;AAAA,MAAO6hB,YAAP;AAAA,MAAqBU,eAArB;;AAEA5R,EAAAA,eAAS,CAAC;;;AACR,iCAAI6N,YAAY,CAACtX,OAAjB,aAAI,sBAAsBjC,KAA1B,EAAiC;AAC/BuZ,MAAAA,YAAY,CAACtX,OAAb,CAAqBjC,KAArB;AACD;AACF,GAJQ,EAIN,CAACuZ,YAAD,CAJM,CAAT;AAMA,SACE1lB,4BAAA,wBAAA,MAAA,EACEA,4BAAA,CAACwa,0BAAD;AAAc5Z,IAAAA,MAAM,EAAC;GAArB,EACEZ,4BAAA,CAACkmB,kBAAD,MAAA,EACElmB,4BAAA,CAAComB,yBAAD;AAAaC,IAAAA,EAAE,EAAC;AAA0B+B,IAAAA,UAAU;AAAC3B,IAAAA,SAAS,EAAE,CAACR;GAAjE,EACEjmB,4BAAA,CAAComB,yBAAW,CAACG,KAAb,MAAA,eAAA,CADF,EAEEvmB,4BAAA,CAACwmB,uBAAD;AACElmB,IAAAA,IAAI,EAAC;AACLqI,IAAAA,KAAK,EAAE0K;AACPiD,IAAAA,QAAQ,EAAE,kBAAC9V,CAAD;AACR,UAAMmI,KAAK,GAAGnI,CAAC,CAACma,MAAF,CAAShS,KAAvB;AACAid,MAAAA,MAAM,CAACjd,KAAD,CAAN;AACA4gB,MAAAA,cAAc,CAAChE,UAAU,CAAC5c,KAAD,CAAX,CAAd;AACD;AACD/H,IAAAA,MAAM,EAAC;AACP8lB,IAAAA,WAAW,EAAC;AACZliB,IAAAA,GAAG,EAAEkhB;GAVP,CAFF,EAcE1lB,4BAAA,CAAComB,yBAAW,CAACQ,QAAb,MAAA,oCAAA,CAdF,EAeG,CAACX,UAAD,IACCjmB,4BAAA,CAAComB,yBAAW,CAACS,iBAAb,MAAA,kBAAA,CAhBJ,CADF,EAoBE7mB,4BAAA,CAAC4Y,sBAAD;AAAU8B,IAAAA,IAAI,EAAC;AAA4BC,IAAAA,MAAM,EAAC;AAASC,IAAAA,GAAG,EAAC;GAA/D,qBAAA,CApBF,EAuBE5a,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACkrB;GAAvB,EACEzoB,4BAAA,CAAComB,yBAAD;AACEC,IAAAA,EAAE,EAAC;AACH+B,IAAAA,UAAU;AACV3B,IAAAA,SAAS,EAAE,CAAC0C,YAAY,CAACzlB,MAAM,CAACxC,KAAD,CAAP,EAAgB4nB,YAAhB;GAH1B,EAIE9oB,4BAAA,CAAComB,yBAAW,CAACG,KAAb,MAAA,SAAA,CAJF,EAKEvmB,4BAAA,CAACwmB,uBAAD;AACE7d,IAAAA,KAAK,EAAEzH;AACPZ,IAAAA,IAAI,EAAC;AACLM,IAAAA,MAAM,EAAC;AACPua,IAAAA,IAAI,EAAC;AACLja,IAAAA,KAAK,EAAC;AACNoV,IAAAA,QAAQ,EAAE,kBAAC9V,CAAD;AAAA,aAA4CgpB,QAAQ,CAAChpB,CAAC,CAACma,MAAF,CAAShS,KAAV,CAApD;AAAA;GANZ,CALF,EAaG,CAACwgB,YAAY,CAACzlB,MAAM,CAACxC,KAAD,CAAP,EAAgB4nB,YAAhB,CAAb,IACC9oB,4BAAA,CAAComB,yBAAW,CAACS,iBAAb,MAAA,oCAAA,CAdJ,CADF,EAqBE7mB,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACmrB;GAAvB,EACE1oB,4BAAA,CAAC0pB,mBAAD;AACErD,IAAAA,EAAE,EAAC;AACH1d,IAAAA,KAAK,EAAC;AACNghB,IAAAA,SAAS,EAAEb,YAAY,KAAK;AAC5BxS,IAAAA,QAAQ,EAAE;AAAA,aAAMgT,OAAO,CAAC,SAAD,CAAb;AAAA;AACVrpB,IAAAA,SAAS,EAAE1C,QAAM,CAACqrB;GALpB,WAAA,CADF,EASE5oB,4BAAA,CAAC0pB,mBAAD;AACErD,IAAAA,EAAE,EAAC;AACH1d,IAAAA,KAAK,EAAC;AACNghB,IAAAA,SAAS,EAAEb,YAAY,KAAK;AAC5BxS,IAAAA,QAAQ,EAAE;AAAA,aAAMgT,OAAO,CAAC,IAAD,CAAb;AAAA;AACVrpB,IAAAA,SAAS,EAAE1C,QAAM,CAACqrB;GALpB,UAAA,CATF,CArBF,CAvBF,EA+DE5oB,4BAAA,CAAC4pB,sBAAD;AACEvD,IAAAA,EAAE,EAAC;AACH/lB,IAAAA,IAAI,EAAC;AACLqI,IAAAA,KAAK,EAAC;AACNghB,IAAAA,SAAS,EAAEZ;AACXzS,IAAAA,QAAQ,EAAE;AAAA,aAAMmT,eAAe,CAAC,CAACV,YAAF,CAArB;AAAA;AACVnoB,IAAAA,MAAM,EAAC;GANT,+CAAA,CA/DF,EAwEEZ,4BAAA,CAACynB,kBAAD;AAAM5O,IAAAA,EAAE,EAAC;AAAIgR,IAAAA,SAAS,EAAC;AAAUliB,IAAAA,SAAS,EAAC;GAA3C,gFAAA,EAEE3H,4BAAA,CAAC4Y,sBAAD;AACE8B,IAAAA,IAAI,EAAC;AACLC,IAAAA,MAAM,EAAC;AACPC,IAAAA,GAAG,EAAC;GAHN,yBAAA,CAFF,uCAAA,CAxEF,CADF,CADF,EAuFE5a,4BAAA,CAAC8mB,2BAAD,MAAA,EACE9mB,4BAAA,CAAC8C,oBAAD;AACElC,IAAAA,MAAM,EAAC;AACPR,IAAAA,OAAO,EAAE;AAAA,aAAMqlB,OAAO,CAAC,KAAD,CAAb;AAAA;AACTriB,IAAAA,OAAO,EAAC;AACRD,IAAAA,IAAI,EAAC;GAJP,UAAA,CADF,EAQEnD,4BAAA,CAAC8C,oBAAD;AACElC,IAAAA,MAAM,EAAC;AACPR,IAAAA,OAAO,EAAE;AAAA,aACPqlB,OAAO,CAACoD,eAAe,CAAC;AAAExV,QAAAA,GAAG,EAAHA,GAAF;AAAOnS,QAAAA,KAAK,EAAEwC,MAAM,CAACxC,KAAD,CAApB;AAA6B4nB,QAAAA,YAAY,EAAZA,YAA7B;AAA2CC,QAAAA,YAAY,EAAZA;AAA3C,OAAD,CAAhB,CADA;AAAA;AAGT3lB,IAAAA,OAAO,EAAC;AACRD,IAAAA,IAAI,EAAC;GANP,UAAA,CARF,CAvFF,CADF;AA4GD,CA1HM;AA4HP,AAAO,IAAM2mB,8BAA8B,GAAG,SAAjCA,8BAAiC,CAC5ChP,OAD4C;AAG5C,SAAOA,OAAO,CAACC,WAAR,CAAoB;AACzBzH,IAAAA,KAAK,EAAE,wBADkB;AAEzBpS,IAAAA,KAAK,EAAE,OAFkB;AAGzB8W,IAAAA,SAAS,EAAE,OAHc;AAIzBgD,IAAAA,wBAAwB,EAAE,IAJD;AAKzBC,IAAAA,yBAAyB,EAAE,IALF;AAMzBC,IAAAA,UAAU,EAAE;AACVC,MAAAA,IAAI,EAAEpC,kBAAkB,CAACrS;AADf;AANa,GAApB,CAAP;AAUD,CAbM;;ACvKA,IAAMqjB,6BAA6B,GAAG,SAAhCA,6BAAgC;MAC3CtE,eAAAA;MACAuE,cAAAA;MACAC,cAAAA;AAEA,MAAMC,aAAa,GAAGF,MAAM,CAAC5Z,MAA7B;AAEA,SACEpQ,4BAAA,wBAAA,MAAA,EACEA,4BAAA,CAACwa,0BAAD;AAAc5Z,IAAAA,MAAM,EAAC;GAArB,EACEZ,4BAAA,CAAC2Y,uBAAD,MAAA,EACGuR,aAAa,KAAK,CAAlB,gDAC8CD,MAD9C,kDAEgDA,MAHnD,CADF,EAMEjqB,4BAAA,CAAC2Y,uBAAD,MAAA,EACGuR,aAAa,KAAK,CAAlB,GACG,yDADH,GAEG,6DAHN,CANF,EAWElqB,4BAAA,CAACmqB,wBAAD,MAAA,EACGH,MAAM,CAACtb,GAAP,CAAW;AAAA,QAAG4E,KAAH,SAAGA,KAAH;AAAA,QAAU8W,WAAV,SAAUA,WAAV;AAAA,QAAuBC,YAAvB,SAAuBA,YAAvB;AAAA,QAAqCC,gBAArC,SAAqCA,gBAArC;AAAA,WACVtqB,4BAAA,CAACmqB,wBAAU,CAACznB,IAAZ;AACEoM,MAAAA,GAAG,EAAEub;AACL/W,MAAAA,KAAK,EAAEA;AACP+W,MAAAA,YAAY,EAAKA,YAAL;AACZC,MAAAA,gBAAgB,EAAEA;AAClBF,MAAAA,WAAW,EAAEA;KALf,CADU;AAAA,GAAX,CADH,CAXF,CADF,EAwBEpqB,4BAAA,CAAC8mB,2BAAD,MAAA,EACE9mB,4BAAA,CAAC8C,oBAAD;AAAQ1C,IAAAA,OAAO,EAAE;AAAA,aAAMqlB,OAAO,CAAC,KAAD,CAAb;AAAA;AAAsBriB,IAAAA,OAAO,EAAC;AAAYD,IAAAA,IAAI,EAAC;GAAhE,UAAA,CADF,EAIEnD,4BAAA,CAAC8C,oBAAD;AACElC,IAAAA,MAAM,EAAC;AACPR,IAAAA,OAAO,EAAE;AAAA,aAAMqlB,OAAO,CAAC,IAAD,CAAb;AAAA;AACTriB,IAAAA,OAAO,EAAC;AACRD,IAAAA,IAAI,EAAC;GAJP,WAAA,CAJF,CAxBF,CADF;AAuCD,CA9CM;AAgDP,AAAO,IAAMonB,sBAAsB,GAAG,SAAzBA,sBAAyB,CACpCzP,OADoC,EAEpC3R,OAFoC;AAYpC,SAAO2R,OAAO,CAACC,WAAR,CAAoB;AACzBzH,IAAAA,KAAK,EAAE,+BADkB;AAEzBpS,IAAAA,KAAK,EAAE,QAFkB;AAGzB8W,IAAAA,SAAS,EAAE,OAHc;AAIzBgD,IAAAA,wBAAwB,EAAE,IAJD;AAKzBC,IAAAA,yBAAyB,EAAE,IALF;AAMzBC,IAAAA,UAAU;AACRC,MAAAA,IAAI,EAAEpC,kBAAkB,CAACyR;AADjB,OAELrhB,OAFK;AANe,GAApB,CAAP;AAWD,CAvBM;;ACtCP,IAAM5L,QAAM,GAAG;AACbC,EAAAA,IAAI,eAAEC,WAAG,CAAC;AACRwD,IAAAA,QAAQ,EAAE,OADF;AAERwpB,IAAAA,IAAI,EAAE,CAFE;AAGRC,IAAAA,KAAK,EAAE,CAHC;AAIRC,IAAAA,GAAG,EAAE,CAJG;AAKRC,IAAAA,MAAM,EAAE;AALA,GAAD,CADI;AAQbC,EAAAA,QAAQ,eAAEptB,WAAG,CAAC;AACZwD,IAAAA,QAAQ,EAAE,OADE;AAEZ0pB,IAAAA,GAAG,EAAE,CAFO;AAGZxpB,IAAAA,MAAM,EAAE,MAHI;AAIZspB,IAAAA,IAAI,EAAE,CAJM;AAKZC,IAAAA,KAAK,EAAE;AALK,GAAD,CARA;AAebI,EAAAA,WAAW,eAAErtB,WAAG,CAAC;AACfwD,IAAAA,QAAQ,EAAE,OADK;AAEf2pB,IAAAA,MAAM,EAAE,CAFO;AAGfH,IAAAA,IAAI,EAAE,CAHS;AAIfC,IAAAA,KAAK,EAAE,CAJQ;AAKfvpB,IAAAA,MAAM,EAAE;AALO,GAAD,CAfH;AAsBb4pB,EAAAA,WAAW,eAAEttB,WAAG,CAAC;AACfyD,IAAAA,KAAK,EAAE,KADQ;AAEfD,IAAAA,QAAQ,EAAE,OAFK;AAGf0pB,IAAAA,GAAG,EAAE,MAHU;AAIfF,IAAAA,IAAI,EAAE,CAJS;AAKfG,IAAAA,MAAM,EAAE,MALO;AAMfI,IAAAA,SAAS,EAAE,QANI;AAOfvP,IAAAA,SAAS,EAAE;AAPI,GAAD,CAtBH;AA+BbwP,EAAAA,qBAAqB,eAAExtB,WAAG,CAAC;AACzBgtB,IAAAA,IAAI,EAAE,CADmB;AAEzBC,IAAAA,KAAK,EAAE,CAFkB;AAGzBxpB,IAAAA,KAAK,EAAE;AAHkB,GAAD,CA/Bb;AAoCbgqB,EAAAA,YAAY,eAAEztB,WAAG,CAAC;AAChByD,IAAAA,KAAK,EAAE,KADS;AAEhBD,IAAAA,QAAQ,EAAE,OAFM;AAGhB0pB,IAAAA,GAAG,EAAE,MAHW;AAIhBD,IAAAA,KAAK,EAAE,CAJS;AAKhBE,IAAAA,MAAM,EAAE,MALQ;AAMhBI,IAAAA,SAAS,EAAE,QANK;AAOhBvP,IAAAA,SAAS,EAAE;AAPK,GAAD,CApCJ;AA6Cb0P,EAAAA,SAAS,eAAE1tB,WAAG,CAAC;AACbwD,IAAAA,QAAQ,EAAE,OADG;AAEb0pB,IAAAA,GAAG,EAAE,MAFQ;AAGbC,IAAAA,MAAM,EAAE,MAHK;AAIb1pB,IAAAA,KAAK,EAAE,KAJM;AAKbvB,IAAAA,UAAU,EAAE1B,MAAM,CAACU,OALN;AAMb8rB,IAAAA,IAAI,EAAE;AANO,GAAD,CA7CD;AAqDb7mB,EAAAA,MAAM,eAAEnG,WAAG,CAAC;AACVwD,IAAAA,QAAQ,EAAE,OADA;AAEV7C,IAAAA,MAAM,EAAE,SAFE;AAGVT,IAAAA,MAAM,EAAE,GAHE;AAIVgtB,IAAAA,GAAG,EAAE,KAJK;AAKVxpB,IAAAA,MAAM,EAAE,MALE;AAMVlC,IAAAA,eAAe,EAAEhB,MAAM,CAACiB,OANd;AAOVR,IAAAA,MAAM,iBAAeT,MAAM,CAACU,OAPlB;AAQVJ,IAAAA,OAAO,EAAE;AARC,GAAD,CArDE;AA+Db6sB,EAAAA,UAAU,eAAE3tB,WAAG,CAAC;AACdgtB,IAAAA,IAAI,EAAE;AADQ,GAAD,CA/DF;AAkEbY,EAAAA,UAAU,eAAE5tB,WAAG,CAAC;AACditB,IAAAA,KAAK,EAAE,CADO;AAEdY,IAAAA,gBAAgB,EAAE;AAFJ,GAAD,CAlEF;AAsEbvnB,EAAAA,IAAI,eAAEtG,WAAG,CAAC;AACRwG,IAAAA,aAAa,EAAE;AADP,GAAD;AAtEI,CAAf;AA2EA,AAAO,IAAMsnB,kBAAkB,GAAG,SAArBA,kBAAqB,CAACxrB,KAAD;;;AAChC,wBAAwCC,cAAK,CAACkH,QAAN,wBAAuBnH,KAAK,CAACyrB,YAA7B,kCAA6C,EAA7C,CAAxC;AAAA,MAAOC,YAAP;AAAA,MAAqBC,eAArB;;AACA,yBAAsC1rB,cAAK,CAACkH,QAAN,CAAwB,IAAxB,CAAtC;AAAA,MAAOykB,WAAP;AAAA,MAAoBC,cAApB;;AACA,yBAA4B5rB,cAAK,CAACkH,QAAN,CAA6C,IAA7C,CAA5B;AAAA,MAAOwK,MAAP;AAAA,MAAekG,SAAf;;AAEA5X,EAAAA,cAAK,CAAC6X,SAAN,CAAgB;;;AACd;AACA,kBAAA9X,KAAK,CAAC6c,GAAN,qDAAW1U,MAAX,uCAAmB2jB,YAAnB,CAAgC,MAAhC;AAED,GAJD,EAIG,EAJH;;AAOA7rB,EAAAA,cAAK,CAAC6X,SAAN,CAAgB;AACdiU,IAAAA,UAAU,CAAC;AACTpa,MAAAA,MAAM,QAAN,YAAAA,MAAM,CAAEzD,WAAR;AACAyD,MAAAA,MAAM,QAAN,YAAAA,MAAM,CAAExD,OAAR;AACD,KAHS,EAGP,GAHO,CAAV;AAID,GALD,EAKG,CAACwD,MAAD,CALH;AAOA,MAAMzM,OAAO,GAAGjF,cAAK,CAAC+b,OAAN,CAAc;AAC5B,WAAOgQ,qBAAqB,CAAC;AAAEnP,MAAAA,GAAG,EAAE7c,KAAK,CAAC6c,GAAb;AAAkBlL,MAAAA,MAAM,EAANA,MAAlB;AAA0BuY,MAAAA,MAAM,EAAElqB,KAAK,CAACkqB;AAAxC,KAAD,CAA5B;AAED,GAHe,EAGb,CAACvY,MAAD,CAHa,CAAhB;;AAKAzM,EAAAA,OAAO,CAAC4C,YAAR,GAAuB;AACrB9H,IAAAA,KAAK,CAAC0lB,OAAN,CAAc;AACZ9c,MAAAA,KAAK,EAAE8iB,YADK;AAEZrtB,MAAAA,MAAM,EAAEsT,MAAF,oBAAEA,MAAM,CAAE5E,SAAR;AAFI,KAAd;AAID,GALD;;AAOA,MAAM1D,SAAS,4BAAGrJ,KAAK,CAAC6c,GAAN,CAAUoP,OAAV,CAAkB5iB,SAAlB,CAA4BrJ,KAAK,CAACkqB,MAAlC,CAAH,oCAAgD,KAA/D;AAEA,SACEjqB,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACC;oBAAmB;GAA1C,EACEwC,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACstB;GAAvB,EACE7qB,4BAAA,CAAC8H,eAAD;AAAiB9C,IAAAA,IAAI,EAAC;AAAMhC,IAAAA,QAAQ,EAAE;AAAOyE,IAAAA,eAAe,EAAE;AAAOxC,IAAAA,OAAO,EAAEA;GAA9E,CADF,CADF,EAKEjF,4BAAA,MAAA;AACEC,IAAAA,SAAS,EAAEC,UAAE,CAAC3C,QAAM,CAACwtB,WAAR,iBACVxtB,QAAM,CAAC0tB,qBADG,IACqBU,WAAW,KAAK,KADrC;GADf,EAIE3rB,4BAAA,CAACyX,gBAAD;AACEzS,IAAAA,IAAI,EAAC;AACLmT,IAAAA,OAAO;AACPnV,IAAAA,QAAQ,EAAE;AACVoG,IAAAA,SAAS,EAAEA;AACX6O,IAAAA,OAAO,EAAE,iBAACvG,MAAD;;;AACPA,MAAAA,MAAM,CAACgF,UAAP,yBAAkB3W,KAAK,CAACyrB,YAAxB,mCAAwC,EAAxC;AACA9Z,MAAAA,MAAM,CAAC5D,WAAP,CAAmB,KAAnB;AACA8J,MAAAA,SAAS,CAAClG,MAAD,CAAT;AACAA,MAAAA,MAAM,CAACvF,KAAP;AACAuF,MAAAA,MAAM,CAAC0E,MAAP,CAAcE,QAAd,CAAuB,UAAC3N,KAAD;AACrB+iB,QAAAA,eAAe,CAAC/iB,KAAD,CAAf;AACA5I,QAAAA,KAAK,CAACksB,cAAN,CAAqBtjB,KAArB;AACD,OAHD;AAID;GAdH,CAJF,CALF,EA0BGgjB,WAAW,IACV3rB,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAAC2tB;GAAvB,EACElrB,4BAAA,CAAC6b,eAAD;AACEzS,IAAAA,SAAS,EAAEA;AACXpE,IAAAA,IAAI,EAAC;AACL2D,IAAAA,KAAK,EAAE8iB;AACPnP,IAAAA,iBAAiB,EAAEvc,KAAK,CAACuc;GAJ3B,CADF,CA3BJ,EAoCGqP,WAAW,IAAI3rB,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAAC4tB;GAAvB,CApClB,EAqCGQ,WAAW,IACV3rB,4BAAA,SAAA;AACEC,IAAAA,SAAS,EAAEC,UAAE,CAAC3C,QAAM,CAACqG,MAAR,EAAgBrG,QAAM,CAAC6tB,UAAvB;kBACF;AACXhrB,IAAAA,OAAO,EAAE;AACPwrB,MAAAA,cAAc,CAAC,KAAD,CAAd;AACD;GALH,EAME5rB,4BAAA,CAACksB,yBAAD;AAAkB9oB,IAAAA,OAAO,EAAC;AAAQD,IAAAA,IAAI,EAAC;AAAOlD,IAAAA,SAAS,EAAE1C,QAAM,CAACwG;GAAhE,CANF,CAtCJ,EA+CG,CAAC4nB,WAAD,IACC3rB,4BAAA,SAAA;AACEC,IAAAA,SAAS,EAAEC,UAAE,CAAC3C,QAAM,CAACqG,MAAR,EAAgBrG,QAAM,CAAC8tB,UAAvB;kBACF;AACXjrB,IAAAA,OAAO,EAAE;AACPwrB,MAAAA,cAAc,CAAC,IAAD,CAAd;AACD;GALH,EAME5rB,4BAAA,CAACmsB,wBAAD;AAAiB/oB,IAAAA,OAAO,EAAC;AAAQD,IAAAA,IAAI,EAAC;AAAOlD,IAAAA,SAAS,EAAE1C,QAAM,CAACwG;GAA/D,CANF,CAhDJ,EAyDE/D,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAACutB;GAAvB,EACE9qB,4BAAA,CAAC8Y,iBAAD,MAAA,EACE9Y,4BAAA,CAAC0Y,YAAD;AACEtY,IAAAA,OAAO,EAAE;AACPya,MAAAA,mBAAmB,CAAC9a,KAAK,CAAC6c,GAAN,CAAU9B,OAAX,CAAnB;AACD;GAHH,CADF,CADF,CAzDF,CADF;AAqED,CAtGM;AAwGP,AAAO,IAAMpT,WAAW,GAAG,SAAdA,WAAc,CACzBoT,OADyB,EAEzB3R,OAFyB;AAIzB,SAAO2R,OAAO,CAACC,WAAR,CAAoB;AACzB7Z,IAAAA,KAAK,EAAE,KADkB;AAEzB8Z,IAAAA,wBAAwB,EAAE,KAFD;AAGzBhD,IAAAA,SAAS,EAAE,OAHc;AAIzBiD,IAAAA,yBAAyB,EAAE,KAJF;AAKzBC,IAAAA,UAAU,EAAE;AACVC,MAAAA,IAAI,EAAEpC,kBAAkB,CAACqT,OADf;AAEVZ,MAAAA,YAAY,EAAEriB,OAAO,CAACqiB,YAFZ;AAGVvB,MAAAA,MAAM,EAAE9gB,OAAO,CAAC8gB;AAHN;AALa,GAApB,CAAP;AAWD,CAfM;;AC9LP,SAASoC,mBAAT,CAA6BC,GAA7B;AACE,MAAIA,GAAJ,EAAS;AACP,WAAOA,GAAG,CAACC,IAAJ,GAAWnX,OAAX,CAAmB,SAAnB,EAA8B,GAA9B,CAAP;AACD,GAFD,MAEO;AACL,WAAOkX,GAAP;AACD;AACF;;AAED,SAASE,eAAT,CAAyBF,GAAzB;AACE,SAAOA,GAAG,CAAClX,OAAJ,CAAY,SAAZ,EAAuB,EAAvB,CAAP;AACD;;AAED,SAASqX,eAAT,CAAyBH,GAAzB;AACE,SAAOD,mBAAmB,CAACG,eAAe,CAACF,GAAD,CAAf,CAAqBlX,OAArB,CAA6B,IAA7B,EAAmC,GAAnC,CAAD,CAA1B;AACD;;AAED,SAAgBsX,mBAAmBC;AACjC,MAAMC,cAAc,GAA2B;AAC7CC,IAAAA,MAAM,EAAE,sBADqC;AAE7C7C,IAAAA,MAAM,EAAE,sBAFqC;AAG7C8C,IAAAA,SAAS,EAAE,yBAHkC;AAI7CC,IAAAA,MAAM,EAAE;AAJqC,GAA/C;AAOA,SAAOJ,OAAO,CAACvX,OAAR,CAAgB,iDAAhB,EAAmE,UAAC4X,CAAD,EAAIC,EAAJ;AACxE,WAAOL,cAAc,CAACK,EAAD,CAArB;AACD,GAFM,CAAP;AAGD;;AAED,SAASC,aAAT,CACEC,KADF;MAEIC,kBAAAA;MAAYC,oBAAAA;MAAcC,yBAAAA;AAE5B,MAAMC,aAAa,GAAGtlB,GAAG,CAACklB,KAAD,EAAQ,CAAC,QAAD,EAAW,MAAX,EAAmBC,UAAnB,CAAR,CAAzB;AACA,MAAMI,YAAY,GAAGH,YAAY,GAAGplB,GAAG,CAACklB,KAAD,EAAQ,CAAC,QAAD,EAAW,MAAX,EAAmBE,YAAnB,CAAR,CAAN,GAAkD,IAAnF;AACA,MAAMI,WAAW,GAAGxlB,GAAG,CAACklB,KAAD,EAAQ,CAAC,QAAD,EAAW,MAAX,EAAmBG,iBAAnB,CAAR,CAAvB;AACA,MAAMI,IAAI,GAKMH,aAAa,IAAIC,YAAjB,IAAiCC,WALjD;;AAOA,MAAIE,QAAQ,CAACD,IAAD,CAAR,IAAkBA,IAAI,CAACra,GAA3B,EAAgC;AAC9B,QAAMC,KAAK,GACTrL,GAAG,CAACklB,KAAD,EAAQ,CAAC,QAAD,EAAW,OAAX,EAAoBC,UAApB,CAAR,CAAH,IACAnlB,GAAG,CAACklB,KAAD,EAAQ,CAAC,QAAD,EAAW,OAAX,EAAoBE,YAAY,IAAI,EAApC,CAAR,CADH,IAEAplB,GAAG,CAACklB,KAAD,EAAQ,CAAC,QAAD,EAAW,OAAX,EAAoBG,iBAApB,CAAR,CAFH,IAGAb,eAAe,CAACiB,IAAI,CAACE,QAAN,CAJjB;AAMA,QAAMjB,OAAO,GAAGD,kBAAkB,CAACgB,IAAI,CAACra,GAAN,CAAlC;AAEA,WAAO;AACLC,MAAAA,KAAK,EAALA,KADK;AAEL6Z,MAAAA,KAAK,EAALA,KAFK;AAGL9Z,MAAAA,GAAG,EAAEsZ,OAHA;AAIL;AACAkB,MAAAA,WAAW,EAAEvH,OAAO,CAACiH,aAAD,CALf;AAML;AACA;AACA;AACAO,MAAAA,UAAU,EAAExH,OAAO,CAACkH,YAAD,CATd;AAUL;AACAO,MAAAA,UAAU,SAAOza,KAAP,UAAiBqZ,OAAjB;AAXL,KAAP;AAaD,GAtBD,MAsBO;AACL,WAAO,IAAP;AACD;AACF;;AAED,SAAsBqB,gBAAtB;AAAA;AAAA;;;qEAAO,iBAAgChE,MAAhC,EAAsDgC,OAAtD;AAAA;AAAA;AAAA;AAAA;AAAA;AACL;AACA;AACMiC,YAAAA,YAHD,GAGgBjE,MAAM,CAACkE,MAAP,CAAc,UAACf,KAAD;AACjC,qBAAO,CAACllB,GAAG,CAACklB,KAAD,EAAQ,CAAC,QAAD,EAAW,MAAX,EAAmBnB,OAAO,CAACoB,UAA3B,CAAR,CAAX;AACD,aAFoB,CAHhB;AAOCe,YAAAA,aAPD,GAOiBnE,MAAM,CACzBtb,GADmB,CACf,UAACye,KAAD;AAAA,qBAAWD,aAAa,CAACC,KAAD,EAAQnB,OAAR,CAAxB;AAAA,aADe;AAAA,aAGnBkC,MAHmB,CAGZ,UAACf,KAAD;AAAA,qBAAWA,KAAK,KAAK,IAArB;AAAA,aAHY,CAPjB;AAaL;;AAbK,kBAcDc,YAAY,CAAC7d,MAAb,GAAsB,CAdrB;AAAA;AAAA;AAAA;;AAeGge,YAAAA,cAfH,GAeoBD,aAAa;AAAA,aAEjCD,MAFoB,CAEb;AAAA,kBAAGL,WAAH,SAAGA,WAAH;AAAA,qBAAqB,CAACA,WAAtB;AAAA,aAFa,EAGpBnf,GAHoB,CAGhB;kBAAG4E,cAAAA;kBAAOwa,mBAAAA;kBAAYX,cAAAA;AACzB,kBAAM/mB,IAAI,GAAG0nB,UAAU,GAAG9B,OAAO,CAACqB,YAAX,GAA0BrB,OAAO,CAACsB,iBAAzD;AACA,qBAAO;AACLha,gBAAAA,KAAK,EAALA,KADK;AAEL+W,gBAAAA,YAAY,EAAE8C,KAAK,CAACkB,MAAN,CAAaX,IAAb,CAAkBtnB,IAAlB,EAAkCiN,GAF3C;AAGLiX,gBAAAA,gBAAgB,EAAEhX,KAHb;AAIL8W,gBAAAA,WAAW,EAAE0D,UAAU,yBAAuB1nB,IAAvB,8BAAoDA,IAApD,MAJlB;AAKL+mB,gBAAAA,KAAK,EAAEA;AALF,eAAP;AAOD,aAZoB,CAfpB;AAAA,6CA6BI;AACLmB,cAAAA,SAAS,EAAEF,cADN;AAELG,cAAAA,KAAK,EAAEJ;AAFF,aA7BJ;;AAAA;AAAA,6CAkCE;AACLI,cAAAA,KAAK,EAAEJ;AADF,aAlCF;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;AC3FP;AAEA;AASA,SAASK,YAAT,CAAsBlb,KAAtB;AACEA,EAAAA,KAAK,GAAGA,KAAK,IAAI,EAAjB;AACAA,EAAAA,KAAK,GAAGA,KAAK,CAAC8B,OAAN,CAAc,cAAd,EAA8B,EAA9B,CAAR;AACA9B,EAAAA,KAAK,GAAGA,KAAK,CAAC8B,OAAN,CAAc,cAAd,EAA8B,EAA9B,CAAR;AACA,SAAO9B,KAAP;AACD;;AAED,SAAS9C,IAAT,CAAcP,IAAd;AACE,SAAOA,IAAI,CAACwe,KAAL,CAAW,GAAX,EAAgB7kB,KAAhB,EAAP;AACD;;AAED,SAAS8kB,IAAT,CAAcze,IAAd;AACE,MAAM0e,QAAQ,GAAG1e,IAAI,CAACwe,KAAL,CAAW,GAAX,CAAjB;AACAE,EAAAA,QAAQ,CAAC/kB,KAAT;AACA,SAAO+kB,QAAQ,CAACpd,IAAT,CAAc,GAAd,CAAP;AACD;;AAED,IAAMqd,UAAU,GAAG;AACjBC,EAAAA,MAAM,EAAE,gBAAU/lB,KAAV;AACN,WAAO;AACLA,MAAAA,KAAK,EAAEA,KAAK,CAAC,CAAD,CADP;AAELmH,MAAAA,IAAI,EAAEnH,KAAK,CAAC,CAAD,CAFN;AAGL4R,MAAAA,IAAI,EAAElK,IAAI,CAAC1H,KAAK,CAAC,CAAD,CAAN,CAHL;AAILwK,MAAAA,KAAK,EAAEkb,YAAY,CAACE,IAAI,CAAC5lB,KAAK,CAAC,CAAD,CAAN,CAAL;AAJd,KAAP;AAMD,GARgB;AASjBtE,EAAAA,GAAG,EAAE,aAAUsE,KAAV;AACH,WAAO;AACLA,MAAAA,KAAK,EAAEA,KAAK,CAAC,CAAD,CADP;AAELmH,MAAAA,IAAI,EAAEnH,KAAK,CAAC,CAAD,CAFN;AAGLud,MAAAA,EAAE,EAAEvd,KAAK,CAAC,CAAD;AAHJ,KAAP;AAKD,GAfgB;AAgBjBvH,EAAAA,KAAK,EAAE,eAAUuH,KAAV;AACL,WAAO;AACLA,MAAAA,KAAK,EAAEA,KAAK,CAAC,CAAD,CADP;AAELud,MAAAA,EAAE,EAAEvd,KAAK,CAAC,CAAD,CAFJ;AAGL4R,MAAAA,IAAI,EAAElK,IAAI,CAAC1H,KAAK,CAAC,CAAD,CAAN,CAHL;AAILwK,MAAAA,KAAK,EAAEkb,YAAY,CAACE,IAAI,CAAC5lB,KAAK,CAAC,CAAD,CAAN,CAAL;AAJd,KAAP;AAMD;AAvBgB,CAAnB;AA0BA,IAAMgmB,MAAM,GAAG;AACbD,EAAAA,MAAM,EAAE,iCADK;AAEbrqB,EAAAA,GAAG,EAAE,oCAFQ;AAGbjD,EAAAA,KAAK,EAAE;AAHM,CAAf;AAKA,AAAO,IAAMwtB,UAAU,gBAAGC,UAAU,CAAC,QAAD,CAA7B;AACP,AAAO,IAAMC,QAAQ,gBAAGD,UAAU,CAAC,KAAD,CAA3B;AACP,AAAO,IAAME,UAAU,gBAAGF,UAAU,CAAC,OAAD,CAA7B;AAEP,SAAgBG,mBAAmBlf;AACjC,MAAIoW,EAAE,GAAG+I,cAAc,CAACnf,IAAD,CAAvB;AAEAmE,EAAAA,OAAO,CAAC2a,UAAU,CAAC9e,IAAD,CAAX,EAAmB,UAAC4e,MAAD;AACxBxI,IAAAA,EAAE,IAAI,CAAN;AACApW,IAAAA,IAAI,GAAGA,IAAI,CAACmF,OAAL,CAAayZ,MAAM,CAAC/lB,KAApB,EAA2BumB,QAAQ,CAACR,MAAD,EAASxI,EAAT,CAAnC,CAAP;AACApW,IAAAA,IAAI,IAAI,OAAOqf,UAAU,CAACT,MAAD,EAASxI,EAAT,CAAzB;AACD,GAJM,CAAP;AAMA,SAAOpW,IAAP;AACD;;AAED,SAASsf,WAAT,CAAqBtf,IAArB;AACE,MAAMuf,MAAM,GAAQ,EAApB;AACA,MAAMC,OAAO,GAAQ,EAArB;AAEArb,EAAAA,OAAO,CAAC8a,UAAU,CAACjf,IAAD,CAAX,EAAmB,UAAC1O,KAAD;AACxB,QAAMmuB,YAAY,GAAGF,MAAM,CAACjuB,KAAK,CAACmZ,IAAP,CAA3B;AACA,QAAMtM,OAAO,GAAGuhB,MAAM,CAAC,EAAD,EAAKpuB,KAAL,CAAtB;;AAEA,QAAI,CAACmuB,YAAL,EAAmB;AACjBF,MAAAA,MAAM,CAACphB,OAAO,CAACsM,IAAT,CAAN,GAAuBtM,OAAvB;AACD,KAFD,MAEO,IAAIwhB,QAAQ,CAACxhB,OAAD,CAAR,IAAqB,CAACwhB,QAAQ,CAACF,YAAD,CAAlC,EAAkD;AACvDA,MAAAA,YAAY,CAACpc,KAAb,GAAqBlF,OAAO,CAACkF,KAA7B;AACD;;AAEDmc,IAAAA,OAAO,CAACrhB,OAAO,CAACiY,EAAT,CAAP,GAAsBqJ,YAAY,IAAIthB,OAAtC;AACD,GAXM,CAAP;AAaA,SAAO;AACLohB,IAAAA,MAAM,EAAEA,MADH;AAELC,IAAAA,OAAO,EAAEA;AAFJ,GAAP;AAID;;AAED,SAAgBI,YAAY5f;AAC1B,MAAM6f,MAAM,GAAGP,WAAW,CAACtf,IAAD,CAA1B;AACA,MAAM8f,WAAW,GAAQ,EAAzB;AACA,MAAMC,MAAM,GAAU,EAAtB;AACA,MAAMC,QAAQ,GAAU,EAAxB;AACA,MAAI5b,CAAC,GAAG,CAAR;;AAGAD,EAAAA,OAAO,CAAC6a,QAAQ,CAAChf,IAAD,CAAT,EAAiB,UAACzL,GAAD;AACtB,QAAM0rB,QAAQ,GAAGJ,MAAM,CAACL,OAAP,CAAejrB,GAAG,CAAC6hB,EAAnB,CAAjB;;AACA,QAAI,CAAC6J,QAAL,EAAe;AACb;AACD;;AACD,QAAMxV,IAAI,GAAGwV,QAAQ,CAACxV,IAAtB;AACA,QAAIyV,QAAQ,GAAGJ,WAAW,CAACrV,IAAD,CAA1B;;AAEA,QAAI,CAACyV,QAAL,EAAe;AACbJ,MAAAA,WAAW,CAACrV,IAAD,CAAX,GAAoByV,QAAQ,GAAG9b,CAA/B;AACAA,MAAAA,CAAC,IAAI,CAAL;AACA2b,MAAAA,MAAM,CAAC5M,IAAP,CAAYuM,MAAM,CAAC;AAAES,QAAAA,KAAK,EAAED;AAAT,OAAD,EAAsBD,QAAtB,CAAlB;AACD;;;AAGDD,IAAAA,QAAQ,CAAC7M,IAAT,CAAcuM,MAAM,CAAC;AAAES,MAAAA,KAAK,EAAED;AAAT,KAAD,EAAsB3rB,GAAtB,CAApB;AACD,GAhBM,CAAP;;AAmBA4P,EAAAA,OAAO,CAAC8a,UAAU,CAACjf,IAAD,CAAX,EAAmB,UAAC1O,KAAD;AACxB0O,IAAAA,IAAI,GAAGA,IAAI,CAACmF,OAAL,CAAa7T,KAAK,CAACuH,KAAnB,EAA0B,EAA1B,CAAP;AACD,GAFM,CAAP;;AAKAmH,EAAAA,IAAI,GAAGA,IAAI,CAACmF,OAAL,CAAa,YAAb,EAA2B,EAA3B,CAAP;AACAnF,EAAAA,IAAI,IAAI,MAAR;;AAGAmE,EAAAA,OAAO,CAAC6b,QAAD,EAAW,UAACzrB,GAAD;AAChByL,IAAAA,IAAI,GAAGA,IAAI,CAACmF,OAAL,CAAa5Q,GAAG,CAACsE,KAAjB,EAAwBumB,QAAQ,CAAC7qB,GAAD,EAAMA,GAAG,CAAC4rB,KAAV,CAAhC,CAAP;AACD,GAFM,CAAP;;AAKAhc,EAAAA,OAAO,CAAC4b,MAAD,EAAS,UAACzuB,KAAD;AACd0O,IAAAA,IAAI,IAAI,OAAOqf,UAAU,CAAC/tB,KAAD,EAAQA,KAAK,CAAC6uB,KAAd,CAAzB;AACD,GAFM,CAAP;AAIA,SAAOngB,IAAP;AACD;AAED;;;;AAIA,SAAS+e,UAAT,CAAoB7T,IAApB;AACE,SAAO,UAAClL,IAAD;AAAA,WAAkBogB,OAAO,CAACpgB,IAAD,EAAOkL,IAAP,CAAP,CAAoBzM,GAApB,CAAwBkgB,UAAU,CAACzT,IAAD,CAAlC,CAAlB;AAAA,GAAP;AACD;;AAED,SAAgBiU,eAAekB;AAC7B,MAAIC,QAAQ,CAACD,YAAD,CAAZ,EAA4B;AAC1BA,IAAAA,YAAY,GAAGpB,UAAU,CAACoB,YAAD,CAAzB;AACD;;AAED,MAAME,GAAG,GAAGF,YAAY,CACrB5hB,GADS,CACL,UAAC+hB,CAAD;AAAA,WAAYA,CAAC,CAACpK,EAAd;AAAA,GADK,EAET3X,GAFS,CAEL,UAAC+hB,CAAD;AAAA,WAAYC,QAAQ,CAACD,CAAD,EAAI,EAAJ,CAApB;AAAA,GAFK,EAGTvC,MAHS,CAGF,UAACuC,CAAD;AAAA,WAAYE,QAAQ,CAACF,CAAD,CAAR,IAAeA,CAAC,GAAG,CAA/B;AAAA,GAHE,CAAZ;AAKA,SAAOD,GAAG,CAACpgB,MAAJ,GAAa,CAAb,GAAiBzG,GAAG,CAAC6mB,GAAD,CAAH,IAAY,CAA7B,GAAiC,CAAxC;AACD;;AAED,SAASH,OAAT,CAAiBpgB,IAAjB,EAA+BkL,IAA/B;AACE,MAAMyV,KAAK,GAAG,OAAOzV,IAAI,KAAK,OAAT,GAAmB,GAAnB,GAAyB,EAAhC,CAAd;AACA,MAAM0V,OAAO,GAAG,EAAhB;AACA,MAAMC,EAAE,GAAG,IAAIC,MAAJ,CAAWjC,MAAM,CAAC3T,IAAD,CAAN,CAAa6V,MAAxB,EAAgCJ,KAAhC,CAAX;AACA,MAAIK,KAAK,GAAGH,EAAE,CAACI,IAAH,CAAQjhB,IAAR,CAAZ;;AAEA,SAAOghB,KAAP,EAAc;AACZJ,IAAAA,OAAO,CAACzN,IAAR,CAAa6N,KAAb;AACAH,IAAAA,EAAE,CAACK,SAAH,GAAeF,KAAK,CAACG,KAAN,GAAcH,KAAK,CAAC,CAAD,CAAL,CAAS7gB,MAAtC;AACA6gB,IAAAA,KAAK,GAAGH,EAAE,CAACI,IAAH,CAAQjhB,IAAR,CAAR;AACD;;AAED,SAAO4gB,OAAP;AACD;AAED;;;;;AAIA,SAASjB,QAAT,CAAkBtd,IAAlB;AACE,SAAOqb,QAAQ,CAACrb,IAAD,CAAR,IAAkBie,QAAQ,CAACje,IAAI,CAACgB,KAAN,CAA1B,IAA0ChB,IAAI,CAACgB,KAAL,CAAWlD,MAAX,GAAoB,CAArE;AACD;;AAED,SAASkf,UAAT,CAAoBhd,IAApB,EAA2D+T,EAA3D;AACE,MAAItT,MAAM,GAAG,MAAMsT,EAAN,GAAW,KAAX,GAAmB/T,IAAI,CAACoI,IAArC;;AACA,MAAIkV,QAAQ,CAACtd,IAAD,CAAZ,EAAoB;AAClBS,IAAAA,MAAM,IAAI,OAAOT,IAAI,CAACgB,KAAZ,GAAoB,GAA9B;AACD;;AACD,SAAOP,MAAP;AACD;;AAED,SAASsc,QAAT,CAAkB/c,IAAlB,EAA0C+T,EAA1C;AACE,SAAO,MAAM/T,IAAI,CAACrC,IAAX,GAAkB,IAAlB,GAAyBoW,EAAzB,GAA8B,GAArC;AACD;;SC7Le0F,sBAAsBhsB;AAKpC,MAAQ6c,GAAR,GAAgC7c,KAAhC,CAAQ6c,GAAR;AAAA,MAAalL,MAAb,GAAgC3R,KAAhC,CAAa2R,MAAb;AAAA,MAAqBuY,MAArB,GAAgClqB,KAAhC,CAAqBkqB,MAArB;;AAGA,MAAMoH,4BAA4B;AAAA,8DAAG,iBAAOrH,MAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,mBAC/BA,MAD+B;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAEEgE,gBAAgB,CAAChE,MAAD,EAAS;AAC1DoD,gBAAAA,UAAU,EAAEnD,MAD8C;AAE1DqD,gBAAAA,iBAAiB,EAAE1Q,GAAG,CAACoP,OAAJ,WAFuC;AAG1DqB,gBAAAA,YAAY,EAAEzQ,GAAG,CAACoP,OAAJ,CAAYsC,SAAZ,CAAsBrE,MAAtB;AAH4C,eAAT,CAFlB;;AAAA;AAAA;AAEzBsE,cAAAA,KAFyB,yBAEzBA,KAFyB;AAElBD,cAAAA,SAFkB,yBAElBA,SAFkB;;AAAA,oBAO7BC,KAAK,IAAIA,KAAK,CAACne,MAAN,GAAe,CAPK;AAAA;AAAA;AAAA;;AAAA,mBAQ3Bke,SAR2B;AAAA;AAAA;AAAA;;AAAA;AAAA,qBASF/D,sBAAsB,CAAC3N,GAAG,CAAC9B,OAAL,EAAc;AAC7DmP,gBAAAA,MAAM,EAAEA,MADqD;AAE7DD,gBAAAA,MAAM,EAAEsE;AAFqD,eAAd,CATpB;;AAAA;AASvBgD,cAAAA,YATuB;;AAAA,kBAaxBA,YAbwB;AAAA;AAAA;AAAA;;AAAA,oBAcrBvoB,KAAK,CAAC,mCAAD,CAdgB;;AAAA;AAAA,+CAiBxBwlB,KAAK,CAAC7f,GAAN,CAAU,UAAC4D,IAAD;AAAA,uBAAUA,IAAI,CAACyb,UAAf;AAAA,eAAV,EAAqCxc,IAArC,CAA0C,MAA1C,CAjBwB;;AAAA;AAAA,+CAoB5B,EApB4B;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAA5B8f,4BAA4B;AAAA;AAAA;AAAA,KAAlC;;AAuBA,SAAO;AACLnsB,IAAAA,QAAQ,EAAE;AACRqN,MAAAA,EAAE,EAAE;AACFb,QAAAA,MAAM,QAAN,YAAAA,MAAM,CAAEzM,OAAR,CAAgBsN,EAAhB;AACD,OAHO;AAIRE,MAAAA,EAAE,EAAE;AACFf,QAAAA,MAAM,QAAN,YAAAA,MAAM,CAAEzM,OAAR,CAAgBwN,EAAhB;AACD,OANO;AAORC,MAAAA,EAAE,EAAE;AACFhB,QAAAA,MAAM,QAAN,YAAAA,MAAM,CAAEzM,OAAR,CAAgByN,EAAhB;AACD;AATO,KADL;AAYLtN,IAAAA,MAAM,EAAE;AACNG,MAAAA,MAAM,EAAE;AACNmM,QAAAA,MAAM,QAAN,YAAAA,MAAM,CAAEzM,OAAR,CAAgBM,MAAhB;AACD,OAHK;AAINF,MAAAA,IAAI,EAAE;AACJqM,QAAAA,MAAM,QAAN,YAAAA,MAAM,CAAEzM,OAAR,CAAgBI,IAAhB;AACD,OANK;AAONI,MAAAA,KAAK,EAAE;AACLiM,QAAAA,MAAM,QAAN,YAAAA,MAAM,CAAEzM,OAAR,CAAgBQ,KAAhB;AACD,OATK;AAUNI,MAAAA,EAAE,EAAE;AACF6L,QAAAA,MAAM,QAAN,YAAAA,MAAM,CAAEzM,OAAR,CAAgBY,EAAhB;AACD,OAZK;AAaNF,MAAAA,EAAE,EAAE;AACF+L,QAAAA,MAAM,QAAN,YAAAA,MAAM,CAAEzM,OAAR,CAAgBU,EAAhB;AACD,OAfK;AAgBNO,MAAAA,MAAM,EAAE;AACNwL,QAAAA,MAAM,QAAN,YAAAA,MAAM,CAAEzM,OAAR,CAAgBiB,MAAhB;AACD,OAlBK;AAmBNE,MAAAA,IAAI,EAAE;AACJsL,QAAAA,MAAM,QAAN,YAAAA,MAAM,CAAEzM,OAAR,CAAgBmB,IAAhB;AACD,OArBK;AAsBNE,MAAAA,EAAE,EAAE;AACFoL,QAAAA,MAAM,QAAN,YAAAA,MAAM,CAAEzM,OAAR,CAAgBqB,EAAhB;AACD,OAxBK;AAyBNE,MAAAA,MAAM,EAAE;AACNkL,QAAAA,MAAM,QAAN,YAAAA,MAAM,CAAEzM,OAAR,CAAgBuB,MAAhB;AACD,OA3BK;AA4BNC,MAAAA,MAAM,EAAE;AACNiL,QAAAA,MAAM,QAAN,YAAAA,MAAM,CAAEzM,OAAR,CAAgBwB,MAAhB;AACD;AA9BK,KAZH;AA4CLK,IAAAA,OAAO,EAAE;AACPC,MAAAA,IAAI,EAAE;AACJ2K,QAAAA,MAAM,QAAN,YAAAA,MAAM,CAAEzM,OAAR,CAAgB8B,IAAhB;AACD,OAHM;AAIPC,MAAAA,IAAI,EAAE;AACJ0K,QAAAA,MAAM,QAAN,YAAAA,MAAM,CAAEzM,OAAR,CAAgB+B,IAAhB;AACD;AANM,KA5CJ;AAoDLjB,IAAAA,UAAU;AAAA,uEAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACL2L,MADK;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAIVA,gBAAAA,MAAM,CAACxF,mBAAP;AACM2F,gBAAAA,YALI,GAKWH,MAAM,CAACvE,eAAP,EALX;AAAA;AAAA,uBAMW4Z,oBAAoB,CAACnK,GAAG,CAAC9B,OAAL,EAAc;AAAEjJ,kBAAAA,YAAY,EAAZA;AAAF,iBAAd,CAN/B;;AAAA;AAMJ6C,gBAAAA,MANI;;AAOV,oBAAIA,MAAJ,EAAY;AACVhD,kBAAAA,MAAM,CAACzM,OAAP,CAAeqN,IAAf,CAAoBoC,MAAM,CAACrB,GAA3B,EAAgCxB,YAAY,IAAI6C,MAAM,CAACzE,IAAvD,EAA6DyE,MAAM,CAACpB,KAApE;AACD;;AATS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,OApDL;AA+DL1M,IAAAA,sBAAsB;AAAA,mFAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACjB8K,MADiB;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA,uBAIDmW,0BAA0B,CAACjL,GAAG,CAAC9B,OAAL,CAJzB;;AAAA;AAIhBpG,gBAAAA,MAJgB;;AAKtB,oBAAIA,MAAJ,EAAY;AACVhD,kBAAAA,MAAM,CAAC8E,MAAP,CAAc9B,MAAd;AACD;;AAPqB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,OA/DjB;AAwEL/N,IAAAA,WAAW;AAAA,wEAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACN+K,MADM;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA,uBAIU8W,qBAAqB,CAAC5L,GAAG,CAAC9B,OAAL,CAJ/B;;AAAA;AAILpG,gBAAAA,MAJK;;AAKX,oBAAIA,MAAJ,EAAY;AACVhD,kBAAAA,MAAM,CAACzM,OAAP,CAAe4N,KAAf,CAAqB6B,MAArB;AACD;;AAPU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,OAxEN;AAiFL7N,IAAAA,aAAa,EAAE;AACb,UAAI,CAAC6K,MAAL,EAAa;AACX;AACD;;AACD,UAAIzB,IAAI,GAAGyB,MAAM,CAAC+E,UAAP,EAAX;;AACA,UAAI,CAACxG,IAAL,EAAW;AACT;AACD;;AACDA,MAAAA,IAAI,GAAGshB,kBAAA,CAAiCthB,IAAjC,CAAP;AACAA,MAAAA,IAAI,GAAGshB,WAAA,CAA0BthB,IAA1B,CAAP;AACAyB,MAAAA,MAAM,CAACgF,UAAP,CAAkBzG,IAAlB;AACA2M,MAAAA,GAAG,CAAC4U,QAAJ,CAAaC,OAAb,CAAqB,mEAArB;AACD,KA7FI;AA8FL/qB,IAAAA,oBAAoB;AAAA,iFAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACfgL,MADe;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA,uBAICoY,8BAA8B,CAAClN,GAAG,CAAC9B,OAAL,CAJ/B;;AAAA;AAIdpG,gBAAAA,MAJc;;AAKpB,oBAAIA,MAAJ,EAAY;AACVhD,kBAAAA,MAAM,CAAC8E,MAAP,CAAc9B,MAAd;AACD;;AAPmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,OA9Ff;AAuGLlN,IAAAA,WAAW;AAAA,wEAAE;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,oBACNkK,MADM;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA,uBAKwBkL,GAAG,CAAC8U,SAAJ,CAAcC,YAAd,CAA2B;AAC1DC,kBAAAA,OAAO,EAAE;AAAEC,oBAAAA,YAAY,EAAE;AAAhB;AADiD,iBAA3B,CALxB;;AAAA;AAAA;AAKO1E,gBAAAA,KALP,yBAKD2E,MALC;AAAA;AAAA,uBASmBT,4BAA4B,CAAC,CAAClE,KAAD,CAAD,CAT/C;;AAAA;AASH4E,gBAAAA,aATG;AAUTrgB,gBAAAA,MAAM,CAAC8E,MAAP,CAAcub,aAAd;;AAVS;AAAA;AAYTrgB,gBAAAA,MAAM,CAACvF,KAAP;AAZS;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,OAvGN;AAsHL5E,IAAAA,iBAAiB;AAAA,8EAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACZmK,MADY;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA,uBAKMkL,GAAG,CAAC9B,OAAJ,CAAYkX,oBAAZ,CAAiC;AACpD/H,kBAAAA,MAAM,EAAEA;AAD4C,iBAAjC,CALN;;AAAA;AAKTD,gBAAAA,MALS;AAAA;AAAA,uBAQaqH,4BAA4B,CAACrH,MAAD,CARzC;;AAAA;AAQT+H,gBAAAA,aARS;AASfrgB,gBAAAA,MAAM,CAAC8E,MAAP,CAAcub,aAAd;;AATe;AAAA;AAWfrgB,gBAAAA,MAAM,CAACvF,KAAP;AAXe;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,OAtHZ;AAoILzE,IAAAA,WAAW;AAAA,yEAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACNgK,MADM;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA,uBAIUhK,WAAW,CAACkV,GAAG,CAAC9B,OAAL,EAAc;AAC5C0Q,kBAAAA,YAAY,EAAE9Z,MAAM,CAAC+E,UAAP,EAD8B;AAE5CwT,kBAAAA,MAAM,EAAElqB,KAAK,CAACkqB;AAF8B,iBAAd,CAJrB;;AAAA;AAILvV,gBAAAA,MAJK;AASXhD,gBAAAA,MAAM,CAACgF,UAAP,CAAkBhC,MAAM,CAAC/L,KAAzB;;AAEA,oBAAI+L,MAAM,CAACtW,MAAX,EAAmB;AACjBsT,kBAAAA,MAAM,CAAC3E,SAAP,CAAiB2H,MAAM,CAACtW,MAAxB;AACD;;AAEDsT,gBAAAA,MAAM,CAACvF,KAAP;;AAfW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,OApIN;AAqJLtE,IAAAA,YAAY,EAAE;AAEZ;AACD;AAxJI,GAAP;AA0JD;;ACpLD,IAAMtK,QAAM,GAAG;AACb00B,EAAAA,SAAS,eAAEx0B,WAAG,CAAC;AACbC,IAAAA,OAAO,EAAE,MADI;AAEbE,IAAAA,aAAa,EAAE,QAFF;AAGbs0B,IAAAA,UAAU,EAAEj0B,MAAM,CAACsd;AAHN,GAAD;AADD,CAAf;AAwBA,SAAgB4W,eACdpyB;;;AAMA,wBAAwCC,cAAK,CAACkH,QAAN,wBAAuBnH,KAAK,CAACyrB,YAA7B,kCAA6C,EAA7C,CAAxC;AAAA,MAAOC,YAAP;AAAA,MAAqBC,eAArB;;AACA,yBAAsC1rB,cAAK,CAACkH,QAAN,CAA4B,QAA5B,CAAtC;AAAA,MAAOkrB,WAAP;AAAA,MAAoBC,cAApB;;AACA,yBAA4BryB,cAAK,CAACkH,QAAN,CAA6C,IAA7C,CAA5B;AAAA,MAAOwK,MAAP;AAAA,MAAekG,SAAf;;AACA,yBAA8C5X,cAAK,CAACkH,QAAN,CAAwB,KAAxB,CAA9C;AAAA,MAAOO,eAAP;AAAA,MAAwB6qB,kBAAxB;;AAEAtyB,EAAAA,cAAK,CAAC6X,SAAN,CAAgB;AACd,QAAInG,MAAM,IAAI3R,KAAK,CAACkY,OAApB,EAA6B;AAC3BlY,MAAAA,KAAK,CAACkY,OAAN,CAAcvG,MAAd,EAD2B;;AAG3Boa,MAAAA,UAAU,CAAC;AACTpa,QAAAA,MAAM,CAACxD,OAAP;AACD,OAFS,EAEP,CAFO,CAAV;AAGD;;AAEF,GATD,EASG,CAACwD,MAAD,CATH;AAWA1R,EAAAA,cAAK,CAAC6X,SAAN,CAAgB;AACd9X,IAAAA,KAAK,CAAC6c,GAAN,CAAU2V,MAAV,CAAiBC,GAAjB,CAAqB,QAArB,EAA+B,OAA/B,EAAwCnR,IAAxC,CAA6C,UAAC1Y,KAAD;AAC3C2pB,MAAAA,kBAAkB,CAAC3pB,KAAD,CAAlB;AACD,KAFD;AAID,GALD,EAKG,EALH;AAOA3I,EAAAA,cAAK,CAAC6X,SAAN,CAAgB;AACd,QAAInG,MAAJ,EAAY;AACVA,MAAAA,MAAM,CAAC5D,WAAP,CAAmB/N,KAAK,CAACiD,QAAzB;AACD;AACF,GAJD,EAIG,CAAC0O,MAAD,EAAS3R,KAAK,CAACiD,QAAf,CAJH;AAMA,MAAMyvB,gBAAgB,GAAG/gB,MAAM,KAAK,IAAX,IAAmB3R,KAAK,CAACiD,QAAzB,IAAqCovB,WAAW,KAAK,QAA9E;AAEA,MAAMhpB,SAAS,4BAAGrJ,KAAK,CAAC6c,GAAN,CAAUoP,OAAV,CAAkB5iB,SAAlB,CAA4BrJ,KAAK,CAAC6c,GAAN,CAAUC,KAAV,CAAgBoN,MAA5C,CAAH,oCAA0D,KAAzE;AAEA,MAAMhlB,OAAO,GAAGjF,cAAK,CAAC+b,OAAN,CAAc;AAC5B,WAAOgQ,qBAAqB,CAAC;AAAEnP,MAAAA,GAAG,EAAE7c,KAAK,CAAC6c,GAAb;AAAkBlL,MAAAA,MAAM,EAANA,MAAlB;AAA0BuY,MAAAA,MAAM,EAAElqB,KAAK,CAAC6c,GAAN,CAAUC,KAAV,CAAgBoN;AAAlD,KAAD,CAA5B;AAED,GAHe,EAGb,CAACvY,MAAD,CAHa,CAAhB;AAKA,MAAMghB,gBAAgB,GAAG1yB,cAAK,CAAC2yB,WAAN,CAAkB;AACzC9X,IAAAA,mBAAmB,CAAC9a,KAAK,CAAC6c,GAAN,CAAU9B,OAAX,CAAnB;AAED,GAHwB,EAGtB,EAHsB,CAAzB;AAKA,SACE9a,4BAAA,MAAA;AAAKC,IAAAA,SAAS,EAAE1C,QAAM,CAAC00B;oBAAwB;GAA/C,EACEjyB,4BAAA,CAACc,YAAD;AACEC,IAAAA,MAAM,EAAEqxB;AACR/xB,IAAAA,QAAQ,EAAE,kBAAClC,GAAD;AACRk0B,MAAAA,cAAc,CAACl0B,GAAD,CAAd;AACD;GAJH,CADF,EAOE6B,4BAAA,CAAC8H,eAAD;AACE9C,IAAAA,IAAI,EAAC;AACLhC,IAAAA,QAAQ,EAAEyvB;AACVhrB,IAAAA,eAAe,EAAEA;AACjBxC,IAAAA,OAAO,EAAEA;GAJX,CAPF,EAaEjF,4BAAA,CAACyX,gBAAD;AACEO,IAAAA,SAAS,EAAEjY,KAAK,CAACiY;AACjBhT,IAAAA,IAAI,EAAC;AACLmT,IAAAA,OAAO,EAAEia,WAAW,KAAK;AACzBpvB,IAAAA,QAAQ,EAAEyvB;AACVrpB,IAAAA,SAAS,EAAEA;AACX6O,IAAAA,OAAO,EAAE,iBAACvG,MAAD;;;AACPA,MAAAA,MAAM,CAACgF,UAAP,yBAAkB3W,KAAK,CAACyrB,YAAxB,mCAAwC,EAAxC;AACA9Z,MAAAA,MAAM,CAAC5D,WAAP,CAAmB/N,KAAK,CAACiD,QAAzB;AACA4U,MAAAA,SAAS,CAAClG,MAAD,CAAT;AACAA,MAAAA,MAAM,CAAC0E,MAAP,CAAcE,QAAd,CAAuB,UAAC3N,KAAD;AACrB;AACA,YAAMiqB,YAAY,GAAGjqB,KAAK,CAACyM,OAAN,CAAc,SAAd,EAAyB,EAAzB,CAArB;AACArV,QAAAA,KAAK,CAACksB,cAAN,CAAqB2G,YAArB;AACAlH,QAAAA,eAAe,CAAC/iB,KAAD,CAAf;AACD,OALD;AAMD;GAhBH,CAbF,EA+BGypB,WAAW,KAAK,SAAhB,IACCpyB,4BAAA,CAAC6b,eAAD;AACEzS,IAAAA,SAAS,EAAEA;AACX4O,IAAAA,SAAS,EAAEjY,KAAK,CAACiY;AACjBhT,IAAAA,IAAI,EAAC;AACL2D,IAAAA,KAAK,EAAE8iB;AACPnP,IAAAA,iBAAiB,EAAEvc,KAAK,CAACuc;GAL3B,CAhCJ,EAwCEtc,4BAAA,CAAC8Y,iBAAD,MAAA,EACE9Y,4BAAA,CAAC0Y,YAAD;AAActY,IAAAA,OAAO,EAAEsyB;GAAvB,CADF,CAxCF,EA2CE1yB,4BAAA,CAACwc,mBAAD;AAAqBI,IAAAA,GAAG,EAAE7c,KAAK,CAAC6c;AAAKjU,IAAAA,KAAK,EAAE8iB;GAA5C,CA3CF,CADF;AA+CD;AAED,SAAgBoH,wBAAwB9yB;AACtC,SACEC,4BAAA,CAAC8yB,gCAAD;AACEjoB,IAAAA,QAAQ,EAAE;AACVgS,IAAAA,KAAK,EAAE9c,KAAK,CAAC6c,GAAN,CAAUC;AACjBkW,IAAAA,mBAAmB,EAAEhzB,KAAK,CAACgzB;GAH7B,EAIG;QAAGpqB,aAAAA;QAAO3F,gBAAAA;QAAU4I,gBAAAA;QAAUonB,qBAAAA;AAC7B;AACA,WACEhzB,4BAAA,CAACmyB,cAAD,eACMpyB,KADN;AAEE+O,MAAAA,GAAG,uBAAqBkkB,aAF1B;AAGExH,MAAAA,YAAY,EAAE7iB,KAHhB;AAIE3F,MAAAA,QAAQ,EAAEA,QAJZ;AAKEipB,MAAAA,cAAc,EAAErgB;AALlB,OADF;AASD,GAfH,CADF;AAmBD;;IC1IYqnB,kBAAkB,GAC7B,SADWA,kBACX,CAACrW,GAAD,EAAyBN,iBAAzB;AAAA,SACA,UACEnT,OADF;;;AAKE,QAAI,wBAAAA,OAAO,CAAC+R,UAAR,yCAAoBC,IAApB,MAA6BpC,kBAAkB,CAACqC,UAApD,EAAgE;AAC9D,aAAO8X,qCAAmB,CAACC,UAApB,CAA+BhqB,OAA/B,EAAwC;AAC7C,eAAOnJ,4BAAA,CAACua,qBAAD,MAAA,CAAP;AACD,OAFM,CAAP;AAGD,KAJD,MAIO,IAAI,yBAAApR,OAAO,CAAC+R,UAAR,0CAAoBC,IAApB,MAA6BpC,kBAAkB,CAAChT,UAApD,EAAgE;AACrE,UAAM8L,YAAY,GAAG1I,OAAO,CAAC+R,UAAR,CAAmBrJ,YAAxC;AACA,aAAOqhB,qCAAmB,CAACC,UAApB,CAAsDhqB,OAAtD,EAA+D;YAAGsc,eAAAA;AACvE,eAAOzlB,4BAAA,CAACwlB,eAAD;AAAiB3T,UAAAA,YAAY,EAAEA;AAAc4T,UAAAA,OAAO,EAAEA;SAAtD,CAAP;AACD,OAFM,CAAP;AAGD,KALM,MAKA,IAAI,yBAAAtc,OAAO,CAAC+R,UAAR,0CAAoBC,IAApB,MAA6BpC,kBAAkB,CAACnS,sBAApD,EAA4E;AACjF,aAAOssB,qCAAmB,CAACC,UAApB,CAA+BhqB,OAA/B,EAAwC;YAAGsc,gBAAAA;AAChD,eAAOzlB,4BAAA,CAACsnB,2BAAD;AAA6B7B,UAAAA,OAAO,EAAEA;SAAtC,CAAP;AACD,OAFM,CAAP;AAGD,KAJM,MAIA,IAAI,yBAAAtc,OAAO,CAAC+R,UAAR,0CAAoBC,IAApB,MAA6BpC,kBAAkB,CAACpS,WAApD,EAAiE;AACtE,aAAOusB,qCAAmB,CAACC,UAApB,CAAuDhqB,OAAvD,EAAgE;YAAGsc,gBAAAA;AACxE,eAAOzlB,4BAAA,CAAC8nB,gBAAD;AAAkBrC,UAAAA,OAAO,EAAEA;SAA3B,CAAP;AACD,OAFM,CAAP;AAGD,KAJM,MAIA,IAAI,yBAAAtc,OAAO,CAAC+R,UAAR,0CAAoBC,IAApB,MAA6BpC,kBAAkB,CAACrS,oBAApD,EAA0E;AAC/E,aAAOwsB,qCAAmB,CAACC,UAApB,CACLhqB,OADK,EAEL;YAAGsc,gBAAAA;AACD,eAAOzlB,4BAAA,CAACqpB,yBAAD;AAA2B5D,UAAAA,OAAO,EAAEA;SAApC,CAAP;AACD,OAJI,CAAP;AAMD,KAPM,MAOA,IAAI,yBAAAtc,OAAO,CAAC+R,UAAR,0CAAoBC,IAApB,MAA6BpC,kBAAkB,CAACyR,kBAApD,EAAwE;AAC7E,UAAMP,MAAM,GAAG9gB,OAAO,CAAC+R,UAAR,CAAmB+O,MAAlC;AACA,UAAMD,MAAM,GAAG7gB,OAAO,CAAC+R,UAAR,CAAmB8O,MAAlC;AACA,aAAOkJ,qCAAmB,CAACC,UAApB,CAAwChqB,OAAxC,EAAiD;YAAGsc,gBAAAA;AACzD,eAAOzlB,4BAAA,CAAC+pB,6BAAD;AAA+BtE,UAAAA,OAAO,EAAEA;AAASwE,UAAAA,MAAM,EAAEA;AAAQD,UAAAA,MAAM,EAAEA;SAAzE,CAAP;AACD,OAFM,CAAP;AAGD,KANM,MAMA,IAAI,yBAAA7gB,OAAO,CAAC+R,UAAR,0CAAoBC,IAApB,MAA6BpC,kBAAkB,CAACqT,OAApD,EAA6D;AAClE,UAAMZ,YAAY,GAAGriB,OAAO,CAAC+R,UAAR,CAAmBsQ,YAAxC;AACA,UAAMvB,OAAM,GAAG9gB,OAAO,CAAC+R,UAAR,CAAmB+O,MAAlC;AACA,aAAOiJ,qCAAmB,CAACC,UAApB,CAA8ChqB,OAA9C,EAAuD;YAAGsc,gBAAAA;AAC/D,eACEzlB,4BAAA,CAACurB,kBAAD;AACEU,UAAAA,cAAc,EAAE,wBAACtjB,KAAD;;;AACd,gBAAIA,KAAJ,EAAW;AAAA;;AACT,qBAAOiU,GAAP,kCAAOA,GAAG,CAAEC,KAAZ,qBAAO,WAAYjR,QAAZ,CAAqBjD,KAArB,CAAP;AACD;;AACD,mBAAOiU,GAAP,mCAAOA,GAAG,CAAEC,KAAZ,qBAAO,YAAYuW,WAAZ,EAAP;AACD;AACD3N,UAAAA,OAAO,EAAEA;AACT+F,UAAAA,YAAY,EAAEA;AACdvB,UAAAA,MAAM,EAAEA;AACRrN,UAAAA,GAAG,EAAEA;AACLN,UAAAA,iBAAiB,EAAEA;SAXrB,CADF;AAeD,OAhBM,CAAP;AAiBD;;AACD,WAAOsF,OAAO,CAACT,MAAR,EAAP;AACD,GA1DD;AAAA,CADK;;ICVMkS,oBAAoB,GAAG,SAAvBA,oBAAuB,CAClCzW,GADkC;AAGlC,MAAM1B,UAAU,GAAG0B,GAAG,CAAC1B,UAAJ,CAAeoY,UAAlC;;AACA,MAAIpY,UAAU,CAACC,IAAX,KAAoBpC,kBAAkB,CAACqC,UAA3C,EAAuD;AACrDwB,IAAAA,GAAG,CAAC1U,MAAJ,CAAWqrB,gBAAX;AACA,WAAOvzB,4BAAA,CAACua,qBAAD,MAAA,CAAP;AACD,GAHD,MAGO,IAAIW,UAAU,CAACC,IAAX,KAAoBpC,kBAAkB,CAAChT,UAA3C,EAAuD;AAC5D,QAAM8L,YAAY,GAAGqJ,UAAU,CAACrJ,YAAhC;AACA+K,IAAAA,GAAG,CAAC1U,MAAJ,CAAWqrB,gBAAX;AACA,WAAOvzB,4BAAA,CAACwlB,eAAD;AAAiB3T,MAAAA,YAAY,EAAEA;AAAc4T,MAAAA,OAAO,EAAE7I,GAAG,CAAC4W;KAA1D,CAAP;AACD,GAJM,MAIA,IAAItY,UAAU,CAACC,IAAX,KAAoBpC,kBAAkB,CAACnS,sBAA3C,EAAmE;AACxEgW,IAAAA,GAAG,CAAC1U,MAAJ,CAAWqrB,gBAAX;AACA,WAAOvzB,4BAAA,CAACsnB,2BAAD;AAA6B7B,MAAAA,OAAO,EAAE7I,GAAG,CAAC4W;KAA1C,CAAP;AACD,GAHM,MAGA,IAAItY,UAAU,CAACC,IAAX,KAAoBpC,kBAAkB,CAACpS,WAA3C,EAAwD;AAC7DiW,IAAAA,GAAG,CAAC1U,MAAJ,CAAWqrB,gBAAX;AACA,WAAOvzB,4BAAA,CAAC8nB,gBAAD;AAAkBrC,MAAAA,OAAO,EAAE7I,GAAG,CAAC4W;KAA/B,CAAP;AACD,GAHM,MAGA,IAAItY,UAAU,CAACC,IAAX,KAAoBpC,kBAAkB,CAACrS,oBAA3C,EAAiE;AACtEkW,IAAAA,GAAG,CAAC1U,MAAJ,CAAWqrB,gBAAX;AACA,WAAOvzB,4BAAA,CAACqpB,yBAAD;AAA2B5D,MAAAA,OAAO,EAAE7I,GAAG,CAAC4W;KAAxC,CAAP;AACD,GAHM,MAGA,IAAItY,UAAU,CAACC,IAAX,KAAoBpC,kBAAkB,CAACyR,kBAA3C,EAA+D;AACpE,QAAMP,MAAM,GAAG/O,UAAU,CAAC+O,MAA1B;AACA,QAAMD,MAAM,GAAG9O,UAAU,CAAC8O,MAA1B;AACApN,IAAAA,GAAG,CAAC1U,MAAJ,CAAWqrB,gBAAX;AACA,WAAOvzB,4BAAA,CAAC+pB,6BAAD;AAA+BtE,MAAAA,OAAO,EAAE7I,GAAG,CAAC4W;AAAOvJ,MAAAA,MAAM,EAAEA;AAAQD,MAAAA,MAAM,EAAEA;KAA3E,CAAP;AACD,GALM,MAKA,IAAI9O,UAAU,CAACC,IAAX,KAAoBpC,kBAAkB,CAACqT,OAA3C,EAAoD;AACzD,QAAMnC,OAAM,GAAG/O,UAAU,CAAC+O,MAA1B;AACA,QAAMuB,YAAY,GAAGtQ,UAAU,CAACsQ,YAAhC,CAFyD;;AAIzD5O,IAAAA,GAAG,CAAC1U,MAAJ,CAAW2jB,YAAX,CAAwB,MAAxB;AACA,WACE7rB,4BAAA,CAACurB,kBAAD;AACE9F,MAAAA,OAAO,EAAE7I,GAAG,CAAC4W;AACbvH,MAAAA,cAAc,EAAE;AAEf;AACDT,MAAAA,YAAY,EAAEA;AACdvB,MAAAA,MAAM,EAAEA;AACRrN,MAAAA,GAAG,EAAEA;KAPP,CADF;AAWD;;AAED,SAAO5c,4BAAA,MAAA,MAAA,CAAP;AACD,CA5CM;;;;;;;;"}
\ No newline at end of file
diff --git a/dist/field-editor-markdown.cjs.production.min.js b/dist/field-editor-markdown.cjs.production.min.js
index b39e0041dd382e8c3c6a70e444fbb59a5c2aa496..64ff8a2005dc090f6cf92bb2d6ec346127dd66c8 100644
--- a/dist/field-editor-markdown.cjs.production.min.js
+++ b/dist/field-editor-markdown.cjs.production.min.js
@@ -1,2 +1,2 @@
-"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0}),require("codemirror/mode/markdown/markdown"),require("codemirror/mode/xml/xml"),require("codemirror/addon/edit/continuelist"),require("codemirror/addon/mode/overlay"),require("codemirror/addon/display/autorefresh");var t=require("react"),n=e(t),r=require("emotion"),a=e(require("@contentful/f36-tokens")),i=require("@contentful/field-editor-shared"),o=require("@contentful/f36-components"),l=require("@contentful/f36-icons"),c=e(require("codemirror"));require("codemirror/addon/edit/matchbrackets");var s=e(require("lodash/throttle")),u=e(require("lodash/transform")),d=e(require("lodash/get")),m=e(require("lodash/range")),f=e(require("lodash/min")),p=e(require("lodash/max")),h=e(require("lodash/times")),g=e(require("lodash/repeat")),v=e(require("dompurify")),b=e(require("markdown-to-jsx")),E=e(require("lodash/inRange")),k=e(require("lodash/isObject")),w=e(require("lodash/extend")),x=e(require("lodash/isString")),y=e(require("lodash/isFinite")),C=e(require("lodash/forEach"));function q(e,t,n,r,a,i,o){try{var l=e[i](o),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,a)}function S(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){q(i,r,a,o,l,"next",e)}function l(e){q(i,r,a,o,l,"throw",e)}o(void 0)}))}}function I(){return(I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function N(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t.indexOf(n=i[r])>=0||(a[n]=e[n]);return a}function L(e,t){return t||(t=e.slice(0)),e.raw=t,e}var z={root:r.css({display:"flex",zIndex:10,flexDirection:"row",justifyContent:"flex-end",overflow:"hidden",marginBottom:"-1px",fontSize:a.fontSizeM}),tab:r.css({cursor:"pointer",color:a.gray700,padding:a.spacingXs,minWidth:"70px",border:"1px solid "+a.gray400,borderTopLeftRadius:a.borderRadiusSmall,borderTopRightRadius:a.borderRadiusSmall,marginLeft:a.spacingXs,textAlign:"center",backgroundColor:a.gray100,borderBottomColor:a.gray100,outline:"none","&:focus":{boxShadow:a.boxShadowHeavy},transition:"all "+a.transitionEasingDefault+" "+a.transitionDurationShort}),inactiveTab:r.css({background:a.gray200,borderBottomColor:a.gray400,"&:hover":{background:a.gray300}})};function T(e){var t;return n.createElement("div",{className:r.cx(z.tab,(t={},t[z.inactiveTab]=!1===e.isActive,t)),onClick:function(){e.onSelect(e.name)},onKeyDown:function(t){13===t.keyCode&&e.onSelect(e.name)},tabIndex:0,role:"tab","aria-controls":e.name,"aria-selected":!0===e.isActive,"data-test-id":e.testId},e.children)}function M(e){return n.createElement("div",{className:z.root},n.createElement(T,{name:"editor",onSelect:e.onSelect,isActive:"editor"===e.active,testId:"markdown-tab-md"},"Editor"),n.createElement(T,{name:"preview",onSelect:e.onSelect,isActive:"preview"===e.active,testId:"markdown-tab-preview"},"Preview"))}var H=["label"],B=["label"],F=["label"],A=["label"],D=["label"],R=["label"],O=["label"],V=["label"],P=["label"],j=["label"],_=r.css({position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",border:"0"}),U=function(e){var t=e.label,r=N(e,H);return n.createElement("svg",I({width:14,height:14,viewBox:"0 0 1792 1792"},r),n.createElement("path",{d:"M1411 541l-355 355 355 355 144-144q29-31 70-14 39 17 39 59v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l144-144-355-355-355 355 144 144q31 30 14 69-17 40-59 40H192q-26 0-45-19t-19-45v-448q0-42 40-59 39-17 69 14l144 144 355-355-355-355-144 144q-19 19-45 19-12 0-24-5-40-17-40-59V192q0-26 19-45t45-19h448q42 0 59 40 17 39-14 69L541 381l355 355 355-355-144-144q-31-30-14-69 17-40 59-40h448q26 0 45 19t19 45v448q0 42-39 59-13 5-25 5-26 0-45-19z"}),n.createElement("span",{className:_},t))},X=function(e){var t=e.label,r=N(e,B);return n.createElement("svg",I({width:14,height:14,viewBox:"0 0 1792 1792"},r),n.createElement("path",{d:"M1760 896q14 0 23 9t9 23v64q0 14-9 23t-23 9H32q-14 0-23-9t-9-23v-64q0-14 9-23t23-9h1728zM483 832q-28-35-51-80-48-98-48-188 0-181 134-309 133-127 393-127 50 0 167 19 66 12 177 48 10 38 21 118 14 123 14 183 0 18-5 45l-12 3-84-6-14-2q-50-149-103-205-88-91-210-91-114 0-182 59-67 58-67 146 0 73 66 140t279 129q69 20 173 66 58 28 95 52H483zm507 256h411q7 39 7 92 0 111-41 212-23 56-71 104-37 35-109 81-80 48-153 66-80 21-203 21-114 0-195-23l-140-40q-57-16-72-28-8-8-8-22v-13q0-108-2-156-1-30 0-68l2-37v-44l102-2q15 34 30 71t22.5 56 12.5 27q35 57 80 94 43 36 105 57 59 22 132 22 64 0 139-27 77-26 122-86 47-61 47-129 0-84-81-157-34-29-137-71z"}),n.createElement("span",{className:_},t))},W=function(e){var t=e.label,r=N(e,F);return n.createElement("svg",I({width:14,height:14,viewBox:"0 0 1792 1792"},r),n.createElement("path",{d:"M352 832q0 14-9 23L55 1143q-9 9-23 9-13 0-22.5-9.5T0 1120V544q0-13 9.5-22.5T32 512q14 0 23 9l288 288q9 9 9 23zm1440 480v192q0 13-9.5 22.5t-22.5 9.5H32q-13 0-22.5-9.5T0 1504v-192q0-13 9.5-22.5T32 1280h1728q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5t-22.5 9.5H672q-13 0-22.5-9.5T640 1120V928q0-13 9.5-22.5T672 896h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5T1760 768H672q-13 0-22.5-9.5T640 736V544q0-13 9.5-22.5T672 512h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5T1760 384H32q-13 0-22.5-9.5T0 352V160q0-13 9.5-22.5T32 128h1728q13 0 22.5 9.5t9.5 22.5z"}),n.createElement("span",{className:_},t))},G=function(e){var t=e.label,r=N(e,A);return n.createElement("svg",I({width:14,height:14,viewBox:"0 0 1792 1792"},r),n.createElement("path",{d:"M384 544v576q0 13-9.5 22.5T352 1152q-14 0-23-9L41 855q-9-9-9-23t9-23l288-288q9-9 23-9 13 0 22.5 9.5T384 544zm1408 768v192q0 13-9.5 22.5t-22.5 9.5H32q-13 0-22.5-9.5T0 1504v-192q0-13 9.5-22.5T32 1280h1728q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5t-22.5 9.5H672q-13 0-22.5-9.5T640 1120V928q0-13 9.5-22.5T672 896h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5T1760 768H672q-13 0-22.5-9.5T640 736V544q0-13 9.5-22.5T672 512h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5T1760 384H32q-13 0-22.5-9.5T0 352V160q0-13 9.5-22.5T32 128h1728q13 0 22.5 9.5t9.5 22.5z"}),n.createElement("span",{className:_},t))},K=function(e){var t=e.label,r=N(e,D);return n.createElement("svg",I({width:18,height:14,viewBox:"0 0 2304 1792"},r),n.createElement("path",{d:"M640 1632l384-192v-314l-384 164v342zm-64-454l404-173-404-173-404 173zm1088 454l384-192v-314l-384 164v342zm-64-454l404-173-404-173-404 173zm-448-293l384-165V454l-384 164v267zm-64-379l441-189-441-189-441 189zm1088 518v416q0 36-19 67t-52 47l-448 224q-25 14-57 14t-57-14l-448-224q-4-2-7-4-2 2-7 4l-448 224q-25 14-57 14t-57-14L71 1554q-33-16-52-47t-19-67v-416q0-38 21.5-70T78 906l434-186V320q0-38 21.5-70t56.5-48l448-192q23-10 50-10t50 10l448 192q35 16 56.5 48t21.5 70v400l434 186q36 16 57 48t21 70z"}),n.createElement("span",{className:_},t))},$=function(e){var t=e.label,r=N(e,R);return n.createElement("svg",I({width:14,height:14,viewBox:"0 0 1792 1792"},r),n.createElement("path",{d:"M576 1376v-192q0-14-9-23t-23-9H224q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm0-384V800q0-14-9-23t-23-9H224q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm512 384v-192q0-14-9-23t-23-9H736q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zM576 608V416q0-14-9-23t-23-9H224q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm512 384V800q0-14-9-23t-23-9H736q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm512 384v-192q0-14-9-23t-23-9h-320q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm-512-768V416q0-14-9-23t-23-9H736q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm512 384V800q0-14-9-23t-23-9h-320q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm0-384V416q0-14-9-23t-23-9h-320q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm128-320v1088q0 66-47 113t-113 47H224q-66 0-113-47t-47-113V288q0-66 47-113t113-47h1344q66 0 113 47t47 113z"}),n.createElement("span",{className:_},t))},Y=function(e){var t=e.label,r=N(e,O);return n.createElement("svg",I({width:14,height:14,viewBox:"0 0 1792 1792"},r),n.createElement("path",{d:"M1360 1307l35 159q3 12-3 22.5t-17 14.5l-5 1q-4 2-10.5 3.5t-16 4.5-21.5 5.5-25.5 5-30 5-33.5 4.5-36.5 3-38.5 1q-234 0-409-130.5T511 1054h-95q-13 0-22.5-9.5T384 1022V909q0-13 9.5-22.5T416 877h66q-2-57 1-105h-67q-14 0-23-9t-9-23V626q0-14 9-23t23-9h98q67-210 243.5-338T1158 128q102 0 194 23 11 3 20 15 6 11 3 24l-43 159q-3 13-14 19.5t-24 2.5l-4-1q-4-1-11.5-2.5L1261 364l-22.5-3.5-26-3-29-2.5-29.5-1q-126 0-226 64T778 594h468q16 0 25 12 10 12 7 26l-24 114q-5 26-32 26H734q-3 37 0 105h459q15 0 25 12 9 12 6 27l-24 112q-2 11-11 18.5t-20 7.5H782q48 117 149.5 185.5T1160 1308q18 0 36-1.5t33.5-3.5 29.5-4.5 24.5-5 18.5-4.5l12-3 5-2q13-5 26 2 12 7 15 21z"}),n.createElement("span",{className:_},t))},Z=function(e){var t=e.label,r=N(e,V);return n.createElement("svg",I({width:14,height:14,viewBox:"0 0 1792 1792"},r),n.createElement("path",{d:"M1792 1248v320q0 40-28 68t-68 28h-320q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h96V960H960v192h96q40 0 68 28t28 68v320q0 40-28 68t-68 28H736q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h96V960H320v192h96q40 0 68 28t28 68v320q0 40-28 68t-68 28H96q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h96V960q0-52 38-90t90-38h512V640h-96q-40 0-68-28t-28-68V224q0-40 28-68t68-28h320q40 0 68 28t28 68v320q0 40-28 68t-68 28h-96v192h512q52 0 90 38t38 90v192h96q40 0 68 28t28 68z"}),n.createElement("span",{className:_},t))},Q=function(e){var t=e.label,r=N(e,P);return n.createElement("svg",I({width:14,height:14,viewBox:"0 0 1792 1792"},r),n.createElement("path",{d:"M1664 896q0 156-61 298t-164 245-245 164-298 61q-172 0-327-72.5T305 1387q-7-10-6.5-22.5t8.5-20.5l137-138q10-9 25-9 16 2 23 12 73 95 179 147t225 52q104 0 198.5-40.5T1258 1258t109.5-163.5T1408 896t-40.5-198.5T1258 534t-163.5-109.5T896 384q-98 0-188 35.5T548 521l137 138q31 30 14 69-17 40-59 40H192q-26 0-45-19t-19-45V256q0-42 40-59 39-17 69 14l130 129q107-101 244.5-156.5T896 128q156 0 298 61t245 164 164 245 61 298z"}),n.createElement("span",{className:_},t))},J=function(e){var t=e.label,r=N(e,j);return n.createElement("svg",I({width:14,height:14,viewBox:"0 0 1792 1792"},r),n.createElement("path",{d:"M1664 256v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l138-138q-148-137-349-137-104 0-198.5 40.5T534 534 424.5 697.5 384 896t40.5 198.5T534 1258t163.5 109.5T896 1408q119 0 225-52t179-147q7-10 23-12 15 0 25 9l137 138q9 8 9.5 20.5t-7.5 22.5q-109 132-264 204.5T896 1664q-156 0-298-61t-245-164-164-245-61-298 61-298 164-245 245-164 298-61q147 0 284.5 55.5T1425 340l130-129q29-31 70-14 39 17 39 59z"}),n.createElement("span",{className:_},t))},ee=function(e){var t=function(t){e.onSelect(t)};return n.createElement(o.Menu,null,n.createElement(o.Menu.Trigger,null,e.children),n.createElement(o.Menu.List,null,n.createElement(o.Menu.Item,{testId:"markdown-action-button-heading-h1",onClick:function(){return t("h1")}},"Heading 1"),n.createElement(o.Menu.Item,{testId:"markdown-action-button-heading-h2",onClick:function(){return t("h2")}},"Heading 2"),n.createElement(o.Menu.Item,{testId:"markdown-action-button-heading-h3",onClick:function(){return t("h3")}},"Heading 3")))},te=function(e){return e.canAddNew?n.createElement(ne,I({},e)):n.createElement(o.Button,{isDisabled:e.disabled,startIcon:n.createElement(l.AssetIcon,null),testId:"markdownEditor.linkExistingAssets",size:"small",variant:"secondary",onClick:function(){e.onSelectExisting()}},"Insert media")},ne=function(e){return n.createElement(o.Menu,{placement:"bottom-end"},n.createElement(o.Menu.Trigger,null,n.createElement(o.Button,{endIcon:n.createElement(l.ChevronDownIcon,null),isDisabled:e.disabled,startIcon:n.createElement(l.AssetIcon,null),testId:"markdownEditor.insertMediaDropdownTrigger",size:"small",variant:"secondary"},"Insert media")),n.createElement(o.Menu.List,null,n.createElement(o.Menu.Item,{testId:"markdownEditor.uploadAssetsAndLink",onClick:function(){return e.onAddNew()}},"Add new media and link"),n.createElement(o.Menu.Item,{testId:"markdownEditor.linkExistingAssets",onClick:function(){return e.onSelectExisting()}},"Link existing media")))},re=["tooltip","onClick","children","className","variant","tooltipPlace","isDisabled"],ae={root:r.css({position:"relative",zIndex:Number(a.zIndexWorkbenchHeader),border:"1px solid "+a.gray400,backgroundColor:a.gray100,padding:a.spacingXs,borderTopLeftRadius:a.borderRadiusSmall}),button:r.css({height:"30px",width:"36px",marginLeft:a.spacing2Xs,marginRight:a.spacing2Xs}),icon:r.css({fill:a.gray700,verticalAlign:"middle"}),zenButton:r.css({marginLeft:a.spacingXs}),zenButtonPressed:r.css({backgroundColor:a.gray400}),tooltip:r.css({zIndex:Number(a.zIndexTooltip)})},ie=n.forwardRef((function(e,t){var a=e.tooltip,i=e.onClick,l=e.children,c=e.className,s=e.variant,u=void 0===s?"transparent":s,d=e.tooltipPlace,m=void 0===d?"top":d,f=e.isDisabled,p=void 0!==f&&f,h=N(e,re);return n.createElement(o.Tooltip,{className:ae.tooltip,placement:m,content:a},n.createElement(o.IconButton,I({},h,{ref:t,className:r.cx(ae.button,c),isDisabled:p,onClick:i,variant:u,size:"small",icon:l,"aria-label":a})))}));function oe(e){var t="zen"===e.mode?"bottom":"top";return n.createElement(n.Fragment,null,n.createElement(ee,{onSelect:function(t){t&&e.actions.headings[t]&&e.actions.headings[t]()}},n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-heading",tooltip:"Headings",tooltipPlace:t},n.createElement(l.HeadingIcon,{"aria-label":"Headings",className:ae.icon}))),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-bold",tooltip:"Bold",tooltipPlace:t,onClick:e.actions.simple.bold},n.createElement(l.FormatBoldIcon,{"aria-label":"Bold",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-italic",tooltip:"Italic",tooltipPlace:t,onClick:e.actions.simple.italic},n.createElement(l.FormatItalicIcon,{"aria-label":"Italic",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-quote",tooltip:"Quote",tooltipPlace:t,onClick:e.actions.simple.quote},n.createElement(l.QuoteIcon,{"aria-label":"Quote",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-ul",tooltip:"Unordered list",tooltipPlace:t,onClick:e.actions.simple.ul},n.createElement(l.ListBulletedIcon,{"aria-label":"Unordered list",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-ol",tooltip:"Ordered list",tooltipPlace:t,onClick:e.actions.simple.ol},n.createElement(l.ListNumberedIcon,{"aria-label":"Ordered list",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-link",tooltip:"Link",tooltipPlace:t,onClick:e.actions.insertLink},n.createElement(l.LinkIcon,{"aria-label":"Link",className:ae.icon})))}function le(e){var t="zen"===e.mode?"bottom":"top";return n.createElement(n.Fragment,null,n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-strike",tooltip:"Strike out",tooltipPlace:t,onClick:e.actions.simple.strike},n.createElement(X,{label:"Strike out",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-code",tooltip:"Code block",tooltipPlace:t,onClick:e.actions.simple.code},n.createElement(l.CodeIcon,{"aria-label":"Code block",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-hr",tooltip:"Horizontal rule",tooltipPlace:t,onClick:e.actions.simple.hr},n.createElement(l.HorizontalRuleIcon,{"aria-label":"Horizontal rule",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-indent",tooltip:"Increase indentation",tooltipPlace:t,onClick:e.actions.simple.indent},n.createElement(W,{label:"Increase indentation",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-dedent",tooltip:"Decrease indentation",tooltipPlace:t,onClick:e.actions.simple.dedent},n.createElement(G,{label:"Decrease indentation",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-embed",tooltip:"Embed external content",tooltipPlace:t,onClick:e.actions.embedExternalContent},n.createElement(K,{label:"Embed external content",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-table",tooltip:"Insert table",tooltipPlace:t,onClick:e.actions.insertTable},n.createElement($,{label:"Insert table",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-special",tooltip:"Insert special character",tooltipPlace:t,onClick:e.actions.insertSpecialCharacter},n.createElement(Y,{label:"Insert special character",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-organizeLinks",tooltip:"Organize links",tooltipPlace:t,onClick:e.actions.organizeLinks},n.createElement(Z,{label:"Organize links",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-undo",tooltip:"Undo",tooltipPlace:t,onClick:e.actions.history.undo},n.createElement(Q,{label:"Undo",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-redo",tooltip:"Redo",tooltipPlace:t,onClick:e.actions.history.redo},n.createElement(J,{label:"Redo",className:ae.icon})))}function ce(e){var t=n.useState(!1),r=t[0],a=t[1];return n.createElement("div",{className:ae.root},n.createElement(o.Flex,{justifyContent:"space-between"},n.createElement(o.Flex,null,n.createElement(oe,I({},e)),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-toggle-additional",tooltip:r?"Hide additional actions":"More actions",onClick:function(){a(!r)}},n.createElement(l.MoreHorizontalIcon,{className:ae.icon}))),n.createElement(o.Flex,null,n.createElement(te,{disabled:e.disabled,onSelectExisting:e.actions.linkExistingMedia,onAddNew:e.actions.addNewMedia,canAddNew:e.canUploadAssets}),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-zen",variant:"secondary",onClick:e.actions.openZenMode,className:ae.zenButton,tooltip:"Expand"},n.createElement(U,{label:"Expand",className:ae.icon})))),r&&n.createElement(o.Flex,{justifyContent:"space-between",marginTop:"spacingXs"},n.createElement(o.Flex,null,n.createElement(le,I({},e)))))}function se(e){return n.createElement("div",{className:ae.root},n.createElement(o.Flex,{justifyContent:"space-between"},n.createElement(o.Flex,null,n.createElement(oe,I({},e)),n.createElement(le,I({},e))),n.createElement(o.Flex,null,n.createElement(te,{disabled:e.disabled,onSelectExisting:e.actions.linkExistingMedia,onAddNew:e.actions.addNewMedia,canAddNew:e.canUploadAssets}),n.createElement(o.IconButton,{testId:"markdown-action-button-zen-close",variant:"secondary",size:"small",className:r.cx(ae.zenButton,ae.zenButtonPressed),onClick:function(){e.actions.closeZenMode()},icon:n.createElement(U,{label:"Collapse",className:ae.icon}),"aria-label":"Collapse"}))))}ie.displayName="ToolbarButton";var ue=n.memo((function(e){return n.createElement("zen"===e.mode?se:ce,I({},e))}));ue.displayName="MarkdownToolbar";var de=d(window,"navigator.userAgent",""),me=d(window,"navigator.platform",""),fe="Ctrl";function pe(){return fe}function he(e){if("string"!=typeof e)return e;if(!e.match(/^([+-]?(?:\d+|\d*\.\d+))([a-z]*|%)$/))throw new Error("Couldn't match unit in given string");return parseFloat(e)}function ge(e){return function(t){t.lineStartsWith(e)?t.removeFromLineBeginning(e.length):t.insertAtLineBeginning(e)}}function ve(e,t,n){return function(){if(e.usePrimarySelection(),e.getSelection()){var r=e.getSelectedText();if(r.startsWith(t)&&r.endsWith(t)){var a=t.length,i=r.slice(a,r.length-a);e.replaceSelectedText(i)}else e.wrapSelection(t)}else e.insertAtCursor(t+n+t),e.selectBackwards(t.length,n.length)}}(/(iphone os|ipad|iphone|ipod)/i.test(de)&&!window.MSStream||/mac(68k|ppc|intel)/i.test(me))&&(fe="Cmd");var be,Ee,ke=ge("> "),we=ge("    ");function xe(e){return{bold:ve(e,"__","text in bold"),italic:ve(e,"*","text in italic"),strike:ve(e,"~~","striked out"),quote:ye(e,ke),code:ye(e,we),link:function(t,n,r){e.usePrimarySelection(),e.replaceSelectedText(n?"["+n+"]("+t+(r?' "'+r+'"':"")+")":"<"+t+">","around")},h1:Ie(e,1),h2:Ie(e,2),h3:Ie(e,3),ul:ye(e,qe,!0),ol:ye(e,Se,!0),undo:function(){e.cmd("undo")},redo:function(){e.cmd("redo")},hr:function(){e.moveIfNotEmpty();var t=e.getNl();e.insertAtCursor(t+"---"+t+t)},indent:function(){e.insertAtLineBeginning(e.getIndentation())},dedent:function(){var t=e.getIndentation();e.lineStartsWith(t)&&e.removeFromLineBeginning(t.length)},table:function(t){var n=e.getNl();e.moveIfNotEmpty(),e.insertAtCursor(n);var r=e.getCurrentLineNumber();e.insertAtCursor(function(e,t){var n=new Array(11),r=" "+n.join(" ")+" |",a=" "+n.join("-")+" |",i="|",o="|";h(t,(function(){i+=r,o+=a}));var l=m(e).map((function(){return i.replace(/\| {5}/g,"| Cell")}));return[i.replace(/\| {7}/g,"| Header"),o].concat(l)}(t.rows,t.cols).join(n)),e.insertAtCursor(n+n),e.restoreCursor(2,r)}}}function ye(e,t,n){return function(){e.usePrimarySelection();var r=e.getSelection();r?(function(n,r){var a=[n.anchor.line,n.head.line],i=p(a),o=f(a);m(o||0,void 0!==i?i+1:void 0).forEach((function(n,r){!function(n,r){e.moveToLineBeginning(n),t(e,r)}(n,r+1)}))}(r),e.moveToLineEnd()):(!n||Ce(e)||e.lineStartsWith("- ")||function(e){var t=e.getCurrentLineNumber(),n=e.isLineEmpty(t),r=n?2:4;t>0&&e.isLineEmpty(t-1)&&(r-=1),(!(t<e.getLinesCount()-1)||e.isLineEmpty(t+1))&&(r-=1),e.moveToLineEnd(),e.insertAtCursor(e.getNl(r)),e.restoreCursor(0,n?t:t+2)}(e),t(e))}}function Ce(e){var t=e.getCurrentLine().match(/^(\d+\. )/);return t?t[1]:null}function qe(e){if(e.lineStartsWith("- "))e.removeFromLineBeginning(2);else{var t=Ce(e);t&&e.removeFromLineBeginning(t.length),e.insertAtLineBeginning("- ")}}function Se(e,t){var n=Ce(e);n?e.removeFromLineBeginning(n.length):(e.lineStartsWith("- ")&&e.removeFromLineBeginning(2),e.insertAtLineBeginning((t||1)+". "))}function Ie(e,t){return function(){var n=e.getCurrentCharacter(),r=function(e){var t=e.getCurrentLine().match(/^( {0,3})(#{1,6}) /);if(!t)return null;var n=t[1],r=t[2];return e.select(a(0),a(r.length)),e.getSelection();function a(t){return{line:e.getCurrentLineNumber(),ch:n.length+t}}}(e),a=g("#",t);if(!r)return e.moveToLineBeginning(),e.insertAtCursor(a+" "),void e.restoreCursor(n+a.length+1);if(e.getSelectedText()===a){e.extendSelectionBy(1);var i=e.getSelectionLength();return e.removeSelectedText(),void e.restoreCursor(n-i)}var o=a.length-e.getSelectionLength();e.replaceSelectedText(a),e.restoreCursor(n+o)}}var Ne={root:r.css(be||(be=L(["\n    border: 1px solid ",";\n    border-width: 0 1px;\n    overflow-y: auto;\n    height: auto;\n    min-height: 300px;\n\n    .CodeMirror {\n      height: auto;\n      line-height: ",";\n    }\n    .CodeMirror-lines {\n      color: ",";\n      padding: ",";\n    }\n    .CodeMirror-code {\n      font-family: ",";\n      font-size: ",";\n    }\n    .CodeMirror-scroll {\n      min-height: '6rem';\n    }\n\n    .cm-header {\n      color: ",";\n    }\n    span.cm-variable-2 {\n      color: ",";\n    }\n    .cm-header-1 {\n      font-size: 1.9em;\n    }\n    .cm-header-2 {\n      font-size: 1.75em;\n    }\n    .cm-header-3 {\n      font-size: 1.6em;\n    }\n    .cm-header-4 {\n      font-size: 1.45em;\n    }\n    .cm-header-5 {\n      font-size: 1.3em;\n    }\n    .cm-header-6 {\n      font-size: 1.15em;\n    }\n\n    span.cm-tag,\n    span.cm-string,\n    span.cm-attribute {\n      color: ",";\n    }\n    span.cm-string {\n      text-decoration: none !important;\n    }\n    span.cm-quote,\n    span.cm-comment {\n      color: ",";\n    }\n    span.cm-link,\n    span.cm-url {\n      color: "," !important;\n    }\n    span.cm-link {\n      text-decoration: underline;\n    }\n  "])),a.gray400,a.lineHeightDefault,a.gray700,a.spacingL,a.fontStackMonospace,a.fontSizeM,a.gray900,a.gray700,a.red600,a.gray600,a.blue500),framed:r.css({".CodeMirror":{maxHeight:"500px"}}),zen:r.css({border:"none !important",".CodeMirror-lines":{maxWidth:"650px",margin:"0 auto"}}),disabled:r.css(Ee||(Ee=L(["\n    .CodeMirror {\n      background: ",";\n      cursor: 'not-allowed';\n    }\n    .CodeMirror-cursors {\n      visibility: hidden !important;\n    }\n    .CodeMirror-scroll,\n    .CodeMirror-sizer,\n    .CodeMirror-lines {\n      cursor: not-allowed;\n    }\n  "])),a.gray100)},Le=n.memo((function(e){var a=t.useRef(null),i=t.useState(null),o=i[0],l=i[1];t.useEffect((function(){a.current&&l(function(e,t){var n=function(e,t){var n=t||{},r=n.direction,a=n.fixedHeight,i=n.height,o=n.readOnly,l=!1,d={min:i?he(i):300,max:500,shift:50},m=c(e,{direction:r,readOnly:o,mode:"markdown",lineNumbers:!1,undoDepth:200,matchBrackets:!0,lineWrapping:!0,lineSeparator:null,theme:"elegant",tabSize:2,indentWithTabs:!1,indentUnit:2,autoRefresh:!0,spellcheck:!0,inputStyle:"contenteditable"});return m.setSize("100%",d.min),a||m.on("change",s((function(){var e=m.heightAtLine(m.lastLine(),"local")+d.shift,t=e;e<d.min&&(t=d.min),e>d.max&&(t=d.max),m.setSize("100%",t)}),150)),m.setOption("extraKeys",{Tab:function(){k(N())},Enter:"newlineAndIndentContinueMarkdownList",Esc:function(){m.getInputField().blur()}}),{destroy:function(){m.toTextArea()},disable:function(){m.setOption("readOnly","nocursor")},enable:function(){m.setOption("readOnly",!1)},attachEvent:function(e,t,n){n&&(t=s(t,n)),m.on(e,t)},addKeyShortcuts:function(e){var t=pe();m.addKeyMap(u(e,(function(e,n,r){e[t+"-"+r]=n}),{}))},setValue:function(e){if(e=e||"",z()!==e){var t=q(),n=S();m.setValue(e),h(n,t,!0),l||(m.clearHistory(),l=!0)}},cmd:f,moveToLineBeginning:p,moveIfNotEmpty:function(){if(!(I()<1)){var e=q()+1;m.lastLine()<e&&(g(),E(L())),p(e)}},restoreCursor:h,moveToLineEnd:g,usePrimarySelection:function(){f("singleSelection")},focus:function(){m.focus()},select:b,selectBackwards:function(e,t){function n(e){return{line:q(),ch:S()+e}}b(n(-e-t),n(-e))},selectAll:function(){return m.execCommand("selectAll")},extendSelectionBy:function(e){function t(e,t){var n=w();return n?{line:n[e].line,ch:n[e].ch+t}:{line:0,ch:0}}b(t("anchor",0),t("head",e))},insertAtCursor:E,insertAtLineBeginning:function(e){var t=S();p(),E(e),h(t+e.length),m.focus()},wrapSelection:function(e){var t=e+y()+e,n=w();n&&(m.replaceRange(t,n.anchor,null==n?void 0:n.head),m.focus())},removeFromLineBeginning:function(e){var t=q();m.replaceRange("",{line:t,ch:0},{line:t,ch:e}),m.focus()},removeSelectedText:function(){m.replaceSelection(""),m.focus()},replaceSelectedText:k,getCursor:function(){return m.getCursor()},setCursor:function(e){m.setCursor(e)},getSelection:w,getLine:x,isLineEmpty:function(e){var t=v(e);return t>-1&&x(t).length<1&&t<m.lineCount()},getSelectedText:y,getSelectionLength:function(){return y().length},getCurrentLine:C,getCurrentLineNumber:q,getCurrentCharacter:S,getCurrentLineLength:I,lineStartsWith:function(e){return C().startsWith(e)},getIndentation:N,getNl:L,getValue:z,getLinesCount:function(){return m.lineCount()},getHistorySize:function(e){var t=m.historySize();return e?t[e]:t},setReadOnly:function(e){return m.setOption("readOnly",e)},getHistory:function(){return m.getHistory()},setHistory:function(e){return m.setHistory(e)},setFullsize:function(){m.setSize("100%","100%"),m.refresh()},refresh:function(){return m.refresh()}};function f(e){m.execCommand(e),m.focus()}function p(e){m.setCursor({line:v(e),ch:0}),m.focus()}function h(e,t,n){m.setCursor(v(t),e,{scroll:!n}),n||m.focus()}function g(e){m.setCursor({line:v(e),ch:I()}),m.focus()}function v(e){return 0===e||void 0!==e&&e>0?e:q()}function b(e,t){m.setSelection(e,t),m.focus()}function E(e){m.replaceRange(e,m.getCursor()),m.focus()}function k(e,t){m.replaceSelection(e,t),m.focus()}function w(){var e=m.listSelections();return!m.somethingSelected()||!e||e.length<1?null:e[0]}function x(e){return m.getLine(e)||""}function y(){return w()?m.getSelection():""}function C(){return x(q())}function q(){return m.getCursor().line}function S(){return m.getCursor().ch}function I(){return C().length}function N(){var e;return T(" ",null!=(e=m.getOption("indentUnit"))?e:0)}function L(e){return void 0===e&&(e=1),e<1?"":T("\n",e)}function z(){return m.getValue()||""}function T(e,t){return new Array(t+1).join(e)}}(e,t),r={actions:xe(n),history:{hasUndo:function(){return n.getHistorySize("undo")>0},hasRedo:function(){return n.getHistorySize("redo")>0}},events:{onScroll:function(e){n.attachEvent("scroll",e,150)},onChange:function(e){n.attachEvent("change",function(e){return function(t,r){e(n.getValue(),t,r)}}(e),0)},onPaste:function(e){n.attachEvent("paste",e,0)}},insert:n.insertAtCursor,focus:n.focus,getContent:n.getValue,destroy:n.destroy,setContent:n.setValue,getSelectedText:n.getSelectedText,usePrimarySelection:n.usePrimarySelection,setReadOnly:n.setReadOnly,selectBackwards:n.selectBackwards,getCursor:n.getCursor,setCursor:n.setCursor,clear:function(){return n.setValue("")},selectAll:n.selectAll,setFullsize:n.setFullsize,refresh:n.refresh};return n.addKeyShortcuts({B:r.actions.bold,I:r.actions.italic}),r}(a.current,Object.assign({},{direction:e.direction,readOnly:!0},"zen"===e.mode?{fixedHeight:!0,height:"100%"}:{},void 0!==e.minHeight?{height:e.minHeight}:{})))}),[]),t.useEffect((function(){o&&e.onReady(o)}),[o]);var d=r.cx(Ne.root,void 0!==e.minHeight?r.css({minHeight:e.minHeight}):void 0,"default"===e.mode?Ne.framed:Ne.zen,e.disabled&&Ne.disabled);return n.createElement("div",{className:d,ref:a,"data-test-id":"markdown-textarea",style:{display:e.visible?"block":"none"}})}));Le.displayName="MarkdownTextarea";var ze,Te={root:r.css({display:"flex",justifyContent:"space-between",background:a.gray100,border:"1px solid "+a.gray400,borderBottomLeftRadius:a.borderRadiusSmall,borderBottomRightRadius:a.borderRadiusSmall,padding:a.spacingXs+" "+a.spacingS}),help:r.css({color:a.gray700,fontSize:a.fontSizeS,button:{fontSize:a.fontSizeS,lineHeight:"inherit"}})};function Me(e){return n.createElement(o.Paragraph,{marginBottom:"none",className:Te.help},"Format your text like a pro with the"," ",n.createElement(o.TextLink,{as:"button",testId:"open-markdown-cheatsheet-button",onClick:function(){e.onClick()}},"markdown cheatsheet"),".")}function He(e){return n.createElement("div",{className:Te.root},e.children)}!function(e){e.cheatsheet="markdown-cheatsheet",e.insertLink="markdown-insertLink",e.insertSpecialCharacter="markdown-insertSpecialCharacter",e.insertTable="markdown-insertTable",e.embedExternalContent="markdown-embedExternalContent",e.confirmInsertAsset="markdown-confirmInsertAsset",e.zenMode="markdown-zenMode"}(ze||(ze={}));var Be,Fe={flexColumnContainer:r.css({display:"flex",flexWrap:"nowrap"}),flexColumn:r.css({flexGrow:1}),verticalDivider:r.css({borderRight:"1px solid "+a.gray500,paddingRight:a.spacing3Xl,marginRight:a.spacing2Xl}),preview:r.css({display:"inline-block",paddingRight:a.spacingL,width:"50%"}),unOrderedListPreview:r.css({listStyleType:"disc",marginLeft:a.spacingS}),orderedListPreview:r.css({listStyleType:"decimal",marginLeft:a.spacingS}),markup:r.css({display:"inline-block",color:a.gray600,paddingLeft:a.spacingL,width:"50%"}),h1:r.css({fontSize:a.fontSize2Xl}),h2:r.css({fontSize:a.fontSizeXl}),h3:r.css({fontSize:a.fontSizeL}),helpItem:r.css({marginBottom:a.spacingS,display:"flex",alignItems:"flex-end",height:a.spacingXl}),helpLink:r.css({margin:"auto"}),flexRowContainer:r.css({display:"flex",width:"100%",justifyContent:"center",marginTop:a.spacingXl})},Ae=function(){return n.createElement(o.ModalContent,{testId:"markdown-cheatsheet-dialog-content"},n.createElement("div",{className:Fe.flexColumnContainer},n.createElement("div",{className:r.cx(Fe.flexColumn,Fe.verticalDivider)},n.createElement("div",{className:Fe.helpItem},n.createElement(o.Heading,{marginBottom:"none",as:"h1",className:r.cx(Fe.preview,Fe.h1)},"H1"),n.createElement("div",{className:Fe.markup},"# heading")),n.createElement("div",{className:Fe.helpItem},n.createElement(o.Heading,{marginBottom:"none",as:"h2",className:r.cx(Fe.preview,Fe.h2)},"H2"),n.createElement("div",{className:Fe.markup},"## heading")),n.createElement("div",{className:Fe.helpItem},n.createElement(o.Heading,{marginBottom:"none",as:"h3",className:r.cx(Fe.preview,Fe.h3)},"H3"),n.createElement("div",{className:Fe.markup},"### heading")),n.createElement("div",{className:Fe.helpItem},n.createElement("strong",{className:Fe.preview},"bold"),n.createElement("div",{className:Fe.markup},"__text__")),n.createElement("div",{className:Fe.helpItem},n.createElement("em",{className:Fe.preview},"italic"),n.createElement("div",{className:Fe.markup},"*text*")),n.createElement("div",{className:Fe.helpItem},n.createElement("div",{className:Fe.preview},"strikethrough"),n.createElement("div",{className:Fe.markup},"~~text~~")),n.createElement("div",{className:Fe.helpItem},n.createElement(o.TextLink,{as:"button",className:Fe.preview},"Link"),n.createElement("div",{className:Fe.markup},"[text](url)"))),n.createElement("div",{className:Fe.flexColumn},n.createElement("div",{className:Fe.helpItem},n.createElement("div",{className:Fe.preview},"Image"),n.createElement("div",{className:Fe.markup},"![alt-text](url)")),n.createElement("div",{className:Fe.helpItem},n.createElement("div",{className:Fe.preview},"Unordered list"),n.createElement("div",{className:Fe.markup},"* list item")),n.createElement("div",{className:Fe.helpItem},n.createElement("div",{className:Fe.preview},n.createElement("div",null,"Ordered list")),n.createElement("div",{className:Fe.markup},"1. list item")),n.createElement("div",{className:Fe.helpItem},n.createElement("div",{className:Fe.preview},n.createElement("div",null,"Blockquote")),n.createElement("div",{className:Fe.markup},"> quote")),n.createElement("div",{className:Fe.helpItem},n.createElement("div",{className:Fe.preview},"code span"),n.createElement("div",{className:Fe.markup},"`code here`")),n.createElement("div",{className:Fe.helpItem},n.createElement("div",{className:Fe.preview},"code block"),n.createElement("div",{className:Fe.markup},"```code here```")))),n.createElement("div",{className:Fe.flexRowContainer},n.createElement(o.TextLink,{className:Fe.helpLink,href:"https://help.github.com/en/github/writing-on-github/basic-writing-and-formatting-syntax",target:"_blank",rel:"noopener noreferrer"},"View the full GitHub-flavored Markdown syntax help (opens in a new window)")))},De=function(e){return e.openCurrent({title:"Markdown formatting help",width:"large",minHeight:"415px",shouldCloseOnEscapePress:!0,shouldCloseOnOverlayClick:!0,parameters:{type:ze.cheatsheet}})},Re=["Embedly","children"],Oe={root:r.css(Be||(Be=L(["\n    border: 1px solid ",";\n    border-width: 0 1px;\n    word-wrap: break-word;\n    overflow-wrap: break-word;\n    min-height: 300px;\n    padding: ",";\n    font-size: ",";\n    font-family: ",";\n    line-height: ",";\n    color: ",";\n    white-space: pre-line;\n\n    h1,\n    h2,\n    h3,\n    h4,\n    h5,\n    h6 {\n      margin-top: ",";\n      margin-bottom: ",";\n      color: ",";\n    }\n\n    h1:first-child,\n    h2:first-child,\n    h3:first-child,\n    h4:first-child,\n    h5:first-child,\n    h6:first-child {\n      margin-top: 0;\n    }\n\n    h1 {\n      font-size: 1.9em;\n    }\n    h2 {\n      font-size: 1.75em;\n    }\n    h3 {\n      font-size: 1.6em;\n    }\n    h4 {\n      font-size: 1.45em;\n    }\n    h5 {\n      font-size: 1.3em;\n    }\n    h6 {\n      font-size: 1.15em;\n    }\n\n    p {\n      margin-top: 0;\n      margin-bottom: ",";\n    }\n\n    ul,\n    ol {\n      margin: "," 0;\n      padding-left: ",";\n    }\n    ul > li {\n      list-style-type: disc;\n      margin-bottom: 0;\n    }\n\n    ol > li {\n      list-style-type: decimal;\n      margin-bottom: 0;\n    }\n\n    table {\n      table-layout: fixed;\n      border-right-width: 0;\n      border-bottom-width: 0;\n      width: 80%;\n      margin: "," auto;\n      border-spacing: 0;\n      border-collapse: collapse;\n      border: 1px solid ",";\n    }\n\n    table th,\n    table td {\n      padding: 5px;\n      border-left-width: 0;\n      border-top-width: 0;\n    }\n\n    table th {\n      background: ",";\n    }\n\n    table td {\n      border: 1px solid ",";\n    }\n\n    a {\n      color: ",";\n    }\n\n    hr {\n      margin-top: ",";\n      margin-bottom: ",";\n      height: 1px;\n      background-color: ",";\n      border: none;\n    }\n\n    blockquote {\n      border-left: 4px solid ",";\n      padding-left: ",";\n      margin: 0;\n      margin-top: ",";\n      font-style: italic;\n    }\n\n    img {\n      margin: "," auto;\n      display: block;\n      max-width: 80%;\n      max-height: 250px;\n    }\n\n    pre code {\n      font-size: ",";\n      font-family: ",";\n    }\n\n    .embedly-card {\n      margin: "," auto;\n      display: block;\n    }\n  "])),a.gray400,a.spacingL,a.fontSizeM,a.fontStackPrimary,a.lineHeightDefault,a.gray700,a.spacingL,a.spacingM,a.gray900,a.spacingM,a.spacingS,a.spacingM,a.spacingM,a.gray300,a.gray200,a.gray300,a.blue500,a.spacingL,a.spacingL,a.gray300,a.gray200,a.spacingL,a.spacingM,a.spacingM,a.fontSizeS,a.fontStackMonospace,a.spacingM),framed:r.css({height:"100%",maxHeight:"500px",overflowY:"auto"}),zen:r.css({maxWidth:"650px",margin:"0 auto",border:"none !important"}),rtl:r.css({direction:"rtl"})};function Ve(e){var t=e.Embedly,r=e.children,a=N(e,Re);return"embedly-card"===e.className&&t?n.createElement(t,{url:e.href}):n.createElement("a",I({},a,{target:"_blank",rel:"noopener noreferrer"}),r)}var Pe=n.memo((function(e){var t,a=r.cx(Oe.root,void 0!==e.minHeight?r.css({minHeight:e.minHeight}):void 0,"default"===e.mode?Oe.framed:Oe.zen,"rtl"===e.direction?Oe.rtl:void 0),i=n.useMemo((function(){return v.sanitize(e.value).replace(/href="mailto:[^"]*&amp;/g,(function(e){return e.replace(/&amp;/g,"&")}))}),[e.value]);return n.createElement("div",{className:a,"data-test-id":"markdown-preview"},n.createElement(b,{options:{overrides:{a:{component:Ve,props:{Embedly:null==(t=e.previewComponents)?void 0:t.embedly}}}}},i))}));Pe.displayName="MarkdownPreview";var je={root:r.css({display:"flex",justifyContent:"space-between",fontSize:a.fontSizeM,marginTop:a.spacingXs,color:a.gray700})};function _e(e){var t=i.ConstraintsUtils.fromFieldValidations(e.sdk.field.validations,e.sdk.field.type),r=i.ConstraintsUtils.makeChecker(t);return n.createElement("div",{className:je.root},n.createElement(i.CharCounter,{value:e.value,checkConstraint:r}),n.createElement(i.CharValidation,{constraints:t}))}function Ue(e,t){return e(t={exports:{}},t.exports),t.exports}var Xe=Ue((function(e){var t=function(e){var t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var a=Object.create((t&&t.prototype instanceof d?t:d).prototype),i=new y(r||[]);return a._invoke=function(e,t,n){var r="suspendedStart";return function(a,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw i;return{value:void 0,done:!0}}for(n.method=a,n.arg=i;;){var o=n.delegate;if(o){var l=k(o,n);if(l){if(l===u)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=s(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(e,n,i),a}function s(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var u={};function d(){}function m(){}function f(){}var p={};l(p,a,(function(){return this}));var h=Object.getPrototypeOf,g=h&&h(h(C([])));g&&g!==t&&n.call(g,a)&&(p=g);var v=f.prototype=d.prototype=Object.create(p);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){var r;this._invoke=function(a,i){function o(){return new t((function(r,o){!function r(a,i,o,l){var c=s(e[a],e,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==typeof d&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,o,l)}),(function(e){r("throw",e,o,l)})):t.resolve(d).then((function(e){u.value=e,o(u)}),(function(e){return r("throw",e,o,l)}))}l(c.arg)}(a,i,r,o)}))}return r=r?r.then(o,o):o()}}function k(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var r=s(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,u;var a=r.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function y(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function C(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:q}}function q(){return{value:void 0,done:!0}}return m.prototype=f,l(v,"constructor",f),l(f,"constructor",m),m.displayName=l(f,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,l(e,o,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},b(E.prototype),l(E.prototype,i,(function(){return this})),e.AsyncIterator=E,e.async=function(t,n,r,a,i){void 0===i&&(i=Promise);var o=new E(c(t,n,r,a),i);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},b(v),l(v,o,"Generator"),l(v,a,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=C,y.prototype={constructor:y,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],o=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var l=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(l&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,u):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),x(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;x(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:C(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}})),We=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-/]))?$/;function Ge(e){return We.test(e)}var Ke=function(e){var r=e.selectedText,a=e.onClose,i=t.useRef(null),l=t.useState(r||""),c=l[0],s=l[1],u=t.useState(""),d=u[0],m=u[1],f=t.useState(!1),p=f[0],h=f[1],g=t.useState(""),v=g[0],b=g[1],E=function(e){return a(e)},k=Ge(d);return t.useEffect((function(){var e;null!=i&&null!=(e=i.current)&&e.focus&&i.current.focus()}),[i]),n.createElement(n.Fragment,null,n.createElement(o.ModalContent,{testId:"insert-link-modal"},n.createElement(o.Form,{onSubmit:function(){return E({url:d,text:c,title:v})}},n.createElement(o.FormControl,{id:"link-text-field",isDisabled:Boolean(r)},n.createElement(o.FormControl.Label,null,"Link text"),n.createElement(o.TextInput,{name:"link-text",value:c,onChange:function(e){s(e.target.value)},testId:"link-text-field"})),n.createElement(o.FormControl,{id:"target-url-field",isInvalid:p&&!k},n.createElement(o.FormControl.Label,null,"Target URL"),n.createElement(o.TextInput,{name:"target-url",value:d,onChange:function(e){m(e.target.value),h(!0)},placeholder:"https://",maxLength:2100,testId:"target-url-field",ref:i}),n.createElement(o.FormControl.HelpText,null,"Include protocol (e.g. https://)"),p&&!k&&n.createElement(o.FormControl.ValidationMessage,null,"Invalid URL")),n.createElement(o.FormControl,{id:"link-title-field"},n.createElement(o.FormControl.Label,null,"Link title"),n.createElement(o.TextInput,{name:"link-title",value:v,onChange:function(e){b(e.target.value)},testId:"link-title-field"}),n.createElement(o.FormControl.HelpText,null,"Extra link information, usually shown as a tooltip on mouse hover")))),n.createElement(o.ModalControls,null,n.createElement(o.Button,{testId:"insert-link-cancel",onClick:function(){return a(!1)},variant:"secondary",size:"small"},"Cancel"),n.createElement(o.Button,{testId:"insert-link-confirm",onClick:function(){E({url:d,text:c,title:v})},isDisabled:!k,variant:"positive",size:"small"},"Insert")))},$e=[{code:180,desc:"acute accent"},{code:38,desc:"ampersand"},{code:166,desc:"broken vertical bar"},{code:8226,desc:"bullet"},{code:184,desc:"cedilla"},{code:162,desc:"cent"},{code:169,desc:"copyright"},{code:176,desc:"degree"},{code:247,desc:"division"},{code:189,desc:"fraction half"},{code:188,desc:"fraction quarter"},{code:190,desc:"fraction three quarters"},{code:62,desc:"greater than"},{code:161,desc:"inverted exclamation mark"},{code:191,desc:"inverted question mark"},{code:171,desc:"left-pointing double angle quotation mark"},{code:60,desc:"less than"},{code:175,desc:"macron"},{code:181,desc:"micro"},{code:160,desc:"non-breaking space"},{code:172,desc:"not"},{code:182,desc:"paragraph"},{code:177,desc:"plus-minus"},{code:34,desc:"quotation mark"},{code:174,desc:"registered"},{code:187,desc:"right-pointing double angle quotation mark"},{code:167,desc:"section"},{code:168,desc:"umlaut/diaeresis"},{code:215,desc:"multiplication"},{code:8482,desc:"trade mark"},{code:8364,desc:"euro"},{code:163,desc:"pound"},{code:165,desc:"yen"},{code:8222,desc:"double low-9 quotation mark"},{code:710,desc:"modifier circumflex accent"},{code:8224,desc:"dagger"},{code:8225,desc:"double dagger"},{code:8230,desc:"horizontal ellipsis"},{code:8220,desc:"left double quotation mark"},{code:8249,desc:"single left-pointing angle quotation mark"},{code:8216,desc:"left single quotation mark"},{code:183,desc:"middle dot"},{code:8212,desc:"em dash"},{code:8211,desc:"en dash"},{code:8240,desc:"per mille"},{code:8250,desc:"single right-pointing angle quotation mark"},{code:8217,desc:"right single quotation mark"},{code:8218,desc:"single low-9 quotation mark"},{code:170,desc:"feminine ordinal indicator"},{code:186,desc:"masculine ordinal indicator"},{code:8221,desc:"right double quotation mark"},{code:732,desc:"small tilde"},{code:9829,desc:"black heart"},{code:9830,desc:"diamond"}],Ye={buttonPanel:r.css({display:"flex",flexWrap:"wrap"}),charButton:r.css({border:"1px solid "+a.gray500,width:"4.1rem",height:"4.1rem",fontSize:a.fontSizeXl,marginTop:a.spacing2Xs,marginRight:a.spacing2Xs}),selectedCharButton:r.css({backgroundColor:a.gray100}),tooltip:r.css({zIndex:1e3}),button:r.css({marginTop:a.spacingM,marginRight:a.spacingS})},Ze=function(e){var r=e.onClose,a=t.useState($e[0]),i=a[0],l=a[1];return n.createElement(n.Fragment,null,n.createElement(o.ModalContent,{testId:"insert-special-character-modal"},n.createElement(o.Flex,{flexDirection:"column",alignItems:"center"},n.createElement(o.Text,{as:"div",lineHeight:"lineHeight3Xl",fontSize:"fontSize3Xl",marginBottom:"spacingS"},String.fromCharCode(i.code)),n.createElement(o.Text,{as:"div",marginBottom:"spacingS"},i.desc)),n.createElement("div",{className:Ye.buttonPanel},$e.map((function(e){return n.createElement("div",{key:e.code},n.createElement(o.Tooltip,{className:Ye.tooltip,content:e.desc},n.createElement(o.Button,{testId:"special-character-button",isActive:e.code===i.code,className:Ye.charButton,variant:"transparent",onClick:function(){return l(e)}},String.fromCharCode(e.code))))})))),n.createElement(o.ModalControls,null,n.createElement(o.Button,{testId:"insert-character-cancel",className:Ye.button,onClick:function(){return r(!1)},variant:"secondary",size:"small"},"Cancel"),n.createElement(o.Button,{className:Ye.button,testId:"insert-character-confirm",onClick:function(){return r(String.fromCharCode(i.code))},variant:"positive",size:"small"},"Insert selected")))},Qe=function(e){var r=e.onClose,a=t.useRef(null),i=t.useState(2),l=i[0],c=i[1],s=t.useState(1),u=s[0],d=s[1],m=E(l,2,100),f=E(u,1,100);return t.useEffect((function(){var e;null!=(e=a.current)&&e.focus&&a.current.focus()}),[a]),n.createElement(n.Fragment,null,n.createElement(o.ModalContent,{testId:"insert-table-modal"},n.createElement(o.Form,null,n.createElement(o.FormControl,{id:"insert-table-rows-number-field",isRequired:!0,isInvalid:!m},n.createElement(o.FormControl.Label,null,"Number of rows"),n.createElement(o.TextInput,{name:"rows",value:l.toString(),onChange:function(e){return c(Number(e.target.value))},testId:"insert-table-rows-number-field",min:2,max:100,pattern:"[1-9][0-9]*",type:"number",width:"small",autoComplete:"off",ref:a}),!m&&n.createElement(o.FormControl.ValidationMessage,null,"Should be between 2 and 100")),n.createElement(o.FormControl,{id:"insert-table-columns-number-field",isRequired:!0,isInvalid:!f},n.createElement(o.FormControl.Label,null,"Number of columns"),n.createElement(o.TextInput,{name:"columns",value:u.toString(),onChange:function(e){return d(Number(e.target.value))},testId:"insert-table-columns-number-field",min:1,max:100,pattern:"[1-9][0-9]*",type:"number",width:"small",autoComplete:"off"}),!f&&n.createElement(o.FormControl.ValidationMessage,null,"Should be between 1 and 100")))),n.createElement(o.ModalControls,null,n.createElement(o.Button,{testId:"insert-table-cancel",onClick:function(){return r(!1)},variant:"secondary",size:"small"},"Cancel"),n.createElement(o.Button,{testId:"insert-table-confirm",onClick:function(){return r({rows:l,cols:u})},variant:"positive",size:"small",isDisabled:!m||!f},"Insert")))},Je={widthFiledGroup:r.css({display:"flex",flexWrap:"nowrap",alignItems:"flex-start"}),radioButtonGroup:r.css({display:"inline-flex",alignItems:"flex-start",paddingTop:a.spacingXl}),radioButton:r.css({marginLeft:a.spacingM})},et=function(e,t){return"percent"!==t||e<=100},tt=function(e){var r=e.onClose,a=t.useRef(null),i=t.useState("https://"),l=i[0],c=i[1],s=t.useState("percent"),u=s[0],d=s[1],m=t.useState(!0),f=m[0],p=m[1],h=t.useState("100"),g=h[0],v=h[1],b=t.useState(!1),E=b[0],k=b[1];return t.useEffect((function(){var e;null!=(e=a.current)&&e.focus&&a.current.focus()}),[a]),n.createElement(n.Fragment,null,n.createElement(o.ModalContent,{testId:"embed-external-dialog"},n.createElement(o.Form,null,n.createElement(o.FormControl,{id:"external-link-url-field",isRequired:!0,isInvalid:!f},n.createElement(o.FormControl.Label,null,"Content URL"),n.createElement(o.TextInput,{name:"external-link-url",value:l,onChange:function(e){var t=e.target.value;c(t),p(Ge(t))},testId:"external-link-url-field",placeholder:"https://example.com",ref:a}),n.createElement(o.FormControl.HelpText,null,"Include protocol (e.g. https://)"),!f&&n.createElement(o.FormControl.ValidationMessage,null,"URL is invalid")),n.createElement(o.TextLink,{href:"http://embed.ly/providers",target:"_blank",rel:"noopener noreferrer"},"Supported sources"),n.createElement("div",{className:Je.widthFiledGroup},n.createElement(o.FormControl,{id:"embedded-content-width",isRequired:!0,isInvalid:!et(Number(g),u)},n.createElement(o.FormControl.Label,null,"Width"),n.createElement(o.TextInput,{value:g,name:"embedded-content-width",testId:"embedded-content-width",type:"number",width:"small",onChange:function(e){return v(e.target.value)}}),!et(Number(g),u)&&n.createElement(o.FormControl.ValidationMessage,null,"Should be equal or less then 100")),n.createElement("div",{className:Je.radioButtonGroup},n.createElement(o.Radio,{id:"unit-option-percent",value:"percent",isChecked:"percent"===u,onChange:function(){return d("percent")},className:Je.radioButton},"percent"),n.createElement(o.Radio,{id:"unit-option-pixels",value:"pixels",isChecked:"px"===u,onChange:function(){return d("px")},className:Je.radioButton},"pixels"))),n.createElement(o.Checkbox,{id:"attach-social-checkbox",name:"attach-social-checkbox",value:"Yes",isChecked:E,onChange:function(){return k(!E)},testId:"attach-social-checkbox"},"Attach social sharing links to this element"),n.createElement(o.Text,{as:"p",fontColor:"gray500",marginTop:"spacingXs"},"To enable this embedded content in your application make sure to add the",n.createElement(o.TextLink,{href:"http://embed.ly/docs/products/cards",target:"_blank",rel:"noopener noreferrer"},"Embedly's platform.js"),"on your development environment"))),n.createElement(o.ModalControls,null,n.createElement(o.Button,{testId:"emded-external-cancel",onClick:function(){return r(!1)},variant:"secondary",size:"small"},"Cancel"),n.createElement(o.Button,{testId:"embed-external-confirm",onClick:function(){return r(function(e){var t=e.url;return['<a href="'+t+'" class="embedly-card" ','data-card-width="'+e.width+{percent:"%",px:"px"}[e.selectedUnit]+'" ','data-card-controls="'+(e.attachSocial?"1":"0")+'"',">Embedded content: "+t+"</a>"].join("")}({url:l,width:Number(g),selectedUnit:u,attachSocial:E}))},variant:"positive",size:"small"},"Insert")))},nt=function(e){var t=e.onClose,r=e.assets,a=e.locale,i=r.length;return n.createElement(n.Fragment,null,n.createElement(o.ModalContent,{testId:"confirm-insert-asset"},n.createElement(o.Paragraph,null,1===i?"Link asset with missing file for locale "+a:"Link assets with missing files for locale "+a),n.createElement(o.Paragraph,null,1===i?"Do you want to link to the file in its fallback locale?":"Do you want to link to the files in their fallback locales?"),n.createElement(o.EntityList,null,r.map((function(e){var t=e.thumbnailUrl;return n.createElement(o.EntityList.Item,{key:t,title:e.title,thumbnailUrl:t+"?w=46&h=46&fit=thumb",thumbnailAltText:e.thumbnailAltText,description:e.description})})))),n.createElement(o.ModalControls,null,n.createElement(o.Button,{onClick:function(){return t(!1)},variant:"secondary",size:"small"},"Cancel"),n.createElement(o.Button,{testId:"confirm-insert-asset",onClick:function(){return t(!0)},variant:"positive",size:"small"},"Confirm")))},rt={root:r.css({position:"fixed",left:0,right:0,top:0,bottom:0}),topSplit:r.css({position:"fixed",top:0,height:"48px",left:0,right:0}),bottomSplit:r.css({position:"fixed",bottom:0,left:0,right:0,height:"36px"}),editorSplit:r.css({width:"50%",position:"fixed",top:"48px",left:0,bottom:"36px",overflowX:"hidden",overflowY:"scroll"}),editorSplitFullscreen:r.css({left:0,right:0,width:"100%"}),previewSplit:r.css({width:"50%",position:"fixed",top:"48px",right:0,bottom:"36px",overflowX:"hidden",overflowY:"scroll"}),separator:r.css({position:"fixed",top:"48px",bottom:"36px",width:"1px",background:a.gray400,left:"50%"}),button:r.css({position:"fixed",cursor:"pointer",zIndex:105,top:"49%",height:"30px",backgroundColor:a.gray100,border:"1px solid "+a.gray400,padding:0}),hideButton:r.css({left:"50%"}),showButton:r.css({right:0,borderRightWidth:0}),icon:r.css({verticalAlign:"middle"})},at=function(e){var t,a,i,o=n.useState(null!=(t=e.initialValue)?t:""),c=o[0],s=o[1],u=n.useState(!0),d=u[0],m=u[1],f=n.useState(null),p=f[0],h=f[1];n.useEffect((function(){var t,n;null==(t=e.sdk)||null==(n=t.window)||n.updateHeight("100%")}),[]),n.useEffect((function(){setTimeout((function(){null==p||p.setFullsize(),null==p||p.refresh()}),150)}),[p]);var g=n.useMemo((function(){return kt({sdk:e.sdk,editor:p,locale:e.locale})}),[p]);g.closeZenMode=function(){e.onClose({value:c,cursor:null==p?void 0:p.getCursor()})};var v=null!=(a=e.sdk.locales.direction[e.locale])?a:"ltr";return n.createElement("div",{className:rt.root,"data-test-id":"zen-mode-markdown-editor"},n.createElement("div",{className:rt.topSplit},n.createElement(ue,{mode:"zen",disabled:!1,canUploadAssets:!1,actions:g})),n.createElement("div",{className:r.cx(rt.editorSplit,(i={},i[rt.editorSplitFullscreen]=!1===d,i))},n.createElement(Le,{mode:"zen",visible:!0,disabled:!1,direction:v,onReady:function(t){var n;t.setContent(null!=(n=e.initialValue)?n:""),t.setReadOnly(!1),h(t),t.focus(),t.events.onChange((function(t){s(t),e.saveValueToSDK(t)}))}})),d&&n.createElement("div",{className:rt.previewSplit},n.createElement(Pe,{direction:v,mode:"zen",value:c,previewComponents:e.previewComponents})),d&&n.createElement("div",{className:rt.separator}),d&&n.createElement("button",{className:r.cx(rt.button,rt.hideButton),"aria-label":"Hide preview",onClick:function(){m(!1)}},n.createElement(l.ChevronRightIcon,{variant:"muted",size:"tiny",className:rt.icon})),!d&&n.createElement("button",{className:r.cx(rt.button,rt.showButton),"aria-label":"Show preview",onClick:function(){m(!0)}},n.createElement(l.ChevronLeftIcon,{variant:"muted",size:"tiny",className:rt.icon})),n.createElement("div",{className:rt.bottomSplit},n.createElement(He,null,n.createElement(Me,{onClick:function(){De(e.sdk.dialogs)}}))))};function it(e,t){var n=t.localeCode,r=t.fallbackCode,a=t.defaultLocaleCode,i=d(e,["fields","file",n]),o=r?d(e,["fields","file",r]):null,l=d(e,["fields","file",a]),c=i||o||l;if(k(c)&&c.url){var s=d(e,["fields","title",n])||d(e,["fields","title",r||""])||d(e,["fields","title",a])||function(e){return e?e.trim().replace(/\s{2,}/g," "):e}(function(e){return e.replace(/\.\w+$/g,"")}(c.fileName).replace(/_/g," ")),u=function(e){var t={images:"images.ctfassets.net",assets:"assets.ctfassets.net",downloads:"downloads.ctfassets.net",videos:"videos.ctfassets.net"};return e.replace(/(images|assets|downloads|videos).contentful.com/,(function(e,n){return t[n]}))}(c.url);return{title:s,asset:e,url:u,isLocalized:Boolean(i),isFallback:Boolean(o),asMarkdown:"!["+s+"]("+u+")"}}return null}function ot(e,t){return lt.apply(this,arguments)}function lt(){return(lt=S(Xe.mark((function e(t,n){var r,a,i;return Xe.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.filter((function(e){return!d(e,["fields","file",n.localeCode])})),a=t.map((function(e){return it(e,n)})).filter((function(e){return null!==e})),!(r.length>0)){e.next=5;break}return i=a.filter((function(e){return!e.isLocalized})).map((function(e){var t=e.title,r=e.isFallback,a=e.asset,i=r?n.fallbackCode:n.defaultLocaleCode;return{title:t,thumbnailUrl:a.fields.file[i].url,thumbnailAltText:t,description:r?"Fallback locale ("+i+")":"Default locale ("+i+")",asset:a}})),e.abrupt("return",{fallbacks:i,links:a});case 5:return e.abrupt("return",{links:a});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ct(e){return(e=(e=e||"").replace(/^ *('|"|\()*/,"")).replace(/('|"|\))* *$/,"")}function st(e){return e.split(" ").shift()}function ut(e){var t=e.split(" ");return t.shift(),t.join(" ")}var dt={inline:function(e){return{match:e[0],text:e[1],href:st(e[2]),title:ct(ut(e[2]))}},ref:function(e){return{match:e[0],text:e[1],id:e[2]}},label:function(e){return{match:e[0],id:e[1],href:st(e[2]),title:ct(ut(e[2]))}}},mt={inline:/\[([^\r\n[\]]+)]\(([^\r\n)]+)\)/,ref:/\[([^\r\n[\]]+)] ?\[([^\r\n[\]]+)]/,label:/^ {0,3}\[([^\r\n[\]]+)]:\s+(.+)$/},ft=gt("inline"),pt=gt("ref"),ht=gt("label");function gt(e){return function(t){return function(e,t){for(var n=[],r=new RegExp(mt[t].source,"g"+("label"===t?"m":"")),a=r.exec(e);a;)n.push(a),r.lastIndex=a.index+a[0].length,a=r.exec(e);return n}(t,e).map(dt[e])}}function vt(e){return k(e)&&x(e.title)&&e.title.length>0}function bt(e,t){var n="["+t+"]: "+e.href;return vt(e)&&(n+=' "'+e.title+'"'),n}function Et(e,t){return"["+e.text+"]["+t+"]"}function kt(e){var t,n,r,a,i,o,l,c=e.sdk,s=e.editor,u=e.locale,d=function(){var e=S(Xe.mark((function e(t){var n,r,a;return Xe.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=14;break}return e.next=3,ot(t,{localeCode:u,defaultLocaleCode:c.locales.default,fallbackCode:c.locales.fallbacks[u]});case 3:if(a=(n=e.sent).fallbacks,!((r=n.links)&&r.length>0)){e.next=14;break}if(!a){e.next=13;break}return e.next=10,c.dialogs.openCurrent({title:"Confirm using fallback assets",width:"medium",minHeight:"270px",shouldCloseOnEscapePress:!0,shouldCloseOnOverlayClick:!0,parameters:I({type:ze.confirmInsertAsset},{locale:u,assets:a})});case 10:if(e.sent){e.next=13;break}throw Error("User decided to not use fallbacks");case 13:return e.abrupt("return",r.map((function(e){return e.asMarkdown})).join("\n\n"));case 14:return e.abrupt("return","");case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{headings:{h1:function(){null==s||s.actions.h1()},h2:function(){null==s||s.actions.h2()},h3:function(){null==s||s.actions.h3()}},simple:{italic:function(){null==s||s.actions.italic()},bold:function(){null==s||s.actions.bold()},quote:function(){null==s||s.actions.quote()},ol:function(){null==s||s.actions.ol()},ul:function(){null==s||s.actions.ul()},strike:function(){null==s||s.actions.strike()},code:function(){null==s||s.actions.code()},hr:function(){null==s||s.actions.hr()},indent:function(){null==s||s.actions.indent()},dedent:function(){null==s||s.actions.dedent()}},history:{undo:function(){null==s||s.actions.undo()},redo:function(){null==s||s.actions.redo()}},insertLink:(l=S(Xe.mark((function e(){var t,n;return Xe.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}return e.abrupt("return");case 2:return s.usePrimarySelection(),t=s.getSelectedText(),e.next=6,c.dialogs.openCurrent({title:"Insert link",width:"large",minHeight:"410px",shouldCloseOnEscapePress:!0,shouldCloseOnOverlayClick:!0,parameters:I({type:ze.insertLink},{selectedText:t})});case 6:(n=e.sent)&&s.actions.link(n.url,t||n.text,n.title);case 8:case"end":return e.stop()}}),e)}))),function(){return l.apply(this,arguments)}),insertSpecialCharacter:(o=S(Xe.mark((function e(){var t;return Xe.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,c.dialogs.openCurrent({title:"Insert special character",width:"large",minHeight:"600px",shouldCloseOnEscapePress:!0,shouldCloseOnOverlayClick:!0,parameters:{type:ze.insertSpecialCharacter}});case 4:(t=e.sent)&&s.insert(t);case 6:case"end":return e.stop()}}),e)}))),function(){return o.apply(this,arguments)}),insertTable:(i=S(Xe.mark((function e(){var t;return Xe.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,c.dialogs.openCurrent({title:"Insert table",width:"medium",minHeight:"260px",shouldCloseOnEscapePress:!0,shouldCloseOnOverlayClick:!0,parameters:{type:ze.insertTable}});case 4:(t=e.sent)&&s.actions.table(t);case 6:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)}),organizeLinks:function(){if(s){var e=s.getContent();e&&(e=function(e){var t=function(e){var t={},n={};return C(ht(e),(function(e){var r=t[e.href],a=w({},e);r?vt(a)&&!vt(r)&&(r.title=a.title):t[a.href]=a,n[a.id]=r||a})),{byHref:t,byOldId:n}}(e),n={},r=[],a=[],i=1;return C(pt(e),(function(e){var o=t.byOldId[e.id];if(o){var l=o.href,c=n[l];c||(n[l]=c=i,i+=1,r.push(w({newId:c},o))),a.push(w({newId:c},e))}})),C(ht(e),(function(t){e=e.replace(t.match,"")})),e=e.replace(/[\r\n\s]*$/,""),e+="\n\n",C(a,(function(t){e=e.replace(t.match,Et(t,t.newId))})),C(r,(function(t){e+="\n"+bt(t,t.newId)})),e}(e=function(e){var t=function(e){x(e)&&(e=ht(e));var t=e.map((function(e){return e.id})).map((function(e){return parseInt(e,10)})).filter((function(e){return y(e)&&e>0}));return t.length>0&&p(t)||0}(e);return C(ft(e),(function(n){e=e.replace(n.match,Et(n,t+=1)),e+="\n"+bt(n,t)})),e}(e)),s.setContent(e),c.notifier.success("All your links are now references at the bottom of your document."))}},embedExternalContent:(a=S(Xe.mark((function e(){var t;return Xe.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,c.dialogs.openCurrent({title:"Embed external content",width:"large",minHeight:"435px",shouldCloseOnEscapePress:!0,shouldCloseOnOverlayClick:!0,parameters:{type:ze.embedExternalContent}});case 4:(t=e.sent)&&s.insert(t);case 6:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)}),addNewMedia:(r=S(Xe.mark((function e(){var t;return Xe.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,c.navigator.openNewAsset({slideIn:{waitForClose:!0}});case 5:return t=e.sent.entity,e.next=9,d([t]);case 9:s.insert(e.sent);case 11:return e.prev=11,s.focus(),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[2,,11,14]])}))),function(){return r.apply(this,arguments)}),linkExistingMedia:(n=S(Xe.mark((function e(){var t;return Xe.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,c.dialogs.selectMultipleAssets({locale:u});case 5:return t=e.sent,e.next=8,d(t);case 8:s.insert(e.sent);case 10:return e.prev=10,s.focus(),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[2,,10,13]])}))),function(){return n.apply(this,arguments)}),openZenMode:(t=S(Xe.mark((function t(){var n;return Xe.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,r=c.dialogs,a={initialValue:s.getContent(),locale:e.locale},r.openCurrent({width:"zen",shouldCloseOnEscapePress:!1,minHeight:"100vh",shouldCloseOnOverlayClick:!1,parameters:{type:ze.zenMode,initialValue:a.initialValue,locale:a.locale}});case 4:s.setContent((n=t.sent).value),n.cursor&&s.setCursor(n.cursor),s.focus();case 8:case"end":return t.stop()}var r,a}),t)}))),function(){return t.apply(this,arguments)}),closeZenMode:function(){}}}var wt={container:r.css({display:"flex",flexDirection:"column",fontFamily:a.fontStackPrimary})};function xt(e){var t,r,a=n.useState(null!=(t=e.initialValue)?t:""),i=a[0],o=a[1],l=n.useState("editor"),c=l[0],s=l[1],u=n.useState(null),d=u[0],m=u[1],f=n.useState(!1),p=f[0],h=f[1];n.useEffect((function(){d&&e.onReady&&(e.onReady(d),setTimeout((function(){d.refresh()}),1))}),[d]),n.useEffect((function(){e.sdk.access.can("create","Asset").then((function(e){h(e)}))}),[]),n.useEffect((function(){d&&d.setReadOnly(e.disabled)}),[d,e.disabled]);var g=null===d||e.disabled||"editor"!==c,v=null!=(r=e.sdk.locales.direction[e.sdk.field.locale])?r:"ltr",b=n.useMemo((function(){return kt({sdk:e.sdk,editor:d,locale:e.sdk.field.locale})}),[d]),E=n.useCallback((function(){De(e.sdk.dialogs)}),[]);return n.createElement("div",{className:wt.container,"data-test-id":"markdown-editor"},n.createElement(M,{active:c,onSelect:function(e){s(e)}}),n.createElement(ue,{mode:"default",disabled:g,canUploadAssets:p,actions:b}),n.createElement(Le,{minHeight:e.minHeight,mode:"default",visible:"editor"===c,disabled:g,direction:v,onReady:function(t){var n;t.setContent(null!=(n=e.initialValue)?n:""),t.setReadOnly(e.disabled),m(t),t.events.onChange((function(t){var n=t.replace(/^\s+$/gm,"");e.saveValueToSDK(n),o(t)}))}}),"preview"===c&&n.createElement(Pe,{direction:v,minHeight:e.minHeight,mode:"default",value:i,previewComponents:e.previewComponents}),n.createElement(He,null,n.createElement(Me,{onClick:E})),n.createElement(_e,{sdk:e.sdk,value:i}))}exports.MarkdownEditor=function(e){return n.createElement(i.FieldConnector,{throttle:300,field:e.sdk.field,isInitiallyDisabled:e.isInitiallyDisabled},(function(t){return n.createElement(xt,I({},e,{key:"markdown-editor-"+t.externalReset,initialValue:t.value,disabled:t.disabled,saveValueToSDK:t.setValue}))}))},exports.MarkdownPreview=Pe,exports.openMarkdownDialog=function(e,t){return function(r){var a,o,l,c,s,u,d;if((null==(a=r.parameters)?void 0:a.type)===ze.cheatsheet)return i.ModalDialogLauncher.openDialog(r,(function(){return n.createElement(Ae,null)}));if((null==(o=r.parameters)?void 0:o.type)===ze.insertLink){var m=r.parameters.selectedText;return i.ModalDialogLauncher.openDialog(r,(function(e){return n.createElement(Ke,{selectedText:m,onClose:e.onClose})}))}if((null==(l=r.parameters)?void 0:l.type)===ze.insertSpecialCharacter)return i.ModalDialogLauncher.openDialog(r,(function(e){return n.createElement(Ze,{onClose:e.onClose})}));if((null==(c=r.parameters)?void 0:c.type)===ze.insertTable)return i.ModalDialogLauncher.openDialog(r,(function(e){return n.createElement(Qe,{onClose:e.onClose})}));if((null==(s=r.parameters)?void 0:s.type)===ze.embedExternalContent)return i.ModalDialogLauncher.openDialog(r,(function(e){return n.createElement(tt,{onClose:e.onClose})}));if((null==(u=r.parameters)?void 0:u.type)===ze.confirmInsertAsset){var f=r.parameters.locale,p=r.parameters.assets;return i.ModalDialogLauncher.openDialog(r,(function(e){return n.createElement(nt,{onClose:e.onClose,locale:f,assets:p})}))}if((null==(d=r.parameters)?void 0:d.type)===ze.zenMode){var h=r.parameters.initialValue,g=r.parameters.locale;return i.ModalDialogLauncher.openDialog(r,(function(r){return n.createElement(at,{saveValueToSDK:function(t){var n,r;return t?null==e||null==(r=e.field)?void 0:r.setValue(t):null==e||null==(n=e.field)?void 0:n.removeValue()},onClose:r.onClose,initialValue:h,locale:g,sdk:e,previewComponents:t})}))}return Promise.reject()}},exports.renderMarkdownDialog=function(e){var t=e.parameters.invocation;if(t.type===ze.cheatsheet)return e.window.startAutoResizer(),n.createElement(Ae,null);if(t.type===ze.insertLink){var r=t.selectedText;return e.window.startAutoResizer(),n.createElement(Ke,{selectedText:r,onClose:e.close})}if(t.type===ze.insertSpecialCharacter)return e.window.startAutoResizer(),n.createElement(Ze,{onClose:e.close});if(t.type===ze.insertTable)return e.window.startAutoResizer(),n.createElement(Qe,{onClose:e.close});if(t.type===ze.embedExternalContent)return e.window.startAutoResizer(),n.createElement(tt,{onClose:e.close});if(t.type===ze.confirmInsertAsset){var a=t.locale,i=t.assets;return e.window.startAutoResizer(),n.createElement(nt,{onClose:e.close,locale:a,assets:i})}if(t.type===ze.zenMode){var o=t.locale,l=t.initialValue;return e.window.updateHeight("100%"),n.createElement(at,{onClose:e.close,saveValueToSDK:function(){},initialValue:l,locale:o,sdk:e})}return n.createElement("div",null)};
+"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0}),require("codemirror/mode/markdown/markdown"),require("codemirror/mode/xml/xml"),require("codemirror/addon/edit/continuelist"),require("codemirror/addon/mode/overlay"),require("codemirror/addon/display/autorefresh");var t=require("react"),n=e(t),r=require("emotion"),a=e(require("@contentful/f36-tokens")),i=require("@contentful/field-editor-shared"),o=require("@contentful/f36-components"),l=require("@contentful/f36-icons"),c=e(require("codemirror"));require("codemirror/addon/edit/matchbrackets");var s=e(require("lodash/throttle")),u=e(require("lodash/transform")),d=e(require("lodash/get")),m=e(require("lodash/range")),f=e(require("lodash/min")),p=e(require("lodash/max")),h=e(require("lodash/times")),g=e(require("lodash/repeat")),v=e(require("dompurify")),b=e(require("markdown-to-jsx")),E=e(require("lodash/inRange")),k=e(require("lodash/isObject")),w=e(require("lodash/extend")),x=e(require("lodash/isString")),y=e(require("lodash/isFinite")),C=e(require("lodash/forEach"));function q(e,t,n,r,a,i,o){try{var l=e[i](o),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,a)}function S(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){q(i,r,a,o,l,"next",e)}function l(e){q(i,r,a,o,l,"throw",e)}o(void 0)}))}}function I(){return(I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function N(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t.indexOf(n=i[r])>=0||(a[n]=e[n]);return a}function L(e,t){return t||(t=e.slice(0)),e.raw=t,e}var z={root:r.css({display:"flex",zIndex:10,flexDirection:"row",justifyContent:"flex-end",overflow:"hidden",marginBottom:"-1px",fontSize:a.fontSizeM}),tab:r.css({cursor:"pointer",color:a.gray700,padding:a.spacingXs,minWidth:"70px",border:"1px solid "+a.gray400,borderTopLeftRadius:a.borderRadiusSmall,borderTopRightRadius:a.borderRadiusSmall,marginLeft:a.spacingXs,textAlign:"center",backgroundColor:a.gray100,borderBottomColor:a.gray100,outline:"none","&:focus":{boxShadow:a.boxShadowHeavy},transition:"all "+a.transitionEasingDefault+" "+a.transitionDurationShort}),inactiveTab:r.css({background:a.gray200,borderBottomColor:a.gray400,"&:hover":{background:a.gray300}})};function T(e){var t;return n.createElement("div",{className:r.cx(z.tab,(t={},t[z.inactiveTab]=!1===e.isActive,t)),onClick:function(){e.onSelect(e.name)},onKeyDown:function(t){13===t.keyCode&&e.onSelect(e.name)},tabIndex:0,role:"tab","aria-controls":e.name,"aria-selected":!0===e.isActive,"data-test-id":e.testId},e.children)}function M(e){return n.createElement("div",{className:z.root},n.createElement(T,{name:"editor",onSelect:e.onSelect,isActive:"editor"===e.active,testId:"markdown-tab-md"},"Editor"),n.createElement(T,{name:"preview",onSelect:e.onSelect,isActive:"preview"===e.active,testId:"markdown-tab-preview"},"Preview"))}var H=["label"],B=["label"],F=["label"],A=["label"],D=["label"],R=["label"],O=["label"],V=["label"],P=["label"],j=["label"],_=r.css({position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",border:"0"}),U=function(e){var t=e.label,r=N(e,H);return n.createElement("svg",I({width:14,height:14,viewBox:"0 0 1792 1792"},r),n.createElement("path",{d:"M1411 541l-355 355 355 355 144-144q29-31 70-14 39 17 39 59v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l144-144-355-355-355 355 144 144q31 30 14 69-17 40-59 40H192q-26 0-45-19t-19-45v-448q0-42 40-59 39-17 69 14l144 144 355-355-355-355-144 144q-19 19-45 19-12 0-24-5-40-17-40-59V192q0-26 19-45t45-19h448q42 0 59 40 17 39-14 69L541 381l355 355 355-355-144-144q-31-30-14-69 17-40 59-40h448q26 0 45 19t19 45v448q0 42-39 59-13 5-25 5-26 0-45-19z"}),n.createElement("span",{className:_},t))},X=function(e){var t=e.label,r=N(e,B);return n.createElement("svg",I({width:14,height:14,viewBox:"0 0 1792 1792"},r),n.createElement("path",{d:"M1760 896q14 0 23 9t9 23v64q0 14-9 23t-23 9H32q-14 0-23-9t-9-23v-64q0-14 9-23t23-9h1728zM483 832q-28-35-51-80-48-98-48-188 0-181 134-309 133-127 393-127 50 0 167 19 66 12 177 48 10 38 21 118 14 123 14 183 0 18-5 45l-12 3-84-6-14-2q-50-149-103-205-88-91-210-91-114 0-182 59-67 58-67 146 0 73 66 140t279 129q69 20 173 66 58 28 95 52H483zm507 256h411q7 39 7 92 0 111-41 212-23 56-71 104-37 35-109 81-80 48-153 66-80 21-203 21-114 0-195-23l-140-40q-57-16-72-28-8-8-8-22v-13q0-108-2-156-1-30 0-68l2-37v-44l102-2q15 34 30 71t22.5 56 12.5 27q35 57 80 94 43 36 105 57 59 22 132 22 64 0 139-27 77-26 122-86 47-61 47-129 0-84-81-157-34-29-137-71z"}),n.createElement("span",{className:_},t))},W=function(e){var t=e.label,r=N(e,F);return n.createElement("svg",I({width:14,height:14,viewBox:"0 0 1792 1792"},r),n.createElement("path",{d:"M352 832q0 14-9 23L55 1143q-9 9-23 9-13 0-22.5-9.5T0 1120V544q0-13 9.5-22.5T32 512q14 0 23 9l288 288q9 9 9 23zm1440 480v192q0 13-9.5 22.5t-22.5 9.5H32q-13 0-22.5-9.5T0 1504v-192q0-13 9.5-22.5T32 1280h1728q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5t-22.5 9.5H672q-13 0-22.5-9.5T640 1120V928q0-13 9.5-22.5T672 896h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5T1760 768H672q-13 0-22.5-9.5T640 736V544q0-13 9.5-22.5T672 512h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5T1760 384H32q-13 0-22.5-9.5T0 352V160q0-13 9.5-22.5T32 128h1728q13 0 22.5 9.5t9.5 22.5z"}),n.createElement("span",{className:_},t))},G=function(e){var t=e.label,r=N(e,A);return n.createElement("svg",I({width:14,height:14,viewBox:"0 0 1792 1792"},r),n.createElement("path",{d:"M384 544v576q0 13-9.5 22.5T352 1152q-14 0-23-9L41 855q-9-9-9-23t9-23l288-288q9-9 23-9 13 0 22.5 9.5T384 544zm1408 768v192q0 13-9.5 22.5t-22.5 9.5H32q-13 0-22.5-9.5T0 1504v-192q0-13 9.5-22.5T32 1280h1728q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5t-22.5 9.5H672q-13 0-22.5-9.5T640 1120V928q0-13 9.5-22.5T672 896h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5T1760 768H672q-13 0-22.5-9.5T640 736V544q0-13 9.5-22.5T672 512h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5T1760 384H32q-13 0-22.5-9.5T0 352V160q0-13 9.5-22.5T32 128h1728q13 0 22.5 9.5t9.5 22.5z"}),n.createElement("span",{className:_},t))},K=function(e){var t=e.label,r=N(e,D);return n.createElement("svg",I({width:18,height:14,viewBox:"0 0 2304 1792"},r),n.createElement("path",{d:"M640 1632l384-192v-314l-384 164v342zm-64-454l404-173-404-173-404 173zm1088 454l384-192v-314l-384 164v342zm-64-454l404-173-404-173-404 173zm-448-293l384-165V454l-384 164v267zm-64-379l441-189-441-189-441 189zm1088 518v416q0 36-19 67t-52 47l-448 224q-25 14-57 14t-57-14l-448-224q-4-2-7-4-2 2-7 4l-448 224q-25 14-57 14t-57-14L71 1554q-33-16-52-47t-19-67v-416q0-38 21.5-70T78 906l434-186V320q0-38 21.5-70t56.5-48l448-192q23-10 50-10t50 10l448 192q35 16 56.5 48t21.5 70v400l434 186q36 16 57 48t21 70z"}),n.createElement("span",{className:_},t))},$=function(e){var t=e.label,r=N(e,R);return n.createElement("svg",I({width:14,height:14,viewBox:"0 0 1792 1792"},r),n.createElement("path",{d:"M576 1376v-192q0-14-9-23t-23-9H224q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm0-384V800q0-14-9-23t-23-9H224q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm512 384v-192q0-14-9-23t-23-9H736q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zM576 608V416q0-14-9-23t-23-9H224q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm512 384V800q0-14-9-23t-23-9H736q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm512 384v-192q0-14-9-23t-23-9h-320q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm-512-768V416q0-14-9-23t-23-9H736q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm512 384V800q0-14-9-23t-23-9h-320q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm0-384V416q0-14-9-23t-23-9h-320q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm128-320v1088q0 66-47 113t-113 47H224q-66 0-113-47t-47-113V288q0-66 47-113t113-47h1344q66 0 113 47t47 113z"}),n.createElement("span",{className:_},t))},Y=function(e){var t=e.label,r=N(e,O);return n.createElement("svg",I({width:14,height:14,viewBox:"0 0 1792 1792"},r),n.createElement("path",{d:"M1360 1307l35 159q3 12-3 22.5t-17 14.5l-5 1q-4 2-10.5 3.5t-16 4.5-21.5 5.5-25.5 5-30 5-33.5 4.5-36.5 3-38.5 1q-234 0-409-130.5T511 1054h-95q-13 0-22.5-9.5T384 1022V909q0-13 9.5-22.5T416 877h66q-2-57 1-105h-67q-14 0-23-9t-9-23V626q0-14 9-23t23-9h98q67-210 243.5-338T1158 128q102 0 194 23 11 3 20 15 6 11 3 24l-43 159q-3 13-14 19.5t-24 2.5l-4-1q-4-1-11.5-2.5L1261 364l-22.5-3.5-26-3-29-2.5-29.5-1q-126 0-226 64T778 594h468q16 0 25 12 10 12 7 26l-24 114q-5 26-32 26H734q-3 37 0 105h459q15 0 25 12 9 12 6 27l-24 112q-2 11-11 18.5t-20 7.5H782q48 117 149.5 185.5T1160 1308q18 0 36-1.5t33.5-3.5 29.5-4.5 24.5-5 18.5-4.5l12-3 5-2q13-5 26 2 12 7 15 21z"}),n.createElement("span",{className:_},t))},Z=function(e){var t=e.label,r=N(e,V);return n.createElement("svg",I({width:14,height:14,viewBox:"0 0 1792 1792"},r),n.createElement("path",{d:"M1792 1248v320q0 40-28 68t-68 28h-320q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h96V960H960v192h96q40 0 68 28t28 68v320q0 40-28 68t-68 28H736q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h96V960H320v192h96q40 0 68 28t28 68v320q0 40-28 68t-68 28H96q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h96V960q0-52 38-90t90-38h512V640h-96q-40 0-68-28t-28-68V224q0-40 28-68t68-28h320q40 0 68 28t28 68v320q0 40-28 68t-68 28h-96v192h512q52 0 90 38t38 90v192h96q40 0 68 28t28 68z"}),n.createElement("span",{className:_},t))},Q=function(e){var t=e.label,r=N(e,P);return n.createElement("svg",I({width:14,height:14,viewBox:"0 0 1792 1792"},r),n.createElement("path",{d:"M1664 896q0 156-61 298t-164 245-245 164-298 61q-172 0-327-72.5T305 1387q-7-10-6.5-22.5t8.5-20.5l137-138q10-9 25-9 16 2 23 12 73 95 179 147t225 52q104 0 198.5-40.5T1258 1258t109.5-163.5T1408 896t-40.5-198.5T1258 534t-163.5-109.5T896 384q-98 0-188 35.5T548 521l137 138q31 30 14 69-17 40-59 40H192q-26 0-45-19t-19-45V256q0-42 40-59 39-17 69 14l130 129q107-101 244.5-156.5T896 128q156 0 298 61t245 164 164 245 61 298z"}),n.createElement("span",{className:_},t))},J=function(e){var t=e.label,r=N(e,j);return n.createElement("svg",I({width:14,height:14,viewBox:"0 0 1792 1792"},r),n.createElement("path",{d:"M1664 256v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l138-138q-148-137-349-137-104 0-198.5 40.5T534 534 424.5 697.5 384 896t40.5 198.5T534 1258t163.5 109.5T896 1408q119 0 225-52t179-147q7-10 23-12 15 0 25 9l137 138q9 8 9.5 20.5t-7.5 22.5q-109 132-264 204.5T896 1664q-156 0-298-61t-245-164-164-245-61-298 61-298 164-245 245-164 298-61q147 0 284.5 55.5T1425 340l130-129q29-31 70-14 39 17 39 59z"}),n.createElement("span",{className:_},t))},ee=function(e){var t=function(t){e.onSelect(t)};return n.createElement(o.Menu,null,n.createElement(o.Menu.Trigger,null,e.children),n.createElement(o.Menu.List,null,n.createElement(o.Menu.Item,{testId:"markdown-action-button-heading-h1",onClick:function(){return t("h1")}},"Heading 1"),n.createElement(o.Menu.Item,{testId:"markdown-action-button-heading-h2",onClick:function(){return t("h2")}},"Heading 2"),n.createElement(o.Menu.Item,{testId:"markdown-action-button-heading-h3",onClick:function(){return t("h3")}},"Heading 3")))},te=function(e){return e.canAddNew?n.createElement(ne,I({},e)):n.createElement(o.Button,{isDisabled:e.disabled,startIcon:n.createElement(l.AssetIcon,null),testId:"markdownEditor.linkExistingAssets",size:"small",variant:"secondary",onClick:function(){e.onSelectExisting()}},"Insert media")},ne=function(e){return n.createElement(o.Menu,{placement:"bottom-end"},n.createElement(o.Menu.Trigger,null,n.createElement(o.Button,{endIcon:n.createElement(l.ChevronDownIcon,null),isDisabled:e.disabled,startIcon:n.createElement(l.AssetIcon,null),testId:"markdownEditor.insertMediaDropdownTrigger",size:"small",variant:"secondary"},"Insert media")),n.createElement(o.Menu.List,null,n.createElement(o.Menu.Item,{testId:"markdownEditor.uploadAssetsAndLink",onClick:function(){return e.onAddNew()}},"Add new media and link"),n.createElement(o.Menu.Item,{testId:"markdownEditor.linkExistingAssets",onClick:function(){return e.onSelectExisting()}},"Link existing media")))},re=["tooltip","onClick","children","className","variant","tooltipPlace","isDisabled"],ae={root:r.css({position:"relative",zIndex:Number(a.zIndexWorkbenchHeader),border:"1px solid "+a.gray400,backgroundColor:a.gray100,padding:a.spacingXs,borderTopLeftRadius:a.borderRadiusSmall}),button:r.css({height:"30px",width:"36px",marginLeft:a.spacing2Xs,marginRight:a.spacing2Xs}),icon:r.css({fill:a.gray700,verticalAlign:"middle"}),zenButton:r.css({marginLeft:a.spacingXs}),zenButtonPressed:r.css({backgroundColor:a.gray400}),tooltip:r.css({zIndex:Number(a.zIndexTooltip)})},ie=n.forwardRef((function(e,t){var a=e.tooltip,i=e.onClick,l=e.children,c=e.className,s=e.variant,u=void 0===s?"transparent":s,d=e.tooltipPlace,m=void 0===d?"top":d,f=e.isDisabled,p=void 0!==f&&f,h=N(e,re);return n.createElement(o.Tooltip,{className:ae.tooltip,placement:m,content:a},n.createElement(o.IconButton,I({},h,{ref:t,className:r.cx(ae.button,c),isDisabled:p,onClick:i,variant:u,size:"small",icon:l,"aria-label":a})))}));function oe(e){var t="zen"===e.mode?"bottom":"top";return n.createElement(n.Fragment,null,n.createElement(ee,{onSelect:function(t){t&&e.actions.headings[t]&&e.actions.headings[t]()}},n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-heading",tooltip:"Headings",tooltipPlace:t},n.createElement(l.HeadingIcon,{"aria-label":"Headings",className:ae.icon}))),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-bold",tooltip:"Bold",tooltipPlace:t,onClick:e.actions.simple.bold},n.createElement(l.FormatBoldIcon,{"aria-label":"Bold",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-italic",tooltip:"Italic",tooltipPlace:t,onClick:e.actions.simple.italic},n.createElement(l.FormatItalicIcon,{"aria-label":"Italic",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-quote",tooltip:"Quote",tooltipPlace:t,onClick:e.actions.simple.quote},n.createElement(l.QuoteIcon,{"aria-label":"Quote",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-ul",tooltip:"Unordered list",tooltipPlace:t,onClick:e.actions.simple.ul},n.createElement(l.ListBulletedIcon,{"aria-label":"Unordered list",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-ol",tooltip:"Ordered list",tooltipPlace:t,onClick:e.actions.simple.ol},n.createElement(l.ListNumberedIcon,{"aria-label":"Ordered list",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-link",tooltip:"Link",tooltipPlace:t,onClick:e.actions.insertLink},n.createElement(l.LinkIcon,{"aria-label":"Link",className:ae.icon})))}function le(e){var t="zen"===e.mode?"bottom":"top";return n.createElement(n.Fragment,null,n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-strike",tooltip:"Strike out",tooltipPlace:t,onClick:e.actions.simple.strike},n.createElement(X,{label:"Strike out",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-code",tooltip:"Code block",tooltipPlace:t,onClick:e.actions.simple.code},n.createElement(l.CodeIcon,{"aria-label":"Code block",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-hr",tooltip:"Horizontal rule",tooltipPlace:t,onClick:e.actions.simple.hr},n.createElement(l.HorizontalRuleIcon,{"aria-label":"Horizontal rule",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-indent",tooltip:"Increase indentation",tooltipPlace:t,onClick:e.actions.simple.indent},n.createElement(W,{label:"Increase indentation",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-dedent",tooltip:"Decrease indentation",tooltipPlace:t,onClick:e.actions.simple.dedent},n.createElement(G,{label:"Decrease indentation",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-embed",tooltip:"Embed external content",tooltipPlace:t,onClick:e.actions.embedExternalContent},n.createElement(K,{label:"Embed external content",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-table",tooltip:"Insert table",tooltipPlace:t,onClick:e.actions.insertTable},n.createElement($,{label:"Insert table",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-special",tooltip:"Insert special character",tooltipPlace:t,onClick:e.actions.insertSpecialCharacter},n.createElement(Y,{label:"Insert special character",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-organizeLinks",tooltip:"Organize links",tooltipPlace:t,onClick:e.actions.organizeLinks},n.createElement(Z,{label:"Organize links",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-undo",tooltip:"Undo",tooltipPlace:t,onClick:e.actions.history.undo},n.createElement(Q,{label:"Undo",className:ae.icon})),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-redo",tooltip:"Redo",tooltipPlace:t,onClick:e.actions.history.redo},n.createElement(J,{label:"Redo",className:ae.icon})))}function ce(e){var t=n.useState(!1),r=t[0],a=t[1];return n.createElement("div",{className:ae.root},n.createElement(o.Flex,{justifyContent:"space-between"},n.createElement(o.Flex,null,n.createElement(oe,I({},e)),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-toggle-additional",tooltip:r?"Hide additional actions":"More actions",onClick:function(){a(!r)}},n.createElement(l.MoreHorizontalIcon,{className:ae.icon}))),n.createElement(o.Flex,null,n.createElement(te,{disabled:e.disabled,onSelectExisting:e.actions.linkExistingMedia,onAddNew:e.actions.addNewMedia,canAddNew:e.canUploadAssets}),n.createElement(ie,{isDisabled:e.disabled,testId:"markdown-action-button-zen",variant:"secondary",onClick:e.actions.openZenMode,className:ae.zenButton,tooltip:"Expand"},n.createElement(U,{label:"Expand",className:ae.icon})))),r&&n.createElement(o.Flex,{justifyContent:"space-between",marginTop:"spacingXs"},n.createElement(o.Flex,null,n.createElement(le,I({},e)))))}function se(e){return n.createElement("div",{className:ae.root},n.createElement(o.Flex,{justifyContent:"space-between"},n.createElement(o.Flex,null,n.createElement(oe,I({},e)),n.createElement(le,I({},e))),n.createElement(o.Flex,null,n.createElement(te,{disabled:e.disabled,onSelectExisting:e.actions.linkExistingMedia,onAddNew:e.actions.addNewMedia,canAddNew:e.canUploadAssets}),n.createElement(o.IconButton,{testId:"markdown-action-button-zen-close",variant:"secondary",size:"small",className:r.cx(ae.zenButton,ae.zenButtonPressed),onClick:function(){e.actions.closeZenMode()},icon:n.createElement(U,{label:"Collapse",className:ae.icon}),"aria-label":"Collapse"}))))}ie.displayName="ToolbarButton";var ue=n.memo((function(e){return n.createElement("zen"===e.mode?se:ce,I({},e))}));ue.displayName="MarkdownToolbar";var de=d(window,"navigator.userAgent",""),me=d(window,"navigator.platform",""),fe="Ctrl";function pe(){return fe}function he(e){if("string"!=typeof e)return e;if(!e.match(/^([+-]?(?:\d+|\d*\.\d+))([a-z]*|%)$/))throw new Error("Couldn't match unit in given string");return parseFloat(e)}function ge(e){return function(t){t.lineStartsWith(e)?t.removeFromLineBeginning(e.length):t.insertAtLineBeginning(e)}}function ve(e,t,n){return function(){if(e.usePrimarySelection(),e.getSelection()){var r=e.getSelectedText();if(r.startsWith(t)&&r.endsWith(t)){var a=t.length,i=r.slice(a,r.length-a);e.replaceSelectedText(i)}else e.wrapSelection(t)}else e.insertAtCursor(t+n+t),e.selectBackwards(t.length,n.length)}}(/(iphone os|ipad|iphone|ipod)/i.test(de)&&!window.MSStream||/mac(68k|ppc|intel)/i.test(me))&&(fe="Cmd");var be,Ee,ke=ge("> "),we=ge("    ");function xe(e){return{bold:ve(e,"__","text in bold"),italic:ve(e,"*","text in italic"),strike:ve(e,"~~","striked out"),quote:ye(e,ke),code:ye(e,we),link:function(t,n,r){e.usePrimarySelection(),e.replaceSelectedText(n?"["+n+"]("+t+(r?' "'+r+'"':"")+")":"<"+t+">","around")},h1:Ie(e,1),h2:Ie(e,2),h3:Ie(e,3),ul:ye(e,qe,!0),ol:ye(e,Se,!0),undo:function(){e.cmd("undo")},redo:function(){e.cmd("redo")},hr:function(){e.moveIfNotEmpty();var t=e.getNl();e.insertAtCursor(t+"---"+t+t)},indent:function(){e.insertAtLineBeginning(e.getIndentation())},dedent:function(){var t=e.getIndentation();e.lineStartsWith(t)&&e.removeFromLineBeginning(t.length)},table:function(t){var n=e.getNl();e.moveIfNotEmpty(),e.insertAtCursor(n);var r=e.getCurrentLineNumber();e.insertAtCursor(function(e,t){var n=new Array(11),r=" "+n.join(" ")+" |",a=" "+n.join("-")+" |",i="|",o="|";h(t,(function(){i+=r,o+=a}));var l=m(e).map((function(){return i.replace(/\| {5}/g,"| Cell")}));return[i.replace(/\| {7}/g,"| Header"),o].concat(l)}(t.rows,t.cols).join(n)),e.insertAtCursor(n+n),e.restoreCursor(2,r)}}}function ye(e,t,n){return function(){e.usePrimarySelection();var r=e.getSelection();r?(function(n,r){var a=[n.anchor.line,n.head.line],i=p(a),o=f(a);m(o||0,void 0!==i?i+1:void 0).forEach((function(n,r){!function(n,r){e.moveToLineBeginning(n),t(e,r)}(n,r+1)}))}(r),e.moveToLineEnd()):(!n||Ce(e)||e.lineStartsWith("- ")||function(e){var t=e.getCurrentLineNumber(),n=e.isLineEmpty(t),r=n?2:4;t>0&&e.isLineEmpty(t-1)&&(r-=1),(!(t<e.getLinesCount()-1)||e.isLineEmpty(t+1))&&(r-=1),e.moveToLineEnd(),e.insertAtCursor(e.getNl(r)),e.restoreCursor(0,n?t:t+2)}(e),t(e))}}function Ce(e){var t=e.getCurrentLine().match(/^(\d+\. )/);return t?t[1]:null}function qe(e){if(e.lineStartsWith("- "))e.removeFromLineBeginning(2);else{var t=Ce(e);t&&e.removeFromLineBeginning(t.length),e.insertAtLineBeginning("- ")}}function Se(e,t){var n=Ce(e);n?e.removeFromLineBeginning(n.length):(e.lineStartsWith("- ")&&e.removeFromLineBeginning(2),e.insertAtLineBeginning((t||1)+". "))}function Ie(e,t){return function(){var n=e.getCurrentCharacter(),r=function(e){var t=e.getCurrentLine().match(/^( {0,3})(#{1,6}) /);if(!t)return null;var n=t[1],r=t[2];return e.select(a(0),a(r.length)),e.getSelection();function a(t){return{line:e.getCurrentLineNumber(),ch:n.length+t}}}(e),a=g("#",t);if(!r)return e.moveToLineBeginning(),e.insertAtCursor(a+" "),void e.restoreCursor(n+a.length+1);if(e.getSelectedText()===a){e.extendSelectionBy(1);var i=e.getSelectionLength();return e.removeSelectedText(),void e.restoreCursor(n-i)}var o=a.length-e.getSelectionLength();e.replaceSelectedText(a),e.restoreCursor(n+o)}}var Ne={root:r.css(be||(be=L(["\n    border: 1px solid ",";\n    border-width: 0 1px;\n    overflow-y: auto;\n    height: auto;\n    min-height: 300px;\n\n    .CodeMirror {\n      height: auto;\n      line-height: ",";\n    }\n    .CodeMirror-lines {\n      color: ",";\n      padding: ",";\n    }\n    .CodeMirror-code {\n      font-family: ",";\n      font-size: ",";\n    }\n    .CodeMirror-scroll {\n      min-height: '6rem';\n    }\n\n    .cm-header {\n      color: ",";\n    }\n    span.cm-variable-2 {\n      color: ",";\n    }\n    .cm-header-1 {\n      font-size: 1.9em;\n    }\n    .cm-header-2 {\n      font-size: 1.75em;\n    }\n    .cm-header-3 {\n      font-size: 1.6em;\n    }\n    .cm-header-4 {\n      font-size: 1.45em;\n    }\n    .cm-header-5 {\n      font-size: 1.3em;\n    }\n    .cm-header-6 {\n      font-size: 1.15em;\n    }\n\n    span.cm-tag,\n    span.cm-string,\n    span.cm-attribute {\n      color: ",";\n    }\n    span.cm-string {\n      text-decoration: none !important;\n    }\n    span.cm-quote,\n    span.cm-comment {\n      color: ",";\n    }\n    span.cm-link,\n    span.cm-url {\n      color: "," !important;\n    }\n    span.cm-link {\n      text-decoration: underline;\n    }\n  "])),a.gray400,a.lineHeightDefault,a.gray700,a.spacingL,a.fontStackMonospace,a.fontSizeM,a.gray900,a.gray700,a.red600,a.gray600,a.blue500),framed:r.css({".CodeMirror":{maxHeight:"500px"}}),zen:r.css({border:"none !important",".CodeMirror-lines":{maxWidth:"650px",margin:"0 auto"}}),disabled:r.css(Ee||(Ee=L(["\n    .CodeMirror {\n      background: ",";\n      cursor: 'not-allowed';\n    }\n    .CodeMirror-cursors {\n      visibility: hidden !important;\n    }\n    .CodeMirror-scroll,\n    .CodeMirror-sizer,\n    .CodeMirror-lines {\n      cursor: not-allowed;\n    }\n  "])),a.gray100)},Le=n.memo((function(e){var a=t.useRef(null),i=t.useState(null),o=i[0],l=i[1];t.useEffect((function(){a.current&&l(function(e,t){var n=function(e,t){var n=t||{},r=n.direction,a=n.fixedHeight,i=n.height,o=n.readOnly,l=!1,d={min:i?he(i):300,max:500,shift:50},m=c(e,{direction:r,readOnly:o,mode:"markdown",lineNumbers:!1,undoDepth:200,matchBrackets:!0,lineWrapping:!0,lineSeparator:null,theme:"elegant",tabSize:2,indentWithTabs:!1,indentUnit:2,autoRefresh:!0,spellcheck:!0,inputStyle:"contenteditable"});return m.setSize("100%",d.min),a||m.on("change",s((function(){var e=m.heightAtLine(m.lastLine(),"local")+d.shift,t=e;e<d.min&&(t=d.min),e>d.max&&(t=d.max),m.setSize("100%",t)}),150)),m.setOption("extraKeys",{Tab:function(){k(N())},Enter:"newlineAndIndentContinueMarkdownList",Esc:function(){m.getInputField().blur()}}),{destroy:function(){m.toTextArea()},disable:function(){m.setOption("readOnly","nocursor")},enable:function(){m.setOption("readOnly",!1)},attachEvent:function(e,t,n){n&&(t=s(t,n)),m.on(e,t)},addKeyShortcuts:function(e){var t=pe();m.addKeyMap(u(e,(function(e,n,r){e[t+"-"+r]=n}),{}))},setValue:function(e){if(e=e||"",z()!==e){var t=q(),n=S();m.setValue(e),h(n,t,!0),l||(m.clearHistory(),l=!0)}},cmd:f,moveToLineBeginning:p,moveIfNotEmpty:function(){if(!(I()<1)){var e=q()+1;m.lastLine()<e&&(g(),E(L())),p(e)}},restoreCursor:h,moveToLineEnd:g,usePrimarySelection:function(){f("singleSelection")},focus:function(){m.focus()},select:b,selectBackwards:function(e,t){function n(e){return{line:q(),ch:S()+e}}b(n(-e-t),n(-e))},selectAll:function(){return m.execCommand("selectAll")},extendSelectionBy:function(e){function t(e,t){var n=w();return n?{line:n[e].line,ch:n[e].ch+t}:{line:0,ch:0}}b(t("anchor",0),t("head",e))},insertAtCursor:E,insertAtLineBeginning:function(e){var t=S();p(),E(e),h(t+e.length),m.focus()},wrapSelection:function(e){var t=e+y()+e,n=w();n&&(m.replaceRange(t,n.anchor,null==n?void 0:n.head),m.focus())},removeFromLineBeginning:function(e){var t=q();m.replaceRange("",{line:t,ch:0},{line:t,ch:e}),m.focus()},removeSelectedText:function(){m.replaceSelection(""),m.focus()},replaceSelectedText:k,getCursor:function(){return m.getCursor()},setCursor:function(e){m.setCursor(e)},getSelection:w,getLine:x,isLineEmpty:function(e){var t=v(e);return t>-1&&x(t).length<1&&t<m.lineCount()},getSelectedText:y,getSelectionLength:function(){return y().length},getCurrentLine:C,getCurrentLineNumber:q,getCurrentCharacter:S,getCurrentLineLength:I,lineStartsWith:function(e){return C().startsWith(e)},getIndentation:N,getNl:L,getValue:z,getLinesCount:function(){return m.lineCount()},getHistorySize:function(e){var t=m.historySize();return e?t[e]:t},setReadOnly:function(e){return m.setOption("readOnly",e)},getHistory:function(){return m.getHistory()},setHistory:function(e){return m.setHistory(e)},setFullsize:function(){m.setSize("100%","100%"),m.refresh()},refresh:function(){return m.refresh()}};function f(e){m.execCommand(e),m.focus()}function p(e){m.setCursor({line:v(e),ch:0}),m.focus()}function h(e,t,n){m.setCursor(v(t),e,{scroll:!n}),n||m.focus()}function g(e){m.setCursor({line:v(e),ch:I()}),m.focus()}function v(e){return 0===e||void 0!==e&&e>0?e:q()}function b(e,t){m.setSelection(e,t),m.focus()}function E(e){m.replaceRange(e,m.getCursor()),m.focus()}function k(e,t){m.replaceSelection(e,t),m.focus()}function w(){var e=m.listSelections();return!m.somethingSelected()||!e||e.length<1?null:e[0]}function x(e){return m.getLine(e)||""}function y(){return w()?m.getSelection():""}function C(){return x(q())}function q(){return m.getCursor().line}function S(){return m.getCursor().ch}function I(){return C().length}function N(){var e;return T(" ",null!=(e=m.getOption("indentUnit"))?e:0)}function L(e){return void 0===e&&(e=1),e<1?"":T("\n",e)}function z(){return m.getValue()||""}function T(e,t){return new Array(t+1).join(e)}}(e,t),r={actions:xe(n),history:{hasUndo:function(){return n.getHistorySize("undo")>0},hasRedo:function(){return n.getHistorySize("redo")>0}},events:{onScroll:function(e){n.attachEvent("scroll",e,150)},onChange:function(e){n.attachEvent("change",function(e){return function(t,r){e(n.getValue(),t,r)}}(e),0)},onPaste:function(e){n.attachEvent("paste",e,0)}},insert:n.insertAtCursor,focus:n.focus,getContent:n.getValue,destroy:n.destroy,setContent:n.setValue,getSelectedText:n.getSelectedText,usePrimarySelection:n.usePrimarySelection,setReadOnly:n.setReadOnly,selectBackwards:n.selectBackwards,getCursor:n.getCursor,setCursor:n.setCursor,clear:function(){return n.setValue("")},selectAll:n.selectAll,setFullsize:n.setFullsize,refresh:n.refresh};return n.addKeyShortcuts({B:r.actions.bold,I:r.actions.italic}),r}(a.current,Object.assign({},{direction:e.direction,readOnly:!0},"zen"===e.mode?{fixedHeight:!0,height:"100%"}:{},void 0!==e.minHeight?{height:e.minHeight}:{})))}),[]),t.useEffect((function(){o&&e.onReady(o)}),[o]);var d=r.cx(Ne.root,void 0!==e.minHeight?r.css({minHeight:e.minHeight}):void 0,"default"===e.mode?Ne.framed:Ne.zen,e.disabled&&Ne.disabled);return n.createElement("div",{className:d,ref:a,"data-test-id":"markdown-textarea",style:{display:e.visible?"block":"none"}})}));Le.displayName="MarkdownTextarea";var ze,Te={root:r.css({display:"flex",justifyContent:"space-between",background:a.gray100,border:"1px solid "+a.gray400,borderBottomLeftRadius:a.borderRadiusSmall,borderBottomRightRadius:a.borderRadiusSmall,padding:a.spacingXs+" "+a.spacingS}),help:r.css({color:a.gray700,fontSize:a.fontSizeS,button:{fontSize:a.fontSizeS,lineHeight:"inherit"}})};function Me(e){return n.createElement(o.Paragraph,{marginBottom:"none",className:Te.help},"Format your text like a pro with the"," ",n.createElement(o.TextLink,{as:"button",testId:"open-markdown-cheatsheet-button",onClick:function(){e.onClick()}},"markdown cheatsheet"),".")}function He(e){return n.createElement("div",{className:Te.root},e.children)}!function(e){e.cheatsheet="markdown-cheatsheet",e.insertLink="markdown-insertLink",e.insertSpecialCharacter="markdown-insertSpecialCharacter",e.insertTable="markdown-insertTable",e.embedExternalContent="markdown-embedExternalContent",e.confirmInsertAsset="markdown-confirmInsertAsset",e.zenMode="markdown-zenMode"}(ze||(ze={}));var Be,Fe={flexColumnContainer:r.css({display:"flex",flexWrap:"nowrap"}),flexColumn:r.css({flexGrow:1}),verticalDivider:r.css({borderRight:"1px solid "+a.gray500,paddingRight:a.spacing3Xl,marginRight:a.spacing2Xl}),preview:r.css({display:"inline-block",paddingRight:a.spacingL,width:"50%"}),unOrderedListPreview:r.css({listStyleType:"disc",marginLeft:a.spacingS}),orderedListPreview:r.css({listStyleType:"decimal",marginLeft:a.spacingS}),markup:r.css({display:"inline-block",color:a.gray600,paddingLeft:a.spacingL,width:"50%"}),h1:r.css({fontSize:a.fontSize2Xl}),h2:r.css({fontSize:a.fontSizeXl}),h3:r.css({fontSize:a.fontSizeL}),helpItem:r.css({marginBottom:a.spacingS,display:"flex",alignItems:"flex-end",height:a.spacingXl}),helpLink:r.css({margin:"auto"}),flexRowContainer:r.css({display:"flex",width:"100%",justifyContent:"center",marginTop:a.spacingXl})},Ae=function(){return n.createElement(o.ModalContent,{testId:"markdown-cheatsheet-dialog-content"},n.createElement("div",{className:Fe.flexColumnContainer},n.createElement("div",{className:r.cx(Fe.flexColumn,Fe.verticalDivider)},n.createElement("div",{className:Fe.helpItem},n.createElement(o.Heading,{marginBottom:"none",as:"h1",className:r.cx(Fe.preview,Fe.h1)},"H1"),n.createElement("div",{className:Fe.markup},"# heading")),n.createElement("div",{className:Fe.helpItem},n.createElement(o.Heading,{marginBottom:"none",as:"h2",className:r.cx(Fe.preview,Fe.h2)},"H2"),n.createElement("div",{className:Fe.markup},"## heading")),n.createElement("div",{className:Fe.helpItem},n.createElement(o.Heading,{marginBottom:"none",as:"h3",className:r.cx(Fe.preview,Fe.h3)},"H3"),n.createElement("div",{className:Fe.markup},"### heading")),n.createElement("div",{className:Fe.helpItem},n.createElement("strong",{className:Fe.preview},"bold"),n.createElement("div",{className:Fe.markup},"__text__")),n.createElement("div",{className:Fe.helpItem},n.createElement("em",{className:Fe.preview},"italic"),n.createElement("div",{className:Fe.markup},"*text*")),n.createElement("div",{className:Fe.helpItem},n.createElement("div",{className:Fe.preview},"strikethrough"),n.createElement("div",{className:Fe.markup},"~~text~~")),n.createElement("div",{className:Fe.helpItem},n.createElement(o.TextLink,{as:"button",className:Fe.preview},"Link"),n.createElement("div",{className:Fe.markup},"[text](url)"))),n.createElement("div",{className:Fe.flexColumn},n.createElement("div",{className:Fe.helpItem},n.createElement("div",{className:Fe.preview},"Image"),n.createElement("div",{className:Fe.markup},"![alt-text](url)")),n.createElement("div",{className:Fe.helpItem},n.createElement("div",{className:Fe.preview},"Unordered list"),n.createElement("div",{className:Fe.markup},"* list item")),n.createElement("div",{className:Fe.helpItem},n.createElement("div",{className:Fe.preview},n.createElement("div",null,"Ordered list")),n.createElement("div",{className:Fe.markup},"1. list item")),n.createElement("div",{className:Fe.helpItem},n.createElement("div",{className:Fe.preview},n.createElement("div",null,"Blockquote")),n.createElement("div",{className:Fe.markup},"> quote")),n.createElement("div",{className:Fe.helpItem},n.createElement("div",{className:Fe.preview},"code span"),n.createElement("div",{className:Fe.markup},"`code here`")),n.createElement("div",{className:Fe.helpItem},n.createElement("div",{className:Fe.preview},"code block"),n.createElement("div",{className:Fe.markup},"```code here```")))),n.createElement("div",{className:Fe.flexRowContainer},n.createElement(o.TextLink,{className:Fe.helpLink,href:"https://help.github.com/en/github/writing-on-github/basic-writing-and-formatting-syntax",target:"_blank",rel:"noopener noreferrer"},"View the full GitHub-flavored Markdown syntax help (opens in a new window)")))},De=function(e){return e.openCurrent({title:"Markdown formatting help",width:"large",minHeight:"415px",shouldCloseOnEscapePress:!0,shouldCloseOnOverlayClick:!0,parameters:{type:ze.cheatsheet}})},Re=["Embedly","children"],Oe={root:r.css(Be||(Be=L(["\n    border: 1px solid ",";\n    border-width: 0 1px;\n    word-wrap: break-word;\n    overflow-wrap: break-word;\n    min-height: 300px;\n    padding: ",";\n    font-size: ",";\n    font-family: ",";\n    line-height: ",";\n    color: ",";\n    white-space: pre-line;\n\n    h1,\n    h2,\n    h3,\n    h4,\n    h5,\n    h6 {\n      margin-top: ",";\n      margin-bottom: ",";\n      color: ",";\n    }\n\n    h1:first-child,\n    h2:first-child,\n    h3:first-child,\n    h4:first-child,\n    h5:first-child,\n    h6:first-child {\n      margin-top: 0;\n    }\n\n    h1 {\n      font-size: 1.9em;\n    }\n    h2 {\n      font-size: 1.75em;\n    }\n    h3 {\n      font-size: 1.6em;\n    }\n    h4 {\n      font-size: 1.45em;\n    }\n    h5 {\n      font-size: 1.3em;\n    }\n    h6 {\n      font-size: 1.15em;\n    }\n\n    p {\n      margin-top: 0;\n      margin-bottom: ",";\n    }\n\n    ul,\n    ol {\n      margin: "," 0;\n      padding-left: ",";\n    }\n    ul > li {\n      list-style-type: disc;\n      margin-bottom: 0;\n    }\n\n    ol > li {\n      list-style-type: decimal;\n      margin-bottom: 0;\n    }\n\n    table {\n      table-layout: fixed;\n      border-right-width: 0;\n      border-bottom-width: 0;\n      width: 80%;\n      margin: "," auto;\n      border-spacing: 0;\n      border-collapse: collapse;\n      border: 1px solid ",";\n    }\n\n    table th,\n    table td {\n      padding: 5px;\n      border-left-width: 0;\n      border-top-width: 0;\n    }\n\n    table th {\n      background: ",";\n    }\n\n    table td {\n      border: 1px solid ",";\n    }\n\n    a {\n      color: ",";\n    }\n\n    hr {\n      margin-top: ",";\n      margin-bottom: ",";\n      height: 1px;\n      background-color: ",";\n      border: none;\n    }\n\n    blockquote {\n      border-left: 4px solid ",";\n      padding-left: ",";\n      margin: 0;\n      margin-top: ",";\n      font-style: italic;\n    }\n\n    img {\n      margin: "," auto;\n      display: block;\n      max-width: 80%;\n      max-height: 250px;\n    }\n\n    pre code {\n      font-size: ",";\n      font-family: ",";\n    }\n\n    .embedly-card {\n      margin: "," auto;\n      display: block;\n    }\n  "])),a.gray400,a.spacingL,a.fontSizeM,a.fontStackPrimary,a.lineHeightDefault,a.gray700,a.spacingL,a.spacingM,a.gray900,a.spacingM,a.spacingS,a.spacingM,a.spacingM,a.gray300,a.gray200,a.gray300,a.blue500,a.spacingL,a.spacingL,a.gray300,a.gray200,a.spacingL,a.spacingM,a.spacingM,a.fontSizeS,a.fontStackMonospace,a.spacingM),framed:r.css({height:"100%",maxHeight:"500px",overflowY:"auto"}),zen:r.css({maxWidth:"650px",margin:"0 auto",border:"none !important"}),rtl:r.css({direction:"rtl"})};function Ve(e){var t=e.Embedly,r=e.children,a=N(e,Re);return"embedly-card"===e.className&&t?n.createElement(t,{url:e.href}):n.createElement("a",I({},a,{target:"_blank",rel:"noopener noreferrer"}),r)}var Pe=n.memo((function(e){var t,a=r.cx(Oe.root,void 0!==e.minHeight?r.css({minHeight:e.minHeight}):void 0,"default"===e.mode?Oe.framed:Oe.zen,"rtl"===e.direction?Oe.rtl:void 0),i=n.useMemo((function(){return v.sanitize(e.value).replace(/href="mailto:[^"]*&amp;/g,(function(e){return e.replace(/&amp;/g,"&")}))}),[e.value]);return n.createElement("div",{className:a,"data-test-id":"markdown-preview"},n.createElement(b,{options:{overrides:{a:{component:Ve,props:{Embedly:null==(t=e.previewComponents)?void 0:t.embedly}}}}},i))}));Pe.displayName="MarkdownPreview";var je={root:r.css({display:"flex",justifyContent:"space-between",fontSize:a.fontSizeM,marginTop:a.spacingXs,color:a.gray700})};function _e(e){var t=i.ConstraintsUtils.fromFieldValidations(e.sdk.field.validations,e.sdk.field.type),r=i.ConstraintsUtils.makeChecker(t);return n.createElement("div",{className:je.root},n.createElement(i.CharCounter,{value:e.value,checkConstraint:r}),n.createElement(i.CharValidation,{constraints:t}))}function Ue(e,t){return e(t={exports:{}},t.exports),t.exports}var Xe=Ue((function(e){var t=function(e){var t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var a=Object.create((t&&t.prototype instanceof d?t:d).prototype),i=new y(r||[]);return a._invoke=function(e,t,n){var r="suspendedStart";return function(a,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw i;return{value:void 0,done:!0}}for(n.method=a,n.arg=i;;){var o=n.delegate;if(o){var l=k(o,n);if(l){if(l===u)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=s(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(e,n,i),a}function s(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var u={};function d(){}function m(){}function f(){}var p={};l(p,a,(function(){return this}));var h=Object.getPrototypeOf,g=h&&h(h(C([])));g&&g!==t&&n.call(g,a)&&(p=g);var v=f.prototype=d.prototype=Object.create(p);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){var r;this._invoke=function(a,i){function o(){return new t((function(r,o){!function r(a,i,o,l){var c=s(e[a],e,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==typeof d&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,o,l)}),(function(e){r("throw",e,o,l)})):t.resolve(d).then((function(e){u.value=e,o(u)}),(function(e){return r("throw",e,o,l)}))}l(c.arg)}(a,i,r,o)}))}return r=r?r.then(o,o):o()}}function k(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var r=s(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,u;var a=r.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function y(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function C(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:q}}function q(){return{value:void 0,done:!0}}return m.prototype=f,l(v,"constructor",f),l(f,"constructor",m),m.displayName=l(f,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,l(e,o,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},b(E.prototype),l(E.prototype,i,(function(){return this})),e.AsyncIterator=E,e.async=function(t,n,r,a,i){void 0===i&&(i=Promise);var o=new E(c(t,n,r,a),i);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},b(v),l(v,o,"Generator"),l(v,a,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=C,y.prototype={constructor:y,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],o=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var l=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(l&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,u):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),x(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;x(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:C(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}})),We=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-/]))?$/;function Ge(e){return We.test(e)}var Ke=function(e){var r=e.selectedText,a=e.onClose,i=t.useRef(null),l=t.useState(r||""),c=l[0],s=l[1],u=t.useState(""),d=u[0],m=u[1],f=t.useState(!1),p=f[0],h=f[1],g=t.useState(""),v=g[0],b=g[1],E=function(e){return a(e)},k=Ge(d);return t.useEffect((function(){var e;null!=i&&null!=(e=i.current)&&e.focus&&i.current.focus()}),[i]),n.createElement(n.Fragment,null,n.createElement(o.ModalContent,{testId:"insert-link-modal"},n.createElement(o.Form,{onSubmit:function(){return E({url:d,text:c,title:v})}},n.createElement(o.FormControl,{id:"link-text-field",isDisabled:Boolean(r)},n.createElement(o.FormControl.Label,null,"Link text"),n.createElement(o.TextInput,{name:"link-text",value:c,onChange:function(e){s(e.target.value)},testId:"link-text-field"})),n.createElement(o.FormControl,{id:"target-url-field",isInvalid:p&&!k},n.createElement(o.FormControl.Label,null,"Target URL"),n.createElement(o.TextInput,{name:"target-url",value:d,onChange:function(e){m(e.target.value),h(!0)},placeholder:"https://",maxLength:2100,testId:"target-url-field",ref:i}),n.createElement(o.FormControl.HelpText,null,"Include protocol (e.g. https://)"),p&&!k&&n.createElement(o.FormControl.ValidationMessage,null,"Invalid URL")),n.createElement(o.FormControl,{id:"link-title-field"},n.createElement(o.FormControl.Label,null,"Link title"),n.createElement(o.TextInput,{name:"link-title",value:v,onChange:function(e){b(e.target.value)},testId:"link-title-field"}),n.createElement(o.FormControl.HelpText,null,"Extra link information, usually shown as a tooltip on mouse hover")))),n.createElement(o.ModalControls,null,n.createElement(o.Button,{testId:"insert-link-cancel",onClick:function(){return a(!1)},variant:"secondary",size:"small"},"Cancel"),n.createElement(o.Button,{testId:"insert-link-confirm",onClick:function(){E({url:d,text:c,title:v})},isDisabled:!k,variant:"positive",size:"small"},"Insert")))},$e=[{code:180,desc:"acute accent"},{code:38,desc:"ampersand"},{code:166,desc:"broken vertical bar"},{code:8226,desc:"bullet"},{code:184,desc:"cedilla"},{code:162,desc:"cent"},{code:169,desc:"copyright"},{code:176,desc:"degree"},{code:247,desc:"division"},{code:189,desc:"fraction half"},{code:188,desc:"fraction quarter"},{code:190,desc:"fraction three quarters"},{code:62,desc:"greater than"},{code:161,desc:"inverted exclamation mark"},{code:191,desc:"inverted question mark"},{code:171,desc:"left-pointing double angle quotation mark"},{code:60,desc:"less than"},{code:175,desc:"macron"},{code:181,desc:"micro"},{code:160,desc:"non-breaking space"},{code:172,desc:"not"},{code:182,desc:"paragraph"},{code:177,desc:"plus-minus"},{code:34,desc:"quotation mark"},{code:174,desc:"registered"},{code:187,desc:"right-pointing double angle quotation mark"},{code:167,desc:"section"},{code:168,desc:"umlaut/diaeresis"},{code:215,desc:"multiplication"},{code:8482,desc:"trade mark"},{code:8364,desc:"euro"},{code:163,desc:"pound"},{code:165,desc:"yen"},{code:8222,desc:"double low-9 quotation mark"},{code:710,desc:"modifier circumflex accent"},{code:8224,desc:"dagger"},{code:8225,desc:"double dagger"},{code:8230,desc:"horizontal ellipsis"},{code:8220,desc:"left double quotation mark"},{code:8249,desc:"single left-pointing angle quotation mark"},{code:8216,desc:"left single quotation mark"},{code:183,desc:"middle dot"},{code:8212,desc:"em dash"},{code:8211,desc:"en dash"},{code:8240,desc:"per mille"},{code:8250,desc:"single right-pointing angle quotation mark"},{code:8217,desc:"right single quotation mark"},{code:8218,desc:"single low-9 quotation mark"},{code:170,desc:"feminine ordinal indicator"},{code:186,desc:"masculine ordinal indicator"},{code:8221,desc:"right double quotation mark"},{code:732,desc:"small tilde"},{code:9829,desc:"black heart"},{code:9830,desc:"diamond"}],Ye={buttonPanel:r.css({display:"flex",flexWrap:"wrap"}),charButton:r.css({border:"1px solid "+a.gray500,width:"4.1rem",height:"4.1rem",fontSize:a.fontSizeXl,marginTop:a.spacing2Xs,marginRight:a.spacing2Xs}),selectedCharButton:r.css({backgroundColor:a.gray100}),tooltip:r.css({zIndex:1e3}),button:r.css({marginTop:a.spacingM,marginRight:a.spacingS})},Ze=function(e){var r=e.onClose,a=t.useState($e[0]),i=a[0],l=a[1];return n.createElement(n.Fragment,null,n.createElement(o.ModalContent,{testId:"insert-special-character-modal"},n.createElement(o.Flex,{flexDirection:"column",alignItems:"center"},n.createElement(o.Text,{as:"div",lineHeight:"lineHeight3Xl",fontSize:"fontSize3Xl",marginBottom:"spacingS"},String.fromCharCode(i.code)),n.createElement(o.Text,{as:"div",marginBottom:"spacingS"},i.desc)),n.createElement("div",{className:Ye.buttonPanel},$e.map((function(e){return n.createElement("div",{key:e.code},n.createElement(o.Tooltip,{className:Ye.tooltip,content:e.desc},n.createElement(o.Button,{testId:"special-character-button",isActive:e.code===i.code,className:Ye.charButton,variant:"transparent",onClick:function(){return l(e)}},String.fromCharCode(e.code))))})))),n.createElement(o.ModalControls,null,n.createElement(o.Button,{testId:"insert-character-cancel",className:Ye.button,onClick:function(){return r(!1)},variant:"secondary",size:"small"},"Cancel"),n.createElement(o.Button,{className:Ye.button,testId:"insert-character-confirm",onClick:function(){return r(String.fromCharCode(i.code))},variant:"positive",size:"small"},"Insert selected")))},Qe=function(e){var r=e.onClose,a=t.useRef(null),i=t.useState(2),l=i[0],c=i[1],s=t.useState(1),u=s[0],d=s[1],m=E(l,2,100),f=E(u,1,100);return t.useEffect((function(){var e;null!=(e=a.current)&&e.focus&&a.current.focus()}),[a]),n.createElement(n.Fragment,null,n.createElement(o.ModalContent,{testId:"insert-table-modal"},n.createElement(o.Form,null,n.createElement(o.FormControl,{id:"insert-table-rows-number-field",isRequired:!0,isInvalid:!m},n.createElement(o.FormControl.Label,null,"Number of rows"),n.createElement(o.TextInput,{name:"rows",value:l.toString(),onChange:function(e){return c(Number(e.target.value))},testId:"insert-table-rows-number-field",min:2,max:100,pattern:"[1-9][0-9]*",type:"number",width:"small",autoComplete:"off",ref:a}),!m&&n.createElement(o.FormControl.ValidationMessage,null,"Should be between 2 and 100")),n.createElement(o.FormControl,{id:"insert-table-columns-number-field",isRequired:!0,isInvalid:!f},n.createElement(o.FormControl.Label,null,"Number of columns"),n.createElement(o.TextInput,{name:"columns",value:u.toString(),onChange:function(e){return d(Number(e.target.value))},testId:"insert-table-columns-number-field",min:1,max:100,pattern:"[1-9][0-9]*",type:"number",width:"small",autoComplete:"off"}),!f&&n.createElement(o.FormControl.ValidationMessage,null,"Should be between 1 and 100")))),n.createElement(o.ModalControls,null,n.createElement(o.Button,{testId:"insert-table-cancel",onClick:function(){return r(!1)},variant:"secondary",size:"small"},"Cancel"),n.createElement(o.Button,{testId:"insert-table-confirm",onClick:function(){return r({rows:l,cols:u})},variant:"positive",size:"small",isDisabled:!m||!f},"Insert")))},Je={widthFiledGroup:r.css({display:"flex",flexWrap:"nowrap",alignItems:"flex-start"}),radioButtonGroup:r.css({display:"inline-flex",alignItems:"flex-start",paddingTop:a.spacingXl}),radioButton:r.css({marginLeft:a.spacingM})},et=function(e,t){return"percent"!==t||e<=100},tt=function(e){var r=e.onClose,a=t.useRef(null),i=t.useState("https://"),l=i[0],c=i[1],s=t.useState("percent"),u=s[0],d=s[1],m=t.useState(!0),f=m[0],p=m[1],h=t.useState("100"),g=h[0],v=h[1],b=t.useState(!1),E=b[0],k=b[1];return t.useEffect((function(){var e;null!=(e=a.current)&&e.focus&&a.current.focus()}),[a]),n.createElement(n.Fragment,null,n.createElement(o.ModalContent,{testId:"embed-external-dialog"},n.createElement(o.Form,null,n.createElement(o.FormControl,{id:"external-link-url-field",isRequired:!0,isInvalid:!f},n.createElement(o.FormControl.Label,null,"Content URL"),n.createElement(o.TextInput,{name:"external-link-url",value:l,onChange:function(e){var t=e.target.value;c(t),p(Ge(t))},testId:"external-link-url-field",placeholder:"https://example.com",ref:a}),n.createElement(o.FormControl.HelpText,null,"Include protocol (e.g. https://)"),!f&&n.createElement(o.FormControl.ValidationMessage,null,"URL is invalid")),n.createElement(o.TextLink,{href:"http://embed.ly/providers",target:"_blank",rel:"noopener noreferrer"},"Supported sources"),n.createElement("div",{className:Je.widthFiledGroup},n.createElement(o.FormControl,{id:"embedded-content-width",isRequired:!0,isInvalid:!et(Number(g),u)},n.createElement(o.FormControl.Label,null,"Width"),n.createElement(o.TextInput,{value:g,name:"embedded-content-width",testId:"embedded-content-width",type:"number",width:"small",onChange:function(e){return v(e.target.value)}}),!et(Number(g),u)&&n.createElement(o.FormControl.ValidationMessage,null,"Should be equal or less then 100")),n.createElement("div",{className:Je.radioButtonGroup},n.createElement(o.Radio,{id:"unit-option-percent",value:"percent",isChecked:"percent"===u,onChange:function(){return d("percent")},className:Je.radioButton},"percent"),n.createElement(o.Radio,{id:"unit-option-pixels",value:"pixels",isChecked:"px"===u,onChange:function(){return d("px")},className:Je.radioButton},"pixels"))),n.createElement(o.Checkbox,{id:"attach-social-checkbox",name:"attach-social-checkbox",value:"Yes",isChecked:E,onChange:function(){return k(!E)},testId:"attach-social-checkbox"},"Attach social sharing links to this element"),n.createElement(o.Text,{as:"p",fontColor:"gray500",marginTop:"spacingXs"},"To enable this embedded content in your application make sure to add the",n.createElement(o.TextLink,{href:"http://embed.ly/docs/products/cards",target:"_blank",rel:"noopener noreferrer"},"Embedly's platform.js"),"on your development environment"))),n.createElement(o.ModalControls,null,n.createElement(o.Button,{testId:"emded-external-cancel",onClick:function(){return r(!1)},variant:"secondary",size:"small"},"Cancel"),n.createElement(o.Button,{testId:"embed-external-confirm",onClick:function(){return r(function(e){var t=e.url;return['<a href="'+t+'" class="embedly-card" ','data-card-width="'+e.width+{percent:"%",px:"px"}[e.selectedUnit]+'" ','data-card-controls="'+(e.attachSocial?"1":"0")+'"',">Embedded content: "+t+"</a>"].join("")}({url:l,width:Number(g),selectedUnit:u,attachSocial:E}))},variant:"positive",size:"small"},"Insert")))},nt=function(e){var t=e.onClose,r=e.assets,a=e.locale,i=r.length;return n.createElement(n.Fragment,null,n.createElement(o.ModalContent,{testId:"confirm-insert-asset"},n.createElement(o.Paragraph,null,1===i?"Link asset with missing file for locale "+a:"Link assets with missing files for locale "+a),n.createElement(o.Paragraph,null,1===i?"Do you want to link to the file in its fallback locale?":"Do you want to link to the files in their fallback locales?"),n.createElement(o.EntityList,null,r.map((function(e){var t=e.thumbnailUrl;return n.createElement(o.EntityList.Item,{key:t,title:e.title,thumbnailUrl:t+"?w=46&h=46&fit=thumb",thumbnailAltText:e.thumbnailAltText,description:e.description})})))),n.createElement(o.ModalControls,null,n.createElement(o.Button,{onClick:function(){return t(!1)},variant:"secondary",size:"small"},"Cancel"),n.createElement(o.Button,{testId:"confirm-insert-asset",onClick:function(){return t(!0)},variant:"positive",size:"small"},"Confirm")))},rt={root:r.css({position:"fixed",left:0,right:0,top:0,bottom:0}),topSplit:r.css({position:"fixed",top:0,height:"48px",left:0,right:0}),bottomSplit:r.css({position:"fixed",bottom:0,left:0,right:0,height:"36px"}),editorSplit:r.css({width:"50%",position:"fixed",top:"48px",left:0,bottom:"36px",overflowX:"hidden",overflowY:"scroll"}),editorSplitFullscreen:r.css({left:0,right:0,width:"100%"}),previewSplit:r.css({width:"50%",position:"fixed",top:"48px",right:0,bottom:"36px",overflowX:"hidden",overflowY:"scroll"}),separator:r.css({position:"fixed",top:"48px",bottom:"36px",width:"1px",background:a.gray400,left:"50%"}),button:r.css({position:"fixed",cursor:"pointer",zIndex:105,top:"49%",height:"30px",backgroundColor:a.gray100,border:"1px solid "+a.gray400,padding:0}),hideButton:r.css({left:"50%"}),showButton:r.css({right:0,borderRightWidth:0}),icon:r.css({verticalAlign:"middle"})},at=function(e){var t,a,i,o=n.useState(null!=(t=e.initialValue)?t:""),c=o[0],s=o[1],u=n.useState(!0),d=u[0],m=u[1],f=n.useState(null),p=f[0],h=f[1];n.useEffect((function(){var t,n;null==(t=e.sdk)||null==(n=t.window)||n.updateHeight("100%")}),[]),n.useEffect((function(){setTimeout((function(){null==p||p.setFullsize(),null==p||p.refresh()}),150)}),[p]);var g=n.useMemo((function(){return kt({sdk:e.sdk,editor:p,locale:e.locale})}),[p]);g.closeZenMode=function(){e.onClose({value:c,cursor:null==p?void 0:p.getCursor()})};var v=null!=(a=e.sdk.locales.direction[e.locale])?a:"ltr";return n.createElement("div",{className:rt.root,"data-test-id":"zen-mode-markdown-editor"},n.createElement("div",{className:rt.topSplit},n.createElement(ue,{mode:"zen",disabled:!1,canUploadAssets:!1,actions:g})),n.createElement("div",{className:r.cx(rt.editorSplit,(i={},i[rt.editorSplitFullscreen]=!1===d,i))},n.createElement(Le,{mode:"zen",visible:!0,disabled:!1,direction:v,onReady:function(t){var n;t.setContent(null!=(n=e.initialValue)?n:""),t.setReadOnly(!1),h(t),t.focus(),t.events.onChange((function(t){s(t),e.saveValueToSDK(t)}))}})),d&&n.createElement("div",{className:rt.previewSplit},n.createElement(Pe,{direction:v,mode:"zen",value:c,previewComponents:e.previewComponents})),d&&n.createElement("div",{className:rt.separator}),d&&n.createElement("button",{className:r.cx(rt.button,rt.hideButton),"aria-label":"Hide preview",onClick:function(){m(!1)}},n.createElement(l.ChevronRightIcon,{variant:"muted",size:"tiny",className:rt.icon})),!d&&n.createElement("button",{className:r.cx(rt.button,rt.showButton),"aria-label":"Show preview",onClick:function(){m(!0)}},n.createElement(l.ChevronLeftIcon,{variant:"muted",size:"tiny",className:rt.icon})),n.createElement("div",{className:rt.bottomSplit},n.createElement(He,null,n.createElement(Me,{onClick:function(){De(e.sdk.dialogs)}}))))};function it(e,t){var n=t.localeCode,r=t.fallbackCode,a=t.defaultLocaleCode,i=d(e,["fields","file",n]),o=r?d(e,["fields","file",r]):null,l=d(e,["fields","file",a]),c=i||o||l;if(k(c)&&c.url){var s=d(e,["fields","title",n])||d(e,["fields","title",r||""])||d(e,["fields","title",a])||function(e){return e?e.trim().replace(/\s{2,}/g," "):e}(function(e){return e.replace(/\.\w+$/g,"")}(c.fileName).replace(/_/g," ")),u=function(e){var t={images:"images.ctfassets.net",assets:"assets.ctfassets.net",downloads:"downloads.ctfassets.net",videos:"videos.ctfassets.net"};return e.replace(/(images|assets|downloads|videos).contentful.com/,(function(e,n){return t[n]}))}(c.url);return{title:s,asset:e,url:u,isLocalized:Boolean(i),isFallback:Boolean(o),asMarkdown:"!["+s+"]("+u+")"}}return null}function ot(e,t){return lt.apply(this,arguments)}function lt(){return(lt=S(Xe.mark((function e(t,n){var r,a,i;return Xe.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.filter((function(e){return!d(e,["fields","file",n.localeCode])})),a=t.map((function(e){return it(e,n)})).filter((function(e){return null!==e})),!(r.length>0)){e.next=5;break}return i=a.filter((function(e){return!e.isLocalized})).map((function(e){var t=e.title,r=e.isFallback,a=e.asset,i=r?n.fallbackCode:n.defaultLocaleCode;return{title:t,thumbnailUrl:a.fields.file[i].url,thumbnailAltText:t,description:r?"Fallback locale ("+i+")":"Default locale ("+i+")",asset:a}})),e.abrupt("return",{fallbacks:i,links:a});case 5:return e.abrupt("return",{links:a});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ct(e){return(e=(e=e||"").replace(/^ *('|"|\()*/,"")).replace(/('|"|\))* *$/,"")}function st(e){return e.split(" ").shift()}function ut(e){var t=e.split(" ");return t.shift(),t.join(" ")}var dt={inline:function(e){return{match:e[0],text:e[1],href:st(e[2]),title:ct(ut(e[2]))}},ref:function(e){return{match:e[0],text:e[1],id:e[2]}},label:function(e){return{match:e[0],id:e[1],href:st(e[2]),title:ct(ut(e[2]))}}},mt={inline:/\[([^\r\n[\]]+)]\(([^\r\n)]+)\)/,ref:/\[([^\r\n[\]]+)] ?\[([^\r\n[\]]+)]/,label:/^ {0,3}\[([^\r\n[\]]+)]:\s+(.+)$/},ft=gt("inline"),pt=gt("ref"),ht=gt("label");function gt(e){return function(t){return function(e,t){for(var n=[],r=new RegExp(mt[t].source,"g"+("label"===t?"m":"")),a=r.exec(e);a;)n.push(a),r.lastIndex=a.index+a[0].length,a=r.exec(e);return n}(t,e).map(dt[e])}}function vt(e){return k(e)&&x(e.title)&&e.title.length>0}function bt(e,t){var n="["+t+"]: "+e.href;return vt(e)&&(n+=' "'+e.title+'"'),n}function Et(e,t){return"["+e.text+"]["+t+"]"}function kt(e){var t,n,r,a,i,o,l,c=e.sdk,s=e.editor,u=e.locale,d=function(){var e=S(Xe.mark((function e(t){var n,r,a;return Xe.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=14;break}return e.next=3,ot(t,{localeCode:u,defaultLocaleCode:c.locales.default,fallbackCode:c.locales.fallbacks[u]});case 3:if(a=(n=e.sent).fallbacks,!((r=n.links)&&r.length>0)){e.next=14;break}if(!a){e.next=13;break}return e.next=10,c.dialogs.openCurrent({title:"Confirm using fallback assets",width:"medium",minHeight:"270px",shouldCloseOnEscapePress:!0,shouldCloseOnOverlayClick:!0,parameters:I({type:ze.confirmInsertAsset},{locale:u,assets:a})});case 10:if(e.sent){e.next=13;break}throw Error("User decided to not use fallbacks");case 13:return e.abrupt("return",r.map((function(e){return e.asMarkdown})).join("\n\n"));case 14:return e.abrupt("return","");case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{headings:{h1:function(){null==s||s.actions.h1()},h2:function(){null==s||s.actions.h2()},h3:function(){null==s||s.actions.h3()}},simple:{italic:function(){null==s||s.actions.italic()},bold:function(){null==s||s.actions.bold()},quote:function(){null==s||s.actions.quote()},ol:function(){null==s||s.actions.ol()},ul:function(){null==s||s.actions.ul()},strike:function(){null==s||s.actions.strike()},code:function(){null==s||s.actions.code()},hr:function(){null==s||s.actions.hr()},indent:function(){null==s||s.actions.indent()},dedent:function(){null==s||s.actions.dedent()}},history:{undo:function(){null==s||s.actions.undo()},redo:function(){null==s||s.actions.redo()}},insertLink:(l=S(Xe.mark((function e(){var t,n;return Xe.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}return e.abrupt("return");case 2:return s.usePrimarySelection(),t=s.getSelectedText(),e.next=6,c.dialogs.openCurrent({title:"Insert link",width:"large",minHeight:"410px",shouldCloseOnEscapePress:!0,shouldCloseOnOverlayClick:!0,parameters:I({type:ze.insertLink},{selectedText:t})});case 6:(n=e.sent)&&s.actions.link(n.url,t||n.text,n.title);case 8:case"end":return e.stop()}}),e)}))),function(){return l.apply(this,arguments)}),insertSpecialCharacter:(o=S(Xe.mark((function e(){var t;return Xe.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,c.dialogs.openCurrent({title:"Insert special character",width:"large",minHeight:"600px",shouldCloseOnEscapePress:!0,shouldCloseOnOverlayClick:!0,parameters:{type:ze.insertSpecialCharacter}});case 4:(t=e.sent)&&s.insert(t);case 6:case"end":return e.stop()}}),e)}))),function(){return o.apply(this,arguments)}),insertTable:(i=S(Xe.mark((function e(){var t;return Xe.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,c.dialogs.openCurrent({title:"Insert table",width:"medium",minHeight:"260px",shouldCloseOnEscapePress:!0,shouldCloseOnOverlayClick:!0,parameters:{type:ze.insertTable}});case 4:(t=e.sent)&&s.actions.table(t);case 6:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)}),organizeLinks:function(){if(s){var e=s.getContent();e&&(e=function(e){var t=function(e){var t={},n={};return C(ht(e),(function(e){var r=t[e.href],a=w({},e);r?vt(a)&&!vt(r)&&(r.title=a.title):t[a.href]=a,n[a.id]=r||a})),{byHref:t,byOldId:n}}(e),n={},r=[],a=[],i=1;return C(pt(e),(function(e){var o=t.byOldId[e.id];if(o){var l=o.href,c=n[l];c||(n[l]=c=i,i+=1,r.push(w({newId:c},o))),a.push(w({newId:c},e))}})),C(ht(e),(function(t){e=e.replace(t.match,"")})),e=e.replace(/[\r\n\s]*$/,""),e+="\n\n",C(a,(function(t){e=e.replace(t.match,Et(t,t.newId))})),C(r,(function(t){e+="\n"+bt(t,t.newId)})),e}(e=function(e){var t=function(e){x(e)&&(e=ht(e));var t=e.map((function(e){return e.id})).map((function(e){return parseInt(e,10)})).filter((function(e){return y(e)&&e>0}));return t.length>0&&p(t)||0}(e);return C(ft(e),(function(n){e=e.replace(n.match,Et(n,t+=1)),e+="\n"+bt(n,t)})),e}(e)),s.setContent(e),c.notifier.success("All your links are now references at the bottom of your document."))}},embedExternalContent:(a=S(Xe.mark((function e(){var t;return Xe.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,c.dialogs.openCurrent({title:"Embed external content",width:"large",minHeight:"435px",shouldCloseOnEscapePress:!0,shouldCloseOnOverlayClick:!0,parameters:{type:ze.embedExternalContent}});case 4:(t=e.sent)&&s.insert(t);case 6:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)}),addNewMedia:(r=S(Xe.mark((function e(){var t;return Xe.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,c.navigator.openNewAsset({slideIn:{waitForClose:!0}});case 5:return t=e.sent.entity,e.next=9,d([t]);case 9:s.insert(e.sent);case 11:return e.prev=11,s.focus(),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[2,,11,14]])}))),function(){return r.apply(this,arguments)}),linkExistingMedia:(n=S(Xe.mark((function e(){var t;return Xe.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,c.dialogs.selectMultipleAssets({locale:u});case 5:return t=e.sent,e.next=8,d(t);case 8:s.insert(e.sent);case 10:return e.prev=10,s.focus(),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[2,,10,13]])}))),function(){return n.apply(this,arguments)}),openZenMode:(t=S(Xe.mark((function t(){var n;return Xe.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,r=c.dialogs,a={initialValue:s.getContent(),locale:e.locale},r.openCurrent({width:"zen",shouldCloseOnEscapePress:!1,minHeight:"100vh",shouldCloseOnOverlayClick:!1,parameters:{type:ze.zenMode,initialValue:a.initialValue,locale:a.locale}});case 4:s.setContent((n=t.sent).value),n.cursor&&s.setCursor(n.cursor),s.focus();case 8:case"end":return t.stop()}var r,a}),t)}))),function(){return t.apply(this,arguments)}),closeZenMode:function(){}}}var wt={container:r.css({display:"flex",flexDirection:"column",fontFamily:a.fontStackPrimary})};function xt(e){var t,r,a=n.useState(null!=(t=e.initialValue)?t:""),i=a[0],o=a[1],l=n.useState("editor"),c=l[0],s=l[1],u=n.useState(null),d=u[0],m=u[1],f=n.useState(!1),p=f[0],h=f[1];n.useEffect((function(){d&&e.onReady&&(e.onReady(d),setTimeout((function(){d.refresh()}),1))}),[d]),n.useEffect((function(){e.sdk.access.can("create","Asset").then((function(e){h(e)}))}),[]),n.useEffect((function(){d&&d.setReadOnly(e.disabled)}),[d,e.disabled]);var g=null===d||e.disabled||"editor"!==c,v=null!=(r=e.sdk.locales.direction[e.sdk.field.locale])?r:"ltr",b=n.useMemo((function(){return kt({sdk:e.sdk,editor:d,locale:e.sdk.field.locale})}),[d]),E=n.useCallback((function(){De(e.sdk.dialogs)}),[]);return n.createElement("div",{className:wt.container,"data-test-id":"markdown-editor"},n.createElement(M,{active:c,onSelect:function(e){s(e)}}),n.createElement(ue,{mode:"default",disabled:g,canUploadAssets:p,actions:b}),n.createElement(Le,{minHeight:e.minHeight,mode:"default",visible:"editor"===c,disabled:g,direction:v,onReady:function(t){var n;t.setContent(null!=(n=e.initialValue)?n:""),t.setReadOnly(e.disabled),m(t),t.events.onChange((function(t){var n=t.replace(/^\s+$/gm,"");e.saveValueToSDK(n),o(t)}))}}),"preview"===c&&n.createElement(Pe,{direction:v,minHeight:e.minHeight,mode:"default",value:i,previewComponents:e.previewComponents}),n.createElement(He,null,n.createElement(Me,{onClick:E})),n.createElement(_e,{sdk:e.sdk,value:i}))}exports.MarkdownEditor=xt,exports.MarkdownEditorConnected=function(e){return n.createElement(i.FieldConnector,{throttle:300,field:e.sdk.field,isInitiallyDisabled:e.isInitiallyDisabled},(function(t){return n.createElement(xt,I({},e,{key:"markdown-editor-"+t.externalReset,initialValue:t.value,disabled:t.disabled,saveValueToSDK:t.setValue}))}))},exports.MarkdownPreview=Pe,exports.openMarkdownDialog=function(e,t){return function(r){var a,o,l,c,s,u,d;if((null==(a=r.parameters)?void 0:a.type)===ze.cheatsheet)return i.ModalDialogLauncher.openDialog(r,(function(){return n.createElement(Ae,null)}));if((null==(o=r.parameters)?void 0:o.type)===ze.insertLink){var m=r.parameters.selectedText;return i.ModalDialogLauncher.openDialog(r,(function(e){return n.createElement(Ke,{selectedText:m,onClose:e.onClose})}))}if((null==(l=r.parameters)?void 0:l.type)===ze.insertSpecialCharacter)return i.ModalDialogLauncher.openDialog(r,(function(e){return n.createElement(Ze,{onClose:e.onClose})}));if((null==(c=r.parameters)?void 0:c.type)===ze.insertTable)return i.ModalDialogLauncher.openDialog(r,(function(e){return n.createElement(Qe,{onClose:e.onClose})}));if((null==(s=r.parameters)?void 0:s.type)===ze.embedExternalContent)return i.ModalDialogLauncher.openDialog(r,(function(e){return n.createElement(tt,{onClose:e.onClose})}));if((null==(u=r.parameters)?void 0:u.type)===ze.confirmInsertAsset){var f=r.parameters.locale,p=r.parameters.assets;return i.ModalDialogLauncher.openDialog(r,(function(e){return n.createElement(nt,{onClose:e.onClose,locale:f,assets:p})}))}if((null==(d=r.parameters)?void 0:d.type)===ze.zenMode){var h=r.parameters.initialValue,g=r.parameters.locale;return i.ModalDialogLauncher.openDialog(r,(function(r){return n.createElement(at,{saveValueToSDK:function(t){var n,r;return t?null==e||null==(r=e.field)?void 0:r.setValue(t):null==e||null==(n=e.field)?void 0:n.removeValue()},onClose:r.onClose,initialValue:h,locale:g,sdk:e,previewComponents:t})}))}return Promise.reject()}},exports.renderMarkdownDialog=function(e){var t=e.parameters.invocation;if(t.type===ze.cheatsheet)return e.window.startAutoResizer(),n.createElement(Ae,null);if(t.type===ze.insertLink){var r=t.selectedText;return e.window.startAutoResizer(),n.createElement(Ke,{selectedText:r,onClose:e.close})}if(t.type===ze.insertSpecialCharacter)return e.window.startAutoResizer(),n.createElement(Ze,{onClose:e.close});if(t.type===ze.insertTable)return e.window.startAutoResizer(),n.createElement(Qe,{onClose:e.close});if(t.type===ze.embedExternalContent)return e.window.startAutoResizer(),n.createElement(tt,{onClose:e.close});if(t.type===ze.confirmInsertAsset){var a=t.locale,i=t.assets;return e.window.startAutoResizer(),n.createElement(nt,{onClose:e.close,locale:a,assets:i})}if(t.type===ze.zenMode){var o=t.locale,l=t.initialValue;return e.window.updateHeight("100%"),n.createElement(at,{onClose:e.close,saveValueToSDK:function(){},initialValue:l,locale:o,sdk:e})}return n.createElement("div",null)};
 //# sourceMappingURL=field-editor-markdown.cjs.production.min.js.map
diff --git a/dist/field-editor-markdown.cjs.production.min.js.map b/dist/field-editor-markdown.cjs.production.min.js.map
index 8904e9b6c01906b944ad545f8f095fb4e7e51235..7bab8fd40445e259572f957c90a21d76e04b1870 100644
--- a/dist/field-editor-markdown.cjs.production.min.js.map
+++ b/dist/field-editor-markdown.cjs.production.min.js.map
@@ -1 +1 @@
-{"version":3,"file":"field-editor-markdown.cjs.production.min.js","sources":["../src/components/MarkdownTabs.tsx","../src/components/icons.tsx","../src/components/HeadingSelector.tsx","../src/components/InsertLinkSelector.tsx","../src/components/MarkdownToolbar.tsx","../src/utils/userAgent.ts","../src/components/MarkdownTextarea/CodeMirrorWrapper.ts","../src/components/MarkdownTextarea/MarkdownCommands.ts","../src/components/MarkdownTextarea/MarkdownTextarea.tsx","../src/components/MarkdownTextarea/createMarkdownEditor.ts","../src/types.ts","../src/components/MarkdownBottomBar.tsx","../src/dialogs/CheatsheetModalDialog.tsx","../src/components/MarkdownPreview.tsx","../src/utils/replaceMailtoAmp.ts","../src/components/MarkdownConstraints.tsx","../../../node_modules/regenerator-runtime/runtime.js","../src/utils/isValidUrl.ts","../src/dialogs/InsertLinkModalDialog.tsx","../src/utils/specialCharacters.ts","../src/dialogs/SpecialCharacterModalDialog.tsx","../src/dialogs/InsertTableModalDialog.tsx","../src/dialogs/EmdebExternalContentDialog.tsx","../src/dialogs/ConfirmInsertAssetModalDialog.tsx","../src/dialogs/ZenModeModalDialog.tsx","../src/utils/insertAssetLinks.ts","../src/utils/linkOrganizer.ts","../src/MarkdownActions.ts","../src/MarkdownEditor.tsx","../src/dialogs/openMarkdownDialog.tsx","../src/dialogs/renderMarkdownDialog.tsx"],"sourcesContent":["import React from 'react';\nimport { css, cx } from 'emotion';\nimport tokens from '@contentful/f36-tokens';\nimport { MarkdownTab } from '../types';\n\nconst styles = {\n  root: css({\n    display: 'flex',\n    zIndex: 10,\n    flexDirection: 'row',\n    justifyContent: 'flex-end',\n    overflow: 'hidden',\n    marginBottom: '-1px',\n    fontSize: tokens.fontSizeM,\n  }),\n  tab: css({\n    cursor: 'pointer',\n    color: tokens.gray700,\n    padding: tokens.spacingXs,\n    minWidth: '70px',\n    border: `1px solid ${tokens.gray400}`,\n    borderTopLeftRadius: tokens.borderRadiusSmall,\n    borderTopRightRadius: tokens.borderRadiusSmall,\n    marginLeft: tokens.spacingXs,\n    textAlign: 'center',\n    backgroundColor: tokens.gray100,\n    borderBottomColor: tokens.gray100,\n    outline: 'none',\n    '&:focus': {\n      boxShadow: tokens.boxShadowHeavy,\n    },\n    transition: `all ${tokens.transitionEasingDefault} ${tokens.transitionDurationShort}`,\n  }),\n  inactiveTab: css({\n    background: tokens.gray200,\n    borderBottomColor: tokens.gray400,\n    '&:hover': {\n      background: tokens.gray300,\n    },\n  }),\n};\n\ninterface MarkdownTabsProps {\n  active: MarkdownTab;\n  onSelect: (selected: MarkdownTab) => void;\n}\n\nfunction MarkdownTabItem(props: {\n  isActive: boolean;\n  name: MarkdownTab;\n  testId: string;\n  onSelect: (name: MarkdownTab) => void;\n  children: React.ReactNode;\n}) {\n  return (\n    <div\n      className={cx(styles.tab, {\n        [styles.inactiveTab]: props.isActive === false,\n      })}\n      onClick={() => {\n        props.onSelect(props.name);\n      }}\n      onKeyDown={(e) => {\n        if (e.keyCode === 13) {\n          props.onSelect(props.name);\n        }\n      }}\n      tabIndex={0}\n      role=\"tab\"\n      aria-controls={props.name}\n      aria-selected={props.isActive === true}\n      data-test-id={props.testId}>\n      {props.children}\n    </div>\n  );\n}\n\nexport function MarkdownTabs(props: MarkdownTabsProps) {\n  return (\n    <div className={styles.root}>\n      <MarkdownTabItem\n        name=\"editor\"\n        onSelect={props.onSelect}\n        isActive={props.active === 'editor'}\n        testId=\"markdown-tab-md\">\n        Editor\n      </MarkdownTabItem>\n      <MarkdownTabItem\n        name=\"preview\"\n        onSelect={props.onSelect}\n        isActive={props.active === 'preview'}\n        testId=\"markdown-tab-preview\">\n        Preview\n      </MarkdownTabItem>\n    </div>\n  );\n}\n","import React from 'react';\nimport { css } from 'emotion';\n\ntype IconProps = {\n  width?: number;\n  height?: number;\n  className?: string;\n  label: string;\n};\n\nconst srOnly = css({\n  position: 'absolute',\n  width: '1px',\n  height: '1px',\n  padding: '0',\n  margin: '-1px',\n  overflow: 'hidden',\n  clip: 'rect(0, 0, 0, 0)',\n  border: '0',\n});\n\nexport const Zen = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1411 541l-355 355 355 355 144-144q29-31 70-14 39 17 39 59v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l144-144-355-355-355 355 144 144q31 30 14 69-17 40-59 40H192q-26 0-45-19t-19-45v-448q0-42 40-59 39-17 69 14l144 144 355-355-355-355-144 144q-19 19-45 19-12 0-24-5-40-17-40-59V192q0-26 19-45t45-19h448q42 0 59 40 17 39-14 69L541 381l355 355 355-355-144-144q-31-30-14-69 17-40 59-40h448q26 0 45 19t19 45v448q0 42-39 59-13 5-25 5-26 0-45-19z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Strikethrough = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1760 896q14 0 23 9t9 23v64q0 14-9 23t-23 9H32q-14 0-23-9t-9-23v-64q0-14 9-23t23-9h1728zM483 832q-28-35-51-80-48-98-48-188 0-181 134-309 133-127 393-127 50 0 167 19 66 12 177 48 10 38 21 118 14 123 14 183 0 18-5 45l-12 3-84-6-14-2q-50-149-103-205-88-91-210-91-114 0-182 59-67 58-67 146 0 73 66 140t279 129q69 20 173 66 58 28 95 52H483zm507 256h411q7 39 7 92 0 111-41 212-23 56-71 104-37 35-109 81-80 48-153 66-80 21-203 21-114 0-195-23l-140-40q-57-16-72-28-8-8-8-22v-13q0-108-2-156-1-30 0-68l2-37v-44l102-2q15 34 30 71t22.5 56 12.5 27q35 57 80 94 43 36 105 57 59 22 132 22 64 0 139-27 77-26 122-86 47-61 47-129 0-84-81-157-34-29-137-71z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Indent = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M352 832q0 14-9 23L55 1143q-9 9-23 9-13 0-22.5-9.5T0 1120V544q0-13 9.5-22.5T32 512q14 0 23 9l288 288q9 9 9 23zm1440 480v192q0 13-9.5 22.5t-22.5 9.5H32q-13 0-22.5-9.5T0 1504v-192q0-13 9.5-22.5T32 1280h1728q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5t-22.5 9.5H672q-13 0-22.5-9.5T640 1120V928q0-13 9.5-22.5T672 896h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5T1760 768H672q-13 0-22.5-9.5T640 736V544q0-13 9.5-22.5T672 512h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5T1760 384H32q-13 0-22.5-9.5T0 352V160q0-13 9.5-22.5T32 128h1728q13 0 22.5 9.5t9.5 22.5z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Dedent = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M384 544v576q0 13-9.5 22.5T352 1152q-14 0-23-9L41 855q-9-9-9-23t9-23l288-288q9-9 23-9 13 0 22.5 9.5T384 544zm1408 768v192q0 13-9.5 22.5t-22.5 9.5H32q-13 0-22.5-9.5T0 1504v-192q0-13 9.5-22.5T32 1280h1728q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5t-22.5 9.5H672q-13 0-22.5-9.5T640 1120V928q0-13 9.5-22.5T672 896h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5T1760 768H672q-13 0-22.5-9.5T640 736V544q0-13 9.5-22.5T672 512h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5T1760 384H32q-13 0-22.5-9.5T0 352V160q0-13 9.5-22.5T32 128h1728q13 0 22.5 9.5t9.5 22.5z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Cubes = ({ label, ...rest }: IconProps) => (\n  <svg width={18} height={14} viewBox=\"0 0 2304 1792\" {...rest}>\n    <path d=\"M640 1632l384-192v-314l-384 164v342zm-64-454l404-173-404-173-404 173zm1088 454l384-192v-314l-384 164v342zm-64-454l404-173-404-173-404 173zm-448-293l384-165V454l-384 164v267zm-64-379l441-189-441-189-441 189zm1088 518v416q0 36-19 67t-52 47l-448 224q-25 14-57 14t-57-14l-448-224q-4-2-7-4-2 2-7 4l-448 224q-25 14-57 14t-57-14L71 1554q-33-16-52-47t-19-67v-416q0-38 21.5-70T78 906l434-186V320q0-38 21.5-70t56.5-48l448-192q23-10 50-10t50 10l448 192q35 16 56.5 48t21.5 70v400l434 186q36 16 57 48t21 70z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Table = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M576 1376v-192q0-14-9-23t-23-9H224q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm0-384V800q0-14-9-23t-23-9H224q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm512 384v-192q0-14-9-23t-23-9H736q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zM576 608V416q0-14-9-23t-23-9H224q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm512 384V800q0-14-9-23t-23-9H736q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm512 384v-192q0-14-9-23t-23-9h-320q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm-512-768V416q0-14-9-23t-23-9H736q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm512 384V800q0-14-9-23t-23-9h-320q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm0-384V416q0-14-9-23t-23-9h-320q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm128-320v1088q0 66-47 113t-113 47H224q-66 0-113-47t-47-113V288q0-66 47-113t113-47h1344q66 0 113 47t47 113z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const SpecialChar = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1360 1307l35 159q3 12-3 22.5t-17 14.5l-5 1q-4 2-10.5 3.5t-16 4.5-21.5 5.5-25.5 5-30 5-33.5 4.5-36.5 3-38.5 1q-234 0-409-130.5T511 1054h-95q-13 0-22.5-9.5T384 1022V909q0-13 9.5-22.5T416 877h66q-2-57 1-105h-67q-14 0-23-9t-9-23V626q0-14 9-23t23-9h98q67-210 243.5-338T1158 128q102 0 194 23 11 3 20 15 6 11 3 24l-43 159q-3 13-14 19.5t-24 2.5l-4-1q-4-1-11.5-2.5L1261 364l-22.5-3.5-26-3-29-2.5-29.5-1q-126 0-226 64T778 594h468q16 0 25 12 10 12 7 26l-24 114q-5 26-32 26H734q-3 37 0 105h459q15 0 25 12 9 12 6 27l-24 112q-2 11-11 18.5t-20 7.5H782q48 117 149.5 185.5T1160 1308q18 0 36-1.5t33.5-3.5 29.5-4.5 24.5-5 18.5-4.5l12-3 5-2q13-5 26 2 12 7 15 21z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const OrgLinks = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1792 1248v320q0 40-28 68t-68 28h-320q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h96V960H960v192h96q40 0 68 28t28 68v320q0 40-28 68t-68 28H736q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h96V960H320v192h96q40 0 68 28t28 68v320q0 40-28 68t-68 28H96q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h96V960q0-52 38-90t90-38h512V640h-96q-40 0-68-28t-28-68V224q0-40 28-68t68-28h320q40 0 68 28t28 68v320q0 40-28 68t-68 28h-96v192h512q52 0 90 38t38 90v192h96q40 0 68 28t28 68z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Undo = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1664 896q0 156-61 298t-164 245-245 164-298 61q-172 0-327-72.5T305 1387q-7-10-6.5-22.5t8.5-20.5l137-138q10-9 25-9 16 2 23 12 73 95 179 147t225 52q104 0 198.5-40.5T1258 1258t109.5-163.5T1408 896t-40.5-198.5T1258 534t-163.5-109.5T896 384q-98 0-188 35.5T548 521l137 138q31 30 14 69-17 40-59 40H192q-26 0-45-19t-19-45V256q0-42 40-59 39-17 69 14l130 129q107-101 244.5-156.5T896 128q156 0 298 61t245 164 164 245 61 298z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Redo = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1664 256v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l138-138q-148-137-349-137-104 0-198.5 40.5T534 534 424.5 697.5 384 896t40.5 198.5T534 1258t163.5 109.5T896 1408q119 0 225-52t179-147q7-10 23-12 15 0 25 9l137 138q9 8 9.5 20.5t-7.5 22.5q-109 132-264 204.5T896 1664q-156 0-298-61t-245-164-164-245-61-298 61-298 164-245 245-164 298-61q147 0 284.5 55.5T1425 340l130-129q29-31 70-14 39 17 39 59z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n","import React from 'react';\nimport { Menu } from '@contentful/f36-components';\nimport { HeadingType } from '../types';\n\nexport const HeadingSelector = (props: {\n  children: React.ReactElement;\n  onSelect: (heading: HeadingType) => void;\n  tooltip?: string;\n}) => {\n  const handleMenuClick = (heading: HeadingType) => {\n    props.onSelect(heading);\n  };\n\n  return (\n    <Menu>\n      <Menu.Trigger>{props.children}</Menu.Trigger>\n      <Menu.List>\n        <Menu.Item testId=\"markdown-action-button-heading-h1\" onClick={() => handleMenuClick('h1')}>\n          Heading 1\n        </Menu.Item>\n        <Menu.Item testId=\"markdown-action-button-heading-h2\" onClick={() => handleMenuClick('h2')}>\n          Heading 2\n        </Menu.Item>\n        <Menu.Item testId=\"markdown-action-button-heading-h3\" onClick={() => handleMenuClick('h3')}>\n          Heading 3\n        </Menu.Item>\n      </Menu.List>\n    </Menu>\n  );\n};\n","import React from 'react';\nimport { Menu } from '@contentful/f36-components';\n\nimport { Button } from '@contentful/f36-components';\n\nimport { AssetIcon, ChevronDownIcon } from '@contentful/f36-icons';\n\ninterface InsertLinkSelectorProps {\n  onSelectExisting: Function;\n  onAddNew: Function;\n  canAddNew: boolean;\n  disabled: boolean;\n}\n\nexport const InsertLinkSelector = (props: InsertLinkSelectorProps) => {\n  if (props.canAddNew) {\n    return <MultipleMediaContextMenu {...props} />;\n  } else {\n    return (\n      <Button\n        isDisabled={props.disabled}\n        startIcon={<AssetIcon />}\n        testId=\"markdownEditor.linkExistingAssets\"\n        size=\"small\"\n        variant=\"secondary\"\n        onClick={() => {\n          props.onSelectExisting();\n        }}>\n        Insert media\n      </Button>\n    );\n  }\n};\n\nconst MultipleMediaContextMenu = (props: InsertLinkSelectorProps) => {\n  return (\n    <Menu placement=\"bottom-end\">\n      <Menu.Trigger>\n        <Button\n          endIcon={<ChevronDownIcon />}\n          isDisabled={props.disabled}\n          startIcon={<AssetIcon />}\n          testId=\"markdownEditor.insertMediaDropdownTrigger\"\n          size=\"small\"\n          variant=\"secondary\">\n          Insert media\n        </Button>\n      </Menu.Trigger>\n      <Menu.List>\n        <Menu.Item testId=\"markdownEditor.uploadAssetsAndLink\" onClick={() => props.onAddNew()}>\n          Add new media and link\n        </Menu.Item>\n        <Menu.Item\n          testId=\"markdownEditor.linkExistingAssets\"\n          onClick={() => props.onSelectExisting()}>\n          Link existing media\n        </Menu.Item>\n      </Menu.List>\n    </Menu>\n  );\n};\n","/* eslint-disable react/prop-types */\nimport React from 'react';\nimport { css, cx } from 'emotion';\nimport { IconButton, Flex, Tooltip } from '@contentful/f36-components';\nimport type { ButtonProps } from '@contentful/f36-components';\nimport tokens from '@contentful/f36-tokens';\nimport {\n  HeadingIcon,\n  FormatBoldIcon,\n  FormatItalicIcon,\n  QuoteIcon,\n  ListBulletedIcon,\n  ListNumberedIcon,\n  LinkIcon,\n  CodeIcon,\n  HorizontalRuleIcon,\n  MoreHorizontalIcon,\n} from '@contentful/f36-icons';\nimport * as Icons from './icons';\nimport { HeadingSelector } from './HeadingSelector';\nimport { InsertLinkSelector } from './InsertLinkSelector';\nimport { MarkdownActions } from '../types';\n\nconst styles = {\n  root: css({\n    position: 'relative',\n    zIndex: Number(tokens.zIndexWorkbenchHeader),\n    border: `1px solid ${tokens.gray400}`,\n    backgroundColor: tokens.gray100,\n    padding: tokens.spacingXs,\n    borderTopLeftRadius: tokens.borderRadiusSmall,\n  }),\n  button: css({\n    height: '30px',\n    width: '36px',\n    marginLeft: tokens.spacing2Xs,\n    marginRight: tokens.spacing2Xs,\n  }),\n  icon: css({\n    fill: tokens.gray700,\n    verticalAlign: 'middle',\n  }),\n  zenButton: css({\n    marginLeft: tokens.spacingXs,\n  }),\n  zenButtonPressed: css({\n    backgroundColor: tokens.gray400,\n  }),\n  tooltip: css({\n    zIndex: Number(tokens.zIndexTooltip),\n  }),\n};\n\nconst ToolbarButton = React.forwardRef<\n  HTMLButtonElement,\n  {\n    variant?: 'transparent' | 'secondary';\n    onClick?: Function;\n    tooltipPlace?: 'top' | 'bottom';\n    tooltip: string;\n    children: React.ReactElement;\n  } & Omit<ButtonProps, 'onClick'>\n>((props, ref) => {\n  const {\n    tooltip,\n    onClick,\n    children,\n    className,\n    variant = 'transparent',\n    tooltipPlace = 'top',\n    isDisabled = false,\n    ...otherProps\n  } = props;\n\n  return (\n    <Tooltip className={styles.tooltip} placement={tooltipPlace} content={tooltip}>\n      <IconButton\n        {...otherProps}\n        ref={ref}\n        className={cx(styles.button, className)}\n        isDisabled={isDisabled}\n        onClick={onClick as ButtonProps['onClick']}\n        variant={variant}\n        size=\"small\"\n        icon={children}\n        aria-label={tooltip}\n      />\n    </Tooltip>\n  );\n});\nToolbarButton.displayName = 'ToolbarButton';\n\ninterface MarkdownToolbarProps {\n  canUploadAssets: boolean;\n  disabled: boolean;\n  actions: MarkdownActions;\n  mode: 'default' | 'zen';\n}\n\nfunction MainButtons(props: MarkdownToolbarProps) {\n  const tooltipPlace = props.mode === 'zen' ? 'bottom' : 'top';\n\n  return (\n    <>\n      <HeadingSelector\n        onSelect={(heading) => {\n          if (heading && props.actions.headings[heading]) {\n            props.actions.headings[heading]();\n          }\n        }}>\n        <ToolbarButton\n          isDisabled={props.disabled}\n          testId=\"markdown-action-button-heading\"\n          tooltip=\"Headings\"\n          tooltipPlace={tooltipPlace}>\n          <HeadingIcon aria-label=\"Headings\" className={styles.icon} />\n        </ToolbarButton>\n      </HeadingSelector>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-bold\"\n        tooltip=\"Bold\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.bold}>\n        <FormatBoldIcon aria-label=\"Bold\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-italic\"\n        tooltip=\"Italic\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.italic}>\n        <FormatItalicIcon aria-label=\"Italic\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-quote\"\n        tooltip=\"Quote\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.quote}>\n        <QuoteIcon aria-label=\"Quote\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-ul\"\n        tooltip=\"Unordered list\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.ul}>\n        <ListBulletedIcon aria-label=\"Unordered list\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-ol\"\n        tooltip=\"Ordered list\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.ol}>\n        <ListNumberedIcon aria-label=\"Ordered list\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-link\"\n        tooltip=\"Link\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.insertLink}>\n        <LinkIcon aria-label=\"Link\" className={styles.icon} />\n      </ToolbarButton>\n    </>\n  );\n}\n\nfunction AdditionalButtons(props: MarkdownToolbarProps) {\n  const tooltipPlace = props.mode === 'zen' ? 'bottom' : 'top';\n  return (\n    <>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-strike\"\n        tooltip=\"Strike out\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.strike}>\n        <Icons.Strikethrough label=\"Strike out\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-code\"\n        tooltip=\"Code block\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.code}>\n        <CodeIcon aria-label=\"Code block\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-hr\"\n        tooltip=\"Horizontal rule\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.hr}>\n        <HorizontalRuleIcon aria-label=\"Horizontal rule\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-indent\"\n        tooltip=\"Increase indentation\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.indent}>\n        <Icons.Indent label=\"Increase indentation\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-dedent\"\n        tooltip=\"Decrease indentation\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.dedent}>\n        <Icons.Dedent label=\"Decrease indentation\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-embed\"\n        tooltip=\"Embed external content\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.embedExternalContent}>\n        <Icons.Cubes label=\"Embed external content\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-table\"\n        tooltip=\"Insert table\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.insertTable}>\n        <Icons.Table label=\"Insert table\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-special\"\n        tooltip=\"Insert special character\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.insertSpecialCharacter}>\n        <Icons.SpecialChar label=\"Insert special character\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-organizeLinks\"\n        tooltip=\"Organize links\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.organizeLinks}>\n        <Icons.OrgLinks label=\"Organize links\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-undo\"\n        tooltip=\"Undo\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.history.undo}>\n        <Icons.Undo label=\"Undo\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-redo\"\n        tooltip=\"Redo\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.history.redo}>\n        <Icons.Redo label=\"Redo\" className={styles.icon} />\n      </ToolbarButton>\n    </>\n  );\n}\n\nexport function DefaultMarkdownToolbar(props: MarkdownToolbarProps) {\n  const [showAdditional, setShowAdditional] = React.useState(false);\n\n  return (\n    <div className={styles.root}>\n      <Flex justifyContent=\"space-between\">\n        <Flex>\n          <MainButtons {...props} />\n          <ToolbarButton\n            isDisabled={props.disabled}\n            testId=\"markdown-action-button-toggle-additional\"\n            tooltip={showAdditional ? 'Hide additional actions' : 'More actions'}\n            onClick={() => {\n              setShowAdditional(!showAdditional);\n            }}>\n            <MoreHorizontalIcon className={styles.icon} />\n          </ToolbarButton>\n        </Flex>\n        <Flex>\n          <InsertLinkSelector\n            disabled={props.disabled}\n            onSelectExisting={props.actions.linkExistingMedia}\n            onAddNew={props.actions.addNewMedia}\n            canAddNew={props.canUploadAssets}\n          />\n          <ToolbarButton\n            isDisabled={props.disabled}\n            testId=\"markdown-action-button-zen\"\n            variant=\"secondary\"\n            onClick={props.actions.openZenMode}\n            className={styles.zenButton}\n            tooltip=\"Expand\">\n            <Icons.Zen label=\"Expand\" className={styles.icon} />\n          </ToolbarButton>\n        </Flex>\n      </Flex>\n      {showAdditional && (\n        <Flex justifyContent=\"space-between\" marginTop=\"spacingXs\">\n          <Flex>\n            <AdditionalButtons {...props} />\n          </Flex>\n        </Flex>\n      )}\n    </div>\n  );\n}\n\nexport function ZenMarkdownToolbar(props: MarkdownToolbarProps) {\n  return (\n    <div className={styles.root}>\n      <Flex justifyContent=\"space-between\">\n        <Flex>\n          <MainButtons {...props} />\n          <AdditionalButtons {...props} />\n        </Flex>\n        <Flex>\n          <InsertLinkSelector\n            disabled={props.disabled}\n            onSelectExisting={props.actions.linkExistingMedia}\n            onAddNew={props.actions.addNewMedia}\n            canAddNew={props.canUploadAssets}\n          />\n          <IconButton\n            testId=\"markdown-action-button-zen-close\"\n            variant=\"secondary\"\n            size=\"small\"\n            className={cx(styles.zenButton, styles.zenButtonPressed)}\n            onClick={() => {\n              props.actions.closeZenMode();\n            }}\n            icon={<Icons.Zen label=\"Collapse\" className={styles.icon} />}\n            aria-label=\"Collapse\"\n          />\n        </Flex>\n      </Flex>\n    </div>\n  );\n}\n\nexport const MarkdownToolbar = React.memo((props: MarkdownToolbarProps) => {\n  if (props.mode === 'zen') {\n    return <ZenMarkdownToolbar {...props} />;\n  }\n  return <DefaultMarkdownToolbar {...props} />;\n});\n\nMarkdownToolbar.displayName = 'MarkdownToolbar';\n","import get from 'lodash/get';\n\nconst userAgent = get(window, 'navigator.userAgent', '');\nconst platform = get(window, 'navigator.platform', '');\n\nlet ctrlKey = 'Ctrl';\n\nconst tests = {\n  // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/ban-ts-comment\n  // @ts-ignore ignore missing MSStream\n  ios: /(iphone os|ipad|iphone|ipod)/i.test(userAgent) && !window.MSStream,\n};\n\nif (tests.ios || /mac(68k|ppc|intel)/i.test(platform)) {\n  ctrlKey = 'Cmd';\n}\n\nexport function getCtrlKey() {\n  return ctrlKey;\n}\n","/* eslint-disable @typescript-eslint/no-use-before-define, @typescript-eslint/no-explicit-any */\n\nimport CodeMirror from 'codemirror';\nimport 'codemirror/addon/edit/matchbrackets';\nimport throttle from 'lodash/throttle';\nimport transform from 'lodash/transform';\n\nimport { EditorDirection } from '../../types';\nimport * as userAgent from '../../utils/userAgent';\n\nfunction stripUnit(value: number | string): number {\n  if (typeof value !== 'string') return value;\n\n  const cssRegex = /^([+-]?(?:\\d+|\\d*\\.\\d+))([a-z]*|%)$/;\n  const matchedValue = value.match(cssRegex);\n\n  if (!matchedValue) {\n    throw new Error(\"Couldn't match unit in given string\");\n  }\n\n  return parseFloat(value);\n}\n\nexport function create(\n  host: HTMLElement,\n  options: {\n    direction: EditorDirection;\n    readOnly: boolean;\n    fixedHeight?: number | boolean;\n    height?: number | string;\n  }\n) {\n  const { direction, fixedHeight, height, readOnly } = options || {};\n\n  // Set to true if `setValue()` has been called. This is to prevent\n  // undoing the initial content.\n  let initializedWithValue = false;\n\n  const LF = '\\n';\n\n  const EDITOR_SIZE = {\n    min: height ? stripUnit(height) : 300,\n    max: 500,\n    shift: 50,\n  };\n\n  const cm = CodeMirror(host, {\n    direction,\n    readOnly,\n    mode: 'markdown',\n    lineNumbers: false,\n    undoDepth: 200,\n    matchBrackets: true,\n    lineWrapping: true,\n    // When `lineSeparator === null` the document will be split\n    // on CRLFs as well as lone CRs and LFs. A single LF will\n    // be used as line separator in all output\n    lineSeparator: null,\n    theme: 'elegant',\n    tabSize: 2,\n    indentWithTabs: false,\n    indentUnit: 2,\n    autoRefresh: true,\n    spellcheck: true,\n    inputStyle: 'contenteditable',\n  });\n\n  cm.setSize('100%', EDITOR_SIZE.min);\n\n  if (!fixedHeight) {\n    cm.on('change', throttle(assureHeight, 150));\n  }\n\n  cm.setOption('extraKeys', {\n    Tab: function () {\n      replaceSelectedText(getIndentation());\n    },\n    Enter: 'newlineAndIndentContinueMarkdownList',\n    Esc: () => {\n      cm.getInputField().blur();\n    },\n  });\n\n  /**\n   * @description\n   * Custom API for a CodeMirror instance.\n   *\n   * An instance wraps a CodeMirror instance and provides a custom interface\n   * on top of CodeMirror.\n   */\n  return {\n    destroy,\n    disable,\n    enable,\n    attachEvent,\n    addKeyShortcuts,\n    setValue,\n    cmd,\n    moveToLineBeginning,\n    moveIfNotEmpty,\n    restoreCursor,\n    moveToLineEnd,\n    usePrimarySelection,\n    focus,\n    select,\n    selectBackwards,\n    selectAll: () => cm.execCommand('selectAll'),\n    extendSelectionBy,\n    insertAtCursor,\n    insertAtLineBeginning,\n    wrapSelection,\n    removeFromLineBeginning,\n    removeSelectedText,\n    replaceSelectedText,\n    getCursor,\n    setCursor,\n    getSelection,\n    getLine,\n    isLineEmpty,\n    getSelectedText,\n    getSelectionLength,\n    getCurrentLine,\n    getCurrentLineNumber,\n    getCurrentCharacter,\n    getCurrentLineLength,\n    lineStartsWith,\n    getIndentation,\n    getNl,\n    getValue,\n    getLinesCount,\n    getHistorySize,\n    setReadOnly: (value: boolean) => cm.setOption('readOnly', value),\n    getHistory: () => cm.getHistory(),\n    setHistory: (history: any) => cm.setHistory(history),\n    setFullsize: () => {\n      cm.setSize('100%', '100%');\n      cm.refresh();\n    },\n    refresh: () => cm.refresh(),\n  };\n\n  function destroy() {\n    // @ts-expect-error\n    cm.toTextArea();\n  }\n\n  function disable() {\n    cm.setOption('readOnly', 'nocursor');\n  }\n\n  function enable() {\n    cm.setOption('readOnly', false);\n  }\n\n  function assureHeight() {\n    const current = cm.heightAtLine(cm.lastLine(), 'local') + EDITOR_SIZE.shift;\n    let next = current;\n    if (current < EDITOR_SIZE.min) {\n      next = EDITOR_SIZE.min;\n    }\n    if (current > EDITOR_SIZE.max) {\n      next = EDITOR_SIZE.max;\n    }\n    cm.setSize('100%', next);\n  }\n\n  function attachEvent(name: string, fn: Function, throttleInterval: number) {\n    if (throttleInterval) {\n      fn = throttle(fn as any, throttleInterval);\n    }\n    cm.on(name, fn as any);\n  }\n\n  function addKeyShortcuts(map: any) {\n    const ctrlKey = userAgent.getCtrlKey();\n    cm.addKeyMap(\n      transform(\n        map,\n        (acc, value, key) => {\n          // eslint-disable-next-line -- TODO: describe this disable\n          // @ts-ignore\n          acc[ctrlKey + '-' + key] = value;\n        },\n        {}\n      )\n    );\n  }\n\n  /**\n   * low-level editor manipulation functions\n   */\n\n  /**\n   * @description\n   * Sets the content of the editor while preserving the cursor\n   * position.\n   *\n   * If called for the first time it will not record the change in\n   * the history.\n   */\n  function setValue(value?: string) {\n    value = value || '';\n    if (getValue() === value) {\n      return;\n    }\n\n    // set value, but save cursor position first\n    // position will be restored, but w/o focus (third arg)\n    const line = getCurrentLineNumber();\n    const ch = getCurrentCharacter();\n    cm.setValue(value);\n    restoreCursor(ch, line, true);\n\n    // We do not want to record the initial population in the\n    // history. Otherwise it would always be possible to revert to\n    // the empty string.\n    if (!initializedWithValue) {\n      cm.clearHistory();\n      initializedWithValue = true;\n    }\n  }\n\n  function cmd(name: string) {\n    cm.execCommand(name);\n    cm.focus();\n  }\n\n  function moveToLineBeginning(lineNumber?: number) {\n    cm.setCursor({ line: defaultToCurrentLineNumber(lineNumber), ch: 0 });\n    cm.focus();\n  }\n\n  /**\n   * @description\n   * Insert a new line below the cursor and move to the beginning of\n   * that line.\n   *\n   * Only do this if the editor has content and we are not already on\n   * the last line.\n   *\n   * TODO rename this\n   */\n  function moveIfNotEmpty() {\n    if (getCurrentLineLength() < 1) {\n      return;\n    }\n\n    const next = getCurrentLineNumber() + 1;\n    if (cm.lastLine() < next) {\n      moveToLineEnd();\n      insertAtCursor(getNl());\n    }\n\n    moveToLineBeginning(next);\n  }\n\n  function restoreCursor(character: number, lineNumber?: number, noFocus?: boolean) {\n    cm.setCursor(defaultToCurrentLineNumber(lineNumber), character, {\n      scroll: !noFocus,\n    });\n    if (!noFocus) {\n      cm.focus();\n    }\n  }\n\n  function moveToLineEnd(lineNumber?: number) {\n    cm.setCursor({\n      line: defaultToCurrentLineNumber(lineNumber),\n      ch: getCurrentLineLength(),\n    });\n    cm.focus();\n  }\n\n  function defaultToCurrentLineNumber(lineNumber?: number) {\n    if (lineNumber === 0 || (lineNumber !== undefined && lineNumber > 0)) {\n      return lineNumber;\n    }\n    return getCurrentLineNumber();\n  }\n\n  function usePrimarySelection() {\n    cmd('singleSelection');\n  }\n\n  function focus() {\n    cm.focus();\n  }\n\n  function select(from: CodeMirror.Position, to: CodeMirror.Position) {\n    cm.setSelection(from, to);\n    cm.focus();\n  }\n\n  function selectBackwards(skip: number, len: number) {\n    select(getPos(-skip - len), getPos(-skip));\n\n    function getPos(modifier: number) {\n      return {\n        line: getCurrentLineNumber(),\n        ch: getCurrentCharacter() + modifier,\n      };\n    }\n  }\n\n  function extendSelectionBy(modifier: number) {\n    select(getPos('anchor', 0), getPos('head', modifier));\n\n    function getPos(prop: 'anchor' | 'head', modifier: number): CodeMirror.Position {\n      const selection = getSelection();\n      if (!selection) {\n        return { line: 0, ch: 0 };\n      }\n      return { line: selection[prop].line, ch: selection[prop].ch + modifier };\n    }\n  }\n\n  function insertAtCursor(text: string) {\n    cm.replaceRange(text, cm.getCursor());\n    cm.focus();\n  }\n\n  function insertAtLineBeginning(text: string) {\n    const initialCh = getCurrentCharacter();\n    moveToLineBeginning();\n    insertAtCursor(text);\n    restoreCursor(initialCh + text.length);\n    cm.focus();\n  }\n\n  function wrapSelection(wrapper: string) {\n    const replacement = wrapper + getSelectedText() + wrapper;\n    const selection = getSelection();\n    if (selection) {\n      cm.replaceRange(replacement, selection.anchor, selection?.head);\n      cm.focus();\n    }\n  }\n\n  function removeFromLineBeginning(charCount: number) {\n    const lineNumber = getCurrentLineNumber();\n    cm.replaceRange('', { line: lineNumber, ch: 0 }, { line: lineNumber, ch: charCount });\n    cm.focus();\n  }\n\n  function removeSelectedText() {\n    cm.replaceSelection('');\n    cm.focus();\n  }\n\n  /**\n   * @description\n   * Replace the selected text with the given string.\n   *\n   * If nothing is selected it will insert the text at the current\n   * cursor position\n   *\n   * The optional `select` parameter controls what will be selected\n   * afters wards. By default the cursor will be at the end of the\n   * inserted text. You can pass 'around' to select the inserted\n   * text.\n   */\n  function replaceSelectedText(replacement: string, select?: string) {\n    cm.replaceSelection(replacement, select);\n    cm.focus();\n  }\n\n  /**\n   *  low-level editor get/check functions\n   */\n\n  function getCursor() {\n    return cm.getCursor();\n  }\n\n  function setCursor(cursor: number | CodeMirror.Position) {\n    cm.setCursor(cursor);\n  }\n\n  function getSelection() {\n    const selections = cm.listSelections();\n    if (!cm.somethingSelected() || !selections || selections.length < 1) {\n      return null;\n    }\n    return selections[0];\n  }\n\n  function getLine(lineNumber: number) {\n    return cm.getLine(lineNumber) || '';\n  }\n\n  function isLineEmpty(lineNumber?: number) {\n    const n = defaultToCurrentLineNumber(lineNumber);\n    return n > -1 && getLine(n).length < 1 && n < cm.lineCount();\n  }\n\n  function getLinesCount() {\n    return cm.lineCount();\n  }\n\n  function getSelectedText() {\n    return getSelection() ? cm.getSelection() : '';\n  }\n\n  function getSelectionLength() {\n    return getSelectedText().length;\n  }\n\n  function getCurrentLine() {\n    return getLine(getCurrentLineNumber());\n  }\n\n  function getCurrentLineNumber() {\n    return cm.getCursor().line;\n  }\n\n  function getCurrentCharacter() {\n    return cm.getCursor().ch;\n  }\n\n  function getCurrentLineLength() {\n    return getCurrentLine().length;\n  }\n\n  function lineStartsWith(text: string) {\n    return getCurrentLine().startsWith(text);\n  }\n\n  function getIndentation() {\n    return repeat(' ', cm.getOption('indentUnit') ?? 0);\n  }\n\n  function getNl(n = 1) {\n    if (n < 1) {\n      return '';\n    }\n    return repeat(LF, n);\n  }\n\n  function getValue() {\n    return cm.getValue() || '';\n  }\n\n  function getHistorySize(which?: 'undo' | 'redo') {\n    const history = cm.historySize();\n    return which ? history[which] : history;\n  }\n\n  function repeat(what: string, n: number) {\n    return new Array(n + 1).join(what);\n  }\n}\n","/* eslint-disable @typescript-eslint/no-use-before-define */\n\nimport range from 'lodash/range';\nimport min from 'lodash/min';\nimport max from 'lodash/max';\nimport times from 'lodash/times';\n// eslint-disable-next-line -- TODO: describe this disable  you-dont-need-lodash-underscore/repeat\nimport repeat from 'lodash/repeat';\n\nimport * as CodeMirrorWrapper from './CodeMirrorWrapper';\n\ntype EditorInstanceType = ReturnType<typeof CodeMirrorWrapper.create>;\n\nfunction createPrefixToggleFn(prefix: string) {\n  return (editor: EditorInstanceType) => {\n    if (editor.lineStartsWith(prefix)) {\n      editor.removeFromLineBeginning(prefix.length);\n    } else {\n      editor.insertAtLineBeginning(prefix);\n    }\n  };\n}\n\n/**\n * Wraps the current selection with a marker.\n *\n * If nothing is selected it inserts the given text wrapped in the\n * marker and selects the inner text\n *\n * Used b the `bold`, `italic`, and `strike` commands.\n */\nfunction wrapSelection(editor: EditorInstanceType, marker: string, emptyText: string) {\n  return () => {\n    editor.usePrimarySelection();\n\n    // there's a selection - wrap it with inline marker\n    if (editor.getSelection()) {\n      const selectedText = editor.getSelectedText();\n      if (selectedText.startsWith(marker) && selectedText.endsWith(marker)) {\n        const markerLength = marker.length;\n        const textWithoutMarker = selectedText.slice(\n          markerLength,\n          selectedText.length - markerLength\n        );\n        editor.replaceSelectedText(textWithoutMarker);\n      } else {\n        editor.wrapSelection(marker);\n      }\n    } else {\n      // no selection - insert sample text and select it\n      editor.insertAtCursor(marker + emptyText + marker);\n      editor.selectBackwards(marker.length, emptyText.length);\n    }\n  };\n}\n\nconst HEADER_CHAR = '#';\nconst quoteToggleFn = createPrefixToggleFn('> ');\nconst codeToggleFn = createPrefixToggleFn('    ');\n\n/**\n * @description\n * A collection of commands used by the user bound to a\n * CodeMirrorWrapper instance.\n *\n * The command collection only depends on the wrapper instance and is\n * used by UI from code mirror stuff.\n */\nexport function create(editor: EditorInstanceType) {\n  return {\n    bold: wrapSelection(editor, '__', 'text in bold'),\n    italic: wrapSelection(editor, '*', 'text in italic'),\n    strike: wrapSelection(editor, '~~', 'striked out'),\n    quote: modifySelection(editor, quoteToggleFn),\n    code: modifySelection(editor, codeToggleFn),\n    link,\n    h1: toggleHeader(editor, 1),\n    h2: toggleHeader(editor, 2),\n    h3: toggleHeader(editor, 3),\n    ul: modifySelection(editor, ulToggleFn, true),\n    ol: modifySelection(editor, olToggleFn, true),\n    undo: function () {\n      editor.cmd('undo');\n    },\n    redo: function () {\n      editor.cmd('redo');\n    },\n    hr,\n    indent,\n    dedent,\n    table,\n  };\n\n  /**\n   * @description\n   * Insert a line with `---` below the cursor.\n   */\n  function hr() {\n    editor.moveIfNotEmpty();\n    const nl = editor.getNl();\n    const markup = nl + '---' + nl + nl;\n    editor.insertAtCursor(markup);\n  }\n\n  /**\n   * @description\n   * Indent the current line.\n   */\n  function indent() {\n    editor.insertAtLineBeginning(editor.getIndentation());\n  }\n\n  /**\n   * @description\n   * Dedent the current line.\n   */\n  function dedent() {\n    const indentation = editor.getIndentation();\n    if (editor.lineStartsWith(indentation)) {\n      editor.removeFromLineBeginning(indentation.length);\n    }\n  }\n\n  /**\n   * @description\n   * Insert a markdown table template in a new line.\n   */\n  function table(config: { rows: number; cols: number }) {\n    const nl = editor.getNl();\n    editor.moveIfNotEmpty();\n    editor.insertAtCursor(nl);\n    const line = editor.getCurrentLineNumber();\n    editor.insertAtCursor(tableTemplate(config.rows, config.cols).join(nl));\n    editor.insertAtCursor(nl + nl);\n    editor.restoreCursor(2, line);\n  }\n\n  /**\n   * @description\n   * Inserts or replaces the current selection with a markdown link\n   */\n  function link(url: string, text?: string, title?: string) {\n    editor.usePrimarySelection();\n\n    const linkTitle = title ? ' \"' + title + '\"' : '';\n\n    const link = text ? '[' + text + '](' + url + linkTitle + ')' : '<' + url + '>';\n\n    editor.replaceSelectedText(link, 'around');\n  }\n}\n\n/**\n * For each line in the selection move to that line and call\n * `toggleFn` with the 1-based index of the line in the selection.\n *\n * If there is no selection we just call `toggleFn(editor)`.\n */\nfunction modifySelection(\n  editor: EditorInstanceType,\n  toggleFn: (editor: EditorInstanceType, listNumber?: number) => void,\n  isList?: boolean\n) {\n  return () => {\n    editor.usePrimarySelection();\n\n    const selection = editor.getSelection();\n    if (selection) {\n      // there's a selection - toggle list bullet for each line\n      // listNumber is 1, 2, 3... and can be used as ol bullet\n      forLineIn(selection, (lineNumber: number, listNumber: number) => {\n        // TODO move this into forLineIn\n        editor.moveToLineBeginning(lineNumber);\n        toggleFn(editor, listNumber);\n      });\n      editor.moveToLineEnd();\n    } else {\n      // there's no selection - just toggle line prefix\n      // but if adding list, add whitespace before and after list\n      if (isList && !getListNumber(editor) && !editor.lineStartsWith('- ')) {\n        prepareListWhitespace(editor);\n      }\n      toggleFn(editor);\n    }\n  };\n}\n\n/**\n * Calls callback for each line number that is in the selection\n *\n * The second argument is the 1-based index of the iteration.\n *\n * @param {CodeMirror.Selection} selection\n * param {function(number)} cb\n */\nfunction forLineIn(\n  selection: {\n    anchor: CodeMirror.Position;\n    head: CodeMirror.Position;\n  },\n  cb: Function\n) {\n  // anchor/head depend on selection direction, so min & max have to be used\n  const lines = [selection.anchor.line, selection.head.line];\n  const maxNumber = max(lines);\n  const minNumber = min(lines);\n  const lineRange = range(minNumber || 0, maxNumber !== undefined ? maxNumber + 1 : undefined);\n\n  lineRange.forEach((lineNumber, i) => {\n    cb(lineNumber, i + 1);\n  });\n}\n\nfunction prepareListWhitespace(editor: EditorInstanceType) {\n  const line = editor.getCurrentLineNumber();\n\n  const isCurrentLineEmpty = editor.isLineEmpty(line);\n\n  const isPrevLineEmpty = line > 0 ? editor.isLineEmpty(line - 1) : false;\n  const isNextLineEmpty = line < editor.getLinesCount() - 1 ? editor.isLineEmpty(line + 1) : true;\n\n  let linesToInsert = isCurrentLineEmpty ? 2 : 4;\n  if (isPrevLineEmpty) {\n    linesToInsert = linesToInsert - 1;\n  }\n  if (isNextLineEmpty) {\n    linesToInsert = linesToInsert - 1;\n  }\n\n  editor.moveToLineEnd();\n  editor.insertAtCursor(editor.getNl(linesToInsert));\n  editor.restoreCursor(0, isCurrentLineEmpty ? line : line + 2);\n}\n\nfunction getListNumber(editor: EditorInstanceType) {\n  const result = editor.getCurrentLine().match(/^(\\d+\\. )/);\n  return result ? result[1] : null;\n}\n\nfunction ulToggleFn(editor: EditorInstanceType) {\n  if (editor.lineStartsWith('- ')) {\n    editor.removeFromLineBeginning(2);\n  } else {\n    const listNumber = getListNumber(editor);\n    if (listNumber) {\n      editor.removeFromLineBeginning(listNumber.length);\n    }\n    editor.insertAtLineBeginning('- ');\n  }\n}\n\nfunction olToggleFn(editor: EditorInstanceType, n?: number) {\n  const listNumber = getListNumber(editor);\n  if (listNumber) {\n    editor.removeFromLineBeginning(listNumber.length);\n  } else {\n    if (editor.lineStartsWith('- ')) {\n      editor.removeFromLineBeginning(2);\n    }\n    editor.insertAtLineBeginning((n || 1) + '. ');\n  }\n}\n\n/**\n * From a table layout specification build a Markdown table template.\n *\n * Returns the lines as an array.\n * Used by the `table()` command\n *\n * @param {object} config\n * @param {number} rows\n * @param {number} cols\n * @returns {string[]}\n */\nfunction tableTemplate(nrows: number, ncols: number) {\n  const cellWidth = new Array(11);\n  const cell = ' ' + cellWidth.join(' ') + ' |';\n  const separatorCell = ' ' + cellWidth.join('-') + ' |';\n\n  let baseRow = '|';\n  let separatorRow = '|';\n\n  times(ncols, () => {\n    baseRow += cell;\n    separatorRow += separatorCell;\n  });\n\n  const bodyRows = range(nrows).map(() => baseRow.replace(/\\| {5}/g, '| Cell'));\n\n  const headerRow = baseRow.replace(/\\| {7}/g, '| Header');\n\n  return [headerRow, separatorRow].concat(bodyRows);\n}\n\n/**\n * Toggles the header prefix for a given level on the current line.\n *\n * - Removes a header when one of the same level is\n * - Replaces the header if there is one of a different level\n * - Otherwise inserts the header\n */\nfunction toggleHeader(editor: EditorInstanceType, level: number) {\n  return () => {\n    const initialCh = editor.getCurrentCharacter();\n    const currentHeader = selectHeader(editor);\n    const prefix = repeat(HEADER_CHAR, level);\n\n    // there's no header at the current line - create one\n    if (!currentHeader) {\n      editor.moveToLineBeginning();\n      editor.insertAtCursor(prefix + ' ');\n      editor.restoreCursor(initialCh + prefix.length + 1);\n      return;\n    }\n\n    // there's exactly the same header - remove one\n    if (editor.getSelectedText() === prefix) {\n      editor.extendSelectionBy(1);\n      const removedCh = editor.getSelectionLength();\n      editor.removeSelectedText();\n      editor.restoreCursor(initialCh - removedCh);\n      return;\n    }\n\n    // there's another header at the current line - replace\n    const diff = prefix.length - editor.getSelectionLength();\n    editor.replaceSelectedText(prefix);\n    editor.restoreCursor(initialCh + diff);\n  };\n}\n\n/**\n * On the current line select a Markdown header prefix. That is the\n * string at the beginning of the line that consists of up to six `#`.\n *\n * If the selection was successful return the selected string.\n */\nfunction selectHeader(editor: EditorInstanceType) {\n  const result = editor.getCurrentLine().match(/^( {0,3})(#{1,6}) /);\n  if (!result) {\n    return null;\n  }\n  const indentation = result[1];\n  const header = result[2];\n\n  editor.select(getPos(0), getPos(header.length));\n  return editor.getSelection();\n\n  function getPos(modifier: number) {\n    return {\n      line: editor.getCurrentLineNumber(),\n      ch: indentation.length + modifier,\n    };\n  }\n}\n","import React, { useRef, useEffect, useState } from 'react';\nimport tokens from '@contentful/f36-tokens';\nimport { css, cx } from 'emotion';\nimport { createMarkdownEditor } from './createMarkdownEditor';\nimport { EditorDirection } from '../../types';\n\nexport type InitializedEditorType = ReturnType<typeof createMarkdownEditor>;\n\ntype MarkdownTextareaProps = {\n  /**\n   * Minimum height to set for the markdown text area\n   */\n  minHeight?: string | number;\n  mode: 'default' | 'zen';\n  direction: EditorDirection;\n  disabled: boolean;\n  visible: boolean;\n  onReady: (editor: InitializedEditorType) => void;\n};\n\nconst styles = {\n  root: css`\n    border: 1px solid ${tokens.gray400};\n    border-width: 0 1px;\n    overflow-y: auto;\n    height: auto;\n    min-height: 300px;\n\n    .CodeMirror {\n      height: auto;\n      line-height: ${tokens.lineHeightDefault};\n    }\n    .CodeMirror-lines {\n      color: ${tokens.gray700};\n      padding: ${tokens.spacingL};\n    }\n    .CodeMirror-code {\n      font-family: ${tokens.fontStackMonospace};\n      font-size: ${tokens.fontSizeM};\n    }\n    .CodeMirror-scroll {\n      min-height: '6rem';\n    }\n\n    .cm-header {\n      color: ${tokens.gray900};\n    }\n    span.cm-variable-2 {\n      color: ${tokens.gray700};\n    }\n    .cm-header-1 {\n      font-size: 1.9em;\n    }\n    .cm-header-2 {\n      font-size: 1.75em;\n    }\n    .cm-header-3 {\n      font-size: 1.6em;\n    }\n    .cm-header-4 {\n      font-size: 1.45em;\n    }\n    .cm-header-5 {\n      font-size: 1.3em;\n    }\n    .cm-header-6 {\n      font-size: 1.15em;\n    }\n\n    span.cm-tag,\n    span.cm-string,\n    span.cm-attribute {\n      color: ${tokens.red600};\n    }\n    span.cm-string {\n      text-decoration: none !important;\n    }\n    span.cm-quote,\n    span.cm-comment {\n      color: ${tokens.gray600};\n    }\n    span.cm-link,\n    span.cm-url {\n      color: ${tokens.blue500} !important;\n    }\n    span.cm-link {\n      text-decoration: underline;\n    }\n  `,\n  framed: css({\n    '.CodeMirror': {\n      maxHeight: '500px',\n    },\n  }),\n  zen: css({\n    border: 'none !important',\n    '.CodeMirror-lines': {\n      maxWidth: '650px',\n      margin: '0 auto',\n    },\n  }),\n  disabled: css`\n    .CodeMirror {\n      background: ${tokens.gray100};\n      cursor: 'not-allowed';\n    }\n    .CodeMirror-cursors {\n      visibility: hidden !important;\n    }\n    .CodeMirror-scroll,\n    .CodeMirror-sizer,\n    .CodeMirror-lines {\n      cursor: not-allowed;\n    }\n  `,\n};\n\nexport const MarkdownTextarea = React.memo((props: MarkdownTextareaProps) => {\n  const hostRef = useRef<HTMLDivElement>(null);\n  const [editor, setEditor] = useState<InitializedEditorType | null>(null);\n\n  useEffect(() => {\n    if (hostRef.current) {\n      setEditor(\n        createMarkdownEditor(\n          hostRef.current,\n          Object.assign(\n            {},\n            {\n              direction: props.direction,\n              readOnly: true,\n            },\n            props.mode === 'zen'\n              ? {\n                  fixedHeight: true,\n                  height: '100%',\n                }\n              : {},\n            props.minHeight !== undefined ? { height: props.minHeight } : {}\n          )\n        )\n      );\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, []);\n\n  useEffect(() => {\n    if (editor) {\n      props.onReady(editor);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, [editor]);\n\n  const className = cx(\n    styles.root,\n    props.minHeight !== undefined ? css({ minHeight: props.minHeight }) : undefined,\n    props.mode === 'default' ? styles.framed : styles.zen,\n    props.disabled && styles.disabled\n  );\n\n  return (\n    <div\n      className={className}\n      ref={hostRef}\n      data-test-id=\"markdown-textarea\"\n      style={{ display: props.visible ? 'block' : 'none' }}\n    />\n  );\n});\n\nMarkdownTextarea.displayName = 'MarkdownTextarea';\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n\nimport * as CodeMirrorWrapper from './CodeMirrorWrapper';\nimport * as Commands from './MarkdownCommands';\nimport { EditorDirection } from '../../types';\n\nexport function createMarkdownEditor(\n  host: HTMLElement,\n  options: {\n    direction: EditorDirection;\n    readOnly: boolean;\n    fixedHeight?: number | boolean;\n    height?: number | string;\n  }\n) {\n  const editor = CodeMirrorWrapper.create(host, options);\n\n  function wrapChange(fn: Function) {\n    return (e: any, ch: any) => {\n      fn(editor.getValue(), e, ch);\n    };\n  }\n\n  const api = {\n    actions: Commands.create(editor),\n    history: {\n      hasUndo: function () {\n        return editor.getHistorySize('undo') > 0;\n      },\n      hasRedo: function () {\n        return editor.getHistorySize('redo') > 0;\n      },\n    },\n    events: {\n      onScroll: function (fn: Function) {\n        editor.attachEvent('scroll', fn, 150);\n      },\n      onChange: function (fn: Function) {\n        editor.attachEvent('change', wrapChange(fn), 0);\n      },\n      onPaste: function (fn: Function) {\n        editor.attachEvent('paste', fn, 0);\n      },\n    },\n    insert: editor.insertAtCursor,\n    focus: editor.focus,\n    getContent: editor.getValue,\n    destroy: editor.destroy,\n    setContent: editor.setValue,\n    getSelectedText: editor.getSelectedText,\n    usePrimarySelection: editor.usePrimarySelection,\n    setReadOnly: editor.setReadOnly,\n    selectBackwards: editor.selectBackwards,\n    getCursor: editor.getCursor,\n    setCursor: editor.setCursor,\n    clear: () => editor.setValue(''),\n    selectAll: editor.selectAll,\n    setFullsize: editor.setFullsize,\n    refresh: editor.refresh,\n  };\n\n  editor.addKeyShortcuts({\n    B: api.actions.bold,\n    I: api.actions.italic,\n  });\n\n  return api;\n}\n","export type MarkdownTab = 'editor' | 'preview';\n\nexport type HeadingType = 'h1' | 'h2' | 'h3';\n\nexport type EditorDirection = 'ltr' | 'rtl';\n\nexport enum MarkdownDialogType {\n  cheatsheet = 'markdown-cheatsheet',\n  insertLink = 'markdown-insertLink',\n  insertSpecialCharacter = 'markdown-insertSpecialCharacter',\n  insertTable = 'markdown-insertTable',\n  embedExternalContent = 'markdown-embedExternalContent',\n  confirmInsertAsset = 'markdown-confirmInsertAsset',\n  zenMode = 'markdown-zenMode',\n}\n\nexport type MarkdownDialogsParams =\n  | {\n      type: MarkdownDialogType.zenMode;\n      initialValue: string;\n      locale: string;\n    }\n  | {\n      type: MarkdownDialogType.cheatsheet;\n    }\n  | {\n      type: MarkdownDialogType.insertLink;\n      selectedText?: string;\n    }\n  | {\n      type: MarkdownDialogType.insertSpecialCharacter;\n    }\n  | {\n      type: MarkdownDialogType.insertTable;\n    }\n  | {\n      type: MarkdownDialogType.embedExternalContent;\n    }\n  | {\n      type: MarkdownDialogType.confirmInsertAsset;\n      locale: string;\n      assets: Array<{\n        title: string;\n        description: string;\n        thumbnailUrl: string;\n        thumbnailAltText: string;\n      }>;\n    };\n\nexport type MarkdownActions = {\n  simple: {\n    bold: Function;\n    italic: Function;\n    quote: Function;\n    ol: Function;\n    ul: Function;\n    strike: Function;\n    code: Function;\n    hr: Function;\n    indent: Function;\n    dedent: Function;\n  };\n  headings: {\n    h1: Function;\n    h2: Function;\n    h3: Function;\n  };\n  history: {\n    undo: Function;\n    redo: Function;\n  };\n  insertLink: Function;\n  embedExternalContent: Function;\n  insertTable: Function;\n  insertSpecialCharacter: Function;\n  linkExistingMedia: Function;\n  addNewMedia: Function;\n  organizeLinks: Function;\n  openZenMode: Function;\n  closeZenMode: Function;\n};\n\nexport type PreviewComponents = {\n  embedly?: React.ComponentType<{ url: string }>;\n};\n","import React from 'react';\n\nimport { TextLink, Paragraph } from '@contentful/f36-components';\nimport tokens from '@contentful/f36-tokens';\nimport { css } from 'emotion';\n\nconst styles = {\n  root: css({\n    display: 'flex',\n    justifyContent: 'space-between',\n    background: tokens.gray100,\n    border: `1px solid ${tokens.gray400}`,\n    borderBottomLeftRadius: tokens.borderRadiusSmall,\n    borderBottomRightRadius: tokens.borderRadiusSmall,\n    padding: `${tokens.spacingXs} ${tokens.spacingS}`,\n  }),\n  help: css({\n    color: tokens.gray700,\n    fontSize: tokens.fontSizeS,\n    button: {\n      fontSize: tokens.fontSizeS,\n      lineHeight: 'inherit',\n    },\n  }),\n};\n\nexport function MarkdownCounter(props: { words: number; characters: number }) {\n  return (\n    <Paragraph marginBottom=\"none\" className={styles.help}>\n      {props.words} {props.words !== 1 ? 'words' : 'word'}, {props.characters}{' '}\n      {props.characters !== 1 ? 'characters' : 'character'}\n    </Paragraph>\n  );\n}\n\nexport function MarkdownHelp(props: { onClick: () => void }) {\n  return (\n    <Paragraph marginBottom=\"none\" className={styles.help}>\n      Format your text like a pro with the{' '}\n      <TextLink\n        as=\"button\"\n        testId=\"open-markdown-cheatsheet-button\"\n        onClick={() => {\n          props.onClick();\n        }}\n      >\n        markdown cheatsheet\n      </TextLink>\n      .\n    </Paragraph>\n  );\n}\n\nexport function MarkdownBottomBar(props: { children: React.ReactNode }) {\n  return <div className={styles.root}>{props.children}</div>;\n}\n","import React from 'react';\nimport { css, cx } from 'emotion';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport { ModalContent } from '@contentful/f36-components';\nimport tokens from '@contentful/f36-tokens';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\n\nimport { TextLink, Heading } from '@contentful/f36-components';\n\nconst styles = {\n  flexColumnContainer: css({\n    display: 'flex',\n    flexWrap: 'nowrap',\n  }),\n  flexColumn: css({\n    flexGrow: 1,\n  }),\n  verticalDivider: css({\n    borderRight: `1px solid ${tokens.gray500}`,\n    paddingRight: tokens.spacing3Xl,\n    marginRight: tokens.spacing2Xl,\n  }),\n  preview: css({\n    display: 'inline-block',\n    paddingRight: tokens.spacingL,\n    width: '50%',\n  }),\n  unOrderedListPreview: css({\n    listStyleType: 'disc',\n    marginLeft: tokens.spacingS,\n  }),\n  orderedListPreview: css({\n    listStyleType: 'decimal',\n    marginLeft: tokens.spacingS,\n  }),\n  markup: css({\n    display: 'inline-block',\n    color: tokens.gray600,\n    paddingLeft: tokens.spacingL,\n    width: '50%',\n  }),\n  h1: css({\n    fontSize: tokens.fontSize2Xl,\n  }),\n  h2: css({\n    fontSize: tokens.fontSizeXl,\n  }),\n  h3: css({\n    fontSize: tokens.fontSizeL,\n  }),\n  helpItem: css({\n    marginBottom: tokens.spacingS,\n    display: 'flex',\n    alignItems: 'flex-end',\n    height: tokens.spacingXl,\n  }),\n  helpLink: css({\n    margin: 'auto',\n  }),\n  flexRowContainer: css({\n    display: 'flex',\n    width: '100%',\n    justifyContent: 'center',\n    marginTop: tokens.spacingXl,\n  }),\n};\n\nexport const CheatsheetModalDialog = () => {\n  return (\n    <ModalContent testId=\"markdown-cheatsheet-dialog-content\">\n      <div className={styles.flexColumnContainer}>\n        <div className={cx(styles.flexColumn, styles.verticalDivider)}>\n          <div className={styles.helpItem}>\n            <Heading marginBottom=\"none\" as=\"h1\" className={cx(styles.preview, styles.h1)}>\n              H1\n            </Heading>\n            <div className={styles.markup}># heading</div>\n          </div>\n          <div className={styles.helpItem}>\n            <Heading marginBottom=\"none\" as=\"h2\" className={cx(styles.preview, styles.h2)}>\n              H2\n            </Heading>\n            <div className={styles.markup}>## heading</div>\n          </div>\n          <div className={styles.helpItem}>\n            <Heading marginBottom=\"none\" as=\"h3\" className={cx(styles.preview, styles.h3)}>\n              H3\n            </Heading>\n            <div className={styles.markup}>### heading</div>\n          </div>\n          <div className={styles.helpItem}>\n            <strong className={styles.preview}>bold</strong>\n            <div className={styles.markup}>__text__</div>\n          </div>\n          <div className={styles.helpItem}>\n            <em className={styles.preview}>italic</em>\n            <div className={styles.markup}>*text*</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>strikethrough</div>\n            <div className={styles.markup}>~~text~~</div>\n          </div>\n          <div className={styles.helpItem}>\n            <TextLink as=\"button\" className={styles.preview}>\n              Link\n            </TextLink>\n            <div className={styles.markup}>[text](url)</div>\n          </div>\n        </div>\n        <div className={styles.flexColumn}>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>Image</div>\n            <div className={styles.markup}>![alt-text](url)</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>Unordered list</div>\n            <div className={styles.markup}>* list item</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>\n              <div>Ordered list</div>\n            </div>\n            <div className={styles.markup}>1. list item</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>\n              <div>Blockquote</div>\n            </div>\n            <div className={styles.markup}>&gt; quote</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>code span</div>\n            <div className={styles.markup}>`code here`</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>code block</div>\n            <div className={styles.markup}>```code here```</div>\n          </div>\n        </div>\n      </div>\n      <div className={styles.flexRowContainer}>\n        <TextLink\n          className={styles.helpLink}\n          href=\"https://help.github.com/en/github/writing-on-github/basic-writing-and-formatting-syntax\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\">\n          View the full GitHub-flavored Markdown syntax help (opens in a new window)\n        </TextLink>\n      </div>\n    </ModalContent>\n  );\n};\n\nexport const openCheatsheetModal = (dialogs: DialogsAPI): Promise<void> => {\n  return dialogs.openCurrent({\n    title: 'Markdown formatting help',\n    width: 'large',\n    minHeight: '415px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.cheatsheet,\n    } as MarkdownDialogsParams,\n  });\n};\n","import React from 'react';\n\nimport tokens from '@contentful/f36-tokens';\nimport DOMPurify from 'dompurify';\nimport { css, cx } from 'emotion';\nimport Markdown from 'markdown-to-jsx';\n\nimport { EditorDirection, PreviewComponents } from '../types';\nimport { replaceMailtoAmp } from '../utils/replaceMailtoAmp';\n\nconst styles = {\n  root: css`\n    border: 1px solid ${tokens.gray400};\n    border-width: 0 1px;\n    word-wrap: break-word;\n    overflow-wrap: break-word;\n    min-height: 300px;\n    padding: ${tokens.spacingL};\n    font-size: ${tokens.fontSizeM};\n    font-family: ${tokens.fontStackPrimary};\n    line-height: ${tokens.lineHeightDefault};\n    color: ${tokens.gray700};\n    white-space: pre-line;\n\n    h1,\n    h2,\n    h3,\n    h4,\n    h5,\n    h6 {\n      margin-top: ${tokens.spacingL};\n      margin-bottom: ${tokens.spacingM};\n      color: ${tokens.gray900};\n    }\n\n    h1:first-child,\n    h2:first-child,\n    h3:first-child,\n    h4:first-child,\n    h5:first-child,\n    h6:first-child {\n      margin-top: 0;\n    }\n\n    h1 {\n      font-size: 1.9em;\n    }\n    h2 {\n      font-size: 1.75em;\n    }\n    h3 {\n      font-size: 1.6em;\n    }\n    h4 {\n      font-size: 1.45em;\n    }\n    h5 {\n      font-size: 1.3em;\n    }\n    h6 {\n      font-size: 1.15em;\n    }\n\n    p {\n      margin-top: 0;\n      margin-bottom: ${tokens.spacingM};\n    }\n\n    ul,\n    ol {\n      margin: ${tokens.spacingS} 0;\n      padding-left: ${tokens.spacingM};\n    }\n    ul > li {\n      list-style-type: disc;\n      margin-bottom: 0;\n    }\n\n    ol > li {\n      list-style-type: decimal;\n      margin-bottom: 0;\n    }\n\n    table {\n      table-layout: fixed;\n      border-right-width: 0;\n      border-bottom-width: 0;\n      width: 80%;\n      margin: ${tokens.spacingM} auto;\n      border-spacing: 0;\n      border-collapse: collapse;\n      border: 1px solid ${tokens.gray300};\n    }\n\n    table th,\n    table td {\n      padding: 5px;\n      border-left-width: 0;\n      border-top-width: 0;\n    }\n\n    table th {\n      background: ${tokens.gray200};\n    }\n\n    table td {\n      border: 1px solid ${tokens.gray300};\n    }\n\n    a {\n      color: ${tokens.blue500};\n    }\n\n    hr {\n      margin-top: ${tokens.spacingL};\n      margin-bottom: ${tokens.spacingL};\n      height: 1px;\n      background-color: ${tokens.gray300};\n      border: none;\n    }\n\n    blockquote {\n      border-left: 4px solid ${tokens.gray200};\n      padding-left: ${tokens.spacingL};\n      margin: 0;\n      margin-top: ${tokens.spacingM};\n      font-style: italic;\n    }\n\n    img {\n      margin: ${tokens.spacingM} auto;\n      display: block;\n      max-width: 80%;\n      max-height: 250px;\n    }\n\n    pre code {\n      font-size: ${tokens.fontSizeS};\n      font-family: ${tokens.fontStackMonospace};\n    }\n\n    .embedly-card {\n      margin: ${tokens.spacingM} auto;\n      display: block;\n    }\n  `,\n  framed: css({\n    height: '100%',\n    maxHeight: '500px',\n    overflowY: 'auto',\n  }),\n  zen: css({\n    maxWidth: '650px',\n    margin: '0 auto',\n    border: 'none !important',\n  }),\n  rtl: css({\n    direction: 'rtl',\n  }),\n};\n\ntype MarkdownPreviewProps = {\n  /**\n   * Minimum height to set for the markdown preview\n   */\n  minHeight?: string | number;\n  mode: 'default' | 'zen';\n  direction: EditorDirection;\n  value: string;\n  previewComponents?: PreviewComponents;\n};\n\nfunction MarkdownLink(props: {\n  href: string;\n  title: string;\n  className?: string;\n  // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n  children: any;\n  Embedly?: React.SFC<{ url: string }>;\n}) {\n  const { Embedly, children, ...rest } = props;\n\n  if (props.className === 'embedly-card' && Embedly) {\n    return <Embedly url={props.href} />;\n  }\n\n  return (\n    <a {...rest} target=\"_blank\" rel=\"noopener noreferrer\">\n      {children}\n    </a>\n  );\n}\n\nexport const MarkdownPreview = React.memo((props: MarkdownPreviewProps) => {\n  const className = cx(\n    styles.root,\n    props.minHeight !== undefined ? css({ minHeight: props.minHeight }) : undefined,\n    props.mode === 'default' ? styles.framed : styles.zen,\n    props.direction === 'rtl' ? styles.rtl : undefined\n  );\n\n  // See the list of allowed Tags here:\n  // https://github.com/cure53/DOMPurify/blob/main/src/tags.js#L3-L121\n  const cleanHTML = React.useMemo(() => {\n    return replaceMailtoAmp(DOMPurify.sanitize(props.value));\n  }, [props.value]);\n\n  return (\n    <div className={className} data-test-id=\"markdown-preview\">\n      <Markdown\n        options={{\n          overrides: {\n            a: {\n              // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n              component: MarkdownLink as any,\n              props: {\n                Embedly: props.previewComponents?.embedly,\n              },\n            },\n          },\n        }}>\n        {cleanHTML}\n      </Markdown>\n    </div>\n  );\n});\n\nMarkdownPreview.displayName = 'MarkdownPreview';\n","// This code will replace '&amp;' with '&' only inside the href attribute of the mailto link.\n// Otherwise the mailto link will not work correctly\nexport const replaceMailtoAmp = (string: string) => {\n  return string.replace(/href=\"mailto:[^\"]*&amp;/g, function (match) {\n    return match.replace(/&amp;/g, '&');\n  });\n};\n","import React from 'react';\nimport { css } from 'emotion';\nimport tokens from '@contentful/f36-tokens';\nimport { FieldExtensionSDK } from '@contentful/app-sdk';\nimport { ConstraintsUtils, CharCounter, CharValidation } from '@contentful/field-editor-shared';\n\nconst styles = {\n  root: css({\n    display: 'flex',\n    justifyContent: 'space-between',\n    fontSize: tokens.fontSizeM,\n    marginTop: tokens.spacingXs,\n    color: tokens.gray700,\n  }),\n};\n\nexport function MarkdownConstraints(props: { sdk: FieldExtensionSDK; value: string }) {\n  const constraints = ConstraintsUtils.fromFieldValidations(\n    props.sdk.field.validations,\n    props.sdk.field.type as 'Text'\n  );\n\n  const checkConstraint = ConstraintsUtils.makeChecker(constraints);\n\n  return (\n    <div className={styles.root}>\n      <CharCounter value={props.value} checkConstraint={checkConstraint} />\n      <CharValidation constraints={constraints} />\n    </div>\n  );\n}\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = GeneratorFunctionPrototype;\n  define(Gp, \"constructor\", GeneratorFunctionPrototype);\n  define(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction);\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  });\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  define(Gp, iteratorSymbol, function() {\n    return this;\n  });\n\n  define(Gp, \"toString\", function() {\n    return \"[object Generator]\";\n  });\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, in modern engines\n  // we can explicitly access globalThis. In older engines we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","export const urlRegex =\n  /^(ftp|http|https):\\/\\/(\\w+:{0,1}\\w*@)?(\\S+)(:[0-9]+)?(\\/|\\/([\\w#!:.?+=&%@!\\-/]))?$/;\n\nexport function isValidUrl(value: string) {\n  return urlRegex.test(value);\n}\n","import React, { useState, useRef, useEffect } from 'react';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\nimport {\n  ModalContent,\n  ModalControls,\n  Button,\n  Form,\n  FormControl,\n  TextInput,\n} from '@contentful/f36-components';\nimport { isValidUrl } from '../utils/isValidUrl';\n\ntype InsertLinkModalPositiveResult = { url: string; text: string; title: string };\nexport type InsertLinkModalResult = InsertLinkModalPositiveResult | false | undefined;\n\ntype InsertLinkModalProps = {\n  selectedText?: string;\n  onClose: (result: InsertLinkModalResult) => void;\n};\n\nexport const InsertLinkModal = ({ selectedText, onClose }: InsertLinkModalProps) => {\n  const mainInputRef = useRef<HTMLInputElement>(null);\n  const [text, setText] = useState(selectedText || '');\n  const [url, setUrl] = useState('');\n  const [touched, setTouched] = useState(false);\n  const [title, setTitle] = useState('');\n  const onInsert = (values: InsertLinkModalPositiveResult) => onClose(values);\n\n  const urlIsValid = isValidUrl(url);\n\n  useEffect(() => {\n    if (mainInputRef?.current?.focus) {\n      mainInputRef.current.focus();\n    }\n  }, [mainInputRef]);\n\n  return (\n    <>\n      <ModalContent testId=\"insert-link-modal\">\n        <Form onSubmit={() => onInsert({ url, text, title })}>\n          <FormControl id=\"link-text-field\" isDisabled={Boolean(selectedText)}>\n            <FormControl.Label>Link text</FormControl.Label>\n            <TextInput\n              name=\"link-text\"\n              value={text}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                setText(e.target.value);\n              }}\n              testId=\"link-text-field\"\n            />\n          </FormControl>\n\n          <FormControl id=\"target-url-field\" isInvalid={touched && !urlIsValid}>\n            <FormControl.Label>Target URL</FormControl.Label>\n            <TextInput\n              name=\"target-url\"\n              value={url}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                setUrl(e.target.value);\n                setTouched(true);\n              }}\n              placeholder=\"https://\"\n              maxLength={2100}\n              testId=\"target-url-field\"\n              ref={mainInputRef}\n            />\n            <FormControl.HelpText>Include protocol (e.g. https://)</FormControl.HelpText>\n            {touched && !urlIsValid && (\n              <FormControl.ValidationMessage>Invalid URL</FormControl.ValidationMessage>\n            )}\n          </FormControl>\n\n          <FormControl id=\"link-title-field\">\n            <FormControl.Label>Link title</FormControl.Label>\n            <TextInput\n              name=\"link-title\"\n              value={title}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                setTitle(e.target.value);\n              }}\n              testId=\"link-title-field\"\n            />\n            <FormControl.HelpText>\n              Extra link information, usually shown as a tooltip on mouse hover\n            </FormControl.HelpText>\n          </FormControl>\n        </Form>\n      </ModalContent>\n      <ModalControls>\n        <Button\n          testId=\"insert-link-cancel\"\n          onClick={() => onClose(false)}\n          variant=\"secondary\"\n          size=\"small\">\n          Cancel\n        </Button>\n        <Button\n          testId=\"insert-link-confirm\"\n          onClick={() => {\n            onInsert({ url, text, title });\n          }}\n          isDisabled={!urlIsValid}\n          variant=\"positive\"\n          size=\"small\">\n          Insert\n        </Button>\n      </ModalControls>\n    </>\n  );\n};\n\nexport const openInsertLinkDialog = (\n  dialogs: DialogsAPI,\n  params: { selectedText?: string }\n): Promise<InsertLinkModalResult> => {\n  return dialogs.openCurrent({\n    title: 'Insert link',\n    width: 'large',\n    minHeight: '410px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.insertLink,\n      ...params,\n    } as MarkdownDialogsParams,\n  });\n};\n","export const specialCharacters = [\n  { code: 180, desc: 'acute accent' },\n  { code: 38, desc: 'ampersand' },\n  { code: 166, desc: 'broken vertical bar' },\n  { code: 8226, desc: 'bullet' },\n  { code: 184, desc: 'cedilla' },\n  { code: 162, desc: 'cent' },\n  { code: 169, desc: 'copyright' },\n  { code: 176, desc: 'degree' },\n  { code: 247, desc: 'division' },\n  { code: 189, desc: 'fraction half' },\n  { code: 188, desc: 'fraction quarter' },\n  { code: 190, desc: 'fraction three quarters' },\n  { code: 62, desc: 'greater than' },\n  { code: 161, desc: 'inverted exclamation mark' },\n  { code: 191, desc: 'inverted question mark' },\n  { code: 171, desc: 'left-pointing double angle quotation mark' },\n  { code: 60, desc: 'less than' },\n  { code: 175, desc: 'macron' },\n  { code: 181, desc: 'micro' },\n  { code: 160, desc: 'non-breaking space' },\n  { code: 172, desc: 'not' },\n  { code: 182, desc: 'paragraph' },\n  { code: 177, desc: 'plus-minus' },\n  { code: 34, desc: 'quotation mark' },\n  { code: 174, desc: 'registered' },\n  { code: 187, desc: 'right-pointing double angle quotation mark' },\n  { code: 167, desc: 'section' },\n  { code: 168, desc: 'umlaut/diaeresis' },\n  { code: 215, desc: 'multiplication' },\n  { code: 8482, desc: 'trade mark' },\n  { code: 8364, desc: 'euro' },\n  { code: 163, desc: 'pound' },\n  { code: 165, desc: 'yen' },\n  { code: 8222, desc: 'double low-9 quotation mark' },\n  { code: 710, desc: 'modifier circumflex accent' },\n  { code: 8224, desc: 'dagger' },\n  { code: 8225, desc: 'double dagger' },\n  { code: 8230, desc: 'horizontal ellipsis' },\n  { code: 8220, desc: 'left double quotation mark' },\n  { code: 8249, desc: 'single left-pointing angle quotation mark' },\n  { code: 8216, desc: 'left single quotation mark' },\n  { code: 183, desc: 'middle dot' },\n  { code: 8212, desc: 'em dash' },\n  { code: 8211, desc: 'en dash' },\n  { code: 8240, desc: 'per mille' },\n  { code: 8250, desc: 'single right-pointing angle quotation mark' },\n  { code: 8217, desc: 'right single quotation mark' },\n  { code: 8218, desc: 'single low-9 quotation mark' },\n  { code: 170, desc: 'feminine ordinal indicator' },\n  { code: 186, desc: 'masculine ordinal indicator' },\n  { code: 8221, desc: 'right double quotation mark' },\n  { code: 732, desc: 'small tilde' },\n  { code: 9829, desc: 'black heart' },\n  { code: 9830, desc: 'diamond' },\n];\n","import React, { useState } from 'react';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport { css } from 'emotion';\nimport tokens from '@contentful/f36-tokens';\nimport {\n  ModalContent,\n  ModalControls,\n  Text,\n  Flex,\n  Button,\n  Tooltip,\n} from '@contentful/f36-components';\nimport { specialCharacters } from '../utils/specialCharacters';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\n\nconst styles = {\n  buttonPanel: css({\n    display: 'flex',\n    flexWrap: 'wrap',\n  }),\n  charButton: css({\n    border: `1px solid ${tokens.gray500}`,\n    width: '4.1rem',\n    height: '4.1rem',\n    fontSize: tokens.fontSizeXl,\n    marginTop: tokens.spacing2Xs,\n    marginRight: tokens.spacing2Xs,\n  }),\n  selectedCharButton: css({\n    backgroundColor: tokens.gray100,\n  }),\n  tooltip: css({ zIndex: 1000 }),\n  button: css({\n    marginTop: tokens.spacingM,\n    marginRight: tokens.spacingS,\n  }),\n};\n\nexport type SpecialCharacterModalResult = string | false | undefined;\n\ntype SpecialCharacterModalDialogProps = {\n  onClose: (result: SpecialCharacterModalResult) => void;\n};\n\nexport const SpecialCharacterModalDialog = ({ onClose }: SpecialCharacterModalDialogProps) => {\n  const [selectedCharacter, setSelectedCharacter] = useState<{ code: number; desc: string }>(\n    specialCharacters[0]\n  );\n  return (\n    <>\n      <ModalContent testId=\"insert-special-character-modal\">\n        <Flex flexDirection=\"column\" alignItems=\"center\">\n          <Text as=\"div\" lineHeight=\"lineHeight3Xl\" fontSize=\"fontSize3Xl\" marginBottom=\"spacingS\">\n            {String.fromCharCode(selectedCharacter.code)}\n          </Text>\n          <Text as=\"div\" marginBottom=\"spacingS\">\n            {selectedCharacter.desc}\n          </Text>\n        </Flex>\n        <div className={styles.buttonPanel}>\n          {specialCharacters.map((char) => (\n            <div key={char.code}>\n              <Tooltip className={styles.tooltip} content={char.desc}>\n                <Button\n                  testId=\"special-character-button\"\n                  isActive={char.code === selectedCharacter.code}\n                  className={styles.charButton}\n                  variant=\"transparent\"\n                  onClick={() => setSelectedCharacter(char)}>\n                  {String.fromCharCode(char.code)}\n                </Button>\n              </Tooltip>\n            </div>\n          ))}\n        </div>\n      </ModalContent>\n      <ModalControls>\n        <Button\n          testId=\"insert-character-cancel\"\n          className={styles.button}\n          onClick={() => onClose(false)}\n          variant=\"secondary\"\n          size=\"small\">\n          Cancel\n        </Button>\n        <Button\n          className={styles.button}\n          testId=\"insert-character-confirm\"\n          onClick={() => onClose(String.fromCharCode(selectedCharacter.code))}\n          variant=\"positive\"\n          size=\"small\">\n          Insert selected\n        </Button>\n      </ModalControls>\n    </>\n  );\n};\n\nexport const openInsertSpecialCharacter = (\n  dialogs: DialogsAPI\n): Promise<SpecialCharacterModalResult> => {\n  return dialogs.openCurrent({\n    title: 'Insert special character',\n    width: 'large',\n    minHeight: '600px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.insertSpecialCharacter,\n    } as MarkdownDialogsParams,\n  });\n};\n","import React, { useState, useRef, useEffect } from 'react';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport inRange from 'lodash/inRange';\nimport {\n  ModalContent,\n  ModalControls,\n  Button,\n  Form,\n  FormControl,\n  TextInput,\n} from '@contentful/f36-components';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\n\ntype InsertTableModalPositiveResult = { cols: number; rows: number };\nexport type InsertTableModalResult = InsertTableModalPositiveResult | false | undefined;\n\ntype InsertTableModalProps = {\n  onClose: (result: InsertTableModalResult) => void;\n};\n\nexport const InsertTableModal = ({ onClose }: InsertTableModalProps) => {\n  const mainInputRef = useRef<HTMLInputElement>(null);\n  const [rows, setRows] = useState(2);\n  const [cols, setColumns] = useState(1);\n  const rowsAreValid = inRange(rows, 2, 100);\n  const colsAreValid = inRange(cols, 1, 100);\n\n  useEffect(() => {\n    if (mainInputRef.current?.focus) {\n      mainInputRef.current.focus();\n    }\n  }, [mainInputRef]);\n\n  return (\n    <>\n      <ModalContent testId=\"insert-table-modal\">\n        <Form>\n          <FormControl id=\"insert-table-rows-number-field\" isRequired isInvalid={!rowsAreValid}>\n            <FormControl.Label>Number of rows</FormControl.Label>\n            <TextInput\n              name=\"rows\"\n              value={rows.toString()}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => setRows(Number(e.target.value))}\n              testId=\"insert-table-rows-number-field\"\n              min={2}\n              max={100}\n              pattern=\"[1-9][0-9]*\"\n              type=\"number\"\n              width=\"small\"\n              autoComplete=\"off\"\n              ref={mainInputRef}\n            />\n            {!rowsAreValid && (\n              <FormControl.ValidationMessage>\n                Should be between 2 and 100\n              </FormControl.ValidationMessage>\n            )}\n          </FormControl>\n\n          <FormControl id=\"insert-table-columns-number-field\" isRequired isInvalid={!colsAreValid}>\n            <FormControl.Label>Number of columns</FormControl.Label>\n            <TextInput\n              name=\"columns\"\n              value={cols.toString()}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                setColumns(Number(e.target.value))\n              }\n              testId=\"insert-table-columns-number-field\"\n              min={1}\n              max={100}\n              pattern=\"[1-9][0-9]*\"\n              type=\"number\"\n              width=\"small\"\n              autoComplete=\"off\"\n            />\n            {!colsAreValid && (\n              <FormControl.ValidationMessage>\n                Should be between 1 and 100\n              </FormControl.ValidationMessage>\n            )}\n          </FormControl>\n        </Form>\n      </ModalContent>\n      <ModalControls>\n        <Button\n          testId=\"insert-table-cancel\"\n          onClick={() => onClose(false)}\n          variant=\"secondary\"\n          size=\"small\">\n          Cancel\n        </Button>\n        <Button\n          testId=\"insert-table-confirm\"\n          onClick={() => onClose({ rows, cols })}\n          variant=\"positive\"\n          size=\"small\"\n          isDisabled={!rowsAreValid || !colsAreValid}>\n          Insert\n        </Button>\n      </ModalControls>\n    </>\n  );\n};\n\nexport const openInsertTableDialog = (dialogs: DialogsAPI): Promise<InsertTableModalResult> => {\n  return dialogs.openCurrent({\n    title: 'Insert table',\n    width: 'medium',\n    minHeight: '260px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.insertTable,\n    } as MarkdownDialogsParams,\n  });\n};\n","import React, { useState, useRef, useEffect } from 'react';\nimport { css } from 'emotion';\nimport tokens from '@contentful/f36-tokens';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\nimport {\n  ModalContent,\n  ModalControls,\n  Text,\n  TextLink,\n  Button,\n  Checkbox,\n  Radio,\n  Form,\n  FormControl,\n  TextInput,\n} from '@contentful/f36-components';\nimport { isValidUrl } from '../utils/isValidUrl';\n\nconst styles = {\n  widthFiledGroup: css({\n    display: 'flex',\n    flexWrap: 'nowrap',\n    alignItems: 'flex-start',\n  }),\n  radioButtonGroup: css({\n    display: 'inline-flex',\n    alignItems: 'flex-start',\n    paddingTop: tokens.spacingXl,\n  }),\n  radioButton: css({\n    marginLeft: tokens.spacingM,\n  }),\n};\n\nexport type EmbedExternalContentModalResult = string | false | undefined;\n\ntype EmbedExternalContentModalProps = {\n  onClose: (result: EmbedExternalContentModalResult) => void;\n};\n\ntype Unit = 'percent' | 'px';\n\nconst makeEmbedlyLink = ({\n  url,\n  width,\n  selectedUnit,\n  attachSocial,\n}: {\n  url: string;\n  width: number;\n  selectedUnit: Unit;\n  attachSocial: boolean;\n}): string => {\n  const s = { percent: '%', px: 'px' };\n  return [\n    '<a href=\"' + url + '\" class=\"embedly-card\" ',\n    'data-card-width=\"' + width + s[selectedUnit] + '\" ',\n    'data-card-controls=\"' + (attachSocial ? '1' : '0') + '\"',\n    '>Embedded content: ' + url + '</a>',\n  ].join('');\n};\n\nconst isWidthValid = (width: number, unit: Unit) => (unit === 'percent' ? width <= 100 : true);\n\nexport const EmbedExternalContentModal = ({ onClose }: EmbedExternalContentModalProps) => {\n  const mainInputRef = useRef<HTMLInputElement>(null);\n  const [url, setUrl] = useState<string>('https://');\n  const [selectedUnit, setUnit] = useState<Unit>('percent');\n  const [urlIsValid, setUrlValidity] = useState<boolean>(true);\n  const [width, setWidth] = useState('100');\n  const [attachSocial, setAttachSocial] = useState(false);\n\n  useEffect(() => {\n    if (mainInputRef.current?.focus) {\n      mainInputRef.current.focus();\n    }\n  }, [mainInputRef]);\n\n  return (\n    <>\n      <ModalContent testId=\"embed-external-dialog\">\n        <Form>\n          <FormControl id=\"external-link-url-field\" isRequired isInvalid={!urlIsValid}>\n            <FormControl.Label>Content URL</FormControl.Label>\n            <TextInput\n              name=\"external-link-url\"\n              value={url}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                const value = e.target.value;\n                setUrl(value);\n                setUrlValidity(isValidUrl(value));\n              }}\n              testId=\"external-link-url-field\"\n              placeholder=\"https://example.com\"\n              ref={mainInputRef}\n            />\n            <FormControl.HelpText>Include protocol (e.g. https://)</FormControl.HelpText>\n            {!urlIsValid && (\n              <FormControl.ValidationMessage>URL is invalid</FormControl.ValidationMessage>\n            )}\n          </FormControl>\n          <TextLink href=\"http://embed.ly/providers\" target=\"_blank\" rel=\"noopener noreferrer\">\n            Supported sources\n          </TextLink>\n          <div className={styles.widthFiledGroup}>\n            <FormControl\n              id=\"embedded-content-width\"\n              isRequired\n              isInvalid={!isWidthValid(Number(width), selectedUnit)}>\n              <FormControl.Label>Width</FormControl.Label>\n              <TextInput\n                value={width}\n                name=\"embedded-content-width\"\n                testId=\"embedded-content-width\"\n                type=\"number\"\n                width=\"small\"\n                onChange={(e: React.ChangeEvent<HTMLInputElement>) => setWidth(e.target.value)}\n              />\n              {!isWidthValid(Number(width), selectedUnit) && (\n                <FormControl.ValidationMessage>\n                  Should be equal or less then 100\n                </FormControl.ValidationMessage>\n              )}\n            </FormControl>\n\n            <div className={styles.radioButtonGroup}>\n              <Radio\n                id=\"unit-option-percent\"\n                value=\"percent\"\n                isChecked={selectedUnit === 'percent'}\n                onChange={() => setUnit('percent')}\n                className={styles.radioButton}>\n                percent\n              </Radio>\n              <Radio\n                id=\"unit-option-pixels\"\n                value=\"pixels\"\n                isChecked={selectedUnit === 'px'}\n                onChange={() => setUnit('px')}\n                className={styles.radioButton}>\n                pixels\n              </Radio>\n            </div>\n          </div>\n          <Checkbox\n            id=\"attach-social-checkbox\"\n            name=\"attach-social-checkbox\"\n            value=\"Yes\"\n            isChecked={attachSocial}\n            onChange={() => setAttachSocial(!attachSocial)}\n            testId=\"attach-social-checkbox\">\n            Attach social sharing links to this element\n          </Checkbox>\n          <Text as=\"p\" fontColor=\"gray500\" marginTop=\"spacingXs\">\n            To enable this embedded content in your application make sure to add the&nbsp;\n            <TextLink\n              href=\"http://embed.ly/docs/products/cards\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\">\n              Embedly&apos;s platform.js\n            </TextLink>\n            &nbsp;on your development environment\n          </Text>\n          {/* <EmbedlyPreview previewUrl={url} /> */}\n        </Form>\n      </ModalContent>\n      <ModalControls>\n        <Button\n          testId=\"emded-external-cancel\"\n          onClick={() => onClose(false)}\n          variant=\"secondary\"\n          size=\"small\">\n          Cancel\n        </Button>\n        <Button\n          testId=\"embed-external-confirm\"\n          onClick={() =>\n            onClose(makeEmbedlyLink({ url, width: Number(width), selectedUnit, attachSocial }))\n          }\n          variant=\"positive\"\n          size=\"small\">\n          Insert\n        </Button>\n      </ModalControls>\n    </>\n  );\n};\n\nexport const openEmbedExternalContentDialog = (\n  dialogs: DialogsAPI\n): Promise<EmbedExternalContentModalResult> => {\n  return dialogs.openCurrent({\n    title: 'Embed external content',\n    width: 'large',\n    minHeight: '435px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.embedExternalContent,\n    } as MarkdownDialogsParams,\n  });\n};\n","import React from 'react';\nimport {\n  ModalContent,\n  ModalControls,\n  Paragraph,\n  Button,\n  EntityList,\n} from '@contentful/f36-components';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\n\ninterface ConfirmInsertAssetModalDialogProps {\n  onClose: (result: boolean) => void;\n  assets: Array<{\n    title: string;\n    description: string;\n    thumbnailUrl: string;\n    thumbnailAltText: string;\n  }>;\n  locale: string;\n}\n\nexport const ConfirmInsertAssetModalDialog = ({\n  onClose,\n  assets,\n  locale,\n}: ConfirmInsertAssetModalDialogProps) => {\n  const localesNumber = assets.length;\n\n  return (\n    <>\n      <ModalContent testId=\"confirm-insert-asset\">\n        <Paragraph>\n          {localesNumber === 1\n            ? `Link asset with missing file for locale ${locale}`\n            : `Link assets with missing files for locale ${locale}`}\n        </Paragraph>\n        <Paragraph>\n          {localesNumber === 1\n            ? 'Do you want to link to the file in its fallback locale?'\n            : 'Do you want to link to the files in their fallback locales?'}\n        </Paragraph>\n        <EntityList>\n          {assets.map(({ title, description, thumbnailUrl, thumbnailAltText }) => (\n            <EntityList.Item\n              key={thumbnailUrl}\n              title={title}\n              thumbnailUrl={`${thumbnailUrl}?w=46&h=46&fit=thumb`}\n              thumbnailAltText={thumbnailAltText}\n              description={description}\n            />\n          ))}\n        </EntityList>\n      </ModalContent>\n      <ModalControls>\n        <Button onClick={() => onClose(false)} variant=\"secondary\" size=\"small\">\n          Cancel\n        </Button>\n        <Button\n          testId=\"confirm-insert-asset\"\n          onClick={() => onClose(true)}\n          variant=\"positive\"\n          size=\"small\">\n          Confirm\n        </Button>\n      </ModalControls>\n    </>\n  );\n};\n\nexport const openConfirmInsertAsset = (\n  dialogs: DialogsAPI,\n  options: {\n    locale: string;\n    assets: Array<{\n      title: string;\n      description: string;\n      thumbnailUrl: string;\n      thumbnailAltText: string;\n    }>;\n  }\n): Promise<boolean> => {\n  return dialogs.openCurrent({\n    title: 'Confirm using fallback assets',\n    width: 'medium',\n    minHeight: '270px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.confirmInsertAsset,\n      ...options,\n    } as MarkdownDialogsParams,\n  });\n};\n","import React from 'react';\nimport { css, cx } from 'emotion';\nimport { DialogsAPI, DialogExtensionSDK } from '@contentful/app-sdk';\nimport { MarkdownDialogType, MarkdownDialogsParams, PreviewComponents } from '../types';\nimport { InitializedEditorType } from '../components/MarkdownTextarea/MarkdownTextarea';\nimport { MarkdownToolbar } from '../components/MarkdownToolbar';\nimport { MarkdownTextarea } from '../components/MarkdownTextarea/MarkdownTextarea';\nimport { MarkdownPreview } from '../components/MarkdownPreview';\nimport { MarkdownBottomBar, MarkdownHelp } from '../components/MarkdownBottomBar';\nimport { createMarkdownActions } from '../MarkdownActions';\nimport { openCheatsheetModal } from '../dialogs/CheatsheetModalDialog';\nimport tokens from '@contentful/f36-tokens';\n\nimport { ChevronRightIcon, ChevronLeftIcon } from '@contentful/f36-icons';\n\nexport type ZenModeResult = {\n  value: string;\n  cursor?: {\n    ch: number;\n    line: number;\n  };\n};\n\ntype ZenModeDialogProps = {\n  saveValueToSDK: (value: string | null | undefined) => void;\n  onClose: (result: ZenModeResult) => void;\n  initialValue: string;\n  locale: string;\n  sdk: DialogExtensionSDK;\n  previewComponents?: PreviewComponents;\n};\n\nconst styles = {\n  root: css({\n    position: 'fixed',\n    left: 0,\n    right: 0,\n    top: 0,\n    bottom: 0,\n  }),\n  topSplit: css({\n    position: 'fixed',\n    top: 0,\n    height: '48px',\n    left: 0,\n    right: 0,\n  }),\n  bottomSplit: css({\n    position: 'fixed',\n    bottom: 0,\n    left: 0,\n    right: 0,\n    height: '36px',\n  }),\n  editorSplit: css({\n    width: '50%',\n    position: 'fixed',\n    top: '48px',\n    left: 0,\n    bottom: '36px',\n    overflowX: 'hidden',\n    overflowY: 'scroll',\n  }),\n  editorSplitFullscreen: css({\n    left: 0,\n    right: 0,\n    width: '100%',\n  }),\n  previewSplit: css({\n    width: '50%',\n    position: 'fixed',\n    top: '48px',\n    right: 0,\n    bottom: '36px',\n    overflowX: 'hidden',\n    overflowY: 'scroll',\n  }),\n  separator: css({\n    position: 'fixed',\n    top: '48px',\n    bottom: '36px',\n    width: '1px',\n    background: tokens.gray400,\n    left: '50%',\n  }),\n  button: css({\n    position: 'fixed',\n    cursor: 'pointer',\n    zIndex: 105,\n    top: '49%',\n    height: '30px',\n    backgroundColor: tokens.gray100,\n    border: `1px solid ${tokens.gray400}`,\n    padding: 0,\n  }),\n  hideButton: css({\n    left: '50%',\n  }),\n  showButton: css({\n    right: 0,\n    borderRightWidth: 0,\n  }),\n  icon: css({\n    verticalAlign: 'middle',\n  }),\n};\n\nexport const ZenModeModalDialog = (props: ZenModeDialogProps) => {\n  const [currentValue, setCurrentValue] = React.useState<string>(props.initialValue ?? '');\n  const [showPreview, setShowPreview] = React.useState<boolean>(true);\n  const [editor, setEditor] = React.useState<InitializedEditorType | null>(null);\n\n  React.useEffect(() => {\n    // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n    props.sdk?.window?.updateHeight('100%' as any);\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, []);\n\n  // refresh editor right after dialog is opened to avoid disappearing effect\n  React.useEffect(() => {\n    setTimeout(() => {\n      editor?.setFullsize();\n      editor?.refresh();\n    }, 150);\n  }, [editor]);\n\n  const actions = React.useMemo(() => {\n    return createMarkdownActions({ sdk: props.sdk, editor, locale: props.locale });\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, [editor]);\n\n  actions.closeZenMode = () => {\n    props.onClose({\n      value: currentValue,\n      cursor: editor?.getCursor(),\n    });\n  };\n\n  const direction = props.sdk.locales.direction[props.locale] ?? 'ltr';\n\n  return (\n    <div className={styles.root} data-test-id=\"zen-mode-markdown-editor\">\n      <div className={styles.topSplit}>\n        <MarkdownToolbar mode=\"zen\" disabled={false} canUploadAssets={false} actions={actions} />\n      </div>\n\n      <div\n        className={cx(styles.editorSplit, {\n          [styles.editorSplitFullscreen]: showPreview === false,\n        })}>\n        <MarkdownTextarea\n          mode=\"zen\"\n          visible\n          disabled={false}\n          direction={direction}\n          onReady={(editor) => {\n            editor.setContent(props.initialValue ?? '');\n            editor.setReadOnly(false);\n            setEditor(editor);\n            editor.focus();\n            editor.events.onChange((value: string) => {\n              setCurrentValue(value);\n              props.saveValueToSDK(value);\n            });\n          }}\n        />\n      </div>\n      {showPreview && (\n        <div className={styles.previewSplit}>\n          <MarkdownPreview\n            direction={direction}\n            mode=\"zen\"\n            value={currentValue}\n            previewComponents={props.previewComponents}\n          />\n        </div>\n      )}\n      {showPreview && <div className={styles.separator} />}\n      {showPreview && (\n        <button\n          className={cx(styles.button, styles.hideButton)}\n          aria-label=\"Hide preview\"\n          onClick={() => {\n            setShowPreview(false);\n          }}>\n          <ChevronRightIcon variant=\"muted\" size=\"tiny\" className={styles.icon} />\n        </button>\n      )}\n      {!showPreview && (\n        <button\n          className={cx(styles.button, styles.showButton)}\n          aria-label=\"Show preview\"\n          onClick={() => {\n            setShowPreview(true);\n          }}>\n          <ChevronLeftIcon variant=\"muted\" size=\"tiny\" className={styles.icon} />\n        </button>\n      )}\n      <div className={styles.bottomSplit}>\n        <MarkdownBottomBar>\n          <MarkdownHelp\n            onClick={() => {\n              openCheatsheetModal(props.sdk.dialogs);\n            }}\n          />\n        </MarkdownBottomBar>\n      </div>\n    </div>\n  );\n};\n\nexport const openZenMode = (\n  dialogs: DialogsAPI,\n  options: { initialValue: string; locale: string }\n): Promise<ZenModeResult> => {\n  return dialogs.openCurrent({\n    width: 'zen' as any, // eslint-disable-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n    shouldCloseOnEscapePress: false,\n    minHeight: '100vh',\n    shouldCloseOnOverlayClick: false,\n    parameters: {\n      type: MarkdownDialogType.zenMode,\n      initialValue: options.initialValue,\n      locale: options.locale,\n    } as MarkdownDialogsParams,\n  });\n};\n","import get from 'lodash/get';\nimport isObject from 'lodash/isObject';\n\n// eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\ntype Asset = any;\n\ntype LinkWithMedia = {\n  title: string;\n  asset: Asset;\n  url: string;\n  isLocalized: boolean;\n  isFallback: boolean;\n  asMarkdown: string;\n};\n\ntype Locales = {\n  localeCode: string;\n  fallbackCode: string | undefined;\n  defaultLocaleCode: string;\n};\n\nfunction normalizeWhiteSpace(str: string) {\n  if (str) {\n    return str.trim().replace(/\\s{2,}/g, ' ');\n  } else {\n    return str;\n  }\n}\n\nfunction removeExtension(str: string) {\n  return str.replace(/\\.\\w+$/g, '');\n}\n\nfunction fileNameToTitle(str: string) {\n  return normalizeWhiteSpace(removeExtension(str).replace(/_/g, ' '));\n}\n\nexport function replaceAssetDomain(fileUrl: string) {\n  const assetDomainMap: Record<string, string> = {\n    images: 'images.ctfassets.net',\n    assets: 'assets.ctfassets.net',\n    downloads: 'downloads.ctfassets.net',\n    videos: 'videos.ctfassets.net',\n  };\n\n  return fileUrl.replace(/(images|assets|downloads|videos).contentful.com/, (_, p1) => {\n    return assetDomainMap[p1];\n  });\n}\n\nfunction makeAssetLink(\n  asset: Asset,\n  { localeCode, fallbackCode, defaultLocaleCode }: Locales\n): LinkWithMedia | null {\n  const localizedFile = get(asset, ['fields', 'file', localeCode]);\n  const fallbackFile = fallbackCode ? get(asset, ['fields', 'file', fallbackCode]) : null;\n  const defaultFile = get(asset, ['fields', 'file', defaultLocaleCode]);\n  const file:\n    | {\n        url: string;\n        fileName: string;\n      }\n    | undefined = localizedFile || fallbackFile || defaultFile;\n\n  if (isObject(file) && file.url) {\n    const title: string =\n      get(asset, ['fields', 'title', localeCode]) ||\n      get(asset, ['fields', 'title', fallbackCode || '']) ||\n      get(asset, ['fields', 'title', defaultLocaleCode]) ||\n      fileNameToTitle(file.fileName);\n\n    const fileUrl = replaceAssetDomain(file.url);\n\n    return {\n      title,\n      asset,\n      url: fileUrl,\n      // is normally localized and we should not warn about this file\n      isLocalized: Boolean(localizedFile),\n      // was fallback value used\n      // if it was not localized normally, and we did not used a fallback\n      // it means we used a default locale - we filter empty values\n      isFallback: Boolean(fallbackFile),\n      // todo: tranform using fromHostname\n      asMarkdown: `![${title}](${fileUrl})`,\n    };\n  } else {\n    return null;\n  }\n}\n\nexport async function insertAssetLinks(assets: Array<Asset>, locales: Locales) {\n  // check whether do we have some assets, which don't have\n  // a version in this field's locale\n  const otherLocales = assets.filter((asset) => {\n    return !get(asset, ['fields', 'file', locales.localeCode]);\n  });\n\n  const linksWithMeta = assets\n    .map((asset) => makeAssetLink(asset, locales))\n    // remove empty links\n    .filter((asset) => asset !== null) as LinkWithMedia[];\n\n  // if there have values from fallback/default locales, we need to\n  // provide user a warning so we show him modal\n  if (otherLocales.length > 0) {\n    const fallbackAssets = linksWithMeta\n      // we don't want to warn about normally localized files\n      .filter(({ isLocalized }) => !isLocalized)\n      .map(({ title, isFallback, asset }) => {\n        const code = isFallback ? locales.fallbackCode : locales.defaultLocaleCode;\n        return {\n          title,\n          thumbnailUrl: asset.fields.file[code as string].url,\n          thumbnailAltText: title,\n          description: isFallback ? `Fallback locale (${code})` : `Default locale (${code})`,\n          asset: asset,\n        };\n      });\n\n    return {\n      fallbacks: fallbackAssets,\n      links: linksWithMeta,\n    };\n  }\n  return {\n    links: linksWithMeta,\n  };\n}\n","/* eslint-disable @typescript-eslint/no-use-before-define, @typescript-eslint/no-explicit-any */\n\nimport extend from 'lodash/extend';\nimport isString from 'lodash/isString';\nimport isObject from 'lodash/isObject';\nimport max from 'lodash/max';\n// eslint-disable-next-line -- TODO: describe this disable\nimport isFinite from 'lodash/isFinite';\n// eslint-disable-next-line -- TODO: describe this disable\nimport forEach from 'lodash/forEach';\n\nfunction extractTitle(title: string) {\n  title = title || '';\n  title = title.replace(/^ *('|\"|\\()*/, '');\n  title = title.replace(/('|\"|\\))* *$/, '');\n  return title;\n}\n\nfunction head(text: string) {\n  return text.split(' ').shift();\n}\n\nfunction tail(text: string) {\n  const segments = text.split(' ');\n  segments.shift();\n  return segments.join(' ');\n}\n\nconst PROCESSORS = {\n  inline: function (match: any) {\n    return {\n      match: match[0],\n      text: match[1],\n      href: head(match[2]),\n      title: extractTitle(tail(match[2])),\n    };\n  },\n  ref: function (match: any) {\n    return {\n      match: match[0],\n      text: match[1],\n      id: match[2],\n    };\n  },\n  label: function (match: any) {\n    return {\n      match: match[0],\n      id: match[1],\n      href: head(match[2]),\n      title: extractTitle(tail(match[2])),\n    };\n  },\n};\n\nconst REGEXS = {\n  inline: /\\[([^\\r\\n[\\]]+)]\\(([^\\r\\n)]+)\\)/,\n  ref: /\\[([^\\r\\n[\\]]+)] ?\\[([^\\r\\n[\\]]+)]/,\n  label: /^ {0,3}\\[([^\\r\\n[\\]]+)]:\\s+(.+)$/,\n};\nexport const findInline = makeFinder('inline');\nexport const findRefs = makeFinder('ref');\nexport const findLabels = makeFinder('label');\n\nexport function convertInlineToRef(text: string) {\n  let id = findMaxLabelId(text);\n\n  forEach(findInline(text), (inline) => {\n    id += 1;\n    text = text.replace(inline.match, buildRef(inline, id));\n    text += '\\n' + buildLabel(inline, id);\n  });\n\n  return text;\n}\n\nfunction mergeLabels(text: string): any {\n  const byHref: any = {};\n  const byOldId: any = {};\n\n  forEach(findLabels(text), (label) => {\n    const alreadyAdded = byHref[label.href];\n    const current = extend({}, label);\n\n    if (!alreadyAdded) {\n      byHref[current.href] = current;\n    } else if (hasTitle(current) && !hasTitle(alreadyAdded)) {\n      alreadyAdded.title = current.title;\n    }\n\n    byOldId[current.id] = alreadyAdded || current;\n  });\n\n  return {\n    byHref: byHref,\n    byOldId: byOldId,\n  };\n}\n\nexport function rewriteRefs(text: string) {\n  const merged = mergeLabels(text);\n  const hrefToRefId: any = {};\n  const labels: any[] = [];\n  const rewrites: any[] = [];\n  let i = 1;\n\n  // 1. compose list of labels with new ids, in order\n  forEach(findRefs(text), (ref) => {\n    const oldLabel = merged.byOldId[ref.id];\n    if (!oldLabel) {\n      return;\n    }\n    const href = oldLabel.href;\n    let newRefId = hrefToRefId[href];\n\n    if (!newRefId) {\n      hrefToRefId[href] = newRefId = i;\n      i += 1;\n      labels.push(extend({ newId: newRefId }, oldLabel));\n    }\n\n    // 1b. prepare rewrites to be applied, with new label ids\n    rewrites.push(extend({ newId: newRefId }, ref));\n  });\n\n  // 2. remove all labels!\n  forEach(findLabels(text), (label) => {\n    text = text.replace(label.match, '');\n  });\n\n  // 3. remove whitespace from the end of text\n  text = text.replace(/[\\r\\n\\s]*$/, '');\n  text += '\\n\\n';\n\n  // 4. apply rewrites\n  forEach(rewrites, (ref) => {\n    text = text.replace(ref.match, buildRef(ref, ref.newId));\n  });\n\n  // 5. print new labels at the end of text\n  forEach(labels, (label) => {\n    text += '\\n' + buildLabel(label, label.newId);\n  });\n\n  return text;\n}\n\n/**\n * Finding stuff\n */\n\nfunction makeFinder(type: 'inline' | 'ref' | 'label'): (text: string) => Array<any> {\n  return (text: string) => findAll(text, type).map(PROCESSORS[type] as any);\n}\n\nexport function findMaxLabelId(textOrLabels: any): number {\n  if (isString(textOrLabels)) {\n    textOrLabels = findLabels(textOrLabels);\n  }\n\n  const ids = textOrLabels\n    .map((x: any) => x.id)\n    .map((x: any) => parseInt(x, 10))\n    .filter((x: any) => isFinite(x) && x > 0);\n\n  return ids.length > 0 ? max(ids) || 0 : 0;\n}\n\nfunction findAll(text: string, type: 'inline' | 'ref' | 'label') {\n  const flags = 'g' + (type === 'label' ? 'm' : '');\n  const matches = [];\n  const re = new RegExp(REGEXS[type].source, flags);\n  let found = re.exec(text);\n\n  while (found) {\n    matches.push(found);\n    re.lastIndex = found.index + found[0].length;\n    found = re.exec(text);\n  }\n\n  return matches;\n}\n\n/**\n * Other utilities\n */\n\nfunction hasTitle(link: { title: string }) {\n  return isObject(link) && isString(link.title) && link.title.length > 0;\n}\n\nfunction buildLabel(link: { href: string; title: string }, id: number) {\n  let markup = '[' + id + ']: ' + link.href;\n  if (hasTitle(link)) {\n    markup += ' \"' + link.title + '\"';\n  }\n  return markup;\n}\n\nfunction buildRef(link: { text: string }, id: number) {\n  return '[' + link.text + '][' + id + ']';\n}\n","import { InitializedEditorType } from './components/MarkdownTextarea/MarkdownTextarea';\nimport { KnownSDK } from '@contentful/app-sdk';\nimport { openInsertLinkDialog } from './dialogs/InsertLinkModalDialog';\nimport { openInsertSpecialCharacter } from './dialogs/SpecialCharacterModalDialog';\nimport { openInsertTableDialog } from './dialogs/InsertTableModalDialog';\nimport { openEmbedExternalContentDialog } from './dialogs/EmdebExternalContentDialog';\nimport { openConfirmInsertAsset } from './dialogs/ConfirmInsertAssetModalDialog';\nimport { openZenMode } from './dialogs/ZenModeModalDialog';\nimport { insertAssetLinks } from './utils/insertAssetLinks';\nimport * as LinkOrganizer from './utils/linkOrganizer';\n\nexport function createMarkdownActions(props: {\n  sdk: KnownSDK;\n  editor: InitializedEditorType | null;\n  locale: string;\n}) {\n  const { sdk, editor, locale } = props;\n\n  // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/ban-types\n  const insertAssetsWithConfirmation = async (assets: Array<Object> | null) => {\n    if (assets) {\n      const { links, fallbacks } = await insertAssetLinks(assets, {\n        localeCode: locale,\n        defaultLocaleCode: sdk.locales.default,\n        fallbackCode: sdk.locales.fallbacks[locale],\n      });\n      if (links && links.length > 0) {\n        if (fallbacks) {\n          const insertAnyway = await openConfirmInsertAsset(sdk.dialogs, {\n            locale: locale,\n            assets: fallbacks,\n          });\n          if (!insertAnyway) {\n            throw Error('User decided to not use fallbacks');\n          }\n        }\n        return links.map((link) => link.asMarkdown).join('\\n\\n');\n      }\n    }\n    return '';\n  };\n\n  return {\n    headings: {\n      h1: () => {\n        editor?.actions.h1();\n      },\n      h2: () => {\n        editor?.actions.h2();\n      },\n      h3: () => {\n        editor?.actions.h3();\n      },\n    },\n    simple: {\n      italic: () => {\n        editor?.actions.italic();\n      },\n      bold: () => {\n        editor?.actions.bold();\n      },\n      quote: () => {\n        editor?.actions.quote();\n      },\n      ol: () => {\n        editor?.actions.ol();\n      },\n      ul: () => {\n        editor?.actions.ul();\n      },\n      strike: () => {\n        editor?.actions.strike();\n      },\n      code: () => {\n        editor?.actions.code();\n      },\n      hr: () => {\n        editor?.actions.hr();\n      },\n      indent: () => {\n        editor?.actions.indent();\n      },\n      dedent: () => {\n        editor?.actions.dedent();\n      },\n    },\n    history: {\n      undo: () => {\n        editor?.actions.undo();\n      },\n      redo: () => {\n        editor?.actions.redo();\n      },\n    },\n    insertLink: async () => {\n      if (!editor) {\n        return;\n      }\n      editor.usePrimarySelection();\n      const selectedText = editor.getSelectedText();\n      const result = await openInsertLinkDialog(sdk.dialogs, { selectedText });\n      if (result) {\n        editor.actions.link(result.url, selectedText || result.text, result.title);\n      }\n    },\n    insertSpecialCharacter: async () => {\n      if (!editor) {\n        return;\n      }\n      const result = await openInsertSpecialCharacter(sdk.dialogs);\n      if (result) {\n        editor.insert(result);\n      }\n    },\n    insertTable: async () => {\n      if (!editor) {\n        return;\n      }\n      const result = await openInsertTableDialog(sdk.dialogs);\n      if (result) {\n        editor.actions.table(result);\n      }\n    },\n    organizeLinks: () => {\n      if (!editor) {\n        return;\n      }\n      let text = editor.getContent();\n      if (!text) {\n        return;\n      }\n      text = LinkOrganizer.convertInlineToRef(text);\n      text = LinkOrganizer.rewriteRefs(text);\n      editor.setContent(text);\n      sdk.notifier.success('All your links are now references at the bottom of your document.');\n    },\n    embedExternalContent: async () => {\n      if (!editor) {\n        return;\n      }\n      const result = await openEmbedExternalContentDialog(sdk.dialogs);\n      if (result) {\n        editor.insert(result);\n      }\n    },\n    addNewMedia: async () => {\n      if (!editor) {\n        return;\n      }\n      try {\n        const { entity: asset } = (await sdk.navigator.openNewAsset({\n          slideIn: { waitForClose: true },\n        })) as any; // eslint-disable-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n\n        const markdownLinks = await insertAssetsWithConfirmation([asset]);\n        editor.insert(markdownLinks);\n      } finally {\n        editor.focus();\n      }\n    },\n    linkExistingMedia: async () => {\n      if (!editor) {\n        return;\n      }\n      try {\n        const assets = await sdk.dialogs.selectMultipleAssets({\n          locale: locale,\n        });\n        const markdownLinks = await insertAssetsWithConfirmation(assets);\n        editor.insert(markdownLinks);\n      } finally {\n        editor.focus();\n      }\n    },\n    openZenMode: async () => {\n      if (!editor) {\n        return;\n      }\n      const result = await openZenMode(sdk.dialogs, {\n        initialValue: editor.getContent(),\n        locale: props.locale,\n      });\n\n      editor.setContent(result.value);\n\n      if (result.cursor) {\n        editor.setCursor(result.cursor);\n      }\n\n      editor.focus();\n    },\n    closeZenMode: () => {\n      // do nothing\n      // this method is overwritten in dialog app\n    },\n  };\n}\n","import React from 'react';\nimport { css } from 'emotion';\nimport tokens from '@contentful/f36-tokens';\nimport { FieldConnector } from '@contentful/field-editor-shared';\nimport { FieldExtensionSDK } from '@contentful/app-sdk';\nimport { MarkdownTabs } from './components/MarkdownTabs';\nimport { MarkdownToolbar } from './components/MarkdownToolbar';\nimport { MarkdownTextarea } from './components/MarkdownTextarea/MarkdownTextarea';\nimport { InitializedEditorType } from './components/MarkdownTextarea/MarkdownTextarea';\nimport { MarkdownBottomBar, MarkdownHelp } from './components/MarkdownBottomBar';\nimport { MarkdownTab, PreviewComponents } from './types';\nimport { openCheatsheetModal } from './dialogs/CheatsheetModalDialog';\nimport { MarkdownPreview } from './components/MarkdownPreview';\nimport { MarkdownConstraints } from './components/MarkdownConstraints';\nimport { createMarkdownActions } from './MarkdownActions';\n\nconst styles = {\n  container: css({\n    display: 'flex',\n    flexDirection: 'column',\n    fontFamily: tokens.fontStackPrimary,\n  }),\n};\n\nexport interface MarkdownEditorProps {\n  /**\n   * is the field disabled initially\n   */\n  isInitiallyDisabled: boolean;\n  /**\n   * Minimum height to set for the markdown text area and preview\n   */\n  minHeight?: string | number;\n\n  sdk: FieldExtensionSDK;\n\n  previewComponents?: PreviewComponents;\n  onReady?: Function;\n}\n\nexport function MarkdownEditor(\n  props: MarkdownEditorProps & {\n    disabled: boolean;\n    initialValue: string | null | undefined;\n    saveValueToSDK: Function;\n  }\n) {\n  const [currentValue, setCurrentValue] = React.useState<string>(props.initialValue ?? '');\n  const [selectedTab, setSelectedTab] = React.useState<MarkdownTab>('editor');\n  const [editor, setEditor] = React.useState<InitializedEditorType | null>(null);\n  const [canUploadAssets, setCanUploadAssets] = React.useState<boolean>(false);\n\n  React.useEffect(() => {\n    if (editor && props.onReady) {\n      props.onReady(editor);\n      // fix: http://codemirror.977696.n3.nabble.com/codemirror-content-not-visible-in-bootstrap-modal-td4026988.html\n      setTimeout(() => {\n        editor.refresh();\n      }, 1);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, [editor]);\n\n  React.useEffect(() => {\n    props.sdk.access.can('create', 'Asset').then((value) => {\n      setCanUploadAssets(value);\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, []);\n\n  React.useEffect(() => {\n    if (editor) {\n      editor.setReadOnly(props.disabled);\n    }\n  }, [editor, props.disabled]);\n\n  const isActionDisabled = editor === null || props.disabled || selectedTab !== 'editor';\n\n  const direction = props.sdk.locales.direction[props.sdk.field.locale] ?? 'ltr';\n\n  const actions = React.useMemo(() => {\n    return createMarkdownActions({ sdk: props.sdk, editor, locale: props.sdk.field.locale });\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, [editor]);\n\n  const openMarkdownHelp = React.useCallback(() => {\n    openCheatsheetModal(props.sdk.dialogs);\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, []);\n\n  return (\n    <div className={styles.container} data-test-id=\"markdown-editor\">\n      <MarkdownTabs\n        active={selectedTab}\n        onSelect={(tab) => {\n          setSelectedTab(tab);\n        }}\n      />\n      <MarkdownToolbar\n        mode=\"default\"\n        disabled={isActionDisabled}\n        canUploadAssets={canUploadAssets}\n        actions={actions}\n      />\n      <MarkdownTextarea\n        minHeight={props.minHeight}\n        mode=\"default\"\n        visible={selectedTab === 'editor'}\n        disabled={isActionDisabled}\n        direction={direction}\n        onReady={(editor) => {\n          editor.setContent(props.initialValue ?? '');\n          editor.setReadOnly(props.disabled);\n          setEditor(editor);\n          editor.events.onChange((value: string) => {\n            // Trim empty lines\n            const trimmedValue = value.replace(/^\\s+$/gm, '');\n            props.saveValueToSDK(trimmedValue);\n            setCurrentValue(value);\n          });\n        }}\n      />\n      {selectedTab === 'preview' && (\n        <MarkdownPreview\n          direction={direction}\n          minHeight={props.minHeight}\n          mode=\"default\"\n          value={currentValue}\n          previewComponents={props.previewComponents}\n        />\n      )}\n      <MarkdownBottomBar>\n        <MarkdownHelp onClick={openMarkdownHelp} />\n      </MarkdownBottomBar>\n      <MarkdownConstraints sdk={props.sdk} value={currentValue} />\n    </div>\n  );\n}\n\nexport function MarkdownEditorConnected(props: MarkdownEditorProps) {\n  return (\n    <FieldConnector<string>\n      throttle={300}\n      field={props.sdk.field}\n      isInitiallyDisabled={props.isInitiallyDisabled}>\n      {({ value, disabled, setValue, externalReset }) => {\n        // on external change reset component completely and init with initial value again\n        return (\n          <MarkdownEditor\n            {...props}\n            key={`markdown-editor-${externalReset}`}\n            initialValue={value}\n            disabled={disabled}\n            saveValueToSDK={setValue}\n          />\n        );\n      }}\n    </FieldConnector>\n  );\n}\n","import React from 'react';\nimport {\n  FieldExtensionSDK,\n  DialogExtensionSDK,\n  OpenCustomWidgetOptions,\n} from '@contentful/app-sdk';\nimport { ModalDialogLauncher } from '@contentful/field-editor-shared';\nimport { MarkdownDialogsParams, PreviewComponents } from '../types';\n\nimport { CheatsheetModalDialog } from './CheatsheetModalDialog';\nimport { SpecialCharacterModalDialog } from './SpecialCharacterModalDialog';\nimport { MarkdownDialogType } from '../types';\nimport { InsertLinkModal, InsertLinkModalResult } from './InsertLinkModalDialog';\nimport { InsertTableModal, InsertTableModalResult } from './InsertTableModalDialog';\nimport { ConfirmInsertAssetModalDialog } from './ConfirmInsertAssetModalDialog';\nimport {\n  EmbedExternalContentModal,\n  EmbedExternalContentModalResult,\n} from './EmdebExternalContentDialog';\nimport { ZenModeModalDialog, ZenModeResult } from './ZenModeModalDialog';\n\nexport const openMarkdownDialog =\n  (sdk: FieldExtensionSDK, previewComponents?: PreviewComponents) =>\n  (\n    options: OpenCustomWidgetOptions & {\n      parameters?: MarkdownDialogsParams;\n    }\n  ) => {\n    if (options.parameters?.type === MarkdownDialogType.cheatsheet) {\n      return ModalDialogLauncher.openDialog(options, () => {\n        return <CheatsheetModalDialog />;\n      });\n    } else if (options.parameters?.type === MarkdownDialogType.insertLink) {\n      const selectedText = options.parameters.selectedText;\n      return ModalDialogLauncher.openDialog<InsertLinkModalResult>(options, ({ onClose }) => {\n        return <InsertLinkModal selectedText={selectedText} onClose={onClose} />;\n      });\n    } else if (options.parameters?.type === MarkdownDialogType.insertSpecialCharacter) {\n      return ModalDialogLauncher.openDialog(options, ({ onClose }) => {\n        return <SpecialCharacterModalDialog onClose={onClose} />;\n      });\n    } else if (options.parameters?.type === MarkdownDialogType.insertTable) {\n      return ModalDialogLauncher.openDialog<InsertTableModalResult>(options, ({ onClose }) => {\n        return <InsertTableModal onClose={onClose} />;\n      });\n    } else if (options.parameters?.type === MarkdownDialogType.embedExternalContent) {\n      return ModalDialogLauncher.openDialog<EmbedExternalContentModalResult>(\n        options,\n        ({ onClose }) => {\n          return <EmbedExternalContentModal onClose={onClose} />;\n        }\n      );\n    } else if (options.parameters?.type === MarkdownDialogType.confirmInsertAsset) {\n      const locale = options.parameters.locale;\n      const assets = options.parameters.assets;\n      return ModalDialogLauncher.openDialog<boolean>(options, ({ onClose }) => {\n        return <ConfirmInsertAssetModalDialog onClose={onClose} locale={locale} assets={assets} />;\n      });\n    } else if (options.parameters?.type === MarkdownDialogType.zenMode) {\n      const initialValue = options.parameters.initialValue;\n      const locale = options.parameters.locale;\n      return ModalDialogLauncher.openDialog<ZenModeResult>(options, ({ onClose }) => {\n        return (\n          <ZenModeModalDialog\n            saveValueToSDK={(value) => {\n              if (value) {\n                return sdk?.field?.setValue(value);\n              }\n              return sdk?.field?.removeValue();\n            }}\n            onClose={onClose}\n            initialValue={initialValue}\n            locale={locale}\n            sdk={sdk as unknown as DialogExtensionSDK}\n            previewComponents={previewComponents}\n          />\n        );\n      });\n    }\n    return Promise.reject();\n  };\n","import React from 'react';\nimport { DialogExtensionSDK } from '@contentful/app-sdk';\nimport { MarkdownDialogsParams, MarkdownDialogType } from '../types';\nimport { SpecialCharacterModalDialog } from './SpecialCharacterModalDialog';\nimport { CheatsheetModalDialog } from './CheatsheetModalDialog';\nimport { InsertLinkModal } from './InsertLinkModalDialog';\nimport { InsertTableModal } from './InsertTableModalDialog';\nimport { EmbedExternalContentModal } from './EmdebExternalContentDialog';\nimport { ConfirmInsertAssetModalDialog } from './ConfirmInsertAssetModalDialog';\nimport { ZenModeModalDialog } from './ZenModeModalDialog';\n\nexport const renderMarkdownDialog = (\n  sdk: DialogExtensionSDK & { parameters: { invocation: MarkdownDialogsParams } }\n) => {\n  const parameters = sdk.parameters.invocation;\n  if (parameters.type === MarkdownDialogType.cheatsheet) {\n    sdk.window.startAutoResizer();\n    return <CheatsheetModalDialog />;\n  } else if (parameters.type === MarkdownDialogType.insertLink) {\n    const selectedText = parameters.selectedText;\n    sdk.window.startAutoResizer();\n    return <InsertLinkModal selectedText={selectedText} onClose={sdk.close} />;\n  } else if (parameters.type === MarkdownDialogType.insertSpecialCharacter) {\n    sdk.window.startAutoResizer();\n    return <SpecialCharacterModalDialog onClose={sdk.close} />;\n  } else if (parameters.type === MarkdownDialogType.insertTable) {\n    sdk.window.startAutoResizer();\n    return <InsertTableModal onClose={sdk.close} />;\n  } else if (parameters.type === MarkdownDialogType.embedExternalContent) {\n    sdk.window.startAutoResizer();\n    return <EmbedExternalContentModal onClose={sdk.close} />;\n  } else if (parameters.type === MarkdownDialogType.confirmInsertAsset) {\n    const locale = parameters.locale;\n    const assets = parameters.assets;\n    sdk.window.startAutoResizer();\n    return <ConfirmInsertAssetModalDialog onClose={sdk.close} locale={locale} assets={assets} />;\n  } else if (parameters.type === MarkdownDialogType.zenMode) {\n    const locale = parameters.locale;\n    const initialValue = parameters.initialValue;\n    // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n    sdk.window.updateHeight('100%' as any);\n    return (\n      <ZenModeModalDialog\n        onClose={sdk.close}\n        saveValueToSDK={() => {\n          // don't save changes in dialog mode\n        }}\n        initialValue={initialValue}\n        locale={locale}\n        sdk={sdk}\n      />\n    );\n  }\n\n  return <div />;\n};\n"],"names":["styles","root","css","display","zIndex","flexDirection","justifyContent","overflow","marginBottom","fontSize","tokens","fontSizeM","tab","cursor","color","gray700","padding","spacingXs","minWidth","border","gray400","borderTopLeftRadius","borderRadiusSmall","borderTopRightRadius","marginLeft","textAlign","backgroundColor","gray100","borderBottomColor","outline","boxShadow","boxShadowHeavy","transition","transitionEasingDefault","transitionDurationShort","inactiveTab","background","gray200","gray300","MarkdownTabItem","props","React","className","cx","isActive","onClick","onSelect","name","onKeyDown","e","keyCode","tabIndex","role","testId","children","MarkdownTabs","active","srOnly","position","width","height","margin","clip","Zen","label","rest","viewBox","d","Strikethrough","Indent","Dedent","Cubes","Table","SpecialChar","OrgLinks","Undo","Redo","HeadingSelector","handleMenuClick","heading","Menu","Trigger","List","Item","InsertLinkSelector","canAddNew","MultipleMediaContextMenu","Button","isDisabled","disabled","startIcon","AssetIcon","size","variant","onSelectExisting","placement","endIcon","ChevronDownIcon","onAddNew","Number","zIndexWorkbenchHeader","button","spacing2Xs","marginRight","icon","fill","verticalAlign","zenButton","zenButtonPressed","tooltip","zIndexTooltip","ToolbarButton","forwardRef","ref","tooltipPlace","otherProps","Tooltip","content","IconButton","MainButtons","mode","actions","headings","HeadingIcon","simple","bold","FormatBoldIcon","italic","FormatItalicIcon","quote","QuoteIcon","ul","ListBulletedIcon","ol","ListNumberedIcon","insertLink","LinkIcon","AdditionalButtons","strike","Icons","code","CodeIcon","hr","HorizontalRuleIcon","indent","dedent","embedExternalContent","insertTable","insertSpecialCharacter","organizeLinks","history","undo","redo","DefaultMarkdownToolbar","useState","showAdditional","setShowAdditional","Flex","MoreHorizontalIcon","linkExistingMedia","addNewMedia","canUploadAssets","openZenMode","marginTop","ZenMarkdownToolbar","closeZenMode","displayName","MarkdownToolbar","memo","userAgent","get","window","platform","ctrlKey","getCtrlKey","stripUnit","value","match","Error","parseFloat","createPrefixToggleFn","prefix","editor","lineStartsWith","removeFromLineBeginning","length","insertAtLineBeginning","wrapSelection","marker","emptyText","usePrimarySelection","getSelection","selectedText","getSelectedText","startsWith","endsWith","markerLength","textWithoutMarker","slice","replaceSelectedText","insertAtCursor","selectBackwards","test","MSStream","quoteToggleFn","codeToggleFn","create","modifySelection","link","url","text","title","h1","toggleHeader","h2","h3","ulToggleFn","olToggleFn","cmd","moveIfNotEmpty","nl","getNl","getIndentation","indentation","table","config","line","getCurrentLineNumber","nrows","ncols","cellWidth","Array","cell","join","separatorCell","baseRow","separatorRow","times","bodyRows","range","map","replace","concat","tableTemplate","rows","cols","restoreCursor","toggleFn","isList","selection","cb","lines","anchor","head","maxNumber","max","minNumber","min","undefined","forEach","lineNumber","i","listNumber","moveToLineBeginning","forLineIn","moveToLineEnd","getListNumber","isCurrentLineEmpty","isLineEmpty","linesToInsert","getLinesCount","prepareListWhitespace","result","getCurrentLine","n","level","initialCh","getCurrentCharacter","currentHeader","header","select","getPos","modifier","ch","selectHeader","repeat","extendSelectionBy","removedCh","getSelectionLength","removeSelectedText","diff","lineHeightDefault","spacingL","fontStackMonospace","gray900","red600","gray600","blue500","framed","maxHeight","zen","maxWidth","MarkdownTextarea","hostRef","useRef","setEditor","useEffect","current","host","options","direction","fixedHeight","readOnly","initializedWithValue","EDITOR_SIZE","shift","cm","CodeMirror","lineNumbers","undoDepth","matchBrackets","lineWrapping","lineSeparator","theme","tabSize","indentWithTabs","indentUnit","autoRefresh","spellcheck","inputStyle","setSize","on","throttle","heightAtLine","lastLine","next","setOption","Tab","Enter","Esc","getInputField","blur","destroy","toTextArea","disable","enable","attachEvent","fn","throttleInterval","addKeyShortcuts","addKeyMap","transform","acc","key","setValue","getValue","clearHistory","getCurrentLineLength","focus","skip","len","selectAll","execCommand","prop","wrapper","replacement","replaceRange","charCount","replaceSelection","getCursor","setCursor","getLine","defaultToCurrentLineNumber","lineCount","getHistorySize","which","historySize","setReadOnly","getHistory","setHistory","setFullsize","refresh","character","noFocus","scroll","from","to","setSelection","selections","listSelections","somethingSelected","getOption","what","CodeMirrorWrapper","api","Commands","hasUndo","hasRedo","events","onScroll","onChange","wrapChange","onPaste","insert","getContent","setContent","clear","B","I","createMarkdownEditor","Object","assign","minHeight","onReady","style","visible","MarkdownDialogType","borderBottomLeftRadius","borderBottomRightRadius","spacingS","help","fontSizeS","lineHeight","MarkdownHelp","Paragraph","TextLink","as","MarkdownBottomBar","flexColumnContainer","flexWrap","flexColumn","flexGrow","verticalDivider","borderRight","gray500","paddingRight","spacing3Xl","spacing2Xl","preview","unOrderedListPreview","listStyleType","orderedListPreview","markup","paddingLeft","fontSize2Xl","fontSizeXl","fontSizeL","helpItem","alignItems","spacingXl","helpLink","flexRowContainer","CheatsheetModalDialog","ModalContent","Heading","href","target","rel","openCheatsheetModal","dialogs","openCurrent","shouldCloseOnEscapePress","shouldCloseOnOverlayClick","parameters","type","cheatsheet","fontStackPrimary","spacingM","overflowY","rtl","MarkdownLink","Embedly","MarkdownPreview","cleanHTML","useMemo","DOMPurify","sanitize","Markdown","overrides","a","component","previewComponents","_props$previewCompone","embedly","MarkdownConstraints","constraints","ConstraintsUtils","fromFieldValidations","sdk","field","validations","checkConstraint","makeChecker","CharCounter","CharValidation","runtime","exports","Op","prototype","hasOwn","hasOwnProperty","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","obj","defineProperty","enumerable","configurable","writable","err","wrap","innerFn","outerFn","self","tryLocsList","generator","Generator","context","Context","_invoke","state","method","arg","done","delegate","delegateResult","maybeInvokeDelegate","ContinueSentinel","sent","_sent","dispatchException","abrupt","record","tryCatch","makeInvokeMethod","call","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","this","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","AsyncIterator","PromiseImpl","previousPromise","callInvokeWithMethodAndArg","resolve","reject","invoke","__await","then","unwrapped","error","TypeError","info","resultName","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","doneResult","isGeneratorFunction","genFun","ctor","constructor","mark","setPrototypeOf","__proto__","awrap","async","Promise","iter","keys","object","reverse","pop","skipTempReset","prev","charAt","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","module","regeneratorRuntime","accidentalStrictMode","globalThis","Function","urlRegex","isValidUrl","InsertLinkModal","onClose","mainInputRef","setText","setUrl","touched","setTouched","setTitle","onInsert","urlIsValid","_mainInputRef$current","Form","onSubmit","FormControl","id","Boolean","Label","TextInput","isInvalid","placeholder","maxLength","HelpText","ValidationMessage","ModalControls","specialCharacters","desc","buttonPanel","charButton","selectedCharButton","SpecialCharacterModalDialog","selectedCharacter","setSelectedCharacter","Text","String","fromCharCode","char","InsertTableModal","setRows","setColumns","rowsAreValid","inRange","colsAreValid","isRequired","toString","pattern","autoComplete","widthFiledGroup","radioButtonGroup","paddingTop","radioButton","isWidthValid","unit","EmbedExternalContentModal","selectedUnit","setUnit","setUrlValidity","setWidth","attachSocial","setAttachSocial","Radio","isChecked","Checkbox","fontColor","percent","px","makeEmbedlyLink","ConfirmInsertAssetModalDialog","assets","locale","localesNumber","EntityList","thumbnailUrl","thumbnailAltText","description","left","right","top","bottom","topSplit","bottomSplit","editorSplit","overflowX","editorSplitFullscreen","previewSplit","separator","hideButton","showButton","borderRightWidth","ZenModeModalDialog","initialValue","currentValue","setCurrentValue","showPreview","setShowPreview","updateHeight","setTimeout","createMarkdownActions","locales","saveValueToSDK","ChevronRightIcon","ChevronLeftIcon","makeAssetLink","asset","localeCode","fallbackCode","defaultLocaleCode","localizedFile","fallbackFile","defaultFile","file","isObject","str","trim","normalizeWhiteSpace","removeExtension","fileName","fileUrl","assetDomainMap","images","downloads","videos","_","p1","replaceAssetDomain","isLocalized","isFallback","asMarkdown","insertAssetLinks","otherLocales","filter","linksWithMeta","fallbackAssets","fields","fallbacks","links","extractTitle","split","tail","segments","PROCESSORS","inline","REGEXS","findInline","makeFinder","findRefs","findLabels","matches","re","RegExp","source","found","exec","lastIndex","index","findAll","hasTitle","isString","buildLabel","buildRef","insertAssetsWithConfirmation","confirmInsertAsset","merged","byHref","byOldId","alreadyAdded","extend","mergeLabels","hrefToRefId","labels","rewrites","oldLabel","newRefId","newId","LinkOrganizer","textOrLabels","ids","x","parseInt","isFinite","findMaxLabelId","notifier","success","navigator","openNewAsset","slideIn","waitForClose","entity","selectMultipleAssets","zenMode","container","fontFamily","MarkdownEditor","selectedTab","setSelectedTab","setCanUploadAssets","access","can","isActionDisabled","openMarkdownHelp","useCallback","trimmedValue","FieldConnector","isInitiallyDisabled","externalReset","ModalDialogLauncher","openDialog","_sdk$field","_sdk$field2","removeValue","invocation","startAutoResizer","close"],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"field-editor-markdown.cjs.production.min.js","sources":["../src/components/MarkdownTabs.tsx","../src/components/icons.tsx","../src/components/HeadingSelector.tsx","../src/components/InsertLinkSelector.tsx","../src/components/MarkdownToolbar.tsx","../src/utils/userAgent.ts","../src/components/MarkdownTextarea/CodeMirrorWrapper.ts","../src/components/MarkdownTextarea/MarkdownCommands.ts","../src/components/MarkdownTextarea/MarkdownTextarea.tsx","../src/components/MarkdownTextarea/createMarkdownEditor.ts","../src/types.ts","../src/components/MarkdownBottomBar.tsx","../src/dialogs/CheatsheetModalDialog.tsx","../src/components/MarkdownPreview.tsx","../src/utils/replaceMailtoAmp.ts","../src/components/MarkdownConstraints.tsx","../../../node_modules/regenerator-runtime/runtime.js","../src/utils/isValidUrl.ts","../src/dialogs/InsertLinkModalDialog.tsx","../src/utils/specialCharacters.ts","../src/dialogs/SpecialCharacterModalDialog.tsx","../src/dialogs/InsertTableModalDialog.tsx","../src/dialogs/EmdebExternalContentDialog.tsx","../src/dialogs/ConfirmInsertAssetModalDialog.tsx","../src/dialogs/ZenModeModalDialog.tsx","../src/utils/insertAssetLinks.ts","../src/utils/linkOrganizer.ts","../src/MarkdownActions.ts","../src/MarkdownEditor.tsx","../src/dialogs/openMarkdownDialog.tsx","../src/dialogs/renderMarkdownDialog.tsx"],"sourcesContent":["import React from 'react';\nimport { css, cx } from 'emotion';\nimport tokens from '@contentful/f36-tokens';\nimport { MarkdownTab } from '../types';\n\nconst styles = {\n  root: css({\n    display: 'flex',\n    zIndex: 10,\n    flexDirection: 'row',\n    justifyContent: 'flex-end',\n    overflow: 'hidden',\n    marginBottom: '-1px',\n    fontSize: tokens.fontSizeM,\n  }),\n  tab: css({\n    cursor: 'pointer',\n    color: tokens.gray700,\n    padding: tokens.spacingXs,\n    minWidth: '70px',\n    border: `1px solid ${tokens.gray400}`,\n    borderTopLeftRadius: tokens.borderRadiusSmall,\n    borderTopRightRadius: tokens.borderRadiusSmall,\n    marginLeft: tokens.spacingXs,\n    textAlign: 'center',\n    backgroundColor: tokens.gray100,\n    borderBottomColor: tokens.gray100,\n    outline: 'none',\n    '&:focus': {\n      boxShadow: tokens.boxShadowHeavy,\n    },\n    transition: `all ${tokens.transitionEasingDefault} ${tokens.transitionDurationShort}`,\n  }),\n  inactiveTab: css({\n    background: tokens.gray200,\n    borderBottomColor: tokens.gray400,\n    '&:hover': {\n      background: tokens.gray300,\n    },\n  }),\n};\n\ninterface MarkdownTabsProps {\n  active: MarkdownTab;\n  onSelect: (selected: MarkdownTab) => void;\n}\n\nfunction MarkdownTabItem(props: {\n  isActive: boolean;\n  name: MarkdownTab;\n  testId: string;\n  onSelect: (name: MarkdownTab) => void;\n  children: React.ReactNode;\n}) {\n  return (\n    <div\n      className={cx(styles.tab, {\n        [styles.inactiveTab]: props.isActive === false,\n      })}\n      onClick={() => {\n        props.onSelect(props.name);\n      }}\n      onKeyDown={(e) => {\n        if (e.keyCode === 13) {\n          props.onSelect(props.name);\n        }\n      }}\n      tabIndex={0}\n      role=\"tab\"\n      aria-controls={props.name}\n      aria-selected={props.isActive === true}\n      data-test-id={props.testId}>\n      {props.children}\n    </div>\n  );\n}\n\nexport function MarkdownTabs(props: MarkdownTabsProps) {\n  return (\n    <div className={styles.root}>\n      <MarkdownTabItem\n        name=\"editor\"\n        onSelect={props.onSelect}\n        isActive={props.active === 'editor'}\n        testId=\"markdown-tab-md\">\n        Editor\n      </MarkdownTabItem>\n      <MarkdownTabItem\n        name=\"preview\"\n        onSelect={props.onSelect}\n        isActive={props.active === 'preview'}\n        testId=\"markdown-tab-preview\">\n        Preview\n      </MarkdownTabItem>\n    </div>\n  );\n}\n","import React from 'react';\nimport { css } from 'emotion';\n\ntype IconProps = {\n  width?: number;\n  height?: number;\n  className?: string;\n  label: string;\n};\n\nconst srOnly = css({\n  position: 'absolute',\n  width: '1px',\n  height: '1px',\n  padding: '0',\n  margin: '-1px',\n  overflow: 'hidden',\n  clip: 'rect(0, 0, 0, 0)',\n  border: '0',\n});\n\nexport const Zen = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1411 541l-355 355 355 355 144-144q29-31 70-14 39 17 39 59v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l144-144-355-355-355 355 144 144q31 30 14 69-17 40-59 40H192q-26 0-45-19t-19-45v-448q0-42 40-59 39-17 69 14l144 144 355-355-355-355-144 144q-19 19-45 19-12 0-24-5-40-17-40-59V192q0-26 19-45t45-19h448q42 0 59 40 17 39-14 69L541 381l355 355 355-355-144-144q-31-30-14-69 17-40 59-40h448q26 0 45 19t19 45v448q0 42-39 59-13 5-25 5-26 0-45-19z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Strikethrough = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1760 896q14 0 23 9t9 23v64q0 14-9 23t-23 9H32q-14 0-23-9t-9-23v-64q0-14 9-23t23-9h1728zM483 832q-28-35-51-80-48-98-48-188 0-181 134-309 133-127 393-127 50 0 167 19 66 12 177 48 10 38 21 118 14 123 14 183 0 18-5 45l-12 3-84-6-14-2q-50-149-103-205-88-91-210-91-114 0-182 59-67 58-67 146 0 73 66 140t279 129q69 20 173 66 58 28 95 52H483zm507 256h411q7 39 7 92 0 111-41 212-23 56-71 104-37 35-109 81-80 48-153 66-80 21-203 21-114 0-195-23l-140-40q-57-16-72-28-8-8-8-22v-13q0-108-2-156-1-30 0-68l2-37v-44l102-2q15 34 30 71t22.5 56 12.5 27q35 57 80 94 43 36 105 57 59 22 132 22 64 0 139-27 77-26 122-86 47-61 47-129 0-84-81-157-34-29-137-71z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Indent = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M352 832q0 14-9 23L55 1143q-9 9-23 9-13 0-22.5-9.5T0 1120V544q0-13 9.5-22.5T32 512q14 0 23 9l288 288q9 9 9 23zm1440 480v192q0 13-9.5 22.5t-22.5 9.5H32q-13 0-22.5-9.5T0 1504v-192q0-13 9.5-22.5T32 1280h1728q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5t-22.5 9.5H672q-13 0-22.5-9.5T640 1120V928q0-13 9.5-22.5T672 896h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5T1760 768H672q-13 0-22.5-9.5T640 736V544q0-13 9.5-22.5T672 512h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5T1760 384H32q-13 0-22.5-9.5T0 352V160q0-13 9.5-22.5T32 128h1728q13 0 22.5 9.5t9.5 22.5z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Dedent = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M384 544v576q0 13-9.5 22.5T352 1152q-14 0-23-9L41 855q-9-9-9-23t9-23l288-288q9-9 23-9 13 0 22.5 9.5T384 544zm1408 768v192q0 13-9.5 22.5t-22.5 9.5H32q-13 0-22.5-9.5T0 1504v-192q0-13 9.5-22.5T32 1280h1728q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5t-22.5 9.5H672q-13 0-22.5-9.5T640 1120V928q0-13 9.5-22.5T672 896h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5T1760 768H672q-13 0-22.5-9.5T640 736V544q0-13 9.5-22.5T672 512h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5T1760 384H32q-13 0-22.5-9.5T0 352V160q0-13 9.5-22.5T32 128h1728q13 0 22.5 9.5t9.5 22.5z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Cubes = ({ label, ...rest }: IconProps) => (\n  <svg width={18} height={14} viewBox=\"0 0 2304 1792\" {...rest}>\n    <path d=\"M640 1632l384-192v-314l-384 164v342zm-64-454l404-173-404-173-404 173zm1088 454l384-192v-314l-384 164v342zm-64-454l404-173-404-173-404 173zm-448-293l384-165V454l-384 164v267zm-64-379l441-189-441-189-441 189zm1088 518v416q0 36-19 67t-52 47l-448 224q-25 14-57 14t-57-14l-448-224q-4-2-7-4-2 2-7 4l-448 224q-25 14-57 14t-57-14L71 1554q-33-16-52-47t-19-67v-416q0-38 21.5-70T78 906l434-186V320q0-38 21.5-70t56.5-48l448-192q23-10 50-10t50 10l448 192q35 16 56.5 48t21.5 70v400l434 186q36 16 57 48t21 70z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Table = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M576 1376v-192q0-14-9-23t-23-9H224q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm0-384V800q0-14-9-23t-23-9H224q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm512 384v-192q0-14-9-23t-23-9H736q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zM576 608V416q0-14-9-23t-23-9H224q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm512 384V800q0-14-9-23t-23-9H736q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm512 384v-192q0-14-9-23t-23-9h-320q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm-512-768V416q0-14-9-23t-23-9H736q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm512 384V800q0-14-9-23t-23-9h-320q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm0-384V416q0-14-9-23t-23-9h-320q-14 0-23 9t-9 23v192q0 14 9 23t23 9h320q14 0 23-9t9-23zm128-320v1088q0 66-47 113t-113 47H224q-66 0-113-47t-47-113V288q0-66 47-113t113-47h1344q66 0 113 47t47 113z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const SpecialChar = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1360 1307l35 159q3 12-3 22.5t-17 14.5l-5 1q-4 2-10.5 3.5t-16 4.5-21.5 5.5-25.5 5-30 5-33.5 4.5-36.5 3-38.5 1q-234 0-409-130.5T511 1054h-95q-13 0-22.5-9.5T384 1022V909q0-13 9.5-22.5T416 877h66q-2-57 1-105h-67q-14 0-23-9t-9-23V626q0-14 9-23t23-9h98q67-210 243.5-338T1158 128q102 0 194 23 11 3 20 15 6 11 3 24l-43 159q-3 13-14 19.5t-24 2.5l-4-1q-4-1-11.5-2.5L1261 364l-22.5-3.5-26-3-29-2.5-29.5-1q-126 0-226 64T778 594h468q16 0 25 12 10 12 7 26l-24 114q-5 26-32 26H734q-3 37 0 105h459q15 0 25 12 9 12 6 27l-24 112q-2 11-11 18.5t-20 7.5H782q48 117 149.5 185.5T1160 1308q18 0 36-1.5t33.5-3.5 29.5-4.5 24.5-5 18.5-4.5l12-3 5-2q13-5 26 2 12 7 15 21z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const OrgLinks = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1792 1248v320q0 40-28 68t-68 28h-320q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h96V960H960v192h96q40 0 68 28t28 68v320q0 40-28 68t-68 28H736q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h96V960H320v192h96q40 0 68 28t28 68v320q0 40-28 68t-68 28H96q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h96V960q0-52 38-90t90-38h512V640h-96q-40 0-68-28t-28-68V224q0-40 28-68t68-28h320q40 0 68 28t28 68v320q0 40-28 68t-68 28h-96v192h512q52 0 90 38t38 90v192h96q40 0 68 28t28 68z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Undo = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1664 896q0 156-61 298t-164 245-245 164-298 61q-172 0-327-72.5T305 1387q-7-10-6.5-22.5t8.5-20.5l137-138q10-9 25-9 16 2 23 12 73 95 179 147t225 52q104 0 198.5-40.5T1258 1258t109.5-163.5T1408 896t-40.5-198.5T1258 534t-163.5-109.5T896 384q-98 0-188 35.5T548 521l137 138q31 30 14 69-17 40-59 40H192q-26 0-45-19t-19-45V256q0-42 40-59 39-17 69 14l130 129q107-101 244.5-156.5T896 128q156 0 298 61t245 164 164 245 61 298z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n\nexport const Redo = ({ label, ...rest }: IconProps) => (\n  <svg width={14} height={14} viewBox=\"0 0 1792 1792\" {...rest}>\n    <path d=\"M1664 256v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l138-138q-148-137-349-137-104 0-198.5 40.5T534 534 424.5 697.5 384 896t40.5 198.5T534 1258t163.5 109.5T896 1408q119 0 225-52t179-147q7-10 23-12 15 0 25 9l137 138q9 8 9.5 20.5t-7.5 22.5q-109 132-264 204.5T896 1664q-156 0-298-61t-245-164-164-245-61-298 61-298 164-245 245-164 298-61q147 0 284.5 55.5T1425 340l130-129q29-31 70-14 39 17 39 59z\" />\n    <span className={srOnly}>{label}</span>\n  </svg>\n);\n","import React from 'react';\nimport { Menu } from '@contentful/f36-components';\nimport { HeadingType } from '../types';\n\nexport const HeadingSelector = (props: {\n  children: React.ReactElement;\n  onSelect: (heading: HeadingType) => void;\n  tooltip?: string;\n}) => {\n  const handleMenuClick = (heading: HeadingType) => {\n    props.onSelect(heading);\n  };\n\n  return (\n    <Menu>\n      <Menu.Trigger>{props.children}</Menu.Trigger>\n      <Menu.List>\n        <Menu.Item testId=\"markdown-action-button-heading-h1\" onClick={() => handleMenuClick('h1')}>\n          Heading 1\n        </Menu.Item>\n        <Menu.Item testId=\"markdown-action-button-heading-h2\" onClick={() => handleMenuClick('h2')}>\n          Heading 2\n        </Menu.Item>\n        <Menu.Item testId=\"markdown-action-button-heading-h3\" onClick={() => handleMenuClick('h3')}>\n          Heading 3\n        </Menu.Item>\n      </Menu.List>\n    </Menu>\n  );\n};\n","import React from 'react';\nimport { Menu } from '@contentful/f36-components';\n\nimport { Button } from '@contentful/f36-components';\n\nimport { AssetIcon, ChevronDownIcon } from '@contentful/f36-icons';\n\ninterface InsertLinkSelectorProps {\n  onSelectExisting: Function;\n  onAddNew: Function;\n  canAddNew: boolean;\n  disabled: boolean;\n}\n\nexport const InsertLinkSelector = (props: InsertLinkSelectorProps) => {\n  if (props.canAddNew) {\n    return <MultipleMediaContextMenu {...props} />;\n  } else {\n    return (\n      <Button\n        isDisabled={props.disabled}\n        startIcon={<AssetIcon />}\n        testId=\"markdownEditor.linkExistingAssets\"\n        size=\"small\"\n        variant=\"secondary\"\n        onClick={() => {\n          props.onSelectExisting();\n        }}>\n        Insert media\n      </Button>\n    );\n  }\n};\n\nconst MultipleMediaContextMenu = (props: InsertLinkSelectorProps) => {\n  return (\n    <Menu placement=\"bottom-end\">\n      <Menu.Trigger>\n        <Button\n          endIcon={<ChevronDownIcon />}\n          isDisabled={props.disabled}\n          startIcon={<AssetIcon />}\n          testId=\"markdownEditor.insertMediaDropdownTrigger\"\n          size=\"small\"\n          variant=\"secondary\">\n          Insert media\n        </Button>\n      </Menu.Trigger>\n      <Menu.List>\n        <Menu.Item testId=\"markdownEditor.uploadAssetsAndLink\" onClick={() => props.onAddNew()}>\n          Add new media and link\n        </Menu.Item>\n        <Menu.Item\n          testId=\"markdownEditor.linkExistingAssets\"\n          onClick={() => props.onSelectExisting()}>\n          Link existing media\n        </Menu.Item>\n      </Menu.List>\n    </Menu>\n  );\n};\n","/* eslint-disable react/prop-types */\nimport React from 'react';\nimport { css, cx } from 'emotion';\nimport { IconButton, Flex, Tooltip } from '@contentful/f36-components';\nimport type { ButtonProps } from '@contentful/f36-components';\nimport tokens from '@contentful/f36-tokens';\nimport {\n  HeadingIcon,\n  FormatBoldIcon,\n  FormatItalicIcon,\n  QuoteIcon,\n  ListBulletedIcon,\n  ListNumberedIcon,\n  LinkIcon,\n  CodeIcon,\n  HorizontalRuleIcon,\n  MoreHorizontalIcon,\n} from '@contentful/f36-icons';\nimport * as Icons from './icons';\nimport { HeadingSelector } from './HeadingSelector';\nimport { InsertLinkSelector } from './InsertLinkSelector';\nimport { MarkdownActions } from '../types';\n\nconst styles = {\n  root: css({\n    position: 'relative',\n    zIndex: Number(tokens.zIndexWorkbenchHeader),\n    border: `1px solid ${tokens.gray400}`,\n    backgroundColor: tokens.gray100,\n    padding: tokens.spacingXs,\n    borderTopLeftRadius: tokens.borderRadiusSmall,\n  }),\n  button: css({\n    height: '30px',\n    width: '36px',\n    marginLeft: tokens.spacing2Xs,\n    marginRight: tokens.spacing2Xs,\n  }),\n  icon: css({\n    fill: tokens.gray700,\n    verticalAlign: 'middle',\n  }),\n  zenButton: css({\n    marginLeft: tokens.spacingXs,\n  }),\n  zenButtonPressed: css({\n    backgroundColor: tokens.gray400,\n  }),\n  tooltip: css({\n    zIndex: Number(tokens.zIndexTooltip),\n  }),\n};\n\nconst ToolbarButton = React.forwardRef<\n  HTMLButtonElement,\n  {\n    variant?: 'transparent' | 'secondary';\n    onClick?: Function;\n    tooltipPlace?: 'top' | 'bottom';\n    tooltip: string;\n    children: React.ReactElement;\n  } & Omit<ButtonProps, 'onClick'>\n>((props, ref) => {\n  const {\n    tooltip,\n    onClick,\n    children,\n    className,\n    variant = 'transparent',\n    tooltipPlace = 'top',\n    isDisabled = false,\n    ...otherProps\n  } = props;\n\n  return (\n    <Tooltip className={styles.tooltip} placement={tooltipPlace} content={tooltip}>\n      <IconButton\n        {...otherProps}\n        ref={ref}\n        className={cx(styles.button, className)}\n        isDisabled={isDisabled}\n        onClick={onClick as ButtonProps['onClick']}\n        variant={variant}\n        size=\"small\"\n        icon={children}\n        aria-label={tooltip}\n      />\n    </Tooltip>\n  );\n});\nToolbarButton.displayName = 'ToolbarButton';\n\ninterface MarkdownToolbarProps {\n  canUploadAssets: boolean;\n  disabled: boolean;\n  actions: MarkdownActions;\n  mode: 'default' | 'zen';\n}\n\nfunction MainButtons(props: MarkdownToolbarProps) {\n  const tooltipPlace = props.mode === 'zen' ? 'bottom' : 'top';\n\n  return (\n    <>\n      <HeadingSelector\n        onSelect={(heading) => {\n          if (heading && props.actions.headings[heading]) {\n            props.actions.headings[heading]();\n          }\n        }}>\n        <ToolbarButton\n          isDisabled={props.disabled}\n          testId=\"markdown-action-button-heading\"\n          tooltip=\"Headings\"\n          tooltipPlace={tooltipPlace}>\n          <HeadingIcon aria-label=\"Headings\" className={styles.icon} />\n        </ToolbarButton>\n      </HeadingSelector>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-bold\"\n        tooltip=\"Bold\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.bold}>\n        <FormatBoldIcon aria-label=\"Bold\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-italic\"\n        tooltip=\"Italic\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.italic}>\n        <FormatItalicIcon aria-label=\"Italic\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-quote\"\n        tooltip=\"Quote\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.quote}>\n        <QuoteIcon aria-label=\"Quote\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-ul\"\n        tooltip=\"Unordered list\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.ul}>\n        <ListBulletedIcon aria-label=\"Unordered list\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-ol\"\n        tooltip=\"Ordered list\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.ol}>\n        <ListNumberedIcon aria-label=\"Ordered list\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-link\"\n        tooltip=\"Link\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.insertLink}>\n        <LinkIcon aria-label=\"Link\" className={styles.icon} />\n      </ToolbarButton>\n    </>\n  );\n}\n\nfunction AdditionalButtons(props: MarkdownToolbarProps) {\n  const tooltipPlace = props.mode === 'zen' ? 'bottom' : 'top';\n  return (\n    <>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-strike\"\n        tooltip=\"Strike out\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.strike}>\n        <Icons.Strikethrough label=\"Strike out\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-code\"\n        tooltip=\"Code block\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.code}>\n        <CodeIcon aria-label=\"Code block\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-hr\"\n        tooltip=\"Horizontal rule\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.hr}>\n        <HorizontalRuleIcon aria-label=\"Horizontal rule\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-indent\"\n        tooltip=\"Increase indentation\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.indent}>\n        <Icons.Indent label=\"Increase indentation\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-dedent\"\n        tooltip=\"Decrease indentation\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.simple.dedent}>\n        <Icons.Dedent label=\"Decrease indentation\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-embed\"\n        tooltip=\"Embed external content\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.embedExternalContent}>\n        <Icons.Cubes label=\"Embed external content\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-table\"\n        tooltip=\"Insert table\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.insertTable}>\n        <Icons.Table label=\"Insert table\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-special\"\n        tooltip=\"Insert special character\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.insertSpecialCharacter}>\n        <Icons.SpecialChar label=\"Insert special character\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-organizeLinks\"\n        tooltip=\"Organize links\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.organizeLinks}>\n        <Icons.OrgLinks label=\"Organize links\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-undo\"\n        tooltip=\"Undo\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.history.undo}>\n        <Icons.Undo label=\"Undo\" className={styles.icon} />\n      </ToolbarButton>\n      <ToolbarButton\n        isDisabled={props.disabled}\n        testId=\"markdown-action-button-redo\"\n        tooltip=\"Redo\"\n        tooltipPlace={tooltipPlace}\n        onClick={props.actions.history.redo}>\n        <Icons.Redo label=\"Redo\" className={styles.icon} />\n      </ToolbarButton>\n    </>\n  );\n}\n\nexport function DefaultMarkdownToolbar(props: MarkdownToolbarProps) {\n  const [showAdditional, setShowAdditional] = React.useState(false);\n\n  return (\n    <div className={styles.root}>\n      <Flex justifyContent=\"space-between\">\n        <Flex>\n          <MainButtons {...props} />\n          <ToolbarButton\n            isDisabled={props.disabled}\n            testId=\"markdown-action-button-toggle-additional\"\n            tooltip={showAdditional ? 'Hide additional actions' : 'More actions'}\n            onClick={() => {\n              setShowAdditional(!showAdditional);\n            }}>\n            <MoreHorizontalIcon className={styles.icon} />\n          </ToolbarButton>\n        </Flex>\n        <Flex>\n          <InsertLinkSelector\n            disabled={props.disabled}\n            onSelectExisting={props.actions.linkExistingMedia}\n            onAddNew={props.actions.addNewMedia}\n            canAddNew={props.canUploadAssets}\n          />\n          <ToolbarButton\n            isDisabled={props.disabled}\n            testId=\"markdown-action-button-zen\"\n            variant=\"secondary\"\n            onClick={props.actions.openZenMode}\n            className={styles.zenButton}\n            tooltip=\"Expand\">\n            <Icons.Zen label=\"Expand\" className={styles.icon} />\n          </ToolbarButton>\n        </Flex>\n      </Flex>\n      {showAdditional && (\n        <Flex justifyContent=\"space-between\" marginTop=\"spacingXs\">\n          <Flex>\n            <AdditionalButtons {...props} />\n          </Flex>\n        </Flex>\n      )}\n    </div>\n  );\n}\n\nexport function ZenMarkdownToolbar(props: MarkdownToolbarProps) {\n  return (\n    <div className={styles.root}>\n      <Flex justifyContent=\"space-between\">\n        <Flex>\n          <MainButtons {...props} />\n          <AdditionalButtons {...props} />\n        </Flex>\n        <Flex>\n          <InsertLinkSelector\n            disabled={props.disabled}\n            onSelectExisting={props.actions.linkExistingMedia}\n            onAddNew={props.actions.addNewMedia}\n            canAddNew={props.canUploadAssets}\n          />\n          <IconButton\n            testId=\"markdown-action-button-zen-close\"\n            variant=\"secondary\"\n            size=\"small\"\n            className={cx(styles.zenButton, styles.zenButtonPressed)}\n            onClick={() => {\n              props.actions.closeZenMode();\n            }}\n            icon={<Icons.Zen label=\"Collapse\" className={styles.icon} />}\n            aria-label=\"Collapse\"\n          />\n        </Flex>\n      </Flex>\n    </div>\n  );\n}\n\nexport const MarkdownToolbar = React.memo((props: MarkdownToolbarProps) => {\n  if (props.mode === 'zen') {\n    return <ZenMarkdownToolbar {...props} />;\n  }\n  return <DefaultMarkdownToolbar {...props} />;\n});\n\nMarkdownToolbar.displayName = 'MarkdownToolbar';\n","import get from 'lodash/get';\n\nconst userAgent = get(window, 'navigator.userAgent', '');\nconst platform = get(window, 'navigator.platform', '');\n\nlet ctrlKey = 'Ctrl';\n\nconst tests = {\n  // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/ban-ts-comment\n  // @ts-ignore ignore missing MSStream\n  ios: /(iphone os|ipad|iphone|ipod)/i.test(userAgent) && !window.MSStream,\n};\n\nif (tests.ios || /mac(68k|ppc|intel)/i.test(platform)) {\n  ctrlKey = 'Cmd';\n}\n\nexport function getCtrlKey() {\n  return ctrlKey;\n}\n","/* eslint-disable @typescript-eslint/no-use-before-define, @typescript-eslint/no-explicit-any */\n\nimport CodeMirror from 'codemirror';\nimport 'codemirror/addon/edit/matchbrackets';\nimport throttle from 'lodash/throttle';\nimport transform from 'lodash/transform';\n\nimport { EditorDirection } from '../../types';\nimport * as userAgent from '../../utils/userAgent';\n\nfunction stripUnit(value: number | string): number {\n  if (typeof value !== 'string') return value;\n\n  const cssRegex = /^([+-]?(?:\\d+|\\d*\\.\\d+))([a-z]*|%)$/;\n  const matchedValue = value.match(cssRegex);\n\n  if (!matchedValue) {\n    throw new Error(\"Couldn't match unit in given string\");\n  }\n\n  return parseFloat(value);\n}\n\nexport function create(\n  host: HTMLElement,\n  options: {\n    direction: EditorDirection;\n    readOnly: boolean;\n    fixedHeight?: number | boolean;\n    height?: number | string;\n  }\n) {\n  const { direction, fixedHeight, height, readOnly } = options || {};\n\n  // Set to true if `setValue()` has been called. This is to prevent\n  // undoing the initial content.\n  let initializedWithValue = false;\n\n  const LF = '\\n';\n\n  const EDITOR_SIZE = {\n    min: height ? stripUnit(height) : 300,\n    max: 500,\n    shift: 50,\n  };\n\n  const cm = CodeMirror(host, {\n    direction,\n    readOnly,\n    mode: 'markdown',\n    lineNumbers: false,\n    undoDepth: 200,\n    matchBrackets: true,\n    lineWrapping: true,\n    // When `lineSeparator === null` the document will be split\n    // on CRLFs as well as lone CRs and LFs. A single LF will\n    // be used as line separator in all output\n    lineSeparator: null,\n    theme: 'elegant',\n    tabSize: 2,\n    indentWithTabs: false,\n    indentUnit: 2,\n    autoRefresh: true,\n    spellcheck: true,\n    inputStyle: 'contenteditable',\n  });\n\n  cm.setSize('100%', EDITOR_SIZE.min);\n\n  if (!fixedHeight) {\n    cm.on('change', throttle(assureHeight, 150));\n  }\n\n  cm.setOption('extraKeys', {\n    Tab: function () {\n      replaceSelectedText(getIndentation());\n    },\n    Enter: 'newlineAndIndentContinueMarkdownList',\n    Esc: () => {\n      cm.getInputField().blur();\n    },\n  });\n\n  /**\n   * @description\n   * Custom API for a CodeMirror instance.\n   *\n   * An instance wraps a CodeMirror instance and provides a custom interface\n   * on top of CodeMirror.\n   */\n  return {\n    destroy,\n    disable,\n    enable,\n    attachEvent,\n    addKeyShortcuts,\n    setValue,\n    cmd,\n    moveToLineBeginning,\n    moveIfNotEmpty,\n    restoreCursor,\n    moveToLineEnd,\n    usePrimarySelection,\n    focus,\n    select,\n    selectBackwards,\n    selectAll: () => cm.execCommand('selectAll'),\n    extendSelectionBy,\n    insertAtCursor,\n    insertAtLineBeginning,\n    wrapSelection,\n    removeFromLineBeginning,\n    removeSelectedText,\n    replaceSelectedText,\n    getCursor,\n    setCursor,\n    getSelection,\n    getLine,\n    isLineEmpty,\n    getSelectedText,\n    getSelectionLength,\n    getCurrentLine,\n    getCurrentLineNumber,\n    getCurrentCharacter,\n    getCurrentLineLength,\n    lineStartsWith,\n    getIndentation,\n    getNl,\n    getValue,\n    getLinesCount,\n    getHistorySize,\n    setReadOnly: (value: boolean) => cm.setOption('readOnly', value),\n    getHistory: () => cm.getHistory(),\n    setHistory: (history: any) => cm.setHistory(history),\n    setFullsize: () => {\n      cm.setSize('100%', '100%');\n      cm.refresh();\n    },\n    refresh: () => cm.refresh(),\n  };\n\n  function destroy() {\n    // @ts-expect-error\n    cm.toTextArea();\n  }\n\n  function disable() {\n    cm.setOption('readOnly', 'nocursor');\n  }\n\n  function enable() {\n    cm.setOption('readOnly', false);\n  }\n\n  function assureHeight() {\n    const current = cm.heightAtLine(cm.lastLine(), 'local') + EDITOR_SIZE.shift;\n    let next = current;\n    if (current < EDITOR_SIZE.min) {\n      next = EDITOR_SIZE.min;\n    }\n    if (current > EDITOR_SIZE.max) {\n      next = EDITOR_SIZE.max;\n    }\n    cm.setSize('100%', next);\n  }\n\n  function attachEvent(name: string, fn: Function, throttleInterval: number) {\n    if (throttleInterval) {\n      fn = throttle(fn as any, throttleInterval);\n    }\n    cm.on(name, fn as any);\n  }\n\n  function addKeyShortcuts(map: any) {\n    const ctrlKey = userAgent.getCtrlKey();\n    cm.addKeyMap(\n      transform(\n        map,\n        (acc, value, key) => {\n          // eslint-disable-next-line -- TODO: describe this disable\n          // @ts-ignore\n          acc[ctrlKey + '-' + key] = value;\n        },\n        {}\n      )\n    );\n  }\n\n  /**\n   * low-level editor manipulation functions\n   */\n\n  /**\n   * @description\n   * Sets the content of the editor while preserving the cursor\n   * position.\n   *\n   * If called for the first time it will not record the change in\n   * the history.\n   */\n  function setValue(value?: string) {\n    value = value || '';\n    if (getValue() === value) {\n      return;\n    }\n\n    // set value, but save cursor position first\n    // position will be restored, but w/o focus (third arg)\n    const line = getCurrentLineNumber();\n    const ch = getCurrentCharacter();\n    cm.setValue(value);\n    restoreCursor(ch, line, true);\n\n    // We do not want to record the initial population in the\n    // history. Otherwise it would always be possible to revert to\n    // the empty string.\n    if (!initializedWithValue) {\n      cm.clearHistory();\n      initializedWithValue = true;\n    }\n  }\n\n  function cmd(name: string) {\n    cm.execCommand(name);\n    cm.focus();\n  }\n\n  function moveToLineBeginning(lineNumber?: number) {\n    cm.setCursor({ line: defaultToCurrentLineNumber(lineNumber), ch: 0 });\n    cm.focus();\n  }\n\n  /**\n   * @description\n   * Insert a new line below the cursor and move to the beginning of\n   * that line.\n   *\n   * Only do this if the editor has content and we are not already on\n   * the last line.\n   *\n   * TODO rename this\n   */\n  function moveIfNotEmpty() {\n    if (getCurrentLineLength() < 1) {\n      return;\n    }\n\n    const next = getCurrentLineNumber() + 1;\n    if (cm.lastLine() < next) {\n      moveToLineEnd();\n      insertAtCursor(getNl());\n    }\n\n    moveToLineBeginning(next);\n  }\n\n  function restoreCursor(character: number, lineNumber?: number, noFocus?: boolean) {\n    cm.setCursor(defaultToCurrentLineNumber(lineNumber), character, {\n      scroll: !noFocus,\n    });\n    if (!noFocus) {\n      cm.focus();\n    }\n  }\n\n  function moveToLineEnd(lineNumber?: number) {\n    cm.setCursor({\n      line: defaultToCurrentLineNumber(lineNumber),\n      ch: getCurrentLineLength(),\n    });\n    cm.focus();\n  }\n\n  function defaultToCurrentLineNumber(lineNumber?: number) {\n    if (lineNumber === 0 || (lineNumber !== undefined && lineNumber > 0)) {\n      return lineNumber;\n    }\n    return getCurrentLineNumber();\n  }\n\n  function usePrimarySelection() {\n    cmd('singleSelection');\n  }\n\n  function focus() {\n    cm.focus();\n  }\n\n  function select(from: CodeMirror.Position, to: CodeMirror.Position) {\n    cm.setSelection(from, to);\n    cm.focus();\n  }\n\n  function selectBackwards(skip: number, len: number) {\n    select(getPos(-skip - len), getPos(-skip));\n\n    function getPos(modifier: number) {\n      return {\n        line: getCurrentLineNumber(),\n        ch: getCurrentCharacter() + modifier,\n      };\n    }\n  }\n\n  function extendSelectionBy(modifier: number) {\n    select(getPos('anchor', 0), getPos('head', modifier));\n\n    function getPos(prop: 'anchor' | 'head', modifier: number): CodeMirror.Position {\n      const selection = getSelection();\n      if (!selection) {\n        return { line: 0, ch: 0 };\n      }\n      return { line: selection[prop].line, ch: selection[prop].ch + modifier };\n    }\n  }\n\n  function insertAtCursor(text: string) {\n    cm.replaceRange(text, cm.getCursor());\n    cm.focus();\n  }\n\n  function insertAtLineBeginning(text: string) {\n    const initialCh = getCurrentCharacter();\n    moveToLineBeginning();\n    insertAtCursor(text);\n    restoreCursor(initialCh + text.length);\n    cm.focus();\n  }\n\n  function wrapSelection(wrapper: string) {\n    const replacement = wrapper + getSelectedText() + wrapper;\n    const selection = getSelection();\n    if (selection) {\n      cm.replaceRange(replacement, selection.anchor, selection?.head);\n      cm.focus();\n    }\n  }\n\n  function removeFromLineBeginning(charCount: number) {\n    const lineNumber = getCurrentLineNumber();\n    cm.replaceRange('', { line: lineNumber, ch: 0 }, { line: lineNumber, ch: charCount });\n    cm.focus();\n  }\n\n  function removeSelectedText() {\n    cm.replaceSelection('');\n    cm.focus();\n  }\n\n  /**\n   * @description\n   * Replace the selected text with the given string.\n   *\n   * If nothing is selected it will insert the text at the current\n   * cursor position\n   *\n   * The optional `select` parameter controls what will be selected\n   * afters wards. By default the cursor will be at the end of the\n   * inserted text. You can pass 'around' to select the inserted\n   * text.\n   */\n  function replaceSelectedText(replacement: string, select?: string) {\n    cm.replaceSelection(replacement, select);\n    cm.focus();\n  }\n\n  /**\n   *  low-level editor get/check functions\n   */\n\n  function getCursor() {\n    return cm.getCursor();\n  }\n\n  function setCursor(cursor: number | CodeMirror.Position) {\n    cm.setCursor(cursor);\n  }\n\n  function getSelection() {\n    const selections = cm.listSelections();\n    if (!cm.somethingSelected() || !selections || selections.length < 1) {\n      return null;\n    }\n    return selections[0];\n  }\n\n  function getLine(lineNumber: number) {\n    return cm.getLine(lineNumber) || '';\n  }\n\n  function isLineEmpty(lineNumber?: number) {\n    const n = defaultToCurrentLineNumber(lineNumber);\n    return n > -1 && getLine(n).length < 1 && n < cm.lineCount();\n  }\n\n  function getLinesCount() {\n    return cm.lineCount();\n  }\n\n  function getSelectedText() {\n    return getSelection() ? cm.getSelection() : '';\n  }\n\n  function getSelectionLength() {\n    return getSelectedText().length;\n  }\n\n  function getCurrentLine() {\n    return getLine(getCurrentLineNumber());\n  }\n\n  function getCurrentLineNumber() {\n    return cm.getCursor().line;\n  }\n\n  function getCurrentCharacter() {\n    return cm.getCursor().ch;\n  }\n\n  function getCurrentLineLength() {\n    return getCurrentLine().length;\n  }\n\n  function lineStartsWith(text: string) {\n    return getCurrentLine().startsWith(text);\n  }\n\n  function getIndentation() {\n    return repeat(' ', cm.getOption('indentUnit') ?? 0);\n  }\n\n  function getNl(n = 1) {\n    if (n < 1) {\n      return '';\n    }\n    return repeat(LF, n);\n  }\n\n  function getValue() {\n    return cm.getValue() || '';\n  }\n\n  function getHistorySize(which?: 'undo' | 'redo') {\n    const history = cm.historySize();\n    return which ? history[which] : history;\n  }\n\n  function repeat(what: string, n: number) {\n    return new Array(n + 1).join(what);\n  }\n}\n","/* eslint-disable @typescript-eslint/no-use-before-define */\n\nimport range from 'lodash/range';\nimport min from 'lodash/min';\nimport max from 'lodash/max';\nimport times from 'lodash/times';\n// eslint-disable-next-line -- TODO: describe this disable  you-dont-need-lodash-underscore/repeat\nimport repeat from 'lodash/repeat';\n\nimport * as CodeMirrorWrapper from './CodeMirrorWrapper';\n\ntype EditorInstanceType = ReturnType<typeof CodeMirrorWrapper.create>;\n\nfunction createPrefixToggleFn(prefix: string) {\n  return (editor: EditorInstanceType) => {\n    if (editor.lineStartsWith(prefix)) {\n      editor.removeFromLineBeginning(prefix.length);\n    } else {\n      editor.insertAtLineBeginning(prefix);\n    }\n  };\n}\n\n/**\n * Wraps the current selection with a marker.\n *\n * If nothing is selected it inserts the given text wrapped in the\n * marker and selects the inner text\n *\n * Used b the `bold`, `italic`, and `strike` commands.\n */\nfunction wrapSelection(editor: EditorInstanceType, marker: string, emptyText: string) {\n  return () => {\n    editor.usePrimarySelection();\n\n    // there's a selection - wrap it with inline marker\n    if (editor.getSelection()) {\n      const selectedText = editor.getSelectedText();\n      if (selectedText.startsWith(marker) && selectedText.endsWith(marker)) {\n        const markerLength = marker.length;\n        const textWithoutMarker = selectedText.slice(\n          markerLength,\n          selectedText.length - markerLength\n        );\n        editor.replaceSelectedText(textWithoutMarker);\n      } else {\n        editor.wrapSelection(marker);\n      }\n    } else {\n      // no selection - insert sample text and select it\n      editor.insertAtCursor(marker + emptyText + marker);\n      editor.selectBackwards(marker.length, emptyText.length);\n    }\n  };\n}\n\nconst HEADER_CHAR = '#';\nconst quoteToggleFn = createPrefixToggleFn('> ');\nconst codeToggleFn = createPrefixToggleFn('    ');\n\n/**\n * @description\n * A collection of commands used by the user bound to a\n * CodeMirrorWrapper instance.\n *\n * The command collection only depends on the wrapper instance and is\n * used by UI from code mirror stuff.\n */\nexport function create(editor: EditorInstanceType) {\n  return {\n    bold: wrapSelection(editor, '__', 'text in bold'),\n    italic: wrapSelection(editor, '*', 'text in italic'),\n    strike: wrapSelection(editor, '~~', 'striked out'),\n    quote: modifySelection(editor, quoteToggleFn),\n    code: modifySelection(editor, codeToggleFn),\n    link,\n    h1: toggleHeader(editor, 1),\n    h2: toggleHeader(editor, 2),\n    h3: toggleHeader(editor, 3),\n    ul: modifySelection(editor, ulToggleFn, true),\n    ol: modifySelection(editor, olToggleFn, true),\n    undo: function () {\n      editor.cmd('undo');\n    },\n    redo: function () {\n      editor.cmd('redo');\n    },\n    hr,\n    indent,\n    dedent,\n    table,\n  };\n\n  /**\n   * @description\n   * Insert a line with `---` below the cursor.\n   */\n  function hr() {\n    editor.moveIfNotEmpty();\n    const nl = editor.getNl();\n    const markup = nl + '---' + nl + nl;\n    editor.insertAtCursor(markup);\n  }\n\n  /**\n   * @description\n   * Indent the current line.\n   */\n  function indent() {\n    editor.insertAtLineBeginning(editor.getIndentation());\n  }\n\n  /**\n   * @description\n   * Dedent the current line.\n   */\n  function dedent() {\n    const indentation = editor.getIndentation();\n    if (editor.lineStartsWith(indentation)) {\n      editor.removeFromLineBeginning(indentation.length);\n    }\n  }\n\n  /**\n   * @description\n   * Insert a markdown table template in a new line.\n   */\n  function table(config: { rows: number; cols: number }) {\n    const nl = editor.getNl();\n    editor.moveIfNotEmpty();\n    editor.insertAtCursor(nl);\n    const line = editor.getCurrentLineNumber();\n    editor.insertAtCursor(tableTemplate(config.rows, config.cols).join(nl));\n    editor.insertAtCursor(nl + nl);\n    editor.restoreCursor(2, line);\n  }\n\n  /**\n   * @description\n   * Inserts or replaces the current selection with a markdown link\n   */\n  function link(url: string, text?: string, title?: string) {\n    editor.usePrimarySelection();\n\n    const linkTitle = title ? ' \"' + title + '\"' : '';\n\n    const link = text ? '[' + text + '](' + url + linkTitle + ')' : '<' + url + '>';\n\n    editor.replaceSelectedText(link, 'around');\n  }\n}\n\n/**\n * For each line in the selection move to that line and call\n * `toggleFn` with the 1-based index of the line in the selection.\n *\n * If there is no selection we just call `toggleFn(editor)`.\n */\nfunction modifySelection(\n  editor: EditorInstanceType,\n  toggleFn: (editor: EditorInstanceType, listNumber?: number) => void,\n  isList?: boolean\n) {\n  return () => {\n    editor.usePrimarySelection();\n\n    const selection = editor.getSelection();\n    if (selection) {\n      // there's a selection - toggle list bullet for each line\n      // listNumber is 1, 2, 3... and can be used as ol bullet\n      forLineIn(selection, (lineNumber: number, listNumber: number) => {\n        // TODO move this into forLineIn\n        editor.moveToLineBeginning(lineNumber);\n        toggleFn(editor, listNumber);\n      });\n      editor.moveToLineEnd();\n    } else {\n      // there's no selection - just toggle line prefix\n      // but if adding list, add whitespace before and after list\n      if (isList && !getListNumber(editor) && !editor.lineStartsWith('- ')) {\n        prepareListWhitespace(editor);\n      }\n      toggleFn(editor);\n    }\n  };\n}\n\n/**\n * Calls callback for each line number that is in the selection\n *\n * The second argument is the 1-based index of the iteration.\n *\n * @param {CodeMirror.Selection} selection\n * param {function(number)} cb\n */\nfunction forLineIn(\n  selection: {\n    anchor: CodeMirror.Position;\n    head: CodeMirror.Position;\n  },\n  cb: Function\n) {\n  // anchor/head depend on selection direction, so min & max have to be used\n  const lines = [selection.anchor.line, selection.head.line];\n  const maxNumber = max(lines);\n  const minNumber = min(lines);\n  const lineRange = range(minNumber || 0, maxNumber !== undefined ? maxNumber + 1 : undefined);\n\n  lineRange.forEach((lineNumber, i) => {\n    cb(lineNumber, i + 1);\n  });\n}\n\nfunction prepareListWhitespace(editor: EditorInstanceType) {\n  const line = editor.getCurrentLineNumber();\n\n  const isCurrentLineEmpty = editor.isLineEmpty(line);\n\n  const isPrevLineEmpty = line > 0 ? editor.isLineEmpty(line - 1) : false;\n  const isNextLineEmpty = line < editor.getLinesCount() - 1 ? editor.isLineEmpty(line + 1) : true;\n\n  let linesToInsert = isCurrentLineEmpty ? 2 : 4;\n  if (isPrevLineEmpty) {\n    linesToInsert = linesToInsert - 1;\n  }\n  if (isNextLineEmpty) {\n    linesToInsert = linesToInsert - 1;\n  }\n\n  editor.moveToLineEnd();\n  editor.insertAtCursor(editor.getNl(linesToInsert));\n  editor.restoreCursor(0, isCurrentLineEmpty ? line : line + 2);\n}\n\nfunction getListNumber(editor: EditorInstanceType) {\n  const result = editor.getCurrentLine().match(/^(\\d+\\. )/);\n  return result ? result[1] : null;\n}\n\nfunction ulToggleFn(editor: EditorInstanceType) {\n  if (editor.lineStartsWith('- ')) {\n    editor.removeFromLineBeginning(2);\n  } else {\n    const listNumber = getListNumber(editor);\n    if (listNumber) {\n      editor.removeFromLineBeginning(listNumber.length);\n    }\n    editor.insertAtLineBeginning('- ');\n  }\n}\n\nfunction olToggleFn(editor: EditorInstanceType, n?: number) {\n  const listNumber = getListNumber(editor);\n  if (listNumber) {\n    editor.removeFromLineBeginning(listNumber.length);\n  } else {\n    if (editor.lineStartsWith('- ')) {\n      editor.removeFromLineBeginning(2);\n    }\n    editor.insertAtLineBeginning((n || 1) + '. ');\n  }\n}\n\n/**\n * From a table layout specification build a Markdown table template.\n *\n * Returns the lines as an array.\n * Used by the `table()` command\n *\n * @param {object} config\n * @param {number} rows\n * @param {number} cols\n * @returns {string[]}\n */\nfunction tableTemplate(nrows: number, ncols: number) {\n  const cellWidth = new Array(11);\n  const cell = ' ' + cellWidth.join(' ') + ' |';\n  const separatorCell = ' ' + cellWidth.join('-') + ' |';\n\n  let baseRow = '|';\n  let separatorRow = '|';\n\n  times(ncols, () => {\n    baseRow += cell;\n    separatorRow += separatorCell;\n  });\n\n  const bodyRows = range(nrows).map(() => baseRow.replace(/\\| {5}/g, '| Cell'));\n\n  const headerRow = baseRow.replace(/\\| {7}/g, '| Header');\n\n  return [headerRow, separatorRow].concat(bodyRows);\n}\n\n/**\n * Toggles the header prefix for a given level on the current line.\n *\n * - Removes a header when one of the same level is\n * - Replaces the header if there is one of a different level\n * - Otherwise inserts the header\n */\nfunction toggleHeader(editor: EditorInstanceType, level: number) {\n  return () => {\n    const initialCh = editor.getCurrentCharacter();\n    const currentHeader = selectHeader(editor);\n    const prefix = repeat(HEADER_CHAR, level);\n\n    // there's no header at the current line - create one\n    if (!currentHeader) {\n      editor.moveToLineBeginning();\n      editor.insertAtCursor(prefix + ' ');\n      editor.restoreCursor(initialCh + prefix.length + 1);\n      return;\n    }\n\n    // there's exactly the same header - remove one\n    if (editor.getSelectedText() === prefix) {\n      editor.extendSelectionBy(1);\n      const removedCh = editor.getSelectionLength();\n      editor.removeSelectedText();\n      editor.restoreCursor(initialCh - removedCh);\n      return;\n    }\n\n    // there's another header at the current line - replace\n    const diff = prefix.length - editor.getSelectionLength();\n    editor.replaceSelectedText(prefix);\n    editor.restoreCursor(initialCh + diff);\n  };\n}\n\n/**\n * On the current line select a Markdown header prefix. That is the\n * string at the beginning of the line that consists of up to six `#`.\n *\n * If the selection was successful return the selected string.\n */\nfunction selectHeader(editor: EditorInstanceType) {\n  const result = editor.getCurrentLine().match(/^( {0,3})(#{1,6}) /);\n  if (!result) {\n    return null;\n  }\n  const indentation = result[1];\n  const header = result[2];\n\n  editor.select(getPos(0), getPos(header.length));\n  return editor.getSelection();\n\n  function getPos(modifier: number) {\n    return {\n      line: editor.getCurrentLineNumber(),\n      ch: indentation.length + modifier,\n    };\n  }\n}\n","import React, { useRef, useEffect, useState } from 'react';\nimport tokens from '@contentful/f36-tokens';\nimport { css, cx } from 'emotion';\nimport { createMarkdownEditor } from './createMarkdownEditor';\nimport { EditorDirection } from '../../types';\n\nexport type InitializedEditorType = ReturnType<typeof createMarkdownEditor>;\n\ntype MarkdownTextareaProps = {\n  /**\n   * Minimum height to set for the markdown text area\n   */\n  minHeight?: string | number;\n  mode: 'default' | 'zen';\n  direction: EditorDirection;\n  disabled: boolean;\n  visible: boolean;\n  onReady: (editor: InitializedEditorType) => void;\n};\n\nconst styles = {\n  root: css`\n    border: 1px solid ${tokens.gray400};\n    border-width: 0 1px;\n    overflow-y: auto;\n    height: auto;\n    min-height: 300px;\n\n    .CodeMirror {\n      height: auto;\n      line-height: ${tokens.lineHeightDefault};\n    }\n    .CodeMirror-lines {\n      color: ${tokens.gray700};\n      padding: ${tokens.spacingL};\n    }\n    .CodeMirror-code {\n      font-family: ${tokens.fontStackMonospace};\n      font-size: ${tokens.fontSizeM};\n    }\n    .CodeMirror-scroll {\n      min-height: '6rem';\n    }\n\n    .cm-header {\n      color: ${tokens.gray900};\n    }\n    span.cm-variable-2 {\n      color: ${tokens.gray700};\n    }\n    .cm-header-1 {\n      font-size: 1.9em;\n    }\n    .cm-header-2 {\n      font-size: 1.75em;\n    }\n    .cm-header-3 {\n      font-size: 1.6em;\n    }\n    .cm-header-4 {\n      font-size: 1.45em;\n    }\n    .cm-header-5 {\n      font-size: 1.3em;\n    }\n    .cm-header-6 {\n      font-size: 1.15em;\n    }\n\n    span.cm-tag,\n    span.cm-string,\n    span.cm-attribute {\n      color: ${tokens.red600};\n    }\n    span.cm-string {\n      text-decoration: none !important;\n    }\n    span.cm-quote,\n    span.cm-comment {\n      color: ${tokens.gray600};\n    }\n    span.cm-link,\n    span.cm-url {\n      color: ${tokens.blue500} !important;\n    }\n    span.cm-link {\n      text-decoration: underline;\n    }\n  `,\n  framed: css({\n    '.CodeMirror': {\n      maxHeight: '500px',\n    },\n  }),\n  zen: css({\n    border: 'none !important',\n    '.CodeMirror-lines': {\n      maxWidth: '650px',\n      margin: '0 auto',\n    },\n  }),\n  disabled: css`\n    .CodeMirror {\n      background: ${tokens.gray100};\n      cursor: 'not-allowed';\n    }\n    .CodeMirror-cursors {\n      visibility: hidden !important;\n    }\n    .CodeMirror-scroll,\n    .CodeMirror-sizer,\n    .CodeMirror-lines {\n      cursor: not-allowed;\n    }\n  `,\n};\n\nexport const MarkdownTextarea = React.memo((props: MarkdownTextareaProps) => {\n  const hostRef = useRef<HTMLDivElement>(null);\n  const [editor, setEditor] = useState<InitializedEditorType | null>(null);\n\n  useEffect(() => {\n    if (hostRef.current) {\n      setEditor(\n        createMarkdownEditor(\n          hostRef.current,\n          Object.assign(\n            {},\n            {\n              direction: props.direction,\n              readOnly: true,\n            },\n            props.mode === 'zen'\n              ? {\n                  fixedHeight: true,\n                  height: '100%',\n                }\n              : {},\n            props.minHeight !== undefined ? { height: props.minHeight } : {}\n          )\n        )\n      );\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, []);\n\n  useEffect(() => {\n    if (editor) {\n      props.onReady(editor);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, [editor]);\n\n  const className = cx(\n    styles.root,\n    props.minHeight !== undefined ? css({ minHeight: props.minHeight }) : undefined,\n    props.mode === 'default' ? styles.framed : styles.zen,\n    props.disabled && styles.disabled\n  );\n\n  return (\n    <div\n      className={className}\n      ref={hostRef}\n      data-test-id=\"markdown-textarea\"\n      style={{ display: props.visible ? 'block' : 'none' }}\n    />\n  );\n});\n\nMarkdownTextarea.displayName = 'MarkdownTextarea';\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n\nimport * as CodeMirrorWrapper from './CodeMirrorWrapper';\nimport * as Commands from './MarkdownCommands';\nimport { EditorDirection } from '../../types';\n\nexport function createMarkdownEditor(\n  host: HTMLElement,\n  options: {\n    direction: EditorDirection;\n    readOnly: boolean;\n    fixedHeight?: number | boolean;\n    height?: number | string;\n  }\n) {\n  const editor = CodeMirrorWrapper.create(host, options);\n\n  function wrapChange(fn: Function) {\n    return (e: any, ch: any) => {\n      fn(editor.getValue(), e, ch);\n    };\n  }\n\n  const api = {\n    actions: Commands.create(editor),\n    history: {\n      hasUndo: function () {\n        return editor.getHistorySize('undo') > 0;\n      },\n      hasRedo: function () {\n        return editor.getHistorySize('redo') > 0;\n      },\n    },\n    events: {\n      onScroll: function (fn: Function) {\n        editor.attachEvent('scroll', fn, 150);\n      },\n      onChange: function (fn: Function) {\n        editor.attachEvent('change', wrapChange(fn), 0);\n      },\n      onPaste: function (fn: Function) {\n        editor.attachEvent('paste', fn, 0);\n      },\n    },\n    insert: editor.insertAtCursor,\n    focus: editor.focus,\n    getContent: editor.getValue,\n    destroy: editor.destroy,\n    setContent: editor.setValue,\n    getSelectedText: editor.getSelectedText,\n    usePrimarySelection: editor.usePrimarySelection,\n    setReadOnly: editor.setReadOnly,\n    selectBackwards: editor.selectBackwards,\n    getCursor: editor.getCursor,\n    setCursor: editor.setCursor,\n    clear: () => editor.setValue(''),\n    selectAll: editor.selectAll,\n    setFullsize: editor.setFullsize,\n    refresh: editor.refresh,\n  };\n\n  editor.addKeyShortcuts({\n    B: api.actions.bold,\n    I: api.actions.italic,\n  });\n\n  return api;\n}\n","export type MarkdownTab = 'editor' | 'preview';\n\nexport type HeadingType = 'h1' | 'h2' | 'h3';\n\nexport type EditorDirection = 'ltr' | 'rtl';\n\nexport enum MarkdownDialogType {\n  cheatsheet = 'markdown-cheatsheet',\n  insertLink = 'markdown-insertLink',\n  insertSpecialCharacter = 'markdown-insertSpecialCharacter',\n  insertTable = 'markdown-insertTable',\n  embedExternalContent = 'markdown-embedExternalContent',\n  confirmInsertAsset = 'markdown-confirmInsertAsset',\n  zenMode = 'markdown-zenMode',\n}\n\nexport type MarkdownDialogsParams =\n  | {\n      type: MarkdownDialogType.zenMode;\n      initialValue: string;\n      locale: string;\n    }\n  | {\n      type: MarkdownDialogType.cheatsheet;\n    }\n  | {\n      type: MarkdownDialogType.insertLink;\n      selectedText?: string;\n    }\n  | {\n      type: MarkdownDialogType.insertSpecialCharacter;\n    }\n  | {\n      type: MarkdownDialogType.insertTable;\n    }\n  | {\n      type: MarkdownDialogType.embedExternalContent;\n    }\n  | {\n      type: MarkdownDialogType.confirmInsertAsset;\n      locale: string;\n      assets: Array<{\n        title: string;\n        description: string;\n        thumbnailUrl: string;\n        thumbnailAltText: string;\n      }>;\n    };\n\nexport type MarkdownActions = {\n  simple: {\n    bold: Function;\n    italic: Function;\n    quote: Function;\n    ol: Function;\n    ul: Function;\n    strike: Function;\n    code: Function;\n    hr: Function;\n    indent: Function;\n    dedent: Function;\n  };\n  headings: {\n    h1: Function;\n    h2: Function;\n    h3: Function;\n  };\n  history: {\n    undo: Function;\n    redo: Function;\n  };\n  insertLink: Function;\n  embedExternalContent: Function;\n  insertTable: Function;\n  insertSpecialCharacter: Function;\n  linkExistingMedia: Function;\n  addNewMedia: Function;\n  organizeLinks: Function;\n  openZenMode: Function;\n  closeZenMode: Function;\n};\n\nexport type PreviewComponents = {\n  embedly?: React.ComponentType<{ url: string }>;\n};\n","import React from 'react';\n\nimport { TextLink, Paragraph } from '@contentful/f36-components';\nimport tokens from '@contentful/f36-tokens';\nimport { css } from 'emotion';\n\nconst styles = {\n  root: css({\n    display: 'flex',\n    justifyContent: 'space-between',\n    background: tokens.gray100,\n    border: `1px solid ${tokens.gray400}`,\n    borderBottomLeftRadius: tokens.borderRadiusSmall,\n    borderBottomRightRadius: tokens.borderRadiusSmall,\n    padding: `${tokens.spacingXs} ${tokens.spacingS}`,\n  }),\n  help: css({\n    color: tokens.gray700,\n    fontSize: tokens.fontSizeS,\n    button: {\n      fontSize: tokens.fontSizeS,\n      lineHeight: 'inherit',\n    },\n  }),\n};\n\nexport function MarkdownCounter(props: { words: number; characters: number }) {\n  return (\n    <Paragraph marginBottom=\"none\" className={styles.help}>\n      {props.words} {props.words !== 1 ? 'words' : 'word'}, {props.characters}{' '}\n      {props.characters !== 1 ? 'characters' : 'character'}\n    </Paragraph>\n  );\n}\n\nexport function MarkdownHelp(props: { onClick: () => void }) {\n  return (\n    <Paragraph marginBottom=\"none\" className={styles.help}>\n      Format your text like a pro with the{' '}\n      <TextLink\n        as=\"button\"\n        testId=\"open-markdown-cheatsheet-button\"\n        onClick={() => {\n          props.onClick();\n        }}\n      >\n        markdown cheatsheet\n      </TextLink>\n      .\n    </Paragraph>\n  );\n}\n\nexport function MarkdownBottomBar(props: { children: React.ReactNode }) {\n  return <div className={styles.root}>{props.children}</div>;\n}\n","import React from 'react';\nimport { css, cx } from 'emotion';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport { ModalContent } from '@contentful/f36-components';\nimport tokens from '@contentful/f36-tokens';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\n\nimport { TextLink, Heading } from '@contentful/f36-components';\n\nconst styles = {\n  flexColumnContainer: css({\n    display: 'flex',\n    flexWrap: 'nowrap',\n  }),\n  flexColumn: css({\n    flexGrow: 1,\n  }),\n  verticalDivider: css({\n    borderRight: `1px solid ${tokens.gray500}`,\n    paddingRight: tokens.spacing3Xl,\n    marginRight: tokens.spacing2Xl,\n  }),\n  preview: css({\n    display: 'inline-block',\n    paddingRight: tokens.spacingL,\n    width: '50%',\n  }),\n  unOrderedListPreview: css({\n    listStyleType: 'disc',\n    marginLeft: tokens.spacingS,\n  }),\n  orderedListPreview: css({\n    listStyleType: 'decimal',\n    marginLeft: tokens.spacingS,\n  }),\n  markup: css({\n    display: 'inline-block',\n    color: tokens.gray600,\n    paddingLeft: tokens.spacingL,\n    width: '50%',\n  }),\n  h1: css({\n    fontSize: tokens.fontSize2Xl,\n  }),\n  h2: css({\n    fontSize: tokens.fontSizeXl,\n  }),\n  h3: css({\n    fontSize: tokens.fontSizeL,\n  }),\n  helpItem: css({\n    marginBottom: tokens.spacingS,\n    display: 'flex',\n    alignItems: 'flex-end',\n    height: tokens.spacingXl,\n  }),\n  helpLink: css({\n    margin: 'auto',\n  }),\n  flexRowContainer: css({\n    display: 'flex',\n    width: '100%',\n    justifyContent: 'center',\n    marginTop: tokens.spacingXl,\n  }),\n};\n\nexport const CheatsheetModalDialog = () => {\n  return (\n    <ModalContent testId=\"markdown-cheatsheet-dialog-content\">\n      <div className={styles.flexColumnContainer}>\n        <div className={cx(styles.flexColumn, styles.verticalDivider)}>\n          <div className={styles.helpItem}>\n            <Heading marginBottom=\"none\" as=\"h1\" className={cx(styles.preview, styles.h1)}>\n              H1\n            </Heading>\n            <div className={styles.markup}># heading</div>\n          </div>\n          <div className={styles.helpItem}>\n            <Heading marginBottom=\"none\" as=\"h2\" className={cx(styles.preview, styles.h2)}>\n              H2\n            </Heading>\n            <div className={styles.markup}>## heading</div>\n          </div>\n          <div className={styles.helpItem}>\n            <Heading marginBottom=\"none\" as=\"h3\" className={cx(styles.preview, styles.h3)}>\n              H3\n            </Heading>\n            <div className={styles.markup}>### heading</div>\n          </div>\n          <div className={styles.helpItem}>\n            <strong className={styles.preview}>bold</strong>\n            <div className={styles.markup}>__text__</div>\n          </div>\n          <div className={styles.helpItem}>\n            <em className={styles.preview}>italic</em>\n            <div className={styles.markup}>*text*</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>strikethrough</div>\n            <div className={styles.markup}>~~text~~</div>\n          </div>\n          <div className={styles.helpItem}>\n            <TextLink as=\"button\" className={styles.preview}>\n              Link\n            </TextLink>\n            <div className={styles.markup}>[text](url)</div>\n          </div>\n        </div>\n        <div className={styles.flexColumn}>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>Image</div>\n            <div className={styles.markup}>![alt-text](url)</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>Unordered list</div>\n            <div className={styles.markup}>* list item</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>\n              <div>Ordered list</div>\n            </div>\n            <div className={styles.markup}>1. list item</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>\n              <div>Blockquote</div>\n            </div>\n            <div className={styles.markup}>&gt; quote</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>code span</div>\n            <div className={styles.markup}>`code here`</div>\n          </div>\n          <div className={styles.helpItem}>\n            <div className={styles.preview}>code block</div>\n            <div className={styles.markup}>```code here```</div>\n          </div>\n        </div>\n      </div>\n      <div className={styles.flexRowContainer}>\n        <TextLink\n          className={styles.helpLink}\n          href=\"https://help.github.com/en/github/writing-on-github/basic-writing-and-formatting-syntax\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\">\n          View the full GitHub-flavored Markdown syntax help (opens in a new window)\n        </TextLink>\n      </div>\n    </ModalContent>\n  );\n};\n\nexport const openCheatsheetModal = (dialogs: DialogsAPI): Promise<void> => {\n  return dialogs.openCurrent({\n    title: 'Markdown formatting help',\n    width: 'large',\n    minHeight: '415px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.cheatsheet,\n    } as MarkdownDialogsParams,\n  });\n};\n","import React from 'react';\n\nimport tokens from '@contentful/f36-tokens';\nimport DOMPurify from 'dompurify';\nimport { css, cx } from 'emotion';\nimport Markdown from 'markdown-to-jsx';\n\nimport { EditorDirection, PreviewComponents } from '../types';\nimport { replaceMailtoAmp } from '../utils/replaceMailtoAmp';\n\nconst styles = {\n  root: css`\n    border: 1px solid ${tokens.gray400};\n    border-width: 0 1px;\n    word-wrap: break-word;\n    overflow-wrap: break-word;\n    min-height: 300px;\n    padding: ${tokens.spacingL};\n    font-size: ${tokens.fontSizeM};\n    font-family: ${tokens.fontStackPrimary};\n    line-height: ${tokens.lineHeightDefault};\n    color: ${tokens.gray700};\n    white-space: pre-line;\n\n    h1,\n    h2,\n    h3,\n    h4,\n    h5,\n    h6 {\n      margin-top: ${tokens.spacingL};\n      margin-bottom: ${tokens.spacingM};\n      color: ${tokens.gray900};\n    }\n\n    h1:first-child,\n    h2:first-child,\n    h3:first-child,\n    h4:first-child,\n    h5:first-child,\n    h6:first-child {\n      margin-top: 0;\n    }\n\n    h1 {\n      font-size: 1.9em;\n    }\n    h2 {\n      font-size: 1.75em;\n    }\n    h3 {\n      font-size: 1.6em;\n    }\n    h4 {\n      font-size: 1.45em;\n    }\n    h5 {\n      font-size: 1.3em;\n    }\n    h6 {\n      font-size: 1.15em;\n    }\n\n    p {\n      margin-top: 0;\n      margin-bottom: ${tokens.spacingM};\n    }\n\n    ul,\n    ol {\n      margin: ${tokens.spacingS} 0;\n      padding-left: ${tokens.spacingM};\n    }\n    ul > li {\n      list-style-type: disc;\n      margin-bottom: 0;\n    }\n\n    ol > li {\n      list-style-type: decimal;\n      margin-bottom: 0;\n    }\n\n    table {\n      table-layout: fixed;\n      border-right-width: 0;\n      border-bottom-width: 0;\n      width: 80%;\n      margin: ${tokens.spacingM} auto;\n      border-spacing: 0;\n      border-collapse: collapse;\n      border: 1px solid ${tokens.gray300};\n    }\n\n    table th,\n    table td {\n      padding: 5px;\n      border-left-width: 0;\n      border-top-width: 0;\n    }\n\n    table th {\n      background: ${tokens.gray200};\n    }\n\n    table td {\n      border: 1px solid ${tokens.gray300};\n    }\n\n    a {\n      color: ${tokens.blue500};\n    }\n\n    hr {\n      margin-top: ${tokens.spacingL};\n      margin-bottom: ${tokens.spacingL};\n      height: 1px;\n      background-color: ${tokens.gray300};\n      border: none;\n    }\n\n    blockquote {\n      border-left: 4px solid ${tokens.gray200};\n      padding-left: ${tokens.spacingL};\n      margin: 0;\n      margin-top: ${tokens.spacingM};\n      font-style: italic;\n    }\n\n    img {\n      margin: ${tokens.spacingM} auto;\n      display: block;\n      max-width: 80%;\n      max-height: 250px;\n    }\n\n    pre code {\n      font-size: ${tokens.fontSizeS};\n      font-family: ${tokens.fontStackMonospace};\n    }\n\n    .embedly-card {\n      margin: ${tokens.spacingM} auto;\n      display: block;\n    }\n  `,\n  framed: css({\n    height: '100%',\n    maxHeight: '500px',\n    overflowY: 'auto',\n  }),\n  zen: css({\n    maxWidth: '650px',\n    margin: '0 auto',\n    border: 'none !important',\n  }),\n  rtl: css({\n    direction: 'rtl',\n  }),\n};\n\ntype MarkdownPreviewProps = {\n  /**\n   * Minimum height to set for the markdown preview\n   */\n  minHeight?: string | number;\n  mode: 'default' | 'zen';\n  direction: EditorDirection;\n  value: string;\n  previewComponents?: PreviewComponents;\n};\n\nfunction MarkdownLink(props: {\n  href: string;\n  title: string;\n  className?: string;\n  // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n  children: any;\n  Embedly?: React.SFC<{ url: string }>;\n}) {\n  const { Embedly, children, ...rest } = props;\n\n  if (props.className === 'embedly-card' && Embedly) {\n    return <Embedly url={props.href} />;\n  }\n\n  return (\n    <a {...rest} target=\"_blank\" rel=\"noopener noreferrer\">\n      {children}\n    </a>\n  );\n}\n\nexport const MarkdownPreview = React.memo((props: MarkdownPreviewProps) => {\n  const className = cx(\n    styles.root,\n    props.minHeight !== undefined ? css({ minHeight: props.minHeight }) : undefined,\n    props.mode === 'default' ? styles.framed : styles.zen,\n    props.direction === 'rtl' ? styles.rtl : undefined\n  );\n\n  // See the list of allowed Tags here:\n  // https://github.com/cure53/DOMPurify/blob/main/src/tags.js#L3-L121\n  const cleanHTML = React.useMemo(() => {\n    return replaceMailtoAmp(DOMPurify.sanitize(props.value));\n  }, [props.value]);\n\n  return (\n    <div className={className} data-test-id=\"markdown-preview\">\n      <Markdown\n        options={{\n          overrides: {\n            a: {\n              // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n              component: MarkdownLink as any,\n              props: {\n                Embedly: props.previewComponents?.embedly,\n              },\n            },\n          },\n        }}>\n        {cleanHTML}\n      </Markdown>\n    </div>\n  );\n});\n\nMarkdownPreview.displayName = 'MarkdownPreview';\n","// This code will replace '&amp;' with '&' only inside the href attribute of the mailto link.\n// Otherwise the mailto link will not work correctly\nexport const replaceMailtoAmp = (string: string) => {\n  return string.replace(/href=\"mailto:[^\"]*&amp;/g, function (match) {\n    return match.replace(/&amp;/g, '&');\n  });\n};\n","import React from 'react';\nimport { css } from 'emotion';\nimport tokens from '@contentful/f36-tokens';\nimport { FieldExtensionSDK } from '@contentful/app-sdk';\nimport { ConstraintsUtils, CharCounter, CharValidation } from '@contentful/field-editor-shared';\n\nconst styles = {\n  root: css({\n    display: 'flex',\n    justifyContent: 'space-between',\n    fontSize: tokens.fontSizeM,\n    marginTop: tokens.spacingXs,\n    color: tokens.gray700,\n  }),\n};\n\nexport function MarkdownConstraints(props: { sdk: FieldExtensionSDK; value: string }) {\n  const constraints = ConstraintsUtils.fromFieldValidations(\n    props.sdk.field.validations,\n    props.sdk.field.type as 'Text'\n  );\n\n  const checkConstraint = ConstraintsUtils.makeChecker(constraints);\n\n  return (\n    <div className={styles.root}>\n      <CharCounter value={props.value} checkConstraint={checkConstraint} />\n      <CharValidation constraints={constraints} />\n    </div>\n  );\n}\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = GeneratorFunctionPrototype;\n  define(Gp, \"constructor\", GeneratorFunctionPrototype);\n  define(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction);\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  });\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  define(Gp, iteratorSymbol, function() {\n    return this;\n  });\n\n  define(Gp, \"toString\", function() {\n    return \"[object Generator]\";\n  });\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, in modern engines\n  // we can explicitly access globalThis. In older engines we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","export const urlRegex =\n  /^(ftp|http|https):\\/\\/(\\w+:{0,1}\\w*@)?(\\S+)(:[0-9]+)?(\\/|\\/([\\w#!:.?+=&%@!\\-/]))?$/;\n\nexport function isValidUrl(value: string) {\n  return urlRegex.test(value);\n}\n","import React, { useState, useRef, useEffect } from 'react';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\nimport {\n  ModalContent,\n  ModalControls,\n  Button,\n  Form,\n  FormControl,\n  TextInput,\n} from '@contentful/f36-components';\nimport { isValidUrl } from '../utils/isValidUrl';\n\ntype InsertLinkModalPositiveResult = { url: string; text: string; title: string };\nexport type InsertLinkModalResult = InsertLinkModalPositiveResult | false | undefined;\n\ntype InsertLinkModalProps = {\n  selectedText?: string;\n  onClose: (result: InsertLinkModalResult) => void;\n};\n\nexport const InsertLinkModal = ({ selectedText, onClose }: InsertLinkModalProps) => {\n  const mainInputRef = useRef<HTMLInputElement>(null);\n  const [text, setText] = useState(selectedText || '');\n  const [url, setUrl] = useState('');\n  const [touched, setTouched] = useState(false);\n  const [title, setTitle] = useState('');\n  const onInsert = (values: InsertLinkModalPositiveResult) => onClose(values);\n\n  const urlIsValid = isValidUrl(url);\n\n  useEffect(() => {\n    if (mainInputRef?.current?.focus) {\n      mainInputRef.current.focus();\n    }\n  }, [mainInputRef]);\n\n  return (\n    <>\n      <ModalContent testId=\"insert-link-modal\">\n        <Form onSubmit={() => onInsert({ url, text, title })}>\n          <FormControl id=\"link-text-field\" isDisabled={Boolean(selectedText)}>\n            <FormControl.Label>Link text</FormControl.Label>\n            <TextInput\n              name=\"link-text\"\n              value={text}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                setText(e.target.value);\n              }}\n              testId=\"link-text-field\"\n            />\n          </FormControl>\n\n          <FormControl id=\"target-url-field\" isInvalid={touched && !urlIsValid}>\n            <FormControl.Label>Target URL</FormControl.Label>\n            <TextInput\n              name=\"target-url\"\n              value={url}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                setUrl(e.target.value);\n                setTouched(true);\n              }}\n              placeholder=\"https://\"\n              maxLength={2100}\n              testId=\"target-url-field\"\n              ref={mainInputRef}\n            />\n            <FormControl.HelpText>Include protocol (e.g. https://)</FormControl.HelpText>\n            {touched && !urlIsValid && (\n              <FormControl.ValidationMessage>Invalid URL</FormControl.ValidationMessage>\n            )}\n          </FormControl>\n\n          <FormControl id=\"link-title-field\">\n            <FormControl.Label>Link title</FormControl.Label>\n            <TextInput\n              name=\"link-title\"\n              value={title}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                setTitle(e.target.value);\n              }}\n              testId=\"link-title-field\"\n            />\n            <FormControl.HelpText>\n              Extra link information, usually shown as a tooltip on mouse hover\n            </FormControl.HelpText>\n          </FormControl>\n        </Form>\n      </ModalContent>\n      <ModalControls>\n        <Button\n          testId=\"insert-link-cancel\"\n          onClick={() => onClose(false)}\n          variant=\"secondary\"\n          size=\"small\">\n          Cancel\n        </Button>\n        <Button\n          testId=\"insert-link-confirm\"\n          onClick={() => {\n            onInsert({ url, text, title });\n          }}\n          isDisabled={!urlIsValid}\n          variant=\"positive\"\n          size=\"small\">\n          Insert\n        </Button>\n      </ModalControls>\n    </>\n  );\n};\n\nexport const openInsertLinkDialog = (\n  dialogs: DialogsAPI,\n  params: { selectedText?: string }\n): Promise<InsertLinkModalResult> => {\n  return dialogs.openCurrent({\n    title: 'Insert link',\n    width: 'large',\n    minHeight: '410px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.insertLink,\n      ...params,\n    } as MarkdownDialogsParams,\n  });\n};\n","export const specialCharacters = [\n  { code: 180, desc: 'acute accent' },\n  { code: 38, desc: 'ampersand' },\n  { code: 166, desc: 'broken vertical bar' },\n  { code: 8226, desc: 'bullet' },\n  { code: 184, desc: 'cedilla' },\n  { code: 162, desc: 'cent' },\n  { code: 169, desc: 'copyright' },\n  { code: 176, desc: 'degree' },\n  { code: 247, desc: 'division' },\n  { code: 189, desc: 'fraction half' },\n  { code: 188, desc: 'fraction quarter' },\n  { code: 190, desc: 'fraction three quarters' },\n  { code: 62, desc: 'greater than' },\n  { code: 161, desc: 'inverted exclamation mark' },\n  { code: 191, desc: 'inverted question mark' },\n  { code: 171, desc: 'left-pointing double angle quotation mark' },\n  { code: 60, desc: 'less than' },\n  { code: 175, desc: 'macron' },\n  { code: 181, desc: 'micro' },\n  { code: 160, desc: 'non-breaking space' },\n  { code: 172, desc: 'not' },\n  { code: 182, desc: 'paragraph' },\n  { code: 177, desc: 'plus-minus' },\n  { code: 34, desc: 'quotation mark' },\n  { code: 174, desc: 'registered' },\n  { code: 187, desc: 'right-pointing double angle quotation mark' },\n  { code: 167, desc: 'section' },\n  { code: 168, desc: 'umlaut/diaeresis' },\n  { code: 215, desc: 'multiplication' },\n  { code: 8482, desc: 'trade mark' },\n  { code: 8364, desc: 'euro' },\n  { code: 163, desc: 'pound' },\n  { code: 165, desc: 'yen' },\n  { code: 8222, desc: 'double low-9 quotation mark' },\n  { code: 710, desc: 'modifier circumflex accent' },\n  { code: 8224, desc: 'dagger' },\n  { code: 8225, desc: 'double dagger' },\n  { code: 8230, desc: 'horizontal ellipsis' },\n  { code: 8220, desc: 'left double quotation mark' },\n  { code: 8249, desc: 'single left-pointing angle quotation mark' },\n  { code: 8216, desc: 'left single quotation mark' },\n  { code: 183, desc: 'middle dot' },\n  { code: 8212, desc: 'em dash' },\n  { code: 8211, desc: 'en dash' },\n  { code: 8240, desc: 'per mille' },\n  { code: 8250, desc: 'single right-pointing angle quotation mark' },\n  { code: 8217, desc: 'right single quotation mark' },\n  { code: 8218, desc: 'single low-9 quotation mark' },\n  { code: 170, desc: 'feminine ordinal indicator' },\n  { code: 186, desc: 'masculine ordinal indicator' },\n  { code: 8221, desc: 'right double quotation mark' },\n  { code: 732, desc: 'small tilde' },\n  { code: 9829, desc: 'black heart' },\n  { code: 9830, desc: 'diamond' },\n];\n","import React, { useState } from 'react';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport { css } from 'emotion';\nimport tokens from '@contentful/f36-tokens';\nimport {\n  ModalContent,\n  ModalControls,\n  Text,\n  Flex,\n  Button,\n  Tooltip,\n} from '@contentful/f36-components';\nimport { specialCharacters } from '../utils/specialCharacters';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\n\nconst styles = {\n  buttonPanel: css({\n    display: 'flex',\n    flexWrap: 'wrap',\n  }),\n  charButton: css({\n    border: `1px solid ${tokens.gray500}`,\n    width: '4.1rem',\n    height: '4.1rem',\n    fontSize: tokens.fontSizeXl,\n    marginTop: tokens.spacing2Xs,\n    marginRight: tokens.spacing2Xs,\n  }),\n  selectedCharButton: css({\n    backgroundColor: tokens.gray100,\n  }),\n  tooltip: css({ zIndex: 1000 }),\n  button: css({\n    marginTop: tokens.spacingM,\n    marginRight: tokens.spacingS,\n  }),\n};\n\nexport type SpecialCharacterModalResult = string | false | undefined;\n\ntype SpecialCharacterModalDialogProps = {\n  onClose: (result: SpecialCharacterModalResult) => void;\n};\n\nexport const SpecialCharacterModalDialog = ({ onClose }: SpecialCharacterModalDialogProps) => {\n  const [selectedCharacter, setSelectedCharacter] = useState<{ code: number; desc: string }>(\n    specialCharacters[0]\n  );\n  return (\n    <>\n      <ModalContent testId=\"insert-special-character-modal\">\n        <Flex flexDirection=\"column\" alignItems=\"center\">\n          <Text as=\"div\" lineHeight=\"lineHeight3Xl\" fontSize=\"fontSize3Xl\" marginBottom=\"spacingS\">\n            {String.fromCharCode(selectedCharacter.code)}\n          </Text>\n          <Text as=\"div\" marginBottom=\"spacingS\">\n            {selectedCharacter.desc}\n          </Text>\n        </Flex>\n        <div className={styles.buttonPanel}>\n          {specialCharacters.map((char) => (\n            <div key={char.code}>\n              <Tooltip className={styles.tooltip} content={char.desc}>\n                <Button\n                  testId=\"special-character-button\"\n                  isActive={char.code === selectedCharacter.code}\n                  className={styles.charButton}\n                  variant=\"transparent\"\n                  onClick={() => setSelectedCharacter(char)}>\n                  {String.fromCharCode(char.code)}\n                </Button>\n              </Tooltip>\n            </div>\n          ))}\n        </div>\n      </ModalContent>\n      <ModalControls>\n        <Button\n          testId=\"insert-character-cancel\"\n          className={styles.button}\n          onClick={() => onClose(false)}\n          variant=\"secondary\"\n          size=\"small\">\n          Cancel\n        </Button>\n        <Button\n          className={styles.button}\n          testId=\"insert-character-confirm\"\n          onClick={() => onClose(String.fromCharCode(selectedCharacter.code))}\n          variant=\"positive\"\n          size=\"small\">\n          Insert selected\n        </Button>\n      </ModalControls>\n    </>\n  );\n};\n\nexport const openInsertSpecialCharacter = (\n  dialogs: DialogsAPI\n): Promise<SpecialCharacterModalResult> => {\n  return dialogs.openCurrent({\n    title: 'Insert special character',\n    width: 'large',\n    minHeight: '600px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.insertSpecialCharacter,\n    } as MarkdownDialogsParams,\n  });\n};\n","import React, { useState, useRef, useEffect } from 'react';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport inRange from 'lodash/inRange';\nimport {\n  ModalContent,\n  ModalControls,\n  Button,\n  Form,\n  FormControl,\n  TextInput,\n} from '@contentful/f36-components';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\n\ntype InsertTableModalPositiveResult = { cols: number; rows: number };\nexport type InsertTableModalResult = InsertTableModalPositiveResult | false | undefined;\n\ntype InsertTableModalProps = {\n  onClose: (result: InsertTableModalResult) => void;\n};\n\nexport const InsertTableModal = ({ onClose }: InsertTableModalProps) => {\n  const mainInputRef = useRef<HTMLInputElement>(null);\n  const [rows, setRows] = useState(2);\n  const [cols, setColumns] = useState(1);\n  const rowsAreValid = inRange(rows, 2, 100);\n  const colsAreValid = inRange(cols, 1, 100);\n\n  useEffect(() => {\n    if (mainInputRef.current?.focus) {\n      mainInputRef.current.focus();\n    }\n  }, [mainInputRef]);\n\n  return (\n    <>\n      <ModalContent testId=\"insert-table-modal\">\n        <Form>\n          <FormControl id=\"insert-table-rows-number-field\" isRequired isInvalid={!rowsAreValid}>\n            <FormControl.Label>Number of rows</FormControl.Label>\n            <TextInput\n              name=\"rows\"\n              value={rows.toString()}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => setRows(Number(e.target.value))}\n              testId=\"insert-table-rows-number-field\"\n              min={2}\n              max={100}\n              pattern=\"[1-9][0-9]*\"\n              type=\"number\"\n              width=\"small\"\n              autoComplete=\"off\"\n              ref={mainInputRef}\n            />\n            {!rowsAreValid && (\n              <FormControl.ValidationMessage>\n                Should be between 2 and 100\n              </FormControl.ValidationMessage>\n            )}\n          </FormControl>\n\n          <FormControl id=\"insert-table-columns-number-field\" isRequired isInvalid={!colsAreValid}>\n            <FormControl.Label>Number of columns</FormControl.Label>\n            <TextInput\n              name=\"columns\"\n              value={cols.toString()}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                setColumns(Number(e.target.value))\n              }\n              testId=\"insert-table-columns-number-field\"\n              min={1}\n              max={100}\n              pattern=\"[1-9][0-9]*\"\n              type=\"number\"\n              width=\"small\"\n              autoComplete=\"off\"\n            />\n            {!colsAreValid && (\n              <FormControl.ValidationMessage>\n                Should be between 1 and 100\n              </FormControl.ValidationMessage>\n            )}\n          </FormControl>\n        </Form>\n      </ModalContent>\n      <ModalControls>\n        <Button\n          testId=\"insert-table-cancel\"\n          onClick={() => onClose(false)}\n          variant=\"secondary\"\n          size=\"small\">\n          Cancel\n        </Button>\n        <Button\n          testId=\"insert-table-confirm\"\n          onClick={() => onClose({ rows, cols })}\n          variant=\"positive\"\n          size=\"small\"\n          isDisabled={!rowsAreValid || !colsAreValid}>\n          Insert\n        </Button>\n      </ModalControls>\n    </>\n  );\n};\n\nexport const openInsertTableDialog = (dialogs: DialogsAPI): Promise<InsertTableModalResult> => {\n  return dialogs.openCurrent({\n    title: 'Insert table',\n    width: 'medium',\n    minHeight: '260px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.insertTable,\n    } as MarkdownDialogsParams,\n  });\n};\n","import React, { useState, useRef, useEffect } from 'react';\nimport { css } from 'emotion';\nimport tokens from '@contentful/f36-tokens';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\nimport {\n  ModalContent,\n  ModalControls,\n  Text,\n  TextLink,\n  Button,\n  Checkbox,\n  Radio,\n  Form,\n  FormControl,\n  TextInput,\n} from '@contentful/f36-components';\nimport { isValidUrl } from '../utils/isValidUrl';\n\nconst styles = {\n  widthFiledGroup: css({\n    display: 'flex',\n    flexWrap: 'nowrap',\n    alignItems: 'flex-start',\n  }),\n  radioButtonGroup: css({\n    display: 'inline-flex',\n    alignItems: 'flex-start',\n    paddingTop: tokens.spacingXl,\n  }),\n  radioButton: css({\n    marginLeft: tokens.spacingM,\n  }),\n};\n\nexport type EmbedExternalContentModalResult = string | false | undefined;\n\ntype EmbedExternalContentModalProps = {\n  onClose: (result: EmbedExternalContentModalResult) => void;\n};\n\ntype Unit = 'percent' | 'px';\n\nconst makeEmbedlyLink = ({\n  url,\n  width,\n  selectedUnit,\n  attachSocial,\n}: {\n  url: string;\n  width: number;\n  selectedUnit: Unit;\n  attachSocial: boolean;\n}): string => {\n  const s = { percent: '%', px: 'px' };\n  return [\n    '<a href=\"' + url + '\" class=\"embedly-card\" ',\n    'data-card-width=\"' + width + s[selectedUnit] + '\" ',\n    'data-card-controls=\"' + (attachSocial ? '1' : '0') + '\"',\n    '>Embedded content: ' + url + '</a>',\n  ].join('');\n};\n\nconst isWidthValid = (width: number, unit: Unit) => (unit === 'percent' ? width <= 100 : true);\n\nexport const EmbedExternalContentModal = ({ onClose }: EmbedExternalContentModalProps) => {\n  const mainInputRef = useRef<HTMLInputElement>(null);\n  const [url, setUrl] = useState<string>('https://');\n  const [selectedUnit, setUnit] = useState<Unit>('percent');\n  const [urlIsValid, setUrlValidity] = useState<boolean>(true);\n  const [width, setWidth] = useState('100');\n  const [attachSocial, setAttachSocial] = useState(false);\n\n  useEffect(() => {\n    if (mainInputRef.current?.focus) {\n      mainInputRef.current.focus();\n    }\n  }, [mainInputRef]);\n\n  return (\n    <>\n      <ModalContent testId=\"embed-external-dialog\">\n        <Form>\n          <FormControl id=\"external-link-url-field\" isRequired isInvalid={!urlIsValid}>\n            <FormControl.Label>Content URL</FormControl.Label>\n            <TextInput\n              name=\"external-link-url\"\n              value={url}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                const value = e.target.value;\n                setUrl(value);\n                setUrlValidity(isValidUrl(value));\n              }}\n              testId=\"external-link-url-field\"\n              placeholder=\"https://example.com\"\n              ref={mainInputRef}\n            />\n            <FormControl.HelpText>Include protocol (e.g. https://)</FormControl.HelpText>\n            {!urlIsValid && (\n              <FormControl.ValidationMessage>URL is invalid</FormControl.ValidationMessage>\n            )}\n          </FormControl>\n          <TextLink href=\"http://embed.ly/providers\" target=\"_blank\" rel=\"noopener noreferrer\">\n            Supported sources\n          </TextLink>\n          <div className={styles.widthFiledGroup}>\n            <FormControl\n              id=\"embedded-content-width\"\n              isRequired\n              isInvalid={!isWidthValid(Number(width), selectedUnit)}>\n              <FormControl.Label>Width</FormControl.Label>\n              <TextInput\n                value={width}\n                name=\"embedded-content-width\"\n                testId=\"embedded-content-width\"\n                type=\"number\"\n                width=\"small\"\n                onChange={(e: React.ChangeEvent<HTMLInputElement>) => setWidth(e.target.value)}\n              />\n              {!isWidthValid(Number(width), selectedUnit) && (\n                <FormControl.ValidationMessage>\n                  Should be equal or less then 100\n                </FormControl.ValidationMessage>\n              )}\n            </FormControl>\n\n            <div className={styles.radioButtonGroup}>\n              <Radio\n                id=\"unit-option-percent\"\n                value=\"percent\"\n                isChecked={selectedUnit === 'percent'}\n                onChange={() => setUnit('percent')}\n                className={styles.radioButton}>\n                percent\n              </Radio>\n              <Radio\n                id=\"unit-option-pixels\"\n                value=\"pixels\"\n                isChecked={selectedUnit === 'px'}\n                onChange={() => setUnit('px')}\n                className={styles.radioButton}>\n                pixels\n              </Radio>\n            </div>\n          </div>\n          <Checkbox\n            id=\"attach-social-checkbox\"\n            name=\"attach-social-checkbox\"\n            value=\"Yes\"\n            isChecked={attachSocial}\n            onChange={() => setAttachSocial(!attachSocial)}\n            testId=\"attach-social-checkbox\">\n            Attach social sharing links to this element\n          </Checkbox>\n          <Text as=\"p\" fontColor=\"gray500\" marginTop=\"spacingXs\">\n            To enable this embedded content in your application make sure to add the&nbsp;\n            <TextLink\n              href=\"http://embed.ly/docs/products/cards\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\">\n              Embedly&apos;s platform.js\n            </TextLink>\n            &nbsp;on your development environment\n          </Text>\n          {/* <EmbedlyPreview previewUrl={url} /> */}\n        </Form>\n      </ModalContent>\n      <ModalControls>\n        <Button\n          testId=\"emded-external-cancel\"\n          onClick={() => onClose(false)}\n          variant=\"secondary\"\n          size=\"small\">\n          Cancel\n        </Button>\n        <Button\n          testId=\"embed-external-confirm\"\n          onClick={() =>\n            onClose(makeEmbedlyLink({ url, width: Number(width), selectedUnit, attachSocial }))\n          }\n          variant=\"positive\"\n          size=\"small\">\n          Insert\n        </Button>\n      </ModalControls>\n    </>\n  );\n};\n\nexport const openEmbedExternalContentDialog = (\n  dialogs: DialogsAPI\n): Promise<EmbedExternalContentModalResult> => {\n  return dialogs.openCurrent({\n    title: 'Embed external content',\n    width: 'large',\n    minHeight: '435px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.embedExternalContent,\n    } as MarkdownDialogsParams,\n  });\n};\n","import React from 'react';\nimport {\n  ModalContent,\n  ModalControls,\n  Paragraph,\n  Button,\n  EntityList,\n} from '@contentful/f36-components';\nimport { DialogsAPI } from '@contentful/app-sdk';\nimport { MarkdownDialogType, MarkdownDialogsParams } from '../types';\n\ninterface ConfirmInsertAssetModalDialogProps {\n  onClose: (result: boolean) => void;\n  assets: Array<{\n    title: string;\n    description: string;\n    thumbnailUrl: string;\n    thumbnailAltText: string;\n  }>;\n  locale: string;\n}\n\nexport const ConfirmInsertAssetModalDialog = ({\n  onClose,\n  assets,\n  locale,\n}: ConfirmInsertAssetModalDialogProps) => {\n  const localesNumber = assets.length;\n\n  return (\n    <>\n      <ModalContent testId=\"confirm-insert-asset\">\n        <Paragraph>\n          {localesNumber === 1\n            ? `Link asset with missing file for locale ${locale}`\n            : `Link assets with missing files for locale ${locale}`}\n        </Paragraph>\n        <Paragraph>\n          {localesNumber === 1\n            ? 'Do you want to link to the file in its fallback locale?'\n            : 'Do you want to link to the files in their fallback locales?'}\n        </Paragraph>\n        <EntityList>\n          {assets.map(({ title, description, thumbnailUrl, thumbnailAltText }) => (\n            <EntityList.Item\n              key={thumbnailUrl}\n              title={title}\n              thumbnailUrl={`${thumbnailUrl}?w=46&h=46&fit=thumb`}\n              thumbnailAltText={thumbnailAltText}\n              description={description}\n            />\n          ))}\n        </EntityList>\n      </ModalContent>\n      <ModalControls>\n        <Button onClick={() => onClose(false)} variant=\"secondary\" size=\"small\">\n          Cancel\n        </Button>\n        <Button\n          testId=\"confirm-insert-asset\"\n          onClick={() => onClose(true)}\n          variant=\"positive\"\n          size=\"small\">\n          Confirm\n        </Button>\n      </ModalControls>\n    </>\n  );\n};\n\nexport const openConfirmInsertAsset = (\n  dialogs: DialogsAPI,\n  options: {\n    locale: string;\n    assets: Array<{\n      title: string;\n      description: string;\n      thumbnailUrl: string;\n      thumbnailAltText: string;\n    }>;\n  }\n): Promise<boolean> => {\n  return dialogs.openCurrent({\n    title: 'Confirm using fallback assets',\n    width: 'medium',\n    minHeight: '270px',\n    shouldCloseOnEscapePress: true,\n    shouldCloseOnOverlayClick: true,\n    parameters: {\n      type: MarkdownDialogType.confirmInsertAsset,\n      ...options,\n    } as MarkdownDialogsParams,\n  });\n};\n","import React from 'react';\nimport { css, cx } from 'emotion';\nimport { DialogsAPI, DialogExtensionSDK } from '@contentful/app-sdk';\nimport { MarkdownDialogType, MarkdownDialogsParams, PreviewComponents } from '../types';\nimport { InitializedEditorType } from '../components/MarkdownTextarea/MarkdownTextarea';\nimport { MarkdownToolbar } from '../components/MarkdownToolbar';\nimport { MarkdownTextarea } from '../components/MarkdownTextarea/MarkdownTextarea';\nimport { MarkdownPreview } from '../components/MarkdownPreview';\nimport { MarkdownBottomBar, MarkdownHelp } from '../components/MarkdownBottomBar';\nimport { createMarkdownActions } from '../MarkdownActions';\nimport { openCheatsheetModal } from '../dialogs/CheatsheetModalDialog';\nimport tokens from '@contentful/f36-tokens';\n\nimport { ChevronRightIcon, ChevronLeftIcon } from '@contentful/f36-icons';\n\nexport type ZenModeResult = {\n  value: string;\n  cursor?: {\n    ch: number;\n    line: number;\n  };\n};\n\ntype ZenModeDialogProps = {\n  saveValueToSDK: (value: string | null | undefined) => void;\n  onClose: (result: ZenModeResult) => void;\n  initialValue: string;\n  locale: string;\n  sdk: DialogExtensionSDK;\n  previewComponents?: PreviewComponents;\n};\n\nconst styles = {\n  root: css({\n    position: 'fixed',\n    left: 0,\n    right: 0,\n    top: 0,\n    bottom: 0,\n  }),\n  topSplit: css({\n    position: 'fixed',\n    top: 0,\n    height: '48px',\n    left: 0,\n    right: 0,\n  }),\n  bottomSplit: css({\n    position: 'fixed',\n    bottom: 0,\n    left: 0,\n    right: 0,\n    height: '36px',\n  }),\n  editorSplit: css({\n    width: '50%',\n    position: 'fixed',\n    top: '48px',\n    left: 0,\n    bottom: '36px',\n    overflowX: 'hidden',\n    overflowY: 'scroll',\n  }),\n  editorSplitFullscreen: css({\n    left: 0,\n    right: 0,\n    width: '100%',\n  }),\n  previewSplit: css({\n    width: '50%',\n    position: 'fixed',\n    top: '48px',\n    right: 0,\n    bottom: '36px',\n    overflowX: 'hidden',\n    overflowY: 'scroll',\n  }),\n  separator: css({\n    position: 'fixed',\n    top: '48px',\n    bottom: '36px',\n    width: '1px',\n    background: tokens.gray400,\n    left: '50%',\n  }),\n  button: css({\n    position: 'fixed',\n    cursor: 'pointer',\n    zIndex: 105,\n    top: '49%',\n    height: '30px',\n    backgroundColor: tokens.gray100,\n    border: `1px solid ${tokens.gray400}`,\n    padding: 0,\n  }),\n  hideButton: css({\n    left: '50%',\n  }),\n  showButton: css({\n    right: 0,\n    borderRightWidth: 0,\n  }),\n  icon: css({\n    verticalAlign: 'middle',\n  }),\n};\n\nexport const ZenModeModalDialog = (props: ZenModeDialogProps) => {\n  const [currentValue, setCurrentValue] = React.useState<string>(props.initialValue ?? '');\n  const [showPreview, setShowPreview] = React.useState<boolean>(true);\n  const [editor, setEditor] = React.useState<InitializedEditorType | null>(null);\n\n  React.useEffect(() => {\n    // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n    props.sdk?.window?.updateHeight('100%' as any);\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, []);\n\n  // refresh editor right after dialog is opened to avoid disappearing effect\n  React.useEffect(() => {\n    setTimeout(() => {\n      editor?.setFullsize();\n      editor?.refresh();\n    }, 150);\n  }, [editor]);\n\n  const actions = React.useMemo(() => {\n    return createMarkdownActions({ sdk: props.sdk, editor, locale: props.locale });\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, [editor]);\n\n  actions.closeZenMode = () => {\n    props.onClose({\n      value: currentValue,\n      cursor: editor?.getCursor(),\n    });\n  };\n\n  const direction = props.sdk.locales.direction[props.locale] ?? 'ltr';\n\n  return (\n    <div className={styles.root} data-test-id=\"zen-mode-markdown-editor\">\n      <div className={styles.topSplit}>\n        <MarkdownToolbar mode=\"zen\" disabled={false} canUploadAssets={false} actions={actions} />\n      </div>\n\n      <div\n        className={cx(styles.editorSplit, {\n          [styles.editorSplitFullscreen]: showPreview === false,\n        })}>\n        <MarkdownTextarea\n          mode=\"zen\"\n          visible\n          disabled={false}\n          direction={direction}\n          onReady={(editor) => {\n            editor.setContent(props.initialValue ?? '');\n            editor.setReadOnly(false);\n            setEditor(editor);\n            editor.focus();\n            editor.events.onChange((value: string) => {\n              setCurrentValue(value);\n              props.saveValueToSDK(value);\n            });\n          }}\n        />\n      </div>\n      {showPreview && (\n        <div className={styles.previewSplit}>\n          <MarkdownPreview\n            direction={direction}\n            mode=\"zen\"\n            value={currentValue}\n            previewComponents={props.previewComponents}\n          />\n        </div>\n      )}\n      {showPreview && <div className={styles.separator} />}\n      {showPreview && (\n        <button\n          className={cx(styles.button, styles.hideButton)}\n          aria-label=\"Hide preview\"\n          onClick={() => {\n            setShowPreview(false);\n          }}>\n          <ChevronRightIcon variant=\"muted\" size=\"tiny\" className={styles.icon} />\n        </button>\n      )}\n      {!showPreview && (\n        <button\n          className={cx(styles.button, styles.showButton)}\n          aria-label=\"Show preview\"\n          onClick={() => {\n            setShowPreview(true);\n          }}>\n          <ChevronLeftIcon variant=\"muted\" size=\"tiny\" className={styles.icon} />\n        </button>\n      )}\n      <div className={styles.bottomSplit}>\n        <MarkdownBottomBar>\n          <MarkdownHelp\n            onClick={() => {\n              openCheatsheetModal(props.sdk.dialogs);\n            }}\n          />\n        </MarkdownBottomBar>\n      </div>\n    </div>\n  );\n};\n\nexport const openZenMode = (\n  dialogs: DialogsAPI,\n  options: { initialValue: string; locale: string }\n): Promise<ZenModeResult> => {\n  return dialogs.openCurrent({\n    width: 'zen' as any, // eslint-disable-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n    shouldCloseOnEscapePress: false,\n    minHeight: '100vh',\n    shouldCloseOnOverlayClick: false,\n    parameters: {\n      type: MarkdownDialogType.zenMode,\n      initialValue: options.initialValue,\n      locale: options.locale,\n    } as MarkdownDialogsParams,\n  });\n};\n","import get from 'lodash/get';\nimport isObject from 'lodash/isObject';\n\n// eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\ntype Asset = any;\n\ntype LinkWithMedia = {\n  title: string;\n  asset: Asset;\n  url: string;\n  isLocalized: boolean;\n  isFallback: boolean;\n  asMarkdown: string;\n};\n\ntype Locales = {\n  localeCode: string;\n  fallbackCode: string | undefined;\n  defaultLocaleCode: string;\n};\n\nfunction normalizeWhiteSpace(str: string) {\n  if (str) {\n    return str.trim().replace(/\\s{2,}/g, ' ');\n  } else {\n    return str;\n  }\n}\n\nfunction removeExtension(str: string) {\n  return str.replace(/\\.\\w+$/g, '');\n}\n\nfunction fileNameToTitle(str: string) {\n  return normalizeWhiteSpace(removeExtension(str).replace(/_/g, ' '));\n}\n\nexport function replaceAssetDomain(fileUrl: string) {\n  const assetDomainMap: Record<string, string> = {\n    images: 'images.ctfassets.net',\n    assets: 'assets.ctfassets.net',\n    downloads: 'downloads.ctfassets.net',\n    videos: 'videos.ctfassets.net',\n  };\n\n  return fileUrl.replace(/(images|assets|downloads|videos).contentful.com/, (_, p1) => {\n    return assetDomainMap[p1];\n  });\n}\n\nfunction makeAssetLink(\n  asset: Asset,\n  { localeCode, fallbackCode, defaultLocaleCode }: Locales\n): LinkWithMedia | null {\n  const localizedFile = get(asset, ['fields', 'file', localeCode]);\n  const fallbackFile = fallbackCode ? get(asset, ['fields', 'file', fallbackCode]) : null;\n  const defaultFile = get(asset, ['fields', 'file', defaultLocaleCode]);\n  const file:\n    | {\n        url: string;\n        fileName: string;\n      }\n    | undefined = localizedFile || fallbackFile || defaultFile;\n\n  if (isObject(file) && file.url) {\n    const title: string =\n      get(asset, ['fields', 'title', localeCode]) ||\n      get(asset, ['fields', 'title', fallbackCode || '']) ||\n      get(asset, ['fields', 'title', defaultLocaleCode]) ||\n      fileNameToTitle(file.fileName);\n\n    const fileUrl = replaceAssetDomain(file.url);\n\n    return {\n      title,\n      asset,\n      url: fileUrl,\n      // is normally localized and we should not warn about this file\n      isLocalized: Boolean(localizedFile),\n      // was fallback value used\n      // if it was not localized normally, and we did not used a fallback\n      // it means we used a default locale - we filter empty values\n      isFallback: Boolean(fallbackFile),\n      // todo: tranform using fromHostname\n      asMarkdown: `![${title}](${fileUrl})`,\n    };\n  } else {\n    return null;\n  }\n}\n\nexport async function insertAssetLinks(assets: Array<Asset>, locales: Locales) {\n  // check whether do we have some assets, which don't have\n  // a version in this field's locale\n  const otherLocales = assets.filter((asset) => {\n    return !get(asset, ['fields', 'file', locales.localeCode]);\n  });\n\n  const linksWithMeta = assets\n    .map((asset) => makeAssetLink(asset, locales))\n    // remove empty links\n    .filter((asset) => asset !== null) as LinkWithMedia[];\n\n  // if there have values from fallback/default locales, we need to\n  // provide user a warning so we show him modal\n  if (otherLocales.length > 0) {\n    const fallbackAssets = linksWithMeta\n      // we don't want to warn about normally localized files\n      .filter(({ isLocalized }) => !isLocalized)\n      .map(({ title, isFallback, asset }) => {\n        const code = isFallback ? locales.fallbackCode : locales.defaultLocaleCode;\n        return {\n          title,\n          thumbnailUrl: asset.fields.file[code as string].url,\n          thumbnailAltText: title,\n          description: isFallback ? `Fallback locale (${code})` : `Default locale (${code})`,\n          asset: asset,\n        };\n      });\n\n    return {\n      fallbacks: fallbackAssets,\n      links: linksWithMeta,\n    };\n  }\n  return {\n    links: linksWithMeta,\n  };\n}\n","/* eslint-disable @typescript-eslint/no-use-before-define, @typescript-eslint/no-explicit-any */\n\nimport extend from 'lodash/extend';\nimport isString from 'lodash/isString';\nimport isObject from 'lodash/isObject';\nimport max from 'lodash/max';\n// eslint-disable-next-line -- TODO: describe this disable\nimport isFinite from 'lodash/isFinite';\n// eslint-disable-next-line -- TODO: describe this disable\nimport forEach from 'lodash/forEach';\n\nfunction extractTitle(title: string) {\n  title = title || '';\n  title = title.replace(/^ *('|\"|\\()*/, '');\n  title = title.replace(/('|\"|\\))* *$/, '');\n  return title;\n}\n\nfunction head(text: string) {\n  return text.split(' ').shift();\n}\n\nfunction tail(text: string) {\n  const segments = text.split(' ');\n  segments.shift();\n  return segments.join(' ');\n}\n\nconst PROCESSORS = {\n  inline: function (match: any) {\n    return {\n      match: match[0],\n      text: match[1],\n      href: head(match[2]),\n      title: extractTitle(tail(match[2])),\n    };\n  },\n  ref: function (match: any) {\n    return {\n      match: match[0],\n      text: match[1],\n      id: match[2],\n    };\n  },\n  label: function (match: any) {\n    return {\n      match: match[0],\n      id: match[1],\n      href: head(match[2]),\n      title: extractTitle(tail(match[2])),\n    };\n  },\n};\n\nconst REGEXS = {\n  inline: /\\[([^\\r\\n[\\]]+)]\\(([^\\r\\n)]+)\\)/,\n  ref: /\\[([^\\r\\n[\\]]+)] ?\\[([^\\r\\n[\\]]+)]/,\n  label: /^ {0,3}\\[([^\\r\\n[\\]]+)]:\\s+(.+)$/,\n};\nexport const findInline = makeFinder('inline');\nexport const findRefs = makeFinder('ref');\nexport const findLabels = makeFinder('label');\n\nexport function convertInlineToRef(text: string) {\n  let id = findMaxLabelId(text);\n\n  forEach(findInline(text), (inline) => {\n    id += 1;\n    text = text.replace(inline.match, buildRef(inline, id));\n    text += '\\n' + buildLabel(inline, id);\n  });\n\n  return text;\n}\n\nfunction mergeLabels(text: string): any {\n  const byHref: any = {};\n  const byOldId: any = {};\n\n  forEach(findLabels(text), (label) => {\n    const alreadyAdded = byHref[label.href];\n    const current = extend({}, label);\n\n    if (!alreadyAdded) {\n      byHref[current.href] = current;\n    } else if (hasTitle(current) && !hasTitle(alreadyAdded)) {\n      alreadyAdded.title = current.title;\n    }\n\n    byOldId[current.id] = alreadyAdded || current;\n  });\n\n  return {\n    byHref: byHref,\n    byOldId: byOldId,\n  };\n}\n\nexport function rewriteRefs(text: string) {\n  const merged = mergeLabels(text);\n  const hrefToRefId: any = {};\n  const labels: any[] = [];\n  const rewrites: any[] = [];\n  let i = 1;\n\n  // 1. compose list of labels with new ids, in order\n  forEach(findRefs(text), (ref) => {\n    const oldLabel = merged.byOldId[ref.id];\n    if (!oldLabel) {\n      return;\n    }\n    const href = oldLabel.href;\n    let newRefId = hrefToRefId[href];\n\n    if (!newRefId) {\n      hrefToRefId[href] = newRefId = i;\n      i += 1;\n      labels.push(extend({ newId: newRefId }, oldLabel));\n    }\n\n    // 1b. prepare rewrites to be applied, with new label ids\n    rewrites.push(extend({ newId: newRefId }, ref));\n  });\n\n  // 2. remove all labels!\n  forEach(findLabels(text), (label) => {\n    text = text.replace(label.match, '');\n  });\n\n  // 3. remove whitespace from the end of text\n  text = text.replace(/[\\r\\n\\s]*$/, '');\n  text += '\\n\\n';\n\n  // 4. apply rewrites\n  forEach(rewrites, (ref) => {\n    text = text.replace(ref.match, buildRef(ref, ref.newId));\n  });\n\n  // 5. print new labels at the end of text\n  forEach(labels, (label) => {\n    text += '\\n' + buildLabel(label, label.newId);\n  });\n\n  return text;\n}\n\n/**\n * Finding stuff\n */\n\nfunction makeFinder(type: 'inline' | 'ref' | 'label'): (text: string) => Array<any> {\n  return (text: string) => findAll(text, type).map(PROCESSORS[type] as any);\n}\n\nexport function findMaxLabelId(textOrLabels: any): number {\n  if (isString(textOrLabels)) {\n    textOrLabels = findLabels(textOrLabels);\n  }\n\n  const ids = textOrLabels\n    .map((x: any) => x.id)\n    .map((x: any) => parseInt(x, 10))\n    .filter((x: any) => isFinite(x) && x > 0);\n\n  return ids.length > 0 ? max(ids) || 0 : 0;\n}\n\nfunction findAll(text: string, type: 'inline' | 'ref' | 'label') {\n  const flags = 'g' + (type === 'label' ? 'm' : '');\n  const matches = [];\n  const re = new RegExp(REGEXS[type].source, flags);\n  let found = re.exec(text);\n\n  while (found) {\n    matches.push(found);\n    re.lastIndex = found.index + found[0].length;\n    found = re.exec(text);\n  }\n\n  return matches;\n}\n\n/**\n * Other utilities\n */\n\nfunction hasTitle(link: { title: string }) {\n  return isObject(link) && isString(link.title) && link.title.length > 0;\n}\n\nfunction buildLabel(link: { href: string; title: string }, id: number) {\n  let markup = '[' + id + ']: ' + link.href;\n  if (hasTitle(link)) {\n    markup += ' \"' + link.title + '\"';\n  }\n  return markup;\n}\n\nfunction buildRef(link: { text: string }, id: number) {\n  return '[' + link.text + '][' + id + ']';\n}\n","import { InitializedEditorType } from './components/MarkdownTextarea/MarkdownTextarea';\nimport { KnownSDK } from '@contentful/app-sdk';\nimport { openInsertLinkDialog } from './dialogs/InsertLinkModalDialog';\nimport { openInsertSpecialCharacter } from './dialogs/SpecialCharacterModalDialog';\nimport { openInsertTableDialog } from './dialogs/InsertTableModalDialog';\nimport { openEmbedExternalContentDialog } from './dialogs/EmdebExternalContentDialog';\nimport { openConfirmInsertAsset } from './dialogs/ConfirmInsertAssetModalDialog';\nimport { openZenMode } from './dialogs/ZenModeModalDialog';\nimport { insertAssetLinks } from './utils/insertAssetLinks';\nimport * as LinkOrganizer from './utils/linkOrganizer';\n\nexport function createMarkdownActions(props: {\n  sdk: KnownSDK;\n  editor: InitializedEditorType | null;\n  locale: string;\n}) {\n  const { sdk, editor, locale } = props;\n\n  // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/ban-types\n  const insertAssetsWithConfirmation = async (assets: Array<Object> | null) => {\n    if (assets) {\n      const { links, fallbacks } = await insertAssetLinks(assets, {\n        localeCode: locale,\n        defaultLocaleCode: sdk.locales.default,\n        fallbackCode: sdk.locales.fallbacks[locale],\n      });\n      if (links && links.length > 0) {\n        if (fallbacks) {\n          const insertAnyway = await openConfirmInsertAsset(sdk.dialogs, {\n            locale: locale,\n            assets: fallbacks,\n          });\n          if (!insertAnyway) {\n            throw Error('User decided to not use fallbacks');\n          }\n        }\n        return links.map((link) => link.asMarkdown).join('\\n\\n');\n      }\n    }\n    return '';\n  };\n\n  return {\n    headings: {\n      h1: () => {\n        editor?.actions.h1();\n      },\n      h2: () => {\n        editor?.actions.h2();\n      },\n      h3: () => {\n        editor?.actions.h3();\n      },\n    },\n    simple: {\n      italic: () => {\n        editor?.actions.italic();\n      },\n      bold: () => {\n        editor?.actions.bold();\n      },\n      quote: () => {\n        editor?.actions.quote();\n      },\n      ol: () => {\n        editor?.actions.ol();\n      },\n      ul: () => {\n        editor?.actions.ul();\n      },\n      strike: () => {\n        editor?.actions.strike();\n      },\n      code: () => {\n        editor?.actions.code();\n      },\n      hr: () => {\n        editor?.actions.hr();\n      },\n      indent: () => {\n        editor?.actions.indent();\n      },\n      dedent: () => {\n        editor?.actions.dedent();\n      },\n    },\n    history: {\n      undo: () => {\n        editor?.actions.undo();\n      },\n      redo: () => {\n        editor?.actions.redo();\n      },\n    },\n    insertLink: async () => {\n      if (!editor) {\n        return;\n      }\n      editor.usePrimarySelection();\n      const selectedText = editor.getSelectedText();\n      const result = await openInsertLinkDialog(sdk.dialogs, { selectedText });\n      if (result) {\n        editor.actions.link(result.url, selectedText || result.text, result.title);\n      }\n    },\n    insertSpecialCharacter: async () => {\n      if (!editor) {\n        return;\n      }\n      const result = await openInsertSpecialCharacter(sdk.dialogs);\n      if (result) {\n        editor.insert(result);\n      }\n    },\n    insertTable: async () => {\n      if (!editor) {\n        return;\n      }\n      const result = await openInsertTableDialog(sdk.dialogs);\n      if (result) {\n        editor.actions.table(result);\n      }\n    },\n    organizeLinks: () => {\n      if (!editor) {\n        return;\n      }\n      let text = editor.getContent();\n      if (!text) {\n        return;\n      }\n      text = LinkOrganizer.convertInlineToRef(text);\n      text = LinkOrganizer.rewriteRefs(text);\n      editor.setContent(text);\n      sdk.notifier.success('All your links are now references at the bottom of your document.');\n    },\n    embedExternalContent: async () => {\n      if (!editor) {\n        return;\n      }\n      const result = await openEmbedExternalContentDialog(sdk.dialogs);\n      if (result) {\n        editor.insert(result);\n      }\n    },\n    addNewMedia: async () => {\n      if (!editor) {\n        return;\n      }\n      try {\n        const { entity: asset } = (await sdk.navigator.openNewAsset({\n          slideIn: { waitForClose: true },\n        })) as any; // eslint-disable-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n\n        const markdownLinks = await insertAssetsWithConfirmation([asset]);\n        editor.insert(markdownLinks);\n      } finally {\n        editor.focus();\n      }\n    },\n    linkExistingMedia: async () => {\n      if (!editor) {\n        return;\n      }\n      try {\n        const assets = await sdk.dialogs.selectMultipleAssets({\n          locale: locale,\n        });\n        const markdownLinks = await insertAssetsWithConfirmation(assets);\n        editor.insert(markdownLinks);\n      } finally {\n        editor.focus();\n      }\n    },\n    openZenMode: async () => {\n      if (!editor) {\n        return;\n      }\n      const result = await openZenMode(sdk.dialogs, {\n        initialValue: editor.getContent(),\n        locale: props.locale,\n      });\n\n      editor.setContent(result.value);\n\n      if (result.cursor) {\n        editor.setCursor(result.cursor);\n      }\n\n      editor.focus();\n    },\n    closeZenMode: () => {\n      // do nothing\n      // this method is overwritten in dialog app\n    },\n  };\n}\n","import React from 'react';\nimport { css } from 'emotion';\nimport tokens from '@contentful/f36-tokens';\nimport { FieldConnector } from '@contentful/field-editor-shared';\nimport { FieldExtensionSDK } from '@contentful/app-sdk';\nimport { MarkdownTabs } from './components/MarkdownTabs';\nimport { MarkdownToolbar } from './components/MarkdownToolbar';\nimport { MarkdownTextarea } from './components/MarkdownTextarea/MarkdownTextarea';\nimport { InitializedEditorType } from './components/MarkdownTextarea/MarkdownTextarea';\nimport { MarkdownBottomBar, MarkdownHelp } from './components/MarkdownBottomBar';\nimport { MarkdownTab, PreviewComponents } from './types';\nimport { openCheatsheetModal } from './dialogs/CheatsheetModalDialog';\nimport { MarkdownPreview } from './components/MarkdownPreview';\nimport { MarkdownConstraints } from './components/MarkdownConstraints';\nimport { createMarkdownActions } from './MarkdownActions';\n\nconst styles = {\n  container: css({\n    display: 'flex',\n    flexDirection: 'column',\n    fontFamily: tokens.fontStackPrimary,\n  }),\n};\n\nexport interface MarkdownEditorProps {\n  /**\n   * is the field disabled initially\n   */\n  isInitiallyDisabled: boolean;\n  /**\n   * Minimum height to set for the markdown text area and preview\n   */\n  minHeight?: string | number;\n\n  sdk: FieldExtensionSDK;\n\n  previewComponents?: PreviewComponents;\n  onReady?: Function;\n}\n\nexport function MarkdownEditor(\n  props: MarkdownEditorProps & {\n    disabled: boolean;\n    initialValue: string | null | undefined;\n    saveValueToSDK: Function;\n  }\n) {\n  const [currentValue, setCurrentValue] = React.useState<string>(props.initialValue ?? '');\n  const [selectedTab, setSelectedTab] = React.useState<MarkdownTab>('editor');\n  const [editor, setEditor] = React.useState<InitializedEditorType | null>(null);\n  const [canUploadAssets, setCanUploadAssets] = React.useState<boolean>(false);\n\n  React.useEffect(() => {\n    if (editor && props.onReady) {\n      props.onReady(editor);\n      // fix: http://codemirror.977696.n3.nabble.com/codemirror-content-not-visible-in-bootstrap-modal-td4026988.html\n      setTimeout(() => {\n        editor.refresh();\n      }, 1);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, [editor]);\n\n  React.useEffect(() => {\n    props.sdk.access.can('create', 'Asset').then((value) => {\n      setCanUploadAssets(value);\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, []);\n\n  React.useEffect(() => {\n    if (editor) {\n      editor.setReadOnly(props.disabled);\n    }\n  }, [editor, props.disabled]);\n\n  const isActionDisabled = editor === null || props.disabled || selectedTab !== 'editor';\n\n  const direction = props.sdk.locales.direction[props.sdk.field.locale] ?? 'ltr';\n\n  const actions = React.useMemo(() => {\n    return createMarkdownActions({ sdk: props.sdk, editor, locale: props.sdk.field.locale });\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, [editor]);\n\n  const openMarkdownHelp = React.useCallback(() => {\n    openCheatsheetModal(props.sdk.dialogs);\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- TODO: Evaluate the dependencies\n  }, []);\n\n  return (\n    <div className={styles.container} data-test-id=\"markdown-editor\">\n      <MarkdownTabs\n        active={selectedTab}\n        onSelect={(tab) => {\n          setSelectedTab(tab);\n        }}\n      />\n      <MarkdownToolbar\n        mode=\"default\"\n        disabled={isActionDisabled}\n        canUploadAssets={canUploadAssets}\n        actions={actions}\n      />\n      <MarkdownTextarea\n        minHeight={props.minHeight}\n        mode=\"default\"\n        visible={selectedTab === 'editor'}\n        disabled={isActionDisabled}\n        direction={direction}\n        onReady={(editor) => {\n          editor.setContent(props.initialValue ?? '');\n          editor.setReadOnly(props.disabled);\n          setEditor(editor);\n          editor.events.onChange((value: string) => {\n            // Trim empty lines\n            const trimmedValue = value.replace(/^\\s+$/gm, '');\n            props.saveValueToSDK(trimmedValue);\n            setCurrentValue(value);\n          });\n        }}\n      />\n      {selectedTab === 'preview' && (\n        <MarkdownPreview\n          direction={direction}\n          minHeight={props.minHeight}\n          mode=\"default\"\n          value={currentValue}\n          previewComponents={props.previewComponents}\n        />\n      )}\n      <MarkdownBottomBar>\n        <MarkdownHelp onClick={openMarkdownHelp} />\n      </MarkdownBottomBar>\n      <MarkdownConstraints sdk={props.sdk} value={currentValue} />\n    </div>\n  );\n}\n\nexport function MarkdownEditorConnected(props: MarkdownEditorProps) {\n  return (\n    <FieldConnector<string>\n      throttle={300}\n      field={props.sdk.field}\n      isInitiallyDisabled={props.isInitiallyDisabled}>\n      {({ value, disabled, setValue, externalReset }) => {\n        // on external change reset component completely and init with initial value again\n        return (\n          <MarkdownEditor\n            {...props}\n            key={`markdown-editor-${externalReset}`}\n            initialValue={value}\n            disabled={disabled}\n            saveValueToSDK={setValue}\n          />\n        );\n      }}\n    </FieldConnector>\n  );\n}\n","import React from 'react';\nimport {\n  FieldExtensionSDK,\n  DialogExtensionSDK,\n  OpenCustomWidgetOptions,\n} from '@contentful/app-sdk';\nimport { ModalDialogLauncher } from '@contentful/field-editor-shared';\nimport { MarkdownDialogsParams, PreviewComponents } from '../types';\n\nimport { CheatsheetModalDialog } from './CheatsheetModalDialog';\nimport { SpecialCharacterModalDialog } from './SpecialCharacterModalDialog';\nimport { MarkdownDialogType } from '../types';\nimport { InsertLinkModal, InsertLinkModalResult } from './InsertLinkModalDialog';\nimport { InsertTableModal, InsertTableModalResult } from './InsertTableModalDialog';\nimport { ConfirmInsertAssetModalDialog } from './ConfirmInsertAssetModalDialog';\nimport {\n  EmbedExternalContentModal,\n  EmbedExternalContentModalResult,\n} from './EmdebExternalContentDialog';\nimport { ZenModeModalDialog, ZenModeResult } from './ZenModeModalDialog';\n\nexport const openMarkdownDialog =\n  (sdk: FieldExtensionSDK, previewComponents?: PreviewComponents) =>\n  (\n    options: OpenCustomWidgetOptions & {\n      parameters?: MarkdownDialogsParams;\n    }\n  ) => {\n    if (options.parameters?.type === MarkdownDialogType.cheatsheet) {\n      return ModalDialogLauncher.openDialog(options, () => {\n        return <CheatsheetModalDialog />;\n      });\n    } else if (options.parameters?.type === MarkdownDialogType.insertLink) {\n      const selectedText = options.parameters.selectedText;\n      return ModalDialogLauncher.openDialog<InsertLinkModalResult>(options, ({ onClose }) => {\n        return <InsertLinkModal selectedText={selectedText} onClose={onClose} />;\n      });\n    } else if (options.parameters?.type === MarkdownDialogType.insertSpecialCharacter) {\n      return ModalDialogLauncher.openDialog(options, ({ onClose }) => {\n        return <SpecialCharacterModalDialog onClose={onClose} />;\n      });\n    } else if (options.parameters?.type === MarkdownDialogType.insertTable) {\n      return ModalDialogLauncher.openDialog<InsertTableModalResult>(options, ({ onClose }) => {\n        return <InsertTableModal onClose={onClose} />;\n      });\n    } else if (options.parameters?.type === MarkdownDialogType.embedExternalContent) {\n      return ModalDialogLauncher.openDialog<EmbedExternalContentModalResult>(\n        options,\n        ({ onClose }) => {\n          return <EmbedExternalContentModal onClose={onClose} />;\n        }\n      );\n    } else if (options.parameters?.type === MarkdownDialogType.confirmInsertAsset) {\n      const locale = options.parameters.locale;\n      const assets = options.parameters.assets;\n      return ModalDialogLauncher.openDialog<boolean>(options, ({ onClose }) => {\n        return <ConfirmInsertAssetModalDialog onClose={onClose} locale={locale} assets={assets} />;\n      });\n    } else if (options.parameters?.type === MarkdownDialogType.zenMode) {\n      const initialValue = options.parameters.initialValue;\n      const locale = options.parameters.locale;\n      return ModalDialogLauncher.openDialog<ZenModeResult>(options, ({ onClose }) => {\n        return (\n          <ZenModeModalDialog\n            saveValueToSDK={(value) => {\n              if (value) {\n                return sdk?.field?.setValue(value);\n              }\n              return sdk?.field?.removeValue();\n            }}\n            onClose={onClose}\n            initialValue={initialValue}\n            locale={locale}\n            sdk={sdk as unknown as DialogExtensionSDK}\n            previewComponents={previewComponents}\n          />\n        );\n      });\n    }\n    return Promise.reject();\n  };\n","import React from 'react';\nimport { DialogExtensionSDK } from '@contentful/app-sdk';\nimport { MarkdownDialogsParams, MarkdownDialogType } from '../types';\nimport { SpecialCharacterModalDialog } from './SpecialCharacterModalDialog';\nimport { CheatsheetModalDialog } from './CheatsheetModalDialog';\nimport { InsertLinkModal } from './InsertLinkModalDialog';\nimport { InsertTableModal } from './InsertTableModalDialog';\nimport { EmbedExternalContentModal } from './EmdebExternalContentDialog';\nimport { ConfirmInsertAssetModalDialog } from './ConfirmInsertAssetModalDialog';\nimport { ZenModeModalDialog } from './ZenModeModalDialog';\n\nexport const renderMarkdownDialog = (\n  sdk: DialogExtensionSDK & { parameters: { invocation: MarkdownDialogsParams } }\n) => {\n  const parameters = sdk.parameters.invocation;\n  if (parameters.type === MarkdownDialogType.cheatsheet) {\n    sdk.window.startAutoResizer();\n    return <CheatsheetModalDialog />;\n  } else if (parameters.type === MarkdownDialogType.insertLink) {\n    const selectedText = parameters.selectedText;\n    sdk.window.startAutoResizer();\n    return <InsertLinkModal selectedText={selectedText} onClose={sdk.close} />;\n  } else if (parameters.type === MarkdownDialogType.insertSpecialCharacter) {\n    sdk.window.startAutoResizer();\n    return <SpecialCharacterModalDialog onClose={sdk.close} />;\n  } else if (parameters.type === MarkdownDialogType.insertTable) {\n    sdk.window.startAutoResizer();\n    return <InsertTableModal onClose={sdk.close} />;\n  } else if (parameters.type === MarkdownDialogType.embedExternalContent) {\n    sdk.window.startAutoResizer();\n    return <EmbedExternalContentModal onClose={sdk.close} />;\n  } else if (parameters.type === MarkdownDialogType.confirmInsertAsset) {\n    const locale = parameters.locale;\n    const assets = parameters.assets;\n    sdk.window.startAutoResizer();\n    return <ConfirmInsertAssetModalDialog onClose={sdk.close} locale={locale} assets={assets} />;\n  } else if (parameters.type === MarkdownDialogType.zenMode) {\n    const locale = parameters.locale;\n    const initialValue = parameters.initialValue;\n    // eslint-disable-next-line -- TODO: describe this disable  @typescript-eslint/no-explicit-any\n    sdk.window.updateHeight('100%' as any);\n    return (\n      <ZenModeModalDialog\n        onClose={sdk.close}\n        saveValueToSDK={() => {\n          // don't save changes in dialog mode\n        }}\n        initialValue={initialValue}\n        locale={locale}\n        sdk={sdk}\n      />\n    );\n  }\n\n  return <div />;\n};\n"],"names":["styles","root","css","display","zIndex","flexDirection","justifyContent","overflow","marginBottom","fontSize","tokens","fontSizeM","tab","cursor","color","gray700","padding","spacingXs","minWidth","border","gray400","borderTopLeftRadius","borderRadiusSmall","borderTopRightRadius","marginLeft","textAlign","backgroundColor","gray100","borderBottomColor","outline","boxShadow","boxShadowHeavy","transition","transitionEasingDefault","transitionDurationShort","inactiveTab","background","gray200","gray300","MarkdownTabItem","props","React","className","cx","isActive","onClick","onSelect","name","onKeyDown","e","keyCode","tabIndex","role","testId","children","MarkdownTabs","active","srOnly","position","width","height","margin","clip","Zen","label","rest","viewBox","d","Strikethrough","Indent","Dedent","Cubes","Table","SpecialChar","OrgLinks","Undo","Redo","HeadingSelector","handleMenuClick","heading","Menu","Trigger","List","Item","InsertLinkSelector","canAddNew","MultipleMediaContextMenu","Button","isDisabled","disabled","startIcon","AssetIcon","size","variant","onSelectExisting","placement","endIcon","ChevronDownIcon","onAddNew","Number","zIndexWorkbenchHeader","button","spacing2Xs","marginRight","icon","fill","verticalAlign","zenButton","zenButtonPressed","tooltip","zIndexTooltip","ToolbarButton","forwardRef","ref","tooltipPlace","otherProps","Tooltip","content","IconButton","MainButtons","mode","actions","headings","HeadingIcon","simple","bold","FormatBoldIcon","italic","FormatItalicIcon","quote","QuoteIcon","ul","ListBulletedIcon","ol","ListNumberedIcon","insertLink","LinkIcon","AdditionalButtons","strike","Icons","code","CodeIcon","hr","HorizontalRuleIcon","indent","dedent","embedExternalContent","insertTable","insertSpecialCharacter","organizeLinks","history","undo","redo","DefaultMarkdownToolbar","useState","showAdditional","setShowAdditional","Flex","MoreHorizontalIcon","linkExistingMedia","addNewMedia","canUploadAssets","openZenMode","marginTop","ZenMarkdownToolbar","closeZenMode","displayName","MarkdownToolbar","memo","userAgent","get","window","platform","ctrlKey","getCtrlKey","stripUnit","value","match","Error","parseFloat","createPrefixToggleFn","prefix","editor","lineStartsWith","removeFromLineBeginning","length","insertAtLineBeginning","wrapSelection","marker","emptyText","usePrimarySelection","getSelection","selectedText","getSelectedText","startsWith","endsWith","markerLength","textWithoutMarker","slice","replaceSelectedText","insertAtCursor","selectBackwards","test","MSStream","quoteToggleFn","codeToggleFn","create","modifySelection","link","url","text","title","h1","toggleHeader","h2","h3","ulToggleFn","olToggleFn","cmd","moveIfNotEmpty","nl","getNl","getIndentation","indentation","table","config","line","getCurrentLineNumber","nrows","ncols","cellWidth","Array","cell","join","separatorCell","baseRow","separatorRow","times","bodyRows","range","map","replace","concat","tableTemplate","rows","cols","restoreCursor","toggleFn","isList","selection","cb","lines","anchor","head","maxNumber","max","minNumber","min","undefined","forEach","lineNumber","i","listNumber","moveToLineBeginning","forLineIn","moveToLineEnd","getListNumber","isCurrentLineEmpty","isLineEmpty","linesToInsert","getLinesCount","prepareListWhitespace","result","getCurrentLine","n","level","initialCh","getCurrentCharacter","currentHeader","header","select","getPos","modifier","ch","selectHeader","repeat","extendSelectionBy","removedCh","getSelectionLength","removeSelectedText","diff","lineHeightDefault","spacingL","fontStackMonospace","gray900","red600","gray600","blue500","framed","maxHeight","zen","maxWidth","MarkdownTextarea","hostRef","useRef","setEditor","useEffect","current","host","options","direction","fixedHeight","readOnly","initializedWithValue","EDITOR_SIZE","shift","cm","CodeMirror","lineNumbers","undoDepth","matchBrackets","lineWrapping","lineSeparator","theme","tabSize","indentWithTabs","indentUnit","autoRefresh","spellcheck","inputStyle","setSize","on","throttle","heightAtLine","lastLine","next","setOption","Tab","Enter","Esc","getInputField","blur","destroy","toTextArea","disable","enable","attachEvent","fn","throttleInterval","addKeyShortcuts","addKeyMap","transform","acc","key","setValue","getValue","clearHistory","getCurrentLineLength","focus","skip","len","selectAll","execCommand","prop","wrapper","replacement","replaceRange","charCount","replaceSelection","getCursor","setCursor","getLine","defaultToCurrentLineNumber","lineCount","getHistorySize","which","historySize","setReadOnly","getHistory","setHistory","setFullsize","refresh","character","noFocus","scroll","from","to","setSelection","selections","listSelections","somethingSelected","getOption","what","CodeMirrorWrapper","api","Commands","hasUndo","hasRedo","events","onScroll","onChange","wrapChange","onPaste","insert","getContent","setContent","clear","B","I","createMarkdownEditor","Object","assign","minHeight","onReady","style","visible","MarkdownDialogType","borderBottomLeftRadius","borderBottomRightRadius","spacingS","help","fontSizeS","lineHeight","MarkdownHelp","Paragraph","TextLink","as","MarkdownBottomBar","flexColumnContainer","flexWrap","flexColumn","flexGrow","verticalDivider","borderRight","gray500","paddingRight","spacing3Xl","spacing2Xl","preview","unOrderedListPreview","listStyleType","orderedListPreview","markup","paddingLeft","fontSize2Xl","fontSizeXl","fontSizeL","helpItem","alignItems","spacingXl","helpLink","flexRowContainer","CheatsheetModalDialog","ModalContent","Heading","href","target","rel","openCheatsheetModal","dialogs","openCurrent","shouldCloseOnEscapePress","shouldCloseOnOverlayClick","parameters","type","cheatsheet","fontStackPrimary","spacingM","overflowY","rtl","MarkdownLink","Embedly","MarkdownPreview","cleanHTML","useMemo","DOMPurify","sanitize","Markdown","overrides","a","component","previewComponents","_props$previewCompone","embedly","MarkdownConstraints","constraints","ConstraintsUtils","fromFieldValidations","sdk","field","validations","checkConstraint","makeChecker","CharCounter","CharValidation","runtime","exports","Op","prototype","hasOwn","hasOwnProperty","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","obj","defineProperty","enumerable","configurable","writable","err","wrap","innerFn","outerFn","self","tryLocsList","generator","Generator","context","Context","_invoke","state","method","arg","done","delegate","delegateResult","maybeInvokeDelegate","ContinueSentinel","sent","_sent","dispatchException","abrupt","record","tryCatch","makeInvokeMethod","call","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","this","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","AsyncIterator","PromiseImpl","previousPromise","callInvokeWithMethodAndArg","resolve","reject","invoke","__await","then","unwrapped","error","TypeError","info","resultName","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","doneResult","isGeneratorFunction","genFun","ctor","constructor","mark","setPrototypeOf","__proto__","awrap","async","Promise","iter","keys","object","reverse","pop","skipTempReset","prev","charAt","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","module","regeneratorRuntime","accidentalStrictMode","globalThis","Function","urlRegex","isValidUrl","InsertLinkModal","onClose","mainInputRef","setText","setUrl","touched","setTouched","setTitle","onInsert","urlIsValid","_mainInputRef$current","Form","onSubmit","FormControl","id","Boolean","Label","TextInput","isInvalid","placeholder","maxLength","HelpText","ValidationMessage","ModalControls","specialCharacters","desc","buttonPanel","charButton","selectedCharButton","SpecialCharacterModalDialog","selectedCharacter","setSelectedCharacter","Text","String","fromCharCode","char","InsertTableModal","setRows","setColumns","rowsAreValid","inRange","colsAreValid","isRequired","toString","pattern","autoComplete","widthFiledGroup","radioButtonGroup","paddingTop","radioButton","isWidthValid","unit","EmbedExternalContentModal","selectedUnit","setUnit","setUrlValidity","setWidth","attachSocial","setAttachSocial","Radio","isChecked","Checkbox","fontColor","percent","px","makeEmbedlyLink","ConfirmInsertAssetModalDialog","assets","locale","localesNumber","EntityList","thumbnailUrl","thumbnailAltText","description","left","right","top","bottom","topSplit","bottomSplit","editorSplit","overflowX","editorSplitFullscreen","previewSplit","separator","hideButton","showButton","borderRightWidth","ZenModeModalDialog","initialValue","currentValue","setCurrentValue","showPreview","setShowPreview","updateHeight","setTimeout","createMarkdownActions","locales","saveValueToSDK","ChevronRightIcon","ChevronLeftIcon","makeAssetLink","asset","localeCode","fallbackCode","defaultLocaleCode","localizedFile","fallbackFile","defaultFile","file","isObject","str","trim","normalizeWhiteSpace","removeExtension","fileName","fileUrl","assetDomainMap","images","downloads","videos","_","p1","replaceAssetDomain","isLocalized","isFallback","asMarkdown","insertAssetLinks","otherLocales","filter","linksWithMeta","fallbackAssets","fields","fallbacks","links","extractTitle","split","tail","segments","PROCESSORS","inline","REGEXS","findInline","makeFinder","findRefs","findLabels","matches","re","RegExp","source","found","exec","lastIndex","index","findAll","hasTitle","isString","buildLabel","buildRef","insertAssetsWithConfirmation","confirmInsertAsset","merged","byHref","byOldId","alreadyAdded","extend","mergeLabels","hrefToRefId","labels","rewrites","oldLabel","newRefId","newId","LinkOrganizer","textOrLabels","ids","x","parseInt","isFinite","findMaxLabelId","notifier","success","navigator","openNewAsset","slideIn","waitForClose","entity","selectMultipleAssets","zenMode","container","fontFamily","MarkdownEditor","selectedTab","setSelectedTab","setCanUploadAssets","access","can","isActionDisabled","openMarkdownHelp","useCallback","trimmedValue","FieldConnector","isInitiallyDisabled","externalReset","ModalDialogLauncher","openDialog","_sdk$field","_sdk$field2","removeValue","invocation","startAutoResizer","close"],"mappings":"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"}
\ No newline at end of file
diff --git a/dist/field-editor-markdown.esm.js b/dist/field-editor-markdown.esm.js
index 8b38f61dfec2b7c26b9c80e9c8fce7ded3d18f4f..065b15a20496c814d47e5b8a3998a01e375973e6 100644
--- a/dist/field-editor-markdown.esm.js
+++ b/dist/field-editor-markdown.esm.js
@@ -4613,5 +4613,5 @@ var renderMarkdownDialog = function renderMarkdownDialog(sdk) {
   return React.createElement("div", null);
 };
 
-export { MarkdownEditorConnected as MarkdownEditor, MarkdownPreview, openMarkdownDialog, renderMarkdownDialog };
+export { MarkdownEditor, MarkdownEditorConnected, MarkdownPreview, openMarkdownDialog, renderMarkdownDialog };
 //# sourceMappingURL=field-editor-markdown.esm.js.map
diff --git a/dist/index.d.ts b/dist/index.d.ts
index 742c6b1d1db188ba90353574757ddd0e95476846..9e6a594505eacf4a230af9363aff96de47a815dd 100644
--- a/dist/index.d.ts
+++ b/dist/index.d.ts
@@ -1,5 +1,5 @@
 import './codemirrorImports';
-export { MarkdownEditorConnected as MarkdownEditor } from './MarkdownEditor';
+export { MarkdownEditorConnected, MarkdownEditor } from './MarkdownEditor';
 export { MarkdownPreview } from './components/MarkdownPreview';
 export { openMarkdownDialog } from './dialogs/openMarkdownDialog';
 export { renderMarkdownDialog } from './dialogs/renderMarkdownDialog';
