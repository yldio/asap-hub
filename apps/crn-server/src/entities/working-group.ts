import { WorkingGroupDataObject } from '@asap-hub/model';
import { FetchDiscoverQuery } from '../autogenerated-gql/graphql';

export type WorkingGroupSquidexGraphql = NonNullable<
  NonNullable<
    FetchDiscoverQuery['queryDiscoverContents']
  >[number]['flatData']['workingGroups']
>[number];

export const parseGraphQlWorkingGroup = (
  workingGroup: WorkingGroupSquidexGraphql,
): WorkingGroupDataObject => {
  const workingGroupDataObject = {
    id: workingGroup.id,
    title: workingGroup.flatData.title || '',
    description: workingGroup.flatData.description || '',
    lastUpdated: workingGroup.lastModified,
  };

  if (
    !workingGroup.flatData.externalLink ||
    !workingGroup.flatData.externalLinkText
  ) {
    return workingGroupDataObject;
  }

  return {
    id: workingGroup.id,
    title: workingGroup.flatData.title || '',
    description: workingGroup.flatData.description || '',
    lastUpdated: workingGroup.lastModified,
    externalLink: workingGroup.flatData.externalLink,
    externalLinkText: workingGroup.flatData.externalLinkText,
  };
};
